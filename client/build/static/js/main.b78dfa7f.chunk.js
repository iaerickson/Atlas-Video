(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,a,t){},24:function(e,a,t){"use strict";(function(e){var n=t(28),s=t(7),i=t(8),l=t(13),o=t(10),c=t(9),r=t(0),d=t.n(r),m=t(25),p=t(17),u=t.n(p),g=(t(40),t(21),{1:["span 12/span 24"],2:["span 12/span 12/13/25","span 12/span 12/13/13"],3:["span 6/span 12","span 6/span 12","span 6/span 12/7/19"],4:["span 6/span 12","span 6/span 12","span 6/span 12","span 6/span 12/7/13"],5:["span 3/span 4/13/9","span 3/span 4/13/13","span 3/span 4/13/17","span 3/span 4/13/21","span 9/span 16/10/21"],6:["span 3/span 4/13/7","span 3/span 4/13/11","span 3/span 4/13/15","span 3/span 4/13/19","span 3/span 4/13/23","span 9/span 16/10/21"],7:["span 3/span 4/13/5","span 3/span 4/13/9","span 3/span 4/13/13","span 3/span 4/13/17","span 3/span 4/13/21","span 3/span 4/13/25","span 9/span 16/10/21"]}),h=function(a){Object(o.a)(r,a);var t=Object(c.a)(r);function r(e){var a;return Object(s.a)(this,r),(a=t.call(this,e)).streamInit=function(e,a,t,n){var s={streamID:e,audio:!0,video:!0,screen:!1};switch(a){case"audio-only":s.video=!1;break;case"student":s.audio=!1;break;case"audience":s.video=!1,s.audio=!1;break;default:case"video":}var i=u.a.createStream(Object(m.merge)(s,n));return i.setVideoProfile(t),i},a.subscribeStreamEvents=function(){var e=Object(l.a)(a);e.client.on("stream-added",function(a){var t=a.stream;console.log("New stream added: "+t.getId()),console.log("At "+(new Date).toLocaleTimeString()),console.log("Subscribe ",t),e.client.subscribe(t,function(e){console.log("Subscribe stream failed",e)})}),e.client.on("peer-leave",function(a){console.log("Peer has left: "+a.uid),console.log((new Date).toLocaleTimeString()),console.log(a),e.removeStream(a.uid)}),e.client.on("stream-subscribed",function(a){var t=a.stream;console.log("Got stream-subscribed event"),console.log((new Date).toLocaleTimeString()),console.log("Subscribe remote stream successfully: "+t.getId()),console.log(a),e.addStream(t)}),e.client.on("stream-removed",function(a){var t=a.stream;console.log("Stream removed: "+t.getId()),console.log((new Date).toLocaleTimeString()),console.log(a),e.removeStream(t.getId())})},a.removeStream=function(e){a.state.streamList.map(function(t,s){if(t.getId()===e){t.close();var i=document.querySelector("#ag-item-"+e);i&&i.parentNode.removeChild(i);var l=Object(n.a)(a.state.streamList);l.splice(s,1),a.setState({streamList:l})}})},a.addStream=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.state.streamList.some(function(a){return a.getId()===e.getId()})||(t?a.setState({streamList:a.state.streamList.concat([e])}):a.setState({streamList:[e].concat(a.state.streamList)}))},a.handleCamera=function(e){e.currentTarget.classList.toggle("off"),a.localStream.isVideoOn()?a.localStream.disableVideo():a.localStream.enableVideo()},a.handleMic=function(e){e.currentTarget.classList.toggle("off"),a.localStream.isAudioOn()?a.localStream.disableAudio():a.localStream.enableAudio()},a.switchDisplay=function(e){e.currentTarget.classList.contains("disabled")||a.state.streamList.length<=1||("pip"===a.state.displayMode?a.setState({displayMode:"tile"}):"tile"===a.state.displayMode?a.setState({displayMode:"pip"}):"share"===a.state.displayMode||console.error("Display Mode can only be tile/pip/share"))},a.hideRemote=function(e){if(!(e.currentTarget.classList.contains("disabled")||a.state.streamList.length<=1)){var t=a.state.streamList[a.state.streamList.length-1].getId();Array.from(document.querySelectorAll(".ag-item:not(#ag-item-".concat(t,")"))).map(function(e){"none"!==e.style.display?e.style.display="none":e.style.display="block"})}},a.handleExit=function(e){if(!e.currentTarget.classList.contains("disabled"))try{a.client&&a.client.unpublish(a.localStream),a.localStream&&a.localStream.close(),a.client&&a.client.leave(function(){console.log("Client succeed to leave.")},function(){console.log("Client failed to leave.")})}finally{a.setState({readyState:!1}),a.client=null,a.localStream=null,window.location.hash=""}},a.client={},a.localStream={},a.shareClient={},a.shareStream={},a.state={displayMode:"pip",streamList:[],readyState:!1},a}return Object(i.a)(r,[{key:"componentWillMount",value:function(){var e=this,a=this.props;this.client=u.a.createClient({mode:a.transcode}),this.client.init(a.appId,function(){console.log("AgoraRTC client initialized"),e.subscribeStreamEvents(),e.client.join(a.appId,a.channel,a.uid,function(t){console.log("User "+t+" join channel successfully"),console.log("At "+(new Date).toLocaleTimeString()),e.localStream=e.streamInit(t,a.attendeeMode,a.videoProfile),e.localStream.init(function(){"audience"!==a.attendeeMode&&(e.addStream(e.localStream,!0),e.client.publish(e.localStream,function(e){console.log("Publish local stream error: "+e)})),e.setState({readyState:!0})},function(a){console.log("getUserMedia failed",a),e.setState({readyState:!0})})})})}},{key:"componentDidMount",value:function(){var a=document.querySelector("#ag-canvas"),t=document.querySelector(".ag-btn-group");a.addEventListener("mousemove",function(){e._toolbarToggle&&clearTimeout(e._toolbarToggle),t.classList.add("active"),e._toolbarToggle=setTimeout(function(){t.classList.remove("active")},2e3)})}},{key:"componentDidUpdate",value:function(){var e=document.querySelector("#ag-canvas");if("pip"===this.state.displayMode){var a=this.state.streamList.length;if(a>4)return void this.setState({displayMode:"tile"});this.state.streamList.map(function(t,n){var s=t.getId(),i=document.querySelector("#ag-item-"+s);i||((i=document.createElement("section")).setAttribute("id","ag-item-"+s),i.setAttribute("class","ag-item"),e.appendChild(i),t.play("ag-item-"+s)),n===a-1?i.setAttribute("style","grid-area: span 12/span 24/13/25"):i.setAttribute("style","grid-area: span 3/span 4/".concat(4+3*n,"/25;\n                    z-index:1;width:calc(100% - 20px);height:calc(100% - 20px)")),t.player.resize&&t.player.resize()})}else if("tile"===this.state.displayMode){var t=this.state.streamList.length;this.state.streamList.map(function(a,n){var s=a.getId(),i=document.querySelector("#ag-item-"+s);i||((i=document.createElement("section")).setAttribute("id","ag-item-"+s),i.setAttribute("class","ag-item"),e.appendChild(i),a.play("ag-item-"+s)),i.setAttribute("style","grid-area: ".concat(g[t][n])),a.player.resize&&a.player.resize()})}else this.state.displayMode}},{key:"componentWillUnmount",value:function(){this.client&&this.client.unpublish(this.localStream),this.localStream&&this.localStream.close(),this.client&&this.client.leave(function(){console.log("Client succeed to leave.")},function(){console.log("Client failed to leave.")})}},{key:"render",value:function(){var e="video"===this.props.attendeeMode?d.a.createElement("span",{onClick:this.handleCamera,className:"ag-btn videoControlBtn",title:"Enable/Disable Video"},d.a.createElement("i",{className:"ag-icon ag-icon-camera"}),d.a.createElement("i",{className:"ag-icon ag-icon-camera-off"})):"",a="audience"!==this.props.attendeeMode?d.a.createElement("span",{onClick:this.handleMic,className:"ag-btn audioControlBtn",title:"Enable/Disable Audio"},d.a.createElement("i",{className:"ag-icon ag-icon-mic"}),d.a.createElement("i",{className:"ag-icon ag-icon-mic-off"})):"",t=d.a.createElement("span",{onClick:this.switchDisplay,className:this.state.streamList.length>4?"ag-btn displayModeBtn disabled":"ag-btn displayModeBtn",title:"Switch Display Mode"},d.a.createElement("i",{className:"ag-icon ag-icon-switch-display"})),n=d.a.createElement("span",{className:this.state.streamList.length>4||"pip"!==this.state.displayMode?"ag-btn disableRemoteBtn disabled":"ag-btn disableRemoteBtn",onClick:this.hideRemote,title:"Hide Remote Stream"},d.a.createElement("i",{className:"ag-icon ag-icon-remove-pip"})),s=d.a.createElement("span",{onClick:this.handleExit,className:this.state.readyState?"ag-btn exitBtn":"ag-btn exitBtn disabled",title:"Exit"},d.a.createElement("i",{className:"ag-icon ag-icon-leave"}));return d.a.createElement("div",{id:"ag-canvas",style:{display:"grid",gridGap:"10px",alignItems:"center",justifyItems:"center",gridTemplateRows:"repeat(12, auto)",gridTemplateColumns:"repeat(24, auto)"}},d.a.createElement("div",{className:"ag-btn-group"},s,e,a,t,n))}}]),r}(d.a.Component);a.a=h}).call(this,t(16))},29:function(e,a,t){e.exports=t(45)},35:function(e,a,t){},36:function(e,a,t){},37:function(e,a){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAPCAYAAAGega+EAAAABGdBTUEAALGPC/xhBQAAASFJREFUOBHNk71qAkEUhR3jDwGFpLGSCBaCjZB0VoEQErAWHyMvYKFWiiD4LFaWFmmCnW9gmyZlcCBsvqM7G2aDu9p54XDn3HPu3ZnZ3UyGCIJgBG60GIQFa1QV+Qsnuwrc7tcSwAcYgpJ6Jyg750zPaplhuwZ3YK3NzJP60L+zGL6STGhXMhVTTPlIZ2wnIizgNce1yUfIkyvE8q0x5k0d/ZjgUfSy9lTwqv/JTqbUONl0eFXH5xV1uhf0dui5J1fBBmyB5XRj8iEwt9xaGd5zXJNeIQswBGknxeJFA9bkaQ+aOgCxD9EzJxJ6LSicdEuJk0Lx8gbl2NkKLHVW8rmX/UxPnsu2hoUXDOxSmIIf8A4qQH/1J9D3UQczmvW3R/ELvLZ7YNQHvpUAAAAASUVORK5CYII="},38:function(e,a,t){},40:function(e,a,t){},45:function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),i=t(23),l=t.n(i),o=t(7),c=t(8),r=t(10),d=t(9),m=t(26),p=t(1),u=(t(34),t(35),t(5)),g=(t(21),{minLength:function(e,a){return e.length<a?1:0},maxLength:function(e,a){return e.length>a?1:0},validChar:function(e){return/^[0-9a-zA-Z\_]+$/.test(e)?0:1},isNonEmpty:function(e){return""===e?1:0}}),h={"120p,120p_1":[160,120,15,65],"120p_3":[120,120,15,50],"180p,180p_1":[320,180,15,140],"180p_3":[180,180,15,100],"180p_4":[240,180,15,120],"240p,240p_1":[320,240,15,200],"240p_3":[240,240,15,140],"240p_4":[424,240,15,220],"360p,360p_1":[640,360,15,400],"360p_3":[360,360,15,260],"360p_4":[640,360,30,600],"360p_6":[360,360,30,400],"360p_7":[480,360,15,320],"360p_8":[480,360,30,490],"360p_9":[640,360,15,800],"360p_10":[640,360,24,800],"360p_11":[640,360,24,1e3],"480p,480p_1":[640,480,15,500],"480p_2":[640,480,30,1e3],"480p_3":[480,480,15,400],"480p_4":[640,480,30,750],"480p_6":[480,480,30,600],"480p_8":[848,480,15,610],"480p_9":[848,480,30,930],"480p_10":[640,480,10,400],"720p,720p_1":[1280,720,15,1130],"720p_2":[1280,720,15,2080],"720p_3":[1280,720,30,1710],"720p_5":[960,720,15,910],"720p_6":[960,720,30,1380],"1080p,1080p_1":[1920,1080,15,2080],"1080p_2":[1920,1080,30,3e3],"1080p_3":[1920,1080,30,3150],"1080p_5":[1920,1080,60,4780],"1440p,1440p_1":[2560,1440,30,4850],"1440p_2":[2560,1440,60,7350],"4k,4k_1":[3840,2160,30,8910],"4k_3":[3840,2160,60,13500]},v=(t(36),function(e){Object(r.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleChannel=function(e,a){n.setState({channel:e,joinBtn:a})},n.handleJoin=function(){n.state.joinBtn&&(console.log(n.state),u.set("channel",n.state.channel),u.set("baseMode",n.state.baseMode),u.set("transcode",n.state.transcode),u.set("attendeeMode",n.state.attendeeMode),u.set("videoProfile",n.state.videoProfile),window.location.hash="meeting")},n.state={joinBtn:!1,channel:"",baseMode:"avc",transcode:"interop",attendeeMode:"video",videoProfile:"480p_4"},n}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keypress",function(a){13===a.keyCode&&e.handleJoin()})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"wrapper index"},s.a.createElement("div",{className:"ag-header"}),s.a.createElement("div",{className:"ag-main"},s.a.createElement("section",{className:"login-wrapper"},s.a.createElement("div",{className:"login-header"},s.a.createElement("p",{className:"login-title"},"Welcome to Atlas"),s.a.createElement("p",{className:"login-subtitle"},"How Would You Like To Learn Today?")),s.a.createElement("div",{className:"login-body"},s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column is-12"},s.a.createElement(f,{onChange:this.handleChannel,placeholder:"Input a room name here"}))),s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column is-7"},s.a.createElement(b,{onChange:function(a){return e.setState({baseMode:a})}})),s.a.createElement("div",{className:"column is-5"},s.a.createElement(E,{onRadioChange:function(a){return e.setState({transcode:a})},onSelectChange:function(a){return e.setState({videoProfile:a})}}))),s.a.createElement("div",{className:"columns"},s.a.createElement("div",{className:"column"},s.a.createElement("div",{id:"attendeeMode",className:"control"},s.a.createElement("label",{className:"radio"},s.a.createElement("input",{onChange:function(a){return e.setState({attendeeMode:a.target.value})},value:"video",type:"radio",name:"attendee",defaultChecked:!0}),s.a.createElement("span",{className:"radio-btn"}),s.a.createElement("span",{className:"radio-img video"}),s.a.createElement("span",{className:"radio-msg"},"Video Call : join with video call")),s.a.createElement("br",null),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{onChange:function(a){return e.setState({attendeeMode:a.target.value})},value:"audio-only",type:"radio",name:"attendee"}),s.a.createElement("span",{className:"radio-btn"}),s.a.createElement("span",{className:"radio-img audio"}),s.a.createElement("span",{className:"radio-msg"},"Audio-only : join with audio call")),s.a.createElement("br",null),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{onChange:function(a){return e.setState({attendeeMode:a.target.value})},value:"audience",type:"radio",name:"attendee"}),s.a.createElement("span",{className:"radio-btn"}),s.a.createElement("span",{className:"radio-img audience"}),s.a.createElement("span",{className:"radio-msg"},"Audience : join as an audience")))))),s.a.createElement("div",{className:"login-footer"},s.a.createElement("a",{id:"joinBtn",onClick:this.handleJoin,disabled:!this.state.joinBtn,className:"ag-rounded button is-info"},"Join")))),s.a.createElement("div",{className:"ag-footer"},s.a.createElement("a",{className:"ag-href",href:"https://www.agora.io"}),s.a.createElement("div",null,s.a.createElement("span",null," "),s.a.createElement("span",{className:"ag-contact"}))))}}]),t}(s.a.Component)),f=function(e){Object(r.a)(n,e);var a=Object(d.a)(n);function n(e){var t;return Object(o.a)(this,n),(t=a.call(this,e)).validate=function(e){return t.setState({state:"",errorMsg:""}),g.isNonEmpty(e.trim())?(t.setState({errorMsg:"Cannot be empty!",state:"is-danger"}),!1):g.minLength(e.trim(),1)?(t.setState({errorMsg:"No shorter than 1!",state:"is-danger"}),!1):g.maxLength(e.trim(),16)?(t.setState({errorMsg:"No longer than 16!",state:"is-danger"}),!1):g.validChar(e.trim())?(t.setState({state:"is-danger",errorMsg:'Only capital or lower-case letter, number and "_" are permitted!'}),!1):(t.setState({state:"is-success"}),!0)},t.handleChange=function(e){var a=t.validate(e.target.value);t.props.onChange(e.target.value,a)},t.state={errorMsg:"",state:""},t}return Object(c.a)(n,[{key:"render",value:function(){var e="";switch(this.state.state){default:case"":e="";break;case"is-success":e=s.a.createElement("i",{className:"ag-icon ag-icon-valid"});break;case"is-danger":e=s.a.createElement("i",{className:"ag-icon ag-icon-invalid"})}return s.a.createElement("div",{className:"channel-wrapper control has-icons-left"},s.a.createElement("input",{onInput:this.handleChange,id:"channel",className:"ag-rounded input "+this.state.state,type:"text",placeholder:this.props.placeholder}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement("img",{src:t(37),alt:""})),s.a.createElement("span",{className:"validate-icon"},e),s.a.createElement("div",{className:"validate-msg"},this.state.errorMsg))}}]),n}(s.a.Component),b=function(e){Object(r.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleSelect=function(e){var a=e.label,t=e.value;n.setState({message:a,active:!1}),n.props.onChange(t)},n._options=[{label:"Tutoring Session",value:"avc",content:"One to one and group calls"},{label:"Classroom",value:"al",content:"Classroom setting with teacher and student-specific features"}],n.state={active:!1,message:"Type of Session"},n}return Object(c.a)(t,[{key:"render",value:function(){var e=this,a=this._options.map(function(a,t){return s.a.createElement("div",{className:"dropdown-item",key:t,onClick:function(t){return e.handleSelect(a,t)}},s.a.createElement("p",null,a.label),s.a.createElement("hr",null),s.a.createElement("p",null,a.content))});return s.a.createElement("div",{className:this.state.active?"dropdown is-active":"dropdown"},s.a.createElement("div",{className:"dropdown-trigger",onClick:function(){return e.setState({active:!e.state.active})}},s.a.createElement("a",{id:"baseMode",className:"ag-rounded button","aria-haspopup":"true","aria-controls":"baseModeOptions"},s.a.createElement("span",{id:"baseOptionLabel"},this.state.message),s.a.createElement("span",{className:"icon is-small"},s.a.createElement("i",{className:"ag-icon ag-icon-arrow-down","aria-hidden":"true"})))),s.a.createElement("div",{className:"dropdown-menu",id:"baseModeOptions",role:"menu"},s.a.createElement("div",{className:"dropdown-content"},a)))}}]),t}(s.a.Component),E=function(e){Object(r.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleRadio=function(e){n.props.onRadioChange(e.target.value)},n.handleSelect=function(e){n.props.onSelectChange(e.target.value)},n.state={active:!1},n}return Object(c.a)(t,[{key:"render",value:function(){var e=this,a=Object.entries(h).map(function(e,a){return s.a.createElement("option",{key:a,value:e[0].split(",")[0]},e[1][0],"x ",e[1][1],", ",e[1][2],"fps, ",e[1][3],"kbps")});return s.a.createElement("div",{className:this.state.active?"dropdown is-active":"dropdown"},s.a.createElement("div",{className:"dropdown-trigger",onClick:function(){return e.setState({active:!e.state.active})}},s.a.createElement("a",{id:"advancedProfile",className:"ag-rounded button","aria-haspopup":"true","aria-controls":"advancedOptions"},s.a.createElement("span",null,"Advanced"))),s.a.createElement("div",{className:"dropdown-menu",id:"advancedOptions",role:"menu"},s.a.createElement("div",{className:"dropdown-content"},s.a.createElement("div",{className:"dropdown-item"},s.a.createElement("div",{className:"control"},s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"",type:"radio",name:"transcode",onChange:this.handleRadio}),s.a.createElement("span",null,"VP8-only")),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"interop",type:"radio",defaultChecked:!0,onChange:this.handleRadio,name:"transcode"}),s.a.createElement("span",null,"VP8 & H264")),s.a.createElement("label",{className:"radio"},s.a.createElement("input",{value:"h264_interop",type:"radio",onChange:this.handleRadio,name:"transcode"}),s.a.createElement("span",null,"H264-only")))),s.a.createElement("div",{className:"dropdown-item"},s.a.createElement("div",{className:"select is-rounded"},s.a.createElement("select",{onChange:this.handleSelect,defaultValue:"480p_4",id:"videoProfile",className:"ag-rounded is-clipped"},a))))))}}]),t}(s.a.Component),y=v,N=t(14),S=(t(38),t(24)),w="39723728c05a49e0a905008432adb53e",C=function(e){Object(r.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).videoProfile=u.get("videoProfile").split(",")[0]||"480p_4",n.channel=u.get("channel")||"test",n.transcode=u.get("transcode")||"interop",n.attendeeMode=u.get("attendeeMode")||"video",n.baseMode=u.get("baseMode")||"avc",n.appId=w,n.appId?(n.uid=void 0,n):Object(N.a)(n,alert("Get App ID first!"))}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"wrapper meeting"},s.a.createElement("div",{className:"ag-header"},s.a.createElement("div",{className:"ag-header-lead"}),s.a.createElement("div",{className:"ag-header-msg"},"Room:\xa0",s.a.createElement("span",{id:"room-name"},this.channel))),s.a.createElement("div",{className:"ag-main"},s.a.createElement("div",{className:"ag-container"},s.a.createElement(S.a,{videoProfile:this.videoProfile,channel:this.channel,transcode:this.transcode,attendeeMode:this.attendeeMode,baseMode:this.baseMode,appId:this.appId,uid:this.uid}))),s.a.createElement("div",{className:"ag-footer"}))}}]),t}(s.a.Component),A=function(e){Object(r.a)(t,e);var a=Object(d.a)(t);function t(){return Object(o.a)(this,t),a.apply(this,arguments)}return Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(m.a,null,s.a.createElement("div",{className:"full"},s.a.createElement(p.a,{exact:!0,path:"/",component:y}),s.a.createElement(p.a,{path:"/meeting",component:C})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object.entries||(Object.entries=function(e){for(var a=Object.keys(e),t=a.length,n=new Array(t);t--;)n[t]=[a[t],e[a[t]]];return n});l.a.render(s.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,1,2]]]);
//# sourceMappingURL=main.b78dfa7f.chunk.js.map