{"ast":null,"code":"/*! AgoraRTC|BUILD v3.1.0-0-g75afd8f */\n!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define(\"AgoraRTC\", [], t) : \"object\" == typeof exports ? exports.AgoraRTC = t() : e.AgoraRTC = t();\n}(window, function () {\n  return function (e) {\n    var t = {};\n\n    function n(i) {\n      if (t[i]) return t[i].exports;\n      var a = t[i] = {\n        i: i,\n        l: !1,\n        exports: {}\n      };\n      return e[i].call(a.exports, a, a.exports, n), a.l = !0, a.exports;\n    }\n\n    return n.m = e, n.c = t, n.d = function (e, t, i) {\n      n.o(e, t) || Object.defineProperty(e, t, {\n        enumerable: !0,\n        get: i\n      });\n    }, n.r = function (e) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(e, \"__esModule\", {\n        value: !0\n      });\n    }, n.t = function (e, t) {\n      if (1 & t && (e = n(e)), 8 & t) return e;\n      if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n      var i = Object.create(null);\n      if (n.r(i), Object.defineProperty(i, \"default\", {\n        enumerable: !0,\n        value: e\n      }), 2 & t && \"string\" != typeof e) for (var a in e) n.d(i, a, function (t) {\n        return e[t];\n      }.bind(null, a));\n      return i;\n    }, n.n = function (e) {\n      var t = e && e.__esModule ? function () {\n        return e.default;\n      } : function () {\n        return e;\n      };\n      return n.d(t, \"a\", t), t;\n    }, n.o = function (e, t) {\n      return Object.prototype.hasOwnProperty.call(e, t);\n    }, n.p = \"\", n(n.s = 36);\n  }([function (e, t, n) {\n    \"use strict\";\n\n    n.r(t);\n    var i = n(9),\n        a = n.n(i),\n        r = n(12),\n        o = n(3),\n        s = n(2),\n        c = 0,\n        d = \"free\",\n        u = [],\n        l = [],\n        f = 0;\n    setInterval(function () {\n      Object(o.getParameter)(\"UPLOAD_LOG\") && p.info(\"console log upload\");\n    }, 9e5);\n\n    var p = function () {\n      var e,\n          t,\n          n,\n          i,\n          p,\n          g,\n          m = \"https://\".concat(Object(o.getParameter)(\"LOG_UPLOAD_SERVER\"), \"/upload/v1\"),\n          v = [\"DEBUG\", \"INFO\", \"WARNING\", \"ERROR\", \"NONE\"],\n          S = 0,\n          h = function e(t) {\n        d = \"uploading\", setTimeout(function () {\n          !function (e, t, n) {\n            var i;\n            Array.isArray(e) || (e = [e]), e = e.map(function (e) {\n              return {\n                log_item_id: c++,\n                log_level: e.log_level,\n                payload_str: e.payload\n              };\n            }), i = {\n              sdk_version: o.VERSION,\n              process_id: Object(s.a)(),\n              payload: JSON.stringify(e)\n            };\n\n            try {\n              Object(r.post)(m, i, function (e) {\n                \"OK\" === e ? t && t(e) : n && n(e);\n              }, function (e) {\n                n && n(e);\n              }, {\n                withCredentials: !0\n              });\n            } catch (e) {\n              n && n(e);\n            }\n          }(t, function () {\n            f = 0, 0 !== u.length ? (l = u.length < 10 ? u.splice(0, u.length) : u.splice(0, 10), e(l)) : d = \"free\";\n          }, function () {\n            setTimeout(function () {\n              e(l);\n            }, f++ < 2 ? 200 : 1e4);\n          });\n        }, 3e3);\n      };\n\n      t = function () {\n        for (var t = [0], n = 0; n < arguments.length; n++) t.push(arguments[n]);\n\n        e.apply(this, t);\n      }, n = function () {\n        for (var t = [1], n = 0; n < arguments.length; n++) t.push(arguments[n]);\n\n        e.apply(this, t);\n      }, i = function () {\n        for (var t = [2], n = 0; n < arguments.length; n++) t.push(arguments[n]);\n\n        e.apply(this, t);\n      }, p = function () {\n        for (var t = [3], n = 0; n < arguments.length; n++) t.push(arguments[n]);\n\n        e.apply(this, t);\n      };\n      var _ = {};\n      return g = function (e) {\n        _[e] || (i.apply(void 0, arguments), _[e] = !0);\n      }, {\n        DEBUG: 0,\n        INFO: 1,\n        WARNING: 2,\n        ERROR: 3,\n        NONE: 4,\n        enableLogUpload: function () {\n          Object(o.setParameter)(\"UPLOAD_LOG\", !0);\n        },\n        disableLogUpload: function () {\n          Object(o.setParameter)(\"UPLOAD_LOG\", !1);\n        },\n        setProxyServer: function (e) {\n          m = e ? \"https://\".concat(e, \"/ls/?h=\").concat(Object(o.getParameter)(\"LOG_UPLOAD_SERVER\"), \"&p=443&d=upload/v1\") : \"https://\".concat(Object(o.getParameter)(\"LOG_UPLOAD_SERVER\"), \"/upload/v1\");\n        },\n        setLogLevel: function (e) {\n          e > 4 ? e = 4 : e < 0 && (e = 0), S = e;\n        },\n        log: e = function () {\n          var e,\n              t = arguments[0],\n              n = arguments;\n          if (n[0] = (e = new Date()).toTimeString().split(\" \")[0] + \":\" + e.getMilliseconds() + \" Agora-SDK [\" + (v[t] || \"DEFAULT\") + \"]:\", function (e, t) {\n            if (Object(o.getParameter)(\"UPLOAD_LOG\")) try {\n              t = Array.prototype.slice.call(t);\n              var n = \"\";\n              t.forEach(function (e) {\n                \"object\" === a()(e) && (e = JSON.stringify(e)), n = n + e + \" \";\n              }), u.push({\n                payload: n,\n                log_level: e\n              }), \"free\" === d && (l = u.length < 10 ? u.splice(0, u.length) : u.splice(0, 10), h(l));\n            } catch (e) {}\n          }(t, n), !(t < S)) switch (t) {\n            case 0:\n            case 1:\n              console.log.apply(console, n);\n              break;\n\n            case 2:\n              console.warn.apply(console, n);\n              break;\n\n            case 3:\n              console.log.apply(console, n);\n              break;\n\n            default:\n              return void console.log.apply(console, n);\n          }\n        },\n        debug: t,\n        info: n,\n        warning: i,\n        deprecate: g,\n        error: p\n      };\n    }();\n\n    t.default = p;\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"checkValidObject\", function () {\n      return o;\n    }), n.d(t, \"checkValidString\", function () {\n      return s;\n    }), n.d(t, \"checkValidNumber\", function () {\n      return c;\n    }), n.d(t, \"checkValidFloatNumber\", function () {\n      return d;\n    }), n.d(t, \"checkValidBoolean\", function () {\n      return u;\n    }), n.d(t, \"checkValidEnum\", function () {\n      return r;\n    }), n.d(t, \"isValidString\", function () {\n      return l;\n    }), n.d(t, \"isValidNumber\", function () {\n      return f;\n    }), n.d(t, \"isValidBoolean\", function () {\n      return g;\n    }), n.d(t, \"isASCII\", function () {\n      return S;\n    }), n.d(t, \"isInteger\", function () {\n      return h;\n    }), n.d(t, \"isNumber\", function () {\n      return _;\n    }), n.d(t, \"isString\", function () {\n      return E;\n    }), n.d(t, \"isArray\", function () {\n      return I;\n    }), n.d(t, \"isEmpty\", function () {\n      return T;\n    }), n.d(t, \"isValidToken\", function () {\n      return m;\n    }), n.d(t, \"isValidChannelName\", function () {\n      return v;\n    });\n\n    var i = n(9),\n        a = n.n(i),\n        r = function (e, t, n) {\n      for (var i = 0; i < n.length; i++) if (e === n[i]) return !0;\n\n      throw new Error(\"\".concat(t, \" can only be set as \").concat(JSON.stringify(n)));\n    },\n        o = function (e, t) {\n      if (!e) throw new Error(\"Invalid param: \".concat(t || \"param\", \" cannot be empty\"));\n      if (\"object\" !== a()(e)) throw new Error(\"\".concat(t || \"This paramter\", \" is of the object type\"));\n      return !0;\n    },\n        s = function (e, t, n, i, a) {\n      if (T(n) && (n = 1), i = i || 255, T(a) && (a = !0), T(e)) throw new Error(\"\".concat(t || \"param\", \" cannot be empty\"));\n      if (!l(e, n, i, a)) throw new Error(\"Invalid \".concat(t || \"string param\", \": Length of the string: [\").concat(n, \",\").concat(i, \"].\").concat(a ? \" ASCII characters only.\" : \"\"));\n    },\n        c = function (e, t, n, i) {\n      if (T(n) && (n = 1), i = i || 1e4, T(e)) throw new Error(\"\".concat(t || \"param\", \" cannot be empty\"));\n      if (!f(e, n, i)) throw new Error(\"Invalid \".concat(t || \"number param\", \": The value range is [\").concat(n, \",\").concat(i, \"]. integer only\"));\n    },\n        d = function (e, t, n, i) {\n      if (null == e) throw new Error(\"\".concat(t || \"param\", \" cannot be null\"));\n      if (T(n) && (n = 0), i = i || 1e4, T(e)) throw new Error(\"\".concat(t || \"param\", \" cannot be empty\"));\n      if (!p(e, n, i)) throw new Error(\"Invalid \".concat(t || \"number param\", \": The value range is [\").concat(n, \",\").concat(i, \"].\"));\n    },\n        u = function (e, t) {\n      if (T(e)) throw new Error(\"\".concat(t || \"param\", \" cannot be empty\"));\n      if (!g(e)) throw new Error(\"Invalid \".concat(t || \"boolean param\", \": The value is of the boolean type.\"));\n    },\n        l = function (e, t, n, i) {\n      return t || (t = 0), n || (n = Number.MAX_SAFE_INTEGER), T(i) && (i = !0), E(e) && (!i || S(e)) && e.length >= t && e.length <= n;\n    },\n        f = function (e, t, n) {\n      return h(e) && e >= t && e <= n;\n    },\n        p = function (e, t, n) {\n      return _(e) && e >= t && e <= n;\n    },\n        g = function (e) {\n      return \"boolean\" == typeof e;\n    },\n        m = function (e) {\n      return l(e, 1, 2047);\n    },\n        v = function (e) {\n      return E(e) && /^[a-zA-Z0-9 \\!\\#\\$\\%\\&\\(\\)\\+\\-\\:\\;\\<\\=\\.\\>\\?\\@\\[\\]\\^\\_\\{\\}\\|\\~\\,]{1,64}$/.test(e);\n    },\n        S = function (e) {\n      if (\"string\" == typeof e) {\n        for (var t = 0; t < e.length; t++) {\n          var n = e.charCodeAt(t);\n          if (n < 0 || n > 255) return !1;\n        }\n\n        return !0;\n      }\n    },\n        h = function (e) {\n      return \"number\" == typeof e && e % 1 == 0;\n    },\n        _ = function (e) {\n      return \"number\" == typeof e;\n    },\n        E = function (e) {\n      return \"string\" == typeof e;\n    },\n        I = function (e) {\n      return e instanceof Array;\n    },\n        T = function (e) {\n      return null == e;\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    var i = n(15),\n        a = n.n(i),\n        r = n(6),\n        o = n.n(r),\n        s = n(3),\n        c = n(0),\n        d = n(12),\n        u = n(16),\n        l = n.n(u);\n    n.d(t, \"b\", function () {\n      return S;\n    }), n.d(t, \"a\", function () {\n      return v;\n    });\n\n    var f,\n        p,\n        g = {\n      eventType: null,\n      sid: null,\n      lts: null,\n      success: null,\n      cname: null,\n      uid: null,\n      peer: null,\n      cid: null,\n      elapse: null,\n      extend: null,\n      vid: 0\n    },\n        m = null,\n        v = function () {\n      return m || (m = \"process-\" + l()(), c.default.info(\"processId: \" + m)), m;\n    },\n        S = (p = 0, (f = {\n      list: {},\n      setProxyServer: function (e) {\n        f.proxyServerURL = e;\n      },\n      getUrl: function () {\n        return f.proxyServerURL ? \"https://\".concat(f.proxyServerURL, \"/rs/?h=\").concat(Object(s.getParameter)(\"EVENT_REPORT_DOMAIN\"), \"&p=6443&d=events/message\") : \"https://\".concat(Object(s.getParameter)(\"EVENT_REPORT_DOMAIN\"), \":6443/events/message\");\n      },\n      getBackUrl: function () {\n        return f.proxyServerURL ? \"https://\".concat(f.proxyServerURL, \"/rs/?h=\").concat(Object(s.getParameter)(\"EVENT_REPORT_BACKUP_DOMAIN\"), \"&p=6443&d=events/message\") : \"https://\".concat(Object(s.getParameter)(\"EVENT_REPORT_BACKUP_DOMAIN\"), \":6443/events/message\");\n      },\n      sessionInit: function (e, t) {\n        var n = o()({}, g);\n        n.startTime = +new Date(), n.sid = e, n.cname = t.cname, f.list[e] = n;\n        var i = o()({}, {\n          willUploadConsoleLog: Object(s.getParameter)(\"UPLOAD_LOG\")\n        }, t.extend),\n            a = o()({}, n);\n        a.eventType = \"session_init\", a.appid = t.appid, a.browser = navigator.userAgent, a.build = s.BUILD, a.lts = +new Date(), a.elapse = a.lts - a.startTime, a.extend = JSON.stringify(i), a.mode = t.mode, a.process = v(), a.success = t.succ, a.version = s.VERSION, delete a.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.Session\",\n          data: a\n        }), f._flushInvokeReport(e);\n      },\n      joinChooseServer: function (e, t, n) {\n        if (f.list[e]) {\n          t.uid && (f.list[e].uid = parseInt(t.uid)), t.cid && (f.list[e].cid = parseInt(t.cid));\n          var i = o()({}, f.list[e]);\n          i.eventType = \"join_choose_server\";\n          var a = t.lts;\n          i.lts = Date.now(), i.eventElapse = i.lts - a, i.chooseServerAddr = t.csAddr, i.errorCode = t.ec, i.elapse = i.lts - i.startTime, i.success = t.succ, i.chooseServerAddrList = JSON.stringify(t.serverList), delete i.startTime, f.send({\n            type: \"io.agora.pb.Wrtc.JoinChooseServer\",\n            data: i\n          });\n        }\n      },\n      reqUserAccount: function (e, t) {\n        t.vid && (f.list[e].vid = t.vid);\n        var n = o()({}, f.list[e]),\n            i = t.lts;\n        n.eventType = \"req_user_account\", n.lts = Date.now(), n.success = t.success, n.serverAddress = t.serverAddress, n.stringUid = t.stringUid, n.uid = t.uid, n.errorCode = t.errorCode, n.elapse = n.lts - n.startTime, n.eventElapse = n.lts - i, n.extend = \"string\" == typeof t.extend ? t.extend : JSON.stringify(t.extend), delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.ReqUserAccount\",\n          data: n\n        });\n      },\n      joinGateway: function (e, t) {\n        t.vid && (f.list[e].vid = t.vid);\n        var n = o()({}, f.list[e]),\n            i = t.lts;\n        n.eventType = \"join_gateway\", n.lts = Date.now(), n.gatewayAddr = t.addr, n.success = t.succ, n.errorCode = t.ec, n.elapse = n.lts - n.startTime, n.eventElapse = n.lts - i, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.JoinGateway\",\n          data: n\n        });\n      },\n      publish: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"publish\";\n        var i = t.lts;\n        n.lts = Date.now(), n.eventElapse = n.lts - i, n.elapse = n.lts - n.startTime, n.success = t.succ, n.errorCode = t.ec, t.videoName && (n.videoName = t.videoName), t.audioName && (n.audioName = t.audioName), t.screenName && (n.screenName = t.screenName), delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.Publish\",\n          data: n\n        }), f._flushInvokeReport(e);\n      },\n      subscribe: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"subscribe\";\n        var i = t.lts;\n        n.lts = Date.now(), n.eventElapse = n.lts - i, n.elapse = n.lts - n.startTime, n.errorCode = t.ec, n.success = t.succ, isFinite(t.peerid) ? n.peer = t.peerid : n.peerSuid = \"\" + t.peerid, \"boolean\" == typeof t.video && (n.video = t.video), \"boolean\" == typeof t.audio && (n.audio = t.audio), delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.Subscribe\",\n          data: n\n        }), f._flushInvokeReport(e);\n      },\n      firstRemoteFrame: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"first_remote_frame\";\n        var i = t.lts;\n        n.lts = Date.now(), n.eventElapse = n.lts - i, n.elapse = n.lts - n.startTime, n.width = t.width, n.height = t.height, n.success = t.succ, n.errorCode = t.ec, isFinite(t.peerid) ? n.peer = t.peerid : n.peerSuid = \"\" + t.peerid, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.FirstFrame\",\n          data: n\n        });\n      },\n      firstVideoReceived: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"first_video_received\", n.lts = Date.now(), n.peer = t.peerid, n.uid = t.uid, n.elapse = t.elapse, f.send({\n          type: \"io.agora.pb.Wrtc.FirstVideoReceived\",\n          data: n\n        });\n      },\n      firstAudioReceived: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"first_audio_received\", n.lts = Date.now(), n.peer = t.peerid, n.uid = t.uid, n.elapse = t.elapse, f.send({\n          type: \"io.agora.pb.Wrtc.FirstAudioReceived\",\n          data: n\n        });\n      },\n      firstVideoDecode: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"first_video_decode\", n.lts = Date.now(), n.peer = t.peerid, n.uid = t.uid, n.elapse = t.elapse, n.videowidth = t.width, n.videoheight = t.height, f.send({\n          type: \"io.agora.pb.Wrtc.FirstVideoDecode\",\n          data: n\n        });\n      },\n      firstAudioDecode: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"first_audio_decode\", n.lts = Date.now(), n.uid = t.uid, n.peer = t.peerid, n.elapse = t.elapse, f.send({\n          type: \"io.agora.pb.Wrtc.FirstAudioDecode\",\n          data: n\n        });\n      },\n      onAddAudioStream: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"on_add_audio_stream\", n.lts = Date.now(), n.uid = t.uid, n.peer = t.peerid, f.send({\n          type: \"io.agora.pb.Wrtc.OnAddAudioStream\",\n          data: n\n        });\n      },\n      onAddVideoStream: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"on_add_video_stream\", n.lts = Date.now(), n.uid = t.uid, n.peer = t.peerid, f.send({\n          type: \"io.agora.pb.Wrtc.OnAddVideoStream\",\n          data: n\n        });\n      },\n      onUpdateStream: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"on_update_stream\", n.lts = Date.now(), n.uid = t.uid, n.peer = t.peerid, n.audio = t.audio, n.video = t.video, f.send({\n          type: \"io.agora.pb.Wrtc.OnUpdateStream\",\n          data: n\n        });\n      },\n      onRemoveStream: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"on_remove_stream\", n.lts = Date.now(), n.uid = t.uid, n.peer = t.peerid, f.send({\n          type: \"io.agora.pb.Wrtc.OnRemoveStream\",\n          data: n\n        });\n      },\n      streamSwitch: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"stream_switch\", n.lts = Date.now(), n.isDual = t.isdual, n.elapse = n.lts - n.startTime, n.success = n.succ, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.StreamSwitch\",\n          data: n\n        });\n      },\n      audioSendingStopped: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"audio_sending_stopped\", n.lts = Date.now(), n.elapse = n.lts - n.startTime, n.reason = t.reason, n.success = t.succ, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.AudioSendingStopped\",\n          data: n\n        });\n      },\n      videoSendingStopped: function (e, t) {\n        var n = o()({}, f.list[e]);\n        n.eventType = \"video_sending_stopped\", n.lts = Date.now(), n.elapse = n.lts - n.startTime, n.reson = t.reason, n.success = t.succ, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.VideoSendingStopped\",\n          data: n\n        });\n      },\n      requestProxyAppCenter: function (e, t) {\n        var n = o()({}, f.list[e]),\n            i = t.lts;\n        n.eventType = \"request_proxy_appcenter\", n.lts = Date.now(), n.eventElapse = n.lts - i, n.elapse = n.lts - n.startTime, n.extend = t.extend + \"\", n.APAddr = t.APAddr, n.workerManagerList = t.workerManagerList, n.response = t.response, n.errorCode = t.ec, n.success = t.succ, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.RequestProxyAppCenter\",\n          data: n\n        });\n      },\n      requestProxyWorkerManager: function (e, t) {\n        var n = o()({}, f.list[e]),\n            i = t.lts;\n        n.eventType = \"request_proxy_worker_manager\", n.lts = Date.now(), n.eventElapse = n.lts - i, n.elapse = n.lts - n.startTime, n.extend = t.extend, n.workerManagerAddr = t.workerManagerAddr, n.response = t.response, n.errorCode = t.ec, n.success = t.succ, delete n.startTime, f.send({\n          type: \"io.agora.pb.Wrtc.RequestProxyWorkerManager\",\n          data: n\n        });\n      }\n    }).reportApiInvoke = function (e, t) {\n      var n = t.tag,\n          i = t.name,\n          r = t.getStates,\n          o = t.options,\n          d = t.timeout,\n          u = void 0 === d ? 6e4 : d,\n          l = t.callback,\n          f = t.reportResult,\n          g = void 0 === f || f,\n          m = Date.now(),\n          v = 0,\n          h = p++,\n          _ = function () {\n        return a()({\n          tag: n,\n          invokeId: h,\n          sid: e,\n          name: i,\n          apiInvokeTime: m,\n          options: o\n        }, r && {\n          states: (t = r(), Object.keys(t).reduce(function (e, n) {\n            var i = e;\n            return null != t[n] && (i[n] = t[n]), i;\n          }, {}))\n        });\n        var t;\n      },\n          E = !!Object(s.getParameter)(\"SHOW_REPORT_INVOKER_LOG\");\n\n      E && c.default.info(\"\".concat(i, \" start\"));\n      var I = setTimeout(function () {\n        S._sendApiInvoke(a()({}, _(), {\n          error: \"API_INVOKE_TIMEOUT\",\n          success: !1\n        }));\n      }, u);\n      return function (e, t) {\n        if (clearTimeout(I), ++v > 1 && (e = \"EXECUTOR_INVOKE_\".concat(v)), e) return S._sendApiInvoke(a()({}, _(), {\n          success: !1,\n          error: e\n        }, r && {\n          states: r()\n        })), E && c.default.info(\"\".concat(i, \" onFailure\"), e), l && l(e);\n        S._sendApiInvoke(a()({}, _(), {\n          success: !0\n        }, g && {\n          result: t\n        }, r && {\n          states: r()\n        })), E && c.default.info(\"\".concat(i, \" onSuccess\")), l && l(null, t);\n      };\n    }, f._cachedItems = [], f._cacheInvokeReport = function (e) {\n      e.lts || (e.lts = Date.now()), f._cachedItems.push(e), f._cachedItems.length > 50 && f._cachedItems.shift();\n    }, f._flushInvokeReport = function (e) {\n      if (f._cachedItems.length) {\n        var t = f._cachedItems;\n        f._cachedItems = [], c.default.debug(\"Flush cached event reporting:\", t.length), t.forEach(function (t, n) {\n          t.sid = e, setTimeout(function () {\n            f._sendApiInvoke(t);\n          }, 5e3 + 500 * n);\n        });\n      }\n    }, f._sendApiInvoke = function (e) {\n      var t = e.tag,\n          n = e.invokeId,\n          i = e.sid,\n          r = e.name,\n          o = e.result,\n          c = e.states,\n          d = e.options,\n          u = e.error,\n          l = e.success,\n          p = e.apiInvokeTime,\n          g = e.lts,\n          m = Object(s.getParameter)(\"NOT_REPORT_EVENT\");\n      if (!(t && m instanceof Array && -1 !== m.indexOf(t))) if (f.list[i]) {\n        var v = f.list[i],\n            S = v.startTime,\n            h = v.cname,\n            _ = v.uid,\n            E = v.cid,\n            I = (g = g || Date.now()) - S,\n            T = g - p,\n            y = \"\";\n        if (d) try {\n          y = JSON.stringify(d);\n        } catch (e) {\n          y = d.toString();\n        }\n        var b = a()({\n          invokeId: n,\n          sid: i,\n          cname: h,\n          cid: E,\n          lts: g,\n          uid: _,\n          success: l,\n          elapse: I,\n          apiName: r,\n          execElapse: T\n        }, void 0 !== d && {\n          options: y\n        }, void 0 !== c && {\n          execStates: JSON.stringify(c)\n        }, void 0 !== u && {\n          errorCode: JSON.stringify(u)\n        }, void 0 !== o && {\n          execResult: JSON.stringify(o)\n        });\n        f.send({\n          type: \"io.agora.pb.Wrtc.ApiInvoke\",\n          data: b\n        });\n      } else f._cacheInvokeReport(arguments[0]);\n    }, f._send = function (e) {\n      try {\n        var t = [];\n        e && e.data && e.data.apiName ? t.push([\"apiName\", \"\" + e.data.apiName]) : e && e.data && e.data.eventType && t.push([\"eventType\", e.data.eventType]);\n        var n = t.map(function (e) {\n          return \"\".concat(e[0], \"=\").concat(encodeURIComponent(e[1]));\n        }).join(\"&\"),\n            i = f.getUrl();\n        i = -1 === f.getUrl().indexOf(\"?\") ? \"\".concat(i, \"?\").concat(n) : i, Object(d.post)(i, e, null, function (t) {\n          var i = f.getBackUrl();\n          i = -1 === i.indexOf(\"?\") ? \"\".concat(i, \"?\").concat(n) : i, Object(d.post)(i, e, null, function (e) {}, {\n            timeout: 1e4\n          });\n        }, {\n          timeout: 1e4\n        });\n      } catch (e) {\n        console.error(e);\n      }\n    }, f.sendCache = [], f.sendTimer = null, f.send = function (e) {\n      if (e.data) {\n        var t = e.data;\n        f._lastLts && f._lastLts >= t.lts && (t.lts = f._lastLts + 1), f._lastLts = t.lts;\n      }\n\n      if (f.sendCache.push(e), null === f.sendTimer) return function e() {\n        f.sendTimer = setTimeout(function () {\n          if (0 !== f.sendCache.length) return f._send(f.sendCache.shift()), e();\n          f.sendTimer = null;\n        }, Object(s.getParameter)(\"EVENT_REPORT_SEND_INTERVAL\"));\n      }();\n    }, f);\n  }, function (e, t, n) {\n    \"use strict\";\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n    t.BUILD = \"v3.1.0-0-g75afd8f\";\n    t.VERSION = \"3.1.0\";\n    var i = 0 * Date.now() + 11499 + 86604 + 5615 + 6547 + 846;\n    t.SUPPORT_RESOLUTION_LIST = {\n      \"90p_1\": [160, 90, null, null, null, null],\n      \"120p_1\": [160, 120, 15, 15, 30, 65],\n      \"120p_3\": [120, 120, 15, 15, 30, 50],\n      \"120p_4\": [212, 120, null, null, null, null],\n      \"180p_1\": [320, 180, 15, 15, 30, 140],\n      \"180p_3\": [180, 180, 15, 15, 30, 100],\n      \"180p_4\": [240, 180, 15, 15, 30, 120],\n      \"240p_1\": [320, 240, 15, 15, 40, 200],\n      \"240p_3\": [240, 240, 15, 15, 40, 140],\n      \"240p_4\": [424, 240, 15, 15, 40, 220],\n      \"360p_1\": [640, 360, 15, 15, 80, 400],\n      \"360p_3\": [360, 360, 15, 15, 80, 260],\n      \"360p_4\": [640, 360, 30, 30, 80, 600],\n      \"360p_6\": [360, 360, 30, 30, 80, 400],\n      \"360p_7\": [480, 360, 15, 15, 80, 320],\n      \"360p_8\": [480, 360, 30, 30, 80, 490],\n      \"360p_9\": [640, 360, 15, 15, 80, 800],\n      \"360p_10\": [640, 360, 24, 24, 80, 800],\n      \"360p_11\": [640, 360, 24, 24, 80, 1e3],\n      \"480p_1\": [640, 480, 15, 15, 100, 500, 1, 5],\n      \"480p_2\": [640, 480, 30, 30, 100, 1e3, 25, 30],\n      \"480p_3\": [480, 480, 15, 15, 100, 400],\n      \"480p_4\": [640, 480, 30, 30, 100, 750],\n      \"480p_6\": [480, 480, 30, 30, 100, 600],\n      \"480p_8\": [848, 480, 15, 15, 100, 610],\n      \"480p_9\": [848, 480, 30, 30, 100, 930],\n      \"480p_10\": [640, 480, 10, 10, 100, 400],\n      \"720p_1\": [1280, 720, 15, 15, 120, 1130, 1, 5],\n      \"720p_2\": [1280, 720, 30, 30, 120, 2e3, 25, 30],\n      \"720p_3\": [1280, 720, 30, 30, 120, 1710],\n      \"720p_5\": [960, 720, 15, 15, 120, 910],\n      \"720p_6\": [960, 720, 30, 30, 120, 1380],\n      \"1080p_1\": [1920, 1080, 15, 15, 120, 2080, 1, 5],\n      \"1080p_2\": [1920, 1080, 30, 30, 120, 3e3, 25, 30],\n      \"1080p_3\": [1920, 1080, 30, 30, 120, 3150],\n      \"1080p_5\": [1920, 1080, 60, 60, 120, 4780],\n      \"1440p_1\": [2560, 1440, 30, 30, 120, 4850],\n      \"1440p_2\": [2560, 1440, 60, 60, 120, 7350],\n      \"4k_1\": [3840, 2160, 30, 30, 120, 8910],\n      \"4k_3\": [3840, 2160, 60, 60, 120, 13500]\n    };\n    t.AUDIO_PROFILE_SETTINGS = {\n      speech_low_quality: [!1, !1, !0, !0],\n      speech_standard: [!1, !1, !0, !1],\n      music_standard: [!1, !1, !1, !1],\n      standard_stereo: [!1, !0, !1, !1],\n      high_quality: [!0, !1, !1, !1],\n      high_quality_stereo: [!0, !0, !1, !1],\n      default: [!1, !1, !1, !1]\n    };\n    var a = {\n      WEBCS_DOMAIN: [\"webrtc2-ap-web-1.agora.io\", \"webrtc2-ap-web-2.agoraio.cn\"],\n      WEBCS_DOMAIN_BACKUP_LIST: [\"webrtc2-ap-web-3.agora.io\", \"webrtc2-ap-web-4.agoraio.cn\"],\n      PROXY_CS: [\"ap-proxy-1.agora.io\", \"ap-proxy-2.agora.io\"],\n      CDS_AP: [\"cds-ap-web-1.agora.io\", \"cds-ap-web-2.agoraio.cn\", \"cds-ap-web-3.agora.io\", \"cds-ap-web-4.agoraio.cn\"],\n      ACCOUNT_REGISTER: [\"sua-ap-web-1.agora.io\", \"sua-ap-web-2.agoraio.cn\", \"sua-ap-web-3.agora.io\", \"sua-ap-web-4.agoraio.cn\"],\n      UAP_AP: [\"uap-ap-web-1.agora.io\", \"uap-ap-web-2.agoraio.cn\", \"uap-ap-web-3.agora.io\", \"uap-ap-web-4.agoraio.cn\"],\n      ENABLE_LIVE_SERVER_LIST: !1,\n      LIVE_SERVER_LIST: [],\n      ACCOUNT_REGISTER_RETRY_TIMEOUT: 1,\n      ACCOUNT_REGISTER_RETRY_RATIO: 2,\n      ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX: 6e4,\n      ACCOUNT_REGISTER_RETRY_COUNT_MAX: 1e5,\n      AUDIO_CONTEXT: null,\n      GATEWAY_DOMAINS: [\"edge.agora.io\", \"edge.agoraio.cn\"],\n      LOG_UPLOAD_SERVER: \"logservice.agora.io\",\n      EVENT_REPORT_DOMAIN: \"webcollector-1.agora.io\",\n      EVENT_REPORT_BACKUP_DOMAIN: \"webcollector-2.agoraio.cn\",\n      WEBCS_BACKUP_CONNECT_TIMEOUT: 6e3,\n      LIVESTREAMING_ALIGN: !0,\n      HTTP_CONNECT_TIMEOUT: 5e3,\n      PLAYER_STATE_DEFER: 2e3,\n      SIGNAL_REQUEST_TIMEOUT: 1e7,\n      SIGNAL_REQUEST_WATCH_INTERVAL: 1e3,\n      REPORT_STATS: !0,\n      REPORT_STATS_TIMEOUT: 3e3,\n      UPLOAD_LOG: !1,\n      NOT_REPORT_EVENT: [],\n      FILEPATH_LENMAX: 255,\n      SUBSCRIBE_TCC: !1,\n      PING_PONG_TIME_OUT: 10,\n      DUALSTREAM_OPERATION_CHECK: !0,\n      WEBSOCKET_TIMEOUT_MIN: 1e4,\n      EVENT_REPORT_SEND_INTERVAL: 1e3,\n      MEDIA_ELEMENT_EXISTS_DEPTH: 3,\n      CANDIDATE_TIMEOUT: 2e3,\n      SHIM_CANDIDATE: !1,\n      LEAVE_MSG_TIMEOUT: 2e3,\n      TICKET_RENEW_TIMEOUT: 828e5,\n      SHOW_REPORT_INVOKER_LOG: !1,\n      STATS_FILTER: {\n        transportId: !0,\n        googTrackId: !0\n      },\n      FORCE_TURN: !1,\n      TURN_ENABLE_TCP: !0,\n      TURN_ENABLE_UDP: !0,\n      FORCE_CHANGED_GATEWAY_FLAG: !1,\n      JOIN_EXTEND: \"\",\n      PUB_EXTEND: \"\",\n      SUB_EXTEND: \"\",\n      CHROME_NEW_STATS: !1,\n      AP_BACKOFF_MAX_TIME: 8,\n      SET_DEFAULT_TURNSERVER: !0,\n      TURN_SERVER_PASSWORD: i.toString()\n    };\n\n    t.setParameter = function (e, t) {\n      return void 0 !== a[e] && (a[e] = t, !0);\n    };\n\n    t.getParameter = function (e) {\n      return void 0 !== a[e] ? a[e] : null;\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"APErrorCode\", function () {\n      return i;\n    }), n.d(t, \"GatewayErrorCode\", function () {\n      return a;\n    }), n.d(t, \"StringUidErrorCode\", function () {\n      return r;\n    }), n.d(t, \"JOIN_GS_TRYNEXT_LIST\", function () {\n      return o;\n    }), n.d(t, \"JOIN_CS_RETRY_LIST\", function () {\n      return s;\n    }), n.d(t, \"INJECT_STREAM_STATUS\", function () {\n      return c;\n    });\n    var i = {\n      101100: \"NO_FLAG_SET\",\n      101101: \"FLAG_SET_BUT_EMPTY\",\n      101102: \"INVALID_FALG_SET\",\n      101203: \"NO_SERVICE_AVIABLE\",\n      0: \"OK_CODE\",\n      5: \"INVALID_VENDOR_KEY\",\n      7: \"INVALID_CHANNEL_NAME\",\n      8: \"INTERNAL_ERROR\",\n      9: \"NO_AUTHORIZED\",\n      10: \"DYNAMIC_KEY_TIMEOUT\",\n      11: \"NO_ACTIVE_STATUS\",\n      13: \"DYNAMIC_KEY_EXPIRED\",\n      14: \"STATIC_USE_DYANMIC_KEY\",\n      15: \"DYNAMIC_USE_STATIC_KEY\",\n      1010100: \"NO_FLAG_SET\",\n      1010101: \"FLAG_SET_BUT_EMPTY\",\n      1010102: \"INVALID_FALG_SET\",\n      1010200: \"NO_SERVICE_AVAILABLE\",\n      1010203: \"NO_SERVICE_AVAILABLE_WEBRTC\",\n      1010205: \"NO_SERVICE_AVAILABLE_DISPATCHER\",\n      1010208: \"NO_SERVICE_AVAILABLE_APPCENTER\",\n      1010211: \"NO_SERVICE_AVAILABLE_SUA\",\n      2010005: \"INVALID_VENDOR_KEY\",\n      2010007: \"INVALID_CHANNEL_NAME\",\n      2010008: \"INTERNAL_ERROR\",\n      2010009: \"NO_AUTHORIZED\",\n      2010010: \"DYNAMIC_KEY_TIMEOUT\",\n      2010011: \"NO_ACTIVE_STATUS\",\n      2010013: \"DYNAMIC_KEY_EXPIRED\",\n      2010014: \"STATIC_USE_DYANMIC_KEY\",\n      2010015: \"DYNAMIC_USE_STATIC_KEY\"\n    },\n        a = {\n      2000: \"ERR_NO_VOCS_AVAILABLE\",\n      2001: \"ERR_NO_VOS_AVAILABLE\",\n      2002: \"ERR_JOIN_CHANNEL_TIMEOUT\",\n      2003: \"WARN_REPEAT_JOIN\",\n      2004: \"ERR_JOIN_BY_MULTI_IP\",\n      2011: \"ERR_NOT_JOINED\",\n      2012: \"WARN_REPEAT_JOIN\",\n      2013: \"ERR_INVALID_VENDOR_KEY\",\n      2014: \"ERR_INVALID_CHANNEL_NAME\",\n      2015: \"ERR_INVALID_STRINGUID\",\n      2016: \"ERR_TOO_MANY_USERS\",\n      2017: \"ERR_SET_CLIENT_ROLE_TIMEOUT\",\n      2018: \"ERR_SET_CLIENT_ROLE_NO_PERMISSION\",\n      2019: \"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE\",\n      2020: \"ERR_PUBLISH_REQUEST_INVALID\",\n      2021: \"ERR_SUBSCRIBE_REQUEST_INVALID\",\n      2022: \"ERR_NOT_SUPPORTED_MESSAGE\",\n      2023: \"ERR_ILLEAGAL_PLUGIN\",\n      101: \"ERR_INVALID_VENDOR_KEY\",\n      102: \"ERR_INVALID_CHANNEL_NAME\",\n      103: \"WARN_NO_AVAILABLE_CHANNEL\",\n      104: \"WARN_LOOKUP_CHANNEL_TIMEOUT\",\n      105: \"WARN_LOOKUP_CHANNEL_REJECTED\",\n      106: \"WARN_OPEN_CHANNEL_TIMEOUT\",\n      107: \"WARN_OPEN_CHANNEL_REJECTED\",\n      108: \"WARN_REQUEST_DEFERRED\",\n      109: \"ERR_DYNAMIC_KEY_TIMEOUT\",\n      110: \"ERR_NO_AUTHORIZED\",\n      111: \"ERR_VOM_SERVICE_UNAVAILABLE\",\n      112: \"ERR_NO_CHANNEL_AVAILABLE_CODE\",\n      113: \"ERR_TOO_MANY_USERS\",\n      114: \"ERR_MASTER_VOCS_UNAVAILABLE\",\n      115: \"ERR_INTERNAL_ERROR\",\n      116: \"ERR_NO_ACTIVE_STATUS\",\n      117: \"ERR_INVALID_UID\",\n      118: \"ERR_DYNAMIC_KEY_EXPIRED\",\n      119: \"ERR_STATIC_USE_DYANMIC_KE\",\n      120: \"ERR_DYNAMIC_USE_STATIC_KE\",\n      2: \"K_TIMESTAMP_EXPIRED\",\n      3: \"K_CHANNEL_PERMISSION_INVALID\",\n      4: \"K_CERTIFICATE_INVALID\",\n      5: \"K_CHANNEL_NAME_EMPTY\",\n      6: \"K_CHANNEL_NOT_FOUND\",\n      7: \"K_TICKET_INVALID\",\n      8: \"K_CHANNEL_CONFLICTED\",\n      9: \"K_SERVICE_NOT_READY\",\n      10: \"K_SERVICE_TOO_HEAVY\",\n      14: \"K_UID_BANNED\",\n      15: \"K_IP_BANNED\",\n      16: \"K_CHANNEL_BANNED\"\n    },\n        r = {\n      1: \"ERROR_ILLEAGAL_APPID\",\n      2: \"ERROR_ILLEAGAL_UID\",\n      3: \"INTERNAL_SERVER_ERROR\"\n    },\n        o = [\"ERR_NO_VOCS_AVAILABLE\", \"ERR_NO_VOS_AVAILABLE\", \"ERR_JOIN_CHANNEL_TIMEOUT\", \"WARN_LOOKUP_CHANNEL_TIMEOUT\", \"WARN_OPEN_CHANNEL_TIMEOUT\", \"ERR_VOM_SERVICE_UNAVAILABLE\", \"ERR_TOO_MANY_USERS\", \"ERR_MASTER_VOCS_UNAVAILABLE\", \"ERR_INTERNAL_ERROR\"],\n        s = [\"NO_FLAG_SET\", \"NO_SERVICE_AVIABLE\", \"FLAG_SET_BUT_EMPTY\", \"EMPTY_ADDRESS_RESPONSE\"],\n        c = {\n      INJECT_STREAM_STATUS_START_SUCCESS: 0,\n      INJECT_STREAM_STATUS_START_ALREADY_EXISTS: 1,\n      INJECT_STREAM_STATUS_START_UNAUTHORIZED: 2,\n      INJECT_STREAM_STATUS_START_TIMEDOUT: 3,\n      INJECT_STREAM_STATUS_START_FAILED: 4,\n      INJECT_STREAM_STATUS_STOP_SUCCESS: 5,\n      INJECT_STREAM_STATUS_STOP_NOT_FOUND: 6,\n      INJECT_STREAM_STATUS_STOP_UNAUTHORIZED: 7,\n      INJECT_STREAM_STATUS_STOP_TIMEDOUT: 8,\n      INJECT_STREAM_STATUS_STOP_FAILED: 9,\n      INJECT_STREAM_STATUS_BROKEN: 10\n    };\n    t.default = {\n      FAILED: \"FAILED\",\n      INVALID_KEY: \"INVALID_KEY\",\n      INVALID_CLIENT_MODE: \"INVALID_CLIENT_MODE\",\n      INVALID_CLIENT_CODEC: \"INVALID_CLIENT_CODEC\",\n      CLIENT_MODE_CODEC_MISMATCH: \"CLIENT_MODE_CODEC_MISMATCH\",\n      WEB_API_NOT_SUPPORTED: \"WEB_API_NOT_SUPPORTED\",\n      INVALID_PARAMETER: \"INVALID_PARAMETER\",\n      NO_TRACK_IN_STREAM: \"NO_TRACK_IN_STREAM\",\n      INVALID_OPERATION: \"INVALID_OPERATION\",\n      INVALID_LOCAL_STREAM: \"INVALID_LOCAL_STREAM\",\n      INVALID_REMOTE_STREAM: \"INVALID_REMOTE_STREAM\",\n      INVALID_DYNAMIC_KEY: \"INVALID_DYNAMIC_KEY\",\n      DYNAMIC_KEY_TIMEOUT: \"DYNAMIC_KEY_TIMEOUT\",\n      NO_VOCS_AVAILABLE: \"NO_VOCS_AVAILABLE\",\n      NO_VOS_AVAILABLE: \"ERR_NO_VOS_AVAILABLE\",\n      JOIN_CHANNEL_TIMEOUT: \"ERR_JOIN_CHANNEL_TIMEOUT\",\n      NO_AVAILABLE_CHANNEL: \"NO_AVAILABLE_CHANNEL\",\n      LOOKUP_CHANNEL_TIMEOUT: \"LOOKUP_CHANNEL_TIMEOUT\",\n      LOOKUP_CHANNEL_REJECTED: \"LOOKUP_CHANNEL_REJECTED\",\n      OPEN_CHANNEL_TIMEOUT: \"OPEN_CHANNEL_TIMEOUT\",\n      OPEN_CHANNEL_REJECTED: \"OPEN_CHANNEL_REJECTED\",\n      REQUEST_DEFERRED: \"REQUEST_DEFERRED\",\n      STREAM_ALREADY_PUBLISHED: \"STREAM_ALREADY_PUBLISHED\",\n      STREAM_NOT_YET_PUBLISHED: \"STREAM_NOT_YET_PUBLISHED\",\n      JOIN_TOO_FREQUENT: \"JOIN_TOO_FREQUENT\",\n      SOCKET_ERROR: \"SOCKET_ERROR\",\n      SOCKET_DISCONNECTED: \"SOCKET_DISCONNECTED\",\n      PEERCONNECTION_FAILED: \"PEERCONNECTION_FAILED\",\n      CONNECT_GATEWAY_ERROR: \"CONNECT_GATEWAY_ERROR\",\n      SERVICE_NOT_AVAILABLE: \"SERVICE_NOT_AVAILABLE\",\n      JOIN_CHANNEL_FAILED: \"JOIN_CHANNEL_FAILED\",\n      PUBLISH_STREAM_FAILED: \"PUBLISH_STREAM_FAILED\",\n      UNPUBLISH_STREAM_FAILED: \"UNPUBLISH_STREAM_FAILED\",\n      SUBSCRIBE_STREAM_FAILED: \"SUBSCRIBE_STREAM_FAILED\",\n      UNSUBSCRIBE_STREAM_FAILED: \"UNSUBSCRIBE_STREAM_FAILED\",\n      NO_SUCH_REMOTE_STREAM: \"NO_SUCH_REMOTE_STREAM\",\n      ERR_FAILED: \"1\",\n      ERR_INVALID_VENDOR_KEY: \"101\",\n      ERR_INVALID_CHANNEL_NAME: \"102\",\n      WARN_NO_AVAILABLE_CHANNEL: \"103\",\n      WARN_LOOKUP_CHANNEL_TIMEOUT: \"104\",\n      WARN_LOOKUP_CHANNEL_REJECTED: \"105\",\n      WARN_OPEN_CHANNEL_TIMEOUT: \"106\",\n      WARN_OPEN_CHANNEL_REJECTED: \"107\",\n      WARN_REQUEST_DEFERRED: \"108\",\n      ERR_DYNAMIC_KEY_TIMEOUT: \"109\",\n      ERR_INVALID_DYNAMIC_KEY: \"110\",\n      ERR_NO_VOCS_AVAILABLE: \"2000\",\n      ERR_NO_VOS_AVAILABLE: \"2001\",\n      ERR_JOIN_CHANNEL_TIMEOUT: \"2002\",\n      IOS_NOT_SUPPORT: \"IOS_NOT_SUPPORT\",\n      WECHAT_NOT_SUPPORT: \"WECHAT_NOT_SUPPORT\",\n      SHARING_SCREEN_NOT_SUPPORT: \"SHARING_SCREEN_NOT_SUPPORT\",\n      STILL_ON_PUBLISHING: \"STILL_ON_PUBLISHING\",\n      LOW_STREAM_ALREADY_PUBLISHED: \"LOW_STREAM_ALREADY_PUBLISHED\",\n      LOW_STREAM_NOT_YET_PUBLISHED: \"LOW_STREAM_ALREADY_PUBLISHED\",\n      HIGH_STREAM_NOT_VIDEO_TRACE: \"HIGH_STREAM_NOT_VIDEO_TRACE\",\n      NOT_FIND_DEVICE_BY_LABEL: \"NOT_FIND_DEVICE_BY_LABEL\",\n      ENABLE_DUALSTREAM_FAILED: \"ENABLE_DUALSTREAM_FAILED\",\n      DISABLE_DUALSTREAM_FAILED: \"DISABLE_DUALSTREAM_FAILED\",\n      PLAYER_NOT_FOUND: \"PLAYER_NOT_FOUND\",\n      ELECTRON_NOT_SUPPORT_SHARING_SCREEN: \"ELECTRON_NOT_SUPPORT_SHARING_SCREEN\",\n      BAD_ENVIRONMENT: \"BAD_ENVIRONMENT\",\n      LOAD_AUDIO_FAILED: \"LOAD_AUDIO_FAILED\"\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"getBrowserInfo\", function () {\n      return h;\n    }), n.d(t, \"getBrowserVersion\", function () {\n      return f;\n    }), n.d(t, \"getBrowserOS\", function () {\n      return p;\n    }), n.d(t, \"isChrome\", function () {\n      return i;\n    }), n.d(t, \"isSafari\", function () {\n      return a;\n    }), n.d(t, \"isFireFox\", function () {\n      return o;\n    }), n.d(t, \"isOpera\", function () {\n      return s;\n    }), n.d(t, \"isEdge\", function () {\n      return r;\n    }), n.d(t, \"isQQBrowser\", function () {\n      return c;\n    }), n.d(t, \"isWeChatBrowser\", function () {\n      return d;\n    }), n.d(t, \"isLegacyChrome\", function () {\n      return m;\n    }), n.d(t, \"isSupportedPC\", function () {\n      return u;\n    }), n.d(t, \"isSupportedMobile\", function () {\n      return l;\n    }), n.d(t, \"getChromeKernelVersion\", function () {\n      return S;\n    }), n.d(t, \"isChromeKernel\", function () {\n      return g;\n    });\n\n    var i = function () {\n      var e = h();\n      return e.name && \"Chrome\" === e.name;\n    },\n        a = function () {\n      var e = h();\n      return e.name && \"Safari\" === e.name;\n    },\n        r = function () {\n      var e = h();\n      return e.name && \"Edge\" === e.name;\n    },\n        o = function () {\n      var e = h();\n      return e.name && \"Firefox\" === e.name;\n    },\n        s = function () {\n      var e = h();\n      return e.name && \"OPR\" === e.name;\n    },\n        c = function () {\n      var e = h();\n      return e.name && \"QQBrowser\" === e.name;\n    },\n        d = function () {\n      var e = h();\n      return e.name && \"MicroMessenger\" === e.name;\n    },\n        u = function () {\n      var e = p();\n      return \"Linux\" === e || \"Mac OS X\" === e || \"Mac OS\" === e || -1 !== e.indexOf(\"Windows\");\n    },\n        l = function () {\n      var e = p();\n      return \"Android\" === e || \"iOS\" === e;\n    },\n        f = function () {\n      return h().version;\n    },\n        p = function () {\n      return h().os;\n    },\n        g = function () {\n      return !!navigator.userAgent.match(/chrome\\/[\\d]./i);\n    };\n\n    function m() {\n      return window.navigator.appVersion && null !== window.navigator.appVersion.match(/Chrome\\/([\\w\\W]*?)\\./) && window.navigator.appVersion.match(/Chrome\\/([\\w\\W]*?)\\./)[1] <= 35;\n    }\n\n    var v,\n        S = function () {\n      var e = navigator.userAgent.match(/chrome\\/[\\d]./i);\n      return e && e[0] && e[0].split(\"/\")[1];\n    },\n        h = (v = function () {\n      var e,\n          t = navigator.userAgent,\n          n = t.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n      \"Chrome\" === n[1] && null != (e = t.match(/(OPR(?=\\/))\\/?(\\d+)/i)) && (n = e), \"Safari\" === n[1] && null != (e = t.match(/version\\/(\\d+)/i)) && (n[2] = e[1]), ~t.toLowerCase().indexOf(\"qqbrowser\") && null != (e = t.match(/(qqbrowser(?=\\/))\\/?(\\d+)/i)) && (n = e), ~t.toLowerCase().indexOf(\"micromessenger\") && null != (e = t.match(/(micromessenger(?=\\/))\\/?(\\d+)/i)) && (n = e), ~t.toLowerCase().indexOf(\"edge\") && null != (e = t.match(/(edge(?=\\/))\\/?(\\d+)/i)) && (n = e), ~t.toLowerCase().indexOf(\"trident\") && null != (e = /\\brv[ :]+(\\d+)/g.exec(t) || []) && (n = [null, \"IE\", e[1]]);\n      var i = void 0,\n          a = [{\n        s: \"Windows 10\",\n        r: /(Windows 10.0|Windows NT 10.0)/\n      }, {\n        s: \"Windows 8.1\",\n        r: /(Windows 8.1|Windows NT 6.3)/\n      }, {\n        s: \"Windows 8\",\n        r: /(Windows 8|Windows NT 6.2)/\n      }, {\n        s: \"Windows 7\",\n        r: /(Windows 7|Windows NT 6.1)/\n      }, {\n        s: \"Windows Vista\",\n        r: /Windows NT 6.0/\n      }, {\n        s: \"Windows Server 2003\",\n        r: /Windows NT 5.2/\n      }, {\n        s: \"Windows XP\",\n        r: /(Windows NT 5.1|Windows XP)/\n      }, {\n        s: \"Windows 2000\",\n        r: /(Windows NT 5.0|Windows 2000)/\n      }, {\n        s: \"Windows ME\",\n        r: /(Win 9x 4.90|Windows ME)/\n      }, {\n        s: \"Windows 98\",\n        r: /(Windows 98|Win98)/\n      }, {\n        s: \"Windows 95\",\n        r: /(Windows 95|Win95|Windows_95)/\n      }, {\n        s: \"Windows NT 4.0\",\n        r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/\n      }, {\n        s: \"Windows CE\",\n        r: /Windows CE/\n      }, {\n        s: \"Windows 3.11\",\n        r: /Win16/\n      }, {\n        s: \"Android\",\n        r: /Android/\n      }, {\n        s: \"Open BSD\",\n        r: /OpenBSD/\n      }, {\n        s: \"Sun OS\",\n        r: /SunOS/\n      }, {\n        s: \"Linux\",\n        r: /(Linux|X11)/\n      }, {\n        s: \"iOS\",\n        r: /(iPhone|iPad|iPod)/\n      }, {\n        s: \"Mac OS X\",\n        r: /Mac OS X/\n      }, {\n        s: \"Mac OS\",\n        r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/\n      }, {\n        s: \"QNX\",\n        r: /QNX/\n      }, {\n        s: \"UNIX\",\n        r: /UNIX/\n      }, {\n        s: \"BeOS\",\n        r: /BeOS/\n      }, {\n        s: \"OS/2\",\n        r: /OS\\/2/\n      }, {\n        s: \"Search Bot\",\n        r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/\n      }];\n\n      for (var r in a) {\n        var o = a[r];\n\n        if (o.r.test(navigator.userAgent)) {\n          i = o.s;\n          break;\n        }\n      }\n\n      return {\n        name: n[1],\n        version: n[2],\n        os: i\n      };\n    }(), function () {\n      return v;\n    });\n  }, function (e, t) {\n    function n() {\n      return e.exports = n = Object.assign || function (e) {\n        for (var t = 1; t < arguments.length; t++) {\n          var n = arguments[t];\n\n          for (var i in n) Object.prototype.hasOwnProperty.call(n, i) && (e[i] = n[i]);\n        }\n\n        return e;\n      }, n.apply(this, arguments);\n    }\n\n    e.exports = n;\n  }, function (e, t, n) {\n    e.exports = n(26);\n  }, function (e, t, n) {\n    \"use strict\";\n\n    var i,\n        a = this && this.__extends || (i = function (e, t) {\n      return (i = Object.setPrototypeOf || {\n        __proto__: []\n      } instanceof Array && function (e, t) {\n        e.__proto__ = t;\n      } || function (e, t) {\n        for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]);\n      })(e, t);\n    }, function (e, t) {\n      function n() {\n        this.constructor = e;\n      }\n\n      i(e, t), e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n());\n    }),\n        r = this && this.__awaiter || function (e, t, n, i) {\n      return new (n || (n = Promise))(function (a, r) {\n        function o(e) {\n          try {\n            c(i.next(e));\n          } catch (e) {\n            r(e);\n          }\n        }\n\n        function s(e) {\n          try {\n            c(i.throw(e));\n          } catch (e) {\n            r(e);\n          }\n        }\n\n        function c(e) {\n          e.done ? a(e.value) : new n(function (t) {\n            t(e.value);\n          }).then(o, s);\n        }\n\n        c((i = i.apply(e, t || [])).next());\n      });\n    },\n        o = this && this.__generator || function (e, t) {\n      var n,\n          i,\n          a,\n          r,\n          o = {\n        label: 0,\n        sent: function () {\n          if (1 & a[0]) throw a[1];\n          return a[1];\n        },\n        trys: [],\n        ops: []\n      };\n      return r = {\n        next: s(0),\n        throw: s(1),\n        return: s(2)\n      }, \"function\" == typeof Symbol && (r[Symbol.iterator] = function () {\n        return this;\n      }), r;\n\n      function s(r) {\n        return function (s) {\n          return function (r) {\n            if (n) throw new TypeError(\"Generator is already executing.\");\n\n            for (; o;) try {\n              if (n = 1, i && (a = 2 & r[0] ? i.return : r[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, r[1])).done) return a;\n\n              switch (i = 0, a && (r = [2 & r[0], a.value]), r[0]) {\n                case 0:\n                case 1:\n                  a = r;\n                  break;\n\n                case 4:\n                  return o.label++, {\n                    value: r[1],\n                    done: !1\n                  };\n\n                case 5:\n                  o.label++, i = r[1], r = [0];\n                  continue;\n\n                case 7:\n                  r = o.ops.pop(), o.trys.pop();\n                  continue;\n\n                default:\n                  if (!(a = (a = o.trys).length > 0 && a[a.length - 1]) && (6 === r[0] || 2 === r[0])) {\n                    o = 0;\n                    continue;\n                  }\n\n                  if (3 === r[0] && (!a || r[1] > a[0] && r[1] < a[3])) {\n                    o.label = r[1];\n                    break;\n                  }\n\n                  if (6 === r[0] && o.label < a[1]) {\n                    o.label = a[1], a = r;\n                    break;\n                  }\n\n                  if (a && o.label < a[2]) {\n                    o.label = a[2], o.ops.push(r);\n                    break;\n                  }\n\n                  a[2] && o.ops.pop(), o.trys.pop();\n                  continue;\n              }\n\n              r = t.call(e, o);\n            } catch (e) {\n              r = [6, e], i = 0;\n            } finally {\n              n = a = 0;\n            }\n\n            if (5 & r[0]) throw r[1];\n            return {\n              value: r[0] ? r[1] : void 0,\n              done: !0\n            };\n          }([r, s]);\n        };\n      }\n    },\n        s = this && this.__importDefault || function (e) {\n      return e && e.__esModule ? e : {\n        default: e\n      };\n    };\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n\n    var c = s(n(32)),\n        d = n(3),\n        u = s(n(0)),\n        l = n(1),\n        f = n(12),\n        p = n(10),\n        g = function (e) {\n      function t(t, n) {\n        var i = e.call(this) || this;\n        return i._state = _.RELAY_STATE_IDLE, i._onStatus = function (e) {\n          u.default.debug(\"[\" + i.clientId + \"] ChannelMediaStatus: \" + JSON.stringify(e)), e && e.command && (\"onAudioPacketReceived\" === e.command && i.emit(\"event\", h.PACKET_RECEIVED_AUDIO_FROM_SRC), \"onVideoPacketReceived\" === e.command && i.emit(\"event\", h.PACKET_RECEIVED_VIDEO_FROM_SRC), \"onSrcTokenPrivilegeDidExpire\" === e.command && (i._state = _.RELAY_STATE_FAILURE, i.emit(\"state\", _.RELAY_STATE_FAILURE, E.SRC_TOKEN_EXPIRED)), \"onDestTokenPrivilegeDidExpire\" === e.command && (i._state = _.RELAY_STATE_FAILURE, i.emit(\"state\", _.RELAY_STATE_FAILURE, E.DEST_TOKEN_EXPIRED, e.channelName ? {\n            came: e.channelName\n          } : null)));\n        }, i._onClose = function () {\n          return r(i, void 0, void 0, function () {\n            var e;\n            return o(this, function (t) {\n              switch (t.label) {\n                case 0:\n                  if (u.default.debug(\"[\" + this.clientId + \"] ChannelMediaSocket onClose\"), this.emit(\"event\", h.NETWORK_DISCONNECTED), this.state = _.RELAY_STATE_IDLE, !this._prevChannelMediaConfig) return [3, 4];\n                  t.label = 1;\n\n                case 1:\n                  return t.trys.push([1, 3,, 4]), [4, this.startChannelMediaRelay(this._prevChannelMediaConfig)];\n\n                case 2:\n                  return t.sent(), [3, 4];\n\n                case 3:\n                  return (e = t.sent()) instanceof T && (e.message === v.WS_ABORT || e.message === v.AP_REQUEST_ABORT) ? [2] : (this.emit(\"state\", _.RELAY_STATE_FAILURE, E.SERVER_CONNECTION_LOST), [3, 4]);\n\n                case 4:\n                  return [2];\n              }\n            });\n          });\n        }, i.token = t.appId, i.appId = t.appId, i.cname = t.cname, i.uid = t.uid, i.sid = t.sid, i.clientId = n, i;\n      }\n\n      return a(t, e), Object.defineProperty(t.prototype, \"state\", {\n        get: function () {\n          return this._state;\n        },\n        set: function (e) {\n          var t = this._state;\n          this._state = e, t !== e && this.emit(\"state\", e);\n        },\n        enumerable: !0,\n        configurable: !0\n      }), t.prototype.startChannelMediaRelay = function (e) {\n        return r(this, void 0, void 0, function () {\n          return o(this, function (t) {\n            switch (t.label) {\n              case 0:\n                if (this.state !== _.RELAY_STATE_IDLE) throw new T(v.BAD_STATE);\n                return this.state = _.RELAY_STATE_CONNECTING, [4, this._connect()];\n\n              case 1:\n                return t.sent(), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: connect success\"), [4, this._sendStartRelayMessage(e)];\n\n              case 2:\n                return t.sent(), this._prevChannelMediaConfig = e, [2];\n            }\n          });\n        });\n      }, t.prototype.updateChannelMediaRelay = function (e) {\n        return r(this, void 0, void 0, function () {\n          return o(this, function (t) {\n            switch (t.label) {\n              case 0:\n                if (this.state !== _.RELAY_STATE_RUNNING) throw new T(v.BAD_STATE);\n                return [4, this._sendUpdateMessage(e)];\n\n              case 1:\n                return t.sent(), this._prevChannelMediaConfig = e, [2];\n            }\n          });\n        });\n      }, t.prototype.stopChannelMediaRelay = function () {\n        return r(this, void 0, void 0, function () {\n          return o(this, function (e) {\n            switch (e.label) {\n              case 0:\n                return [4, this._sendStopRelayMessage()];\n\n              case 1:\n                return e.sent(), u.default.debug(\"[\" + this.clientId + \"] stopChannelMediaRelay: send stop message success\"), this.state = _.RELAY_STATE_IDLE, this.dispose(), [2];\n            }\n          });\n        });\n      }, t.prototype.dispose = function () {\n        u.default.debug(\"[\" + this.clientId + \"] disposeChannelMediaRelay\"), this.state = _.RELAY_STATE_IDLE, this.emit(\"dispose\"), this._signal && this._signal.dispose(), this._prevChannelMediaConfig = null, this.removeEvent();\n      }, t.prototype._requestOneAP = function (e) {\n        var t = this;\n        return new Promise(function (n, i) {\n          var a = {\n            command: \"convergeAllocateEdge\",\n            sid: t.sid,\n            appId: t.appId,\n            token: \"\",\n            ts: +new Date(),\n            version: d.VERSION,\n            cname: t.cname,\n            uid: t.uid + \"\",\n            seq: 1,\n            requestId: 1\n          },\n              r = {\n            service_name: \"tele_channel\",\n            json_body: JSON.stringify(a)\n          },\n              o = \"https://\" + e;\n          f.post(o, r, function (e) {\n            var t = null,\n                a = null;\n\n            try {\n              t = JSON.parse(e);\n            } catch (e) {\n              i(new T(v.AP_JSON_PARSE_ERROR, e));\n            }\n\n            0 !== t.code && i(new T(v.AP_REQUEST_ERROR, t));\n\n            try {\n              a = JSON.parse(t.json_body);\n            } catch (e) {\n              i(new T(v.AP_JSON_PARSE_ERROR, e));\n            }\n\n            200 !== a.code && i(new T(v.AP_REQUEST_ERROR, a)), a.servers ? n(a.servers) : i(new T(v.AP_JSON_PARSE_ERROR, a));\n          }, function (e) {\n            return i(e);\n          }, {\n            \"X-Packet-Service-Type\": 0,\n            \"X-Packet-URI\": 61\n          });\n        });\n      }, t.prototype._requestAP = function () {\n        var e = this,\n            t = d.getParameter(\"UAP_AP\");\n        return new Promise(function (n, i) {\n          setTimeout(function () {\n            i(new T(v.AP_REQUEST_TIMEOUT));\n          }, 3e3), e.on(\"dispose\", function () {\n            i(new T(v.AP_REQUEST_ABORT));\n          }), t.forEach(function (t) {\n            t += \"/api/v1\", e._requestOneAP(t).then(function (i) {\n              u.default.debug(\"[\" + e.clientId + \"] startChannelMediaRelay request AP \" + t + \" success: \" + JSON.stringify(i));\n              var a = i[0],\n                  r = \"wss://\" + a.address.replace(/\\./g, \"-\") + \".edge.agora.io:\" + a.wss;\n              n(r);\n            }).catch(function (n) {\n              u.default.debug(\"[\" + e.clientId + \"] startChannelMediaRelay request AP \" + t + \" failed: \" + JSON.stringify(n));\n            });\n          });\n        });\n      }, t.prototype._connectWebsocket = function (e) {\n        return this._signal = new I(this.appId, this.cname, this.uid, this.sid), this._signal.connect(e);\n      }, t.prototype._connect = function () {\n        return r(this, void 0, void 0, function () {\n          var e;\n          return o(this, function (t) {\n            switch (t.label) {\n              case 0:\n                return [4, this._requestAP()];\n\n              case 1:\n                return e = t.sent(), [4, this._connectWebsocket(e)];\n\n              case 2:\n                return t.sent(), this._signal.on(\"close\", this._onClose.bind(this)), this._signal.on(\"status\", this._onStatus.bind(this)), this.emit(\"event\", h.NETWORK_CONNECTED), [2];\n            }\n          });\n        });\n      }, t.prototype._sendStartRelayMessage = function (e) {\n        return r(this, void 0, void 0, function () {\n          var t, n, i, a, r, s;\n          return o(this, function (o) {\n            switch (o.label) {\n              case 0:\n                return this._checkSignal(), t = this._genMessage(S.StopPacketTransfer), [4, this._signal.request(t)];\n\n              case 1:\n                return o.sent(), [4, this._signal.waitStatus(\"Normal Quit\")];\n\n              case 2:\n                return o.sent(), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: StopPacketTransfer success\"), n = this._genMessage(S.SetSdkProfile, e), [4, this._signal.request(n)];\n\n              case 3:\n                return o.sent(), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: SetSdkProfile success\"), i = this._genMessage(S.SetSourceChannel, e), [4, this._signal.request(i)];\n\n              case 4:\n                return o.sent(), [4, this._signal.waitStatus(\"SetSourceChannelStatus\")];\n\n              case 5:\n                return o.sent(), this.emit(\"event\", h.PACKET_JOINED_SRC_CHANNEL), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: SetSourceChannel success\"), a = this._genMessage(S.SetSourceUserId, e), [4, this._signal.request(a)];\n\n              case 6:\n                return o.sent(), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: SetSourceUserId success\"), r = this._genMessage(S.SetDestChannel, e), [4, this._signal.request(r)];\n\n              case 7:\n                return o.sent(), [4, this._signal.waitStatus(\"SetDestChannelStatus\")];\n\n              case 8:\n                return o.sent(), this.emit(\"event\", h.PACKET_JOINED_DEST_CHANNEL), u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: SetDestChannel success\"), s = this._genMessage(S.StartPacketTransfer, e), [4, this._signal.request(s)];\n\n              case 9:\n                return o.sent(), this.emit(\"event\", h.PACKET_SENT_TO_DEST_CHANNEL), this.state = _.RELAY_STATE_RUNNING, u.default.debug(\"[\" + this.clientId + \"] startChannelMediaRelay: StartPacketTransfer success\"), [2];\n            }\n          });\n        });\n      }, t.prototype._sendReconnectMessage = function (e) {\n        return r(this, void 0, void 0, function () {\n          var t;\n          return o(this, function (n) {\n            switch (n.label) {\n              case 0:\n                return this._checkSignal(), t = this._genMessage(S.Reconnect, e), [4, this._signal.request(t)];\n\n              case 1:\n                return n.sent(), [2];\n            }\n          });\n        });\n      }, t.prototype._sendUpdateMessage = function (e) {\n        return r(this, void 0, void 0, function () {\n          var t;\n          return o(this, function (n) {\n            switch (n.label) {\n              case 0:\n                return this._checkSignal(), t = this._genMessage(S.UpdateDestChannel, e), [4, this._signal.request(t)];\n\n              case 1:\n                return n.sent(), this.emit(\"event\", h.PACKET_UPDATE_DEST_CHANNEL), u.default.debug(\"[\" + this.clientId + \"] sendUpdateMessage: UpdateDestChannel success\"), [2];\n            }\n          });\n        });\n      }, t.prototype._sendStopRelayMessage = function () {\n        return r(this, void 0, void 0, function () {\n          var e;\n          return o(this, function (t) {\n            switch (t.label) {\n              case 0:\n                return this._checkSignal(), e = this._genMessage(S.StopPacketTransfer), [4, this._signal.request(e)];\n\n              case 1:\n                return t.sent(), u.default.debug(\"[\" + this.clientId + \"] sendStopRelayMessage: StopPacketTransfer success\"), [2];\n            }\n          });\n        });\n      }, t.prototype._genMessage = function (e, t) {\n        var n = this,\n            i = [],\n            a = [],\n            r = [],\n            o = {\n          appId: this.appId,\n          cname: this.cname,\n          uid: this.uid + \"\",\n          sdkVersion: d.VERSION,\n          sid: this.sid,\n          ts: +new Date(),\n          requestId: 0,\n          seq: 0,\n          allocate: !0,\n          clientRequest: {}\n        },\n            s = null;\n\n        switch (e) {\n          case S.SetSdkProfile:\n            return o.clientRequest = {\n              command: \"SetSdkProfile\",\n              type: \"multi_channel\"\n            }, o;\n\n          case S.SetSourceChannel:\n            return s = t.getSrcChannelMediaInfo(), o.clientRequest = {\n              command: \"SetSourceChannel\",\n              uid: s.uid + \"\",\n              channelName: s.channelName,\n              token: s.token || this.appId\n            }, o;\n\n          case S.SetSourceUserId:\n            return s = t.getSrcChannelMediaInfo(), o.clientRequest = {\n              command: \"SetSourceUserId\",\n              uid: this.uid + \"\"\n            }, o;\n\n          case S.SetDestChannel:\n            return t.getDestChannelMediaInfos().forEach(function (e) {\n              i.push(e.channelName), a.push(e.uid + \"\"), r.push(e.token || n.appId);\n            }), o.clientRequest = {\n              command: \"SetDestChannel\",\n              channelName: i,\n              uid: a,\n              token: r\n            }, o;\n\n          case S.StartPacketTransfer:\n            return o.clientRequest = {\n              command: \"StartPacketTransfer\"\n            }, o;\n\n          case S.Reconnect:\n            return o.clientRequest = {\n              command: \"Reconnect\"\n            }, o;\n\n          case S.StopPacketTransfer:\n            return o.clientRequest = {\n              command: \"StopPacketTransfer\"\n            }, o;\n\n          case S.UpdateDestChannel:\n            return t.getDestChannelMediaInfos().forEach(function (e) {\n              i.push(e.channelName), a.push(e.uid + \"\"), r.push(e.token || n.appId);\n            }), o.clientRequest = {\n              command: \"UpdateDestChannel\",\n              channelName: i,\n              uid: a,\n              token: r\n            }, o;\n        }\n      }, t.prototype._checkSignal = function () {\n        if (!this._signal || !this._signal.isConnect()) throw new T(v.WS_DISCONNECTED);\n      }, t;\n    }(c.default);\n\n    t.default = g;\n\n    var m = function () {\n      function e() {\n        this.destChannelMediaInfos = new Map();\n      }\n\n      return e.prototype.setSrcChannelInfo = function (e) {\n        l.checkValidObject(e, \"srcInfo\");\n        var t = e.uid,\n            n = e.channelName,\n            i = e.token;\n        if (i && !l.isValidToken(i)) throw new Error(\"Invalid token in SrcChannelInfo\");\n        if (!l.isValidChannelName(n)) throw new Error(\"Invalid channelName in SrcChannelInfo\");\n        if (!p.is32Uint(t)) throw new Error(\"Invalid uid in SrcChannelInfo\");\n        this.srcChannelMediaInfo = e;\n      }, e.prototype.setDestChannelInfo = function (e, t) {\n        if (!l.isValidChannelName(e)) throw new Error(\"Invalid channelName in DestChannelInfo\");\n        l.checkValidObject(t, \"destInfo\");\n        var n = t.uid,\n            i = t.token,\n            a = t.channelName;\n        if (i && !l.isValidToken(i)) throw new Error(\"Invalid token in DestChannelInfo\");\n        if (!l.isValidChannelName(a)) throw new Error(\"Invalid channelName in DestChannelInfo\");\n        if (!p.is32Uint(n)) throw new Error(\"Invalid uid in DestChannelInfo\");\n        this.destChannelMediaInfos.set(e, t);\n      }, e.prototype.removeDestChannelInfo = function (e) {\n        if (!l.isValidChannelName(e)) throw new Error(\"Invalid channelName when invoke removeDestChannelInfo\");\n        this.destChannelMediaInfos.delete(e);\n      }, e.prototype.getSrcChannelMediaInfo = function () {\n        return this.srcChannelMediaInfo;\n      }, e.prototype.getDestChannelMediaInfos = function () {\n        return this.destChannelMediaInfos;\n      }, e;\n    }();\n\n    t.ChannelMediaRelayConfiguration = m;\n\n    var v,\n        S,\n        h,\n        _,\n        E,\n        I = function (e) {\n      function t(t, n, i, a) {\n        var r = e.call(this) || this;\n        return r._onOpen = function () {\n          r.emit(\"open\");\n        }, r._onClose = function (e) {\n          r.emit(\"close\"), r.dispose();\n        }, r._onMessage = function (e) {\n          var t = JSON.parse(e.data);\n          if (!t || \"serverResponse\" !== t.command || !t.requestId) return t && \"serverStatus\" === t.command && t.serverStatus && t.serverStatus.command ? (r.emit(\"status\", t.serverStatus), void r.emit(t.serverStatus.command, t.serverStatus)) : void 0;\n          r.emit(\"req_\" + t.requestId, t);\n        }, r._requestId = 1, r.appId = t, r.cname = n, r.uid = i, r.sid = a, r;\n      }\n\n      return a(t, e), t.prototype.isConnect = function () {\n        return this._ws && this._ws.readyState === WebSocket.OPEN;\n      }, t.prototype.sendMessage = function (e) {\n        if (!this._ws || this._ws.readyState !== WebSocket.OPEN) throw new T(v.WS_DISCONNECTED);\n        var t = this._requestId++;\n        return e.requestId = t, e.seq = t, this._ws.send(JSON.stringify(e)), t;\n      }, t.prototype.waitStatus = function (e) {\n        var t = this;\n        return new Promise(function (n, i) {\n          var a = window.setTimeout(function () {\n            i(new T(v.WAIT_STATUS_TIMEOUT, e));\n          }, 5e3);\n          t.once(e, function (t) {\n            clearTimeout(a), t.state && 0 !== t.state ? i(new T(v.WAIT_STATUS_ERROR, e)) : n();\n          }), t.once(\"dispose\", function () {\n            clearTimeout(a), i(new T(v.WS_ABORT));\n          });\n        });\n      }, t.prototype.request = function (e) {\n        var t = this;\n        return new Promise(function (n, i) {\n          var a = t.sendMessage(e),\n              r = window.setTimeout(function () {\n            t.removeAllListeners(\"req_\" + a), i(new T(v.REQUEST_TIMEOUT));\n          }, 3e3);\n          t.once(\"req_\" + a, function (e) {\n            clearTimeout(r), e && 200 === e.code ? n(e) : i(new T(v.REQUEST_FAILED, e));\n          }), t.once(\"dispose\", function () {\n            clearTimeout(r), i(new T(v.WS_ABORT));\n          });\n        });\n      }, t.prototype.connect = function (e) {\n        var t = this;\n        return new Promise(function (n, i) {\n          t._ws = new WebSocket(e), t._ws.onopen = function () {\n            t._onOpen(), t._prvUrl = e, t._ws.onmessage = t._onMessage, t._ws.onclose = t._onClose, t._startHeartBeatCheck(), n();\n          }, t._ws.onclose = function (e) {\n            t._ws = null, i(new T(v.CONNECT_FAILED, \"websocket error code: \" + e.code));\n          }, setTimeout(function () {\n            t._ws && t._ws.readyState !== WebSocket.OPEN && (t._ws.onopen = null, t._ws.onclose = null, t._ws.close(), t._ws = null, i(new T(v.CONNECT_TIMEOUT)));\n          }, 5e3), t.once(\"dispose\", function () {\n            i(new T(v.WS_ABORT));\n          });\n        });\n      }, t.prototype.dispose = function () {\n        this._clearHeartBeatCheck(), this.emit(\"dispose\"), this.removeEvent(), this._ws && (this._ws.onopen = null, this._ws.onclose = null, this._ws.onmessage = null, this._ws.close()), this._ws = null;\n      }, t.prototype._sendPing = function (e) {\n        if (!this._ws || this._ws.readyState !== WebSocket.OPEN) throw new T(v.WS_DISCONNECTED);\n        var t = this._requestId++;\n        return e.requestId = t, this._ws.send(JSON.stringify(e)), t;\n      }, t.prototype._startHeartBeatCheck = function () {\n        var e = this;\n        this._heartBeatTimer = window.setInterval(function () {\n          e._sendPing({\n            command: \"ping\",\n            appId: e.appId,\n            cname: e.cname,\n            uid: e.uid + \"\",\n            sid: e.sid,\n            ts: +new Date(),\n            requestId: 0\n          });\n        }, 3e3);\n      }, t.prototype._clearHeartBeatCheck = function () {\n        window.clearInterval(this._heartBeatTimer);\n      }, t;\n    }(c.default),\n        T = function () {\n      return function (e, t, n) {\n        void 0 === e && (e = \"\"), this.code = n, this.data = t, this.message = e;\n      };\n    }();\n\n    t.ChannelMediaError = T, function (e) {\n      e.CONNECT_FAILED = \"connect failed\", e.CONNECT_TIMEOUT = \"connect timeout\", e.WS_DISCONNECTED = \"websocket disconnected\", e.REQUEST_TIMEOUT = \"request timeout\", e.REQUEST_FAILED = \"request failed\", e.WAIT_STATUS_TIMEOUT = \"wait status timeout\", e.WAIT_STATUS_ERROR = \"wait status error\", e.BAD_STATE = \"bad state\", e.WS_ABORT = \"ws abort\", e.AP_REQUEST_TIMEOUT = \"AP request timeout\", e.AP_JSON_PARSE_ERROR = \"AP json parse error\", e.AP_REQUEST_ERROR = \"AP request error\", e.AP_REQUEST_ABORT = \"AP request abort\";\n    }(v = t.CHANNEL_MEDIA_ERROR || (t.CHANNEL_MEDIA_ERROR = {})), function (e) {\n      e[e.SetSdkProfile = 0] = \"SetSdkProfile\", e[e.SetSourceChannel = 1] = \"SetSourceChannel\", e[e.SetSourceUserId = 2] = \"SetSourceUserId\", e[e.SetDestChannel = 3] = \"SetDestChannel\", e[e.StartPacketTransfer = 4] = \"StartPacketTransfer\", e[e.StopPacketTransfer = 5] = \"StopPacketTransfer\", e[e.UpdateDestChannel = 6] = \"UpdateDestChannel\", e[e.Reconnect = 7] = \"Reconnect\", e[e.SetVideoProfile = 8] = \"SetVideoProfile\";\n    }(S || (S = {})), function (e) {\n      e[e.NETWORK_DISCONNECTED = 0] = \"NETWORK_DISCONNECTED\", e[e.NETWORK_CONNECTED = 1] = \"NETWORK_CONNECTED\", e[e.PACKET_JOINED_SRC_CHANNEL = 2] = \"PACKET_JOINED_SRC_CHANNEL\", e[e.PACKET_JOINED_DEST_CHANNEL = 3] = \"PACKET_JOINED_DEST_CHANNEL\", e[e.PACKET_SENT_TO_DEST_CHANNEL = 4] = \"PACKET_SENT_TO_DEST_CHANNEL\", e[e.PACKET_RECEIVED_VIDEO_FROM_SRC = 5] = \"PACKET_RECEIVED_VIDEO_FROM_SRC\", e[e.PACKET_RECEIVED_AUDIO_FROM_SRC = 6] = \"PACKET_RECEIVED_AUDIO_FROM_SRC\", e[e.PACKET_UPDATE_DEST_CHANNEL = 7] = \"PACKET_UPDATE_DEST_CHANNEL\", e[e.PACKET_UPDATE_DEST_CHANNEL_REFUSED = 8] = \"PACKET_UPDATE_DEST_CHANNEL_REFUSED\", e[e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE = 9] = \"PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE\";\n    }(h = t.CHANNEL_MEDIA_RELAY_EVENT || (t.CHANNEL_MEDIA_RELAY_EVENT = {})), function (e) {\n      e[e.RELAY_STATE_IDLE = 0] = \"RELAY_STATE_IDLE\", e[e.RELAY_STATE_CONNECTING = 1] = \"RELAY_STATE_CONNECTING\", e[e.RELAY_STATE_RUNNING = 2] = \"RELAY_STATE_RUNNING\", e[e.RELAY_STATE_FAILURE = 3] = \"RELAY_STATE_FAILURE\";\n    }(_ = t.CHANNEL_MEDIA_RELAY_STATE || (t.CHANNEL_MEDIA_RELAY_STATE = {})), function (e) {\n      e[e.RELAY_OK = 0] = \"RELAY_OK\", e[e.SERVER_ERROR_RESPONSE = 1] = \"SERVER_ERROR_RESPONSE\", e[e.SERVER_NO_RESPONSE = 2] = \"SERVER_NO_RESPONSE\", e[e.NO_RESOURCE_AVAILABLE = 3] = \"NO_RESOURCE_AVAILABLE\", e[e.FAILED_JOIN_SRC = 4] = \"FAILED_JOIN_SRC\", e[e.FAILED_JOIN_DEST = 5] = \"FAILED_JOIN_DEST\", e[e.FAILED_PACKET_RECEIVED_FROM_SRC = 6] = \"FAILED_PACKET_RECEIVED_FROM_SRC\", e[e.FAILED_PACKET_SENT_TO_DEST = 7] = \"FAILED_PACKET_SENT_TO_DEST\", e[e.SERVER_CONNECTION_LOST = 8] = \"SERVER_CONNECTION_LOST\", e[e.INTERNAL_ERROR = 9] = \"INTERNAL_ERROR\", e[e.SRC_TOKEN_EXPIRED = 10] = \"SRC_TOKEN_EXPIRED\", e[e.DEST_TOKEN_EXPIRED = 11] = \"DEST_TOKEN_EXPIRED\", e[e.RELAY_ALREADY_START = 12] = \"RELAY_ALREADY_START\", e[e.RELAY_NOT_START = 13] = \"RELAY_NOT_START\", e[e.OPERATION_ABORT = 14] = \"OPERATION_ABORT\";\n    }(E = t.CHANNEL_MEDIA_RELAY_ERROR || (t.CHANNEL_MEDIA_RELAY_ERROR = {}));\n  }, function (e, t) {\n    function n(e) {\n      return (n = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n        return typeof e;\n      } : function (e) {\n        return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n      })(e);\n    }\n\n    function i(t) {\n      return \"function\" == typeof Symbol && \"symbol\" === n(Symbol.iterator) ? e.exports = i = function (e) {\n        return n(e);\n      } : e.exports = i = function (e) {\n        return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : n(e);\n      }, i(t);\n    }\n\n    e.exports = i;\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"isLiveTranscodingValid\", function () {\n      return v;\n    }), n.d(t, \"generateSessionId\", function () {\n      return p;\n    }), n.d(t, \"audioLevelHelper\", function () {\n      return f;\n    }), n.d(t, \"vsResHack\", function () {\n      return g;\n    }), n.d(t, \"is32Uint\", function () {\n      return m;\n    }), n.d(t, \"safeCall\", function () {\n      return l;\n    }), n.d(t, \"random\", function () {\n      return h;\n    }), n.d(t, \"popBanTip\", function () {\n      return I;\n    }), n.d(t, \"lengthInUtf8Bytes\", function () {\n      return _;\n    }), n.d(t, \"audioTimerLoop\", function () {\n      return E;\n    });\n\n    var i = n(9),\n        a = n.n(i),\n        r = n(5),\n        o = n(0),\n        s = n(16),\n        c = n.n(s),\n        d = n(14),\n        u = n(13),\n        l = function () {\n      var e = arguments[0];\n\n      if (\"function\" == typeof e) {\n        var t = Array.prototype.slice.call(arguments, 1);\n        e.apply(null, t);\n      }\n    },\n        f = function (e) {\n      return this.audioContext = Object(d.a)(), this.sourceNode = e.otWebkitAudioSource || this.audioContext.createMediaStreamSource(e), this.analyser = this.audioContext.createAnalyser(), this.timeDomainData = new Uint8Array(this.analyser.frequencyBinCount), this.sourceNode.connect(this.analyser), this.getAudioLevel = function () {\n        if (this.analyser) {\n          this.analyser.getByteTimeDomainData(this.timeDomainData);\n\n          for (var e = 0, t = 0; t < this.timeDomainData.length; t++) e = Math.max(e, Math.abs(this.timeDomainData[t] - 128));\n\n          return e / 128;\n        }\n\n        return o.default.warning(\"can't find analyser in audioLevelHelper\"), 0;\n      }, this;\n    };\n\n    function p() {\n      return c()().replace(/-/g, \"\").toUpperCase();\n    }\n\n    var g = function (e, t, n) {\n      try {\n        o.default.debug(\"start vsResHack\", e);\n        var i = document.createElement(\"video\");\n        i.setAttribute(\"autoplay\", \"\"), i.setAttribute(\"muted\", \"\"), i.muted = !0, i.setAttribute(\"playsinline\", \"\"), i.setAttribute(\"style\", \"position: absolute; top: 0; left: 0; width:1px; high:1px;\"), document.body.appendChild(i), i.addEventListener(\"playing\", function (n) {\n          r.isFireFox() ? i.videoWidth && (o.default.debug(\"[vsResHack] get stream resolution: \", \"\".concat(i.videoWidth, \" x \").concat(i.videoHeight), e), t(i.videoWidth, i.videoHeight), document.body.removeChild(i)) : (o.default.debug(\"[vsResHack] get stream resolution: \", \"\".concat(i.videoWidth, \" x \").concat(i.videoHeight), e), t(i.videoWidth, i.videoHeight), document.body.removeChild(i));\n        }), Object(u.setSrcObject)(i, e);\n      } catch (e) {\n        n(e);\n      }\n    },\n        m = function (e) {\n      return \"number\" == typeof e && 0 <= e && e <= 4294967295;\n    },\n        v = function (e) {\n      var t = [\"lowLatency\", \"userConfigExtraInfo\", \"transcodingUsers\"];\n\n      for (var n in e) if (\"lowLatency\" === n && \"boolean\" != typeof e[n] || \"userConfigExtraInfo\" === n && \"object\" !== a()(e[n]) || \"transcodingUsers\" === n && !S(e[n]) || !~t.indexOf(n) && \"number\" != typeof e[n]) throw new Error(\"Param [\" + n + \"] is inValid\");\n\n      return !0;\n    },\n        S = function (e) {\n      for (var t = 0; t < e.length; t++) for (var n in e[t]) if (\"number\" != typeof e[t][n]) throw new Error(\"Param user[\" + t + \"] - [\" + n + \"] is inValid\");\n\n      return !0;\n    },\n        h = function (e) {\n      isNaN(e) && (e = 1e3);\n      var t = +new Date(),\n          n = (t = (9301 * t + 49297) % 233280) / 233280;\n      return Math.ceil(n * e);\n    },\n        _ = function (e) {\n      var t = encodeURIComponent(e).match(/%[89ABab]/g);\n      return e.length + (t ? t.length : 0);\n    },\n        E = function (e, t) {\n      var n = 1 / t,\n          i = Object(d.a)(),\n          a = i.createGain();\n      a.gain.value = 0, a.connect(i.destination);\n      var r = !1;\n      return function t() {\n        var o = i.createOscillator();\n        o.onended = t, o.connect(a), o.start(0), o.stop(i.currentTime + n), e(i.currentTime), r && (o.onended = function () {});\n      }(), function () {\n        r = !0;\n      };\n    },\n        I = function () {\n      if (!document.getElementById(\"agora-ban-tip\")) {\n        var e = document.createElement(\"div\");\n        e.id = \"agora-ban-tip\", e.style = \"position: absolute; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #fff;\", document.querySelector(\"body\").prepend(e);\n        var t = document.createElement(\"div\");\n        t.style = \"background: #000; width: 346px; height: 116px; z-index: 100000; opacity: 0.6; border-radius: 10px; box-shadow: 0 2px 4px #000;\", e.append(t);\n        var n = document.createElement(\"div\");\n        n.style = \"height: 76px; display: flex; justify-content: center; align-items: center;\";\n        var i = document.createElement(\"span\");\n        i.style = \"height: 28px; width: 28px; color: #000; text-align: center; line-height: 30px; background: #fff; border-radius: 50%; font-weight: 600; font-size: 20px;margin-right: 5px;\", i.innerText = \"!\";\n        var a = document.createElement(\"span\");\n        a.innerText = \"This browser does not support webRTC\", n.append(i), n.append(a);\n        var r = document.createElement(\"div\");\n        r.style = \"height: 38px; display: flex; border-top: #fff 1px solid; justify-content: center; align-items: center;\", r.innerText = \"OK\", t.append(n), t.append(r), r.onclick = function () {\n          var e = document.getElementById(\"agora-ban-tip\");\n          e.parentNode.removeChild(e);\n        };\n      }\n    };\n  }, function (e, t) {\n    function n(e, t, n, i, a, r, o) {\n      try {\n        var s = e[r](o),\n            c = s.value;\n      } catch (e) {\n        return void n(e);\n      }\n\n      s.done ? t(c) : Promise.resolve(c).then(i, a);\n    }\n\n    e.exports = function (e) {\n      return function () {\n        var t = this,\n            i = arguments;\n        return new Promise(function (a, r) {\n          var o = e.apply(t, i);\n\n          function s(e) {\n            n(o, a, r, s, c, \"next\", e);\n          }\n\n          function c(e) {\n            n(o, a, r, s, c, \"throw\", e);\n          }\n\n          s(void 0);\n        });\n      };\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"post\", function () {\n      return u;\n    }), n.d(t, \"shouldUseHttps\", function () {\n      return l;\n    }), n.d(t, \"getHTTPSendBytes\", function () {\n      return s;\n    }), n.d(t, \"getHTTPRecvBytes\", function () {\n      return c;\n    }), n.d(t, \"resetHTTPByetsCount\", function () {\n      return d;\n    });\n\n    var i = n(3),\n        a = n(10),\n        r = 0,\n        o = 0,\n        s = function () {\n      return r;\n    },\n        c = function () {\n      return o;\n    },\n        d = function () {\n      r = 0, o = 0;\n    },\n        u = function (e, t, n, s, c) {\n      var d = new XMLHttpRequest();\n      if (d.timeout = t.timeout || Object(i.getParameter)(\"HTTP_CONNECT_TIMEOUT\"), d.open(\"POST\", e, !0), d.setRequestHeader(\"Content-type\", \"application/json; charset=utf-8\"), c) for (var u in c) \"withCredentials\" == u ? d.withCredentials = !0 : d.setRequestHeader(u, c[u]);\n      d.onload = function (e) {\n        o += Object(a.lengthInUtf8Bytes)(d.responseText), n && n(d.responseText);\n      }, d.onerror = function (t) {\n        s && s(t, e);\n      }, d.ontimeout = function (t) {\n        s && s(t, e);\n      };\n      var l = JSON.stringify(t);\n      r += Object(a.lengthInUtf8Bytes)(l), d.send(l);\n    },\n        l = function () {\n      return \"https:\" == document.location.protocol;\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.r(t), n.d(t, \"RTCPeerConnection\", function () {\n      return y;\n    }), n.d(t, \"getUserMedia\", function () {\n      return o;\n    }), n.d(t, \"attachMediaStream\", function () {\n      return s;\n    }), n.d(t, \"reattachMediaStream\", function () {\n      return c;\n    }), n.d(t, \"setSrcObject\", function () {\n      return p;\n    }), n.d(t, \"getSrcObject\", function () {\n      return g;\n    }), n.d(t, \"webrtcDetectedBrowser\", function () {\n      return d;\n    }), n.d(t, \"webrtcDetectedVersion\", function () {\n      return u;\n    }), n.d(t, \"webrtcMinimumVersion\", function () {\n      return l;\n    }), n.d(t, \"webrtcTesting\", function () {\n      return b;\n    }), n.d(t, \"webrtcUtils\", function () {\n      return S;\n    });\n    var i = n(9),\n        a = n.n(i),\n        r = n(5),\n        o = null,\n        s = null,\n        c = null,\n        d = null,\n        u = null,\n        l = null,\n        f = null,\n        p = null,\n        g = null,\n        m = null,\n        v = {\n      addStream: null\n    },\n        S = {\n      log: function () {},\n      extractVersion: function (e, t, n) {\n        var i = e.match(t);\n        return i && i.length >= n && parseInt(i[n]);\n      }\n    };\n    if (\"object\" == (\"undefined\" == typeof window ? \"undefined\" : a()(window)) ? (!window.HTMLMediaElement || \"srcObject\" in window.HTMLMediaElement.prototype ? (p = function (e, t) {\n      e.srcObject = t;\n    }, g = function (e) {\n      return e.srcObject;\n    }) : (p = function (e, t) {\n      \"mozSrcObject\" in e ? e.mozSrcObject = t : (e._srcObject = t, e.src = t ? URL.createObjectURL(t) : null);\n    }, g = function (e) {\n      return \"mozSrcObject\" in e ? e.mozSrcObject : e._srcObject;\n    }), o = window.navigator && window.navigator.getUserMedia) : (p = function (e, t) {\n      e.srcObject = t;\n    }, g = function (e) {\n      return e.srcObject;\n    }), s = function (e, t) {\n      p(e, t);\n    }, c = function (e, t) {\n      p(e, g(t));\n    }, \"undefined\" != typeof window && window.navigator) {\n      if (navigator.mozGetUserMedia && window.mozRTCPeerConnection) {\n        for (var h in S.log(\"This appears to be Firefox\"), d = \"firefox\", u = S.extractVersion(navigator.userAgent, /Firefox\\/([0-9]+)\\./, 1), l = 31, m = mozRTCPeerConnection, v) v[h] = m.prototype[h];\n\n        if (f = function (e, t) {\n          if (u < 38 && e && e.iceServers) {\n            for (var n = [], i = 0; i < e.iceServers.length; i++) {\n              var a = e.iceServers[i];\n              if (a.hasOwnProperty(\"urls\")) for (var r = 0; r < a.urls.length; r++) {\n                var o = {\n                  url: a.urls[r]\n                };\n                0 === a.urls[r].indexOf(\"turn\") && (o.username = a.username, o.credential = a.credential), n.push(o);\n              } else n.push(e.iceServers[i]);\n            }\n\n            e.iceServers = n;\n          }\n\n          var s = new m(e, t);\n\n          for (var c in v) s[c] = v[c];\n\n          return s;\n        }, window.RTCSessionDescription || (window.RTCSessionDescription = mozRTCSessionDescription), window.RTCIceCandidate || (window.RTCIceCandidate = mozRTCIceCandidate), o = function (e, t, n) {\n          var i = function (e) {\n            if (\"object\" !== a()(e) || e.require) return e;\n            var t = [];\n            return Object.keys(e).forEach(function (n) {\n              if (\"require\" !== n && \"advanced\" !== n && \"mediaSource\" !== n) {\n                var i = e[n] = \"object\" === a()(e[n]) ? e[n] : {\n                  ideal: e[n]\n                };\n\n                if (void 0 === i.min && void 0 === i.max && void 0 === i.exact || t.push(n), void 0 !== i.exact && (\"number\" == typeof i.exact ? i.min = i.max = i.exact : e[n] = i.exact, delete i.exact), void 0 !== i.ideal) {\n                  e.advanced = e.advanced || [];\n                  var r = {};\n                  \"number\" == typeof i.ideal ? r[n] = {\n                    min: i.ideal,\n                    max: i.ideal\n                  } : r[n] = i.ideal, e.advanced.push(r), delete i.ideal, Object.keys(i).length || delete e[n];\n                }\n              }\n            }), t.length && (e.require = t), e;\n          };\n\n          return u < 38 && (S.log(\"spec: \" + JSON.stringify(e)), e.audio && (e.audio = i(e.audio)), e.video && (e.video = i(e.video)), S.log(\"ff37: \" + JSON.stringify(e))), navigator.mozGetUserMedia(e, t, n);\n        }, navigator.getUserMedia = o, navigator.mediaDevices || (navigator.mediaDevices = {\n          getUserMedia: T,\n          addEventListener: function () {},\n          removeEventListener: function () {}\n        }), navigator.mediaDevices.enumerateDevices = navigator.mediaDevices.enumerateDevices || function () {\n          return new Promise(function (e) {\n            e([{\n              kind: \"audioinput\",\n              deviceId: \"default\",\n              label: \"\",\n              groupId: \"\"\n            }, {\n              kind: \"videoinput\",\n              deviceId: \"default\",\n              label: \"\",\n              groupId: \"\"\n            }]);\n          });\n        }, u < 41) {\n          var _ = navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n\n          navigator.mediaDevices.enumerateDevices = function () {\n            return _().then(void 0, function (e) {\n              if (\"NotFoundError\" === e.name) return [];\n              throw e;\n            });\n          };\n        }\n      } else if (navigator.webkitGetUserMedia && window.webkitRTCPeerConnection) {\n        for (var h in S.log(\"This appears to be Chrome\"), d = \"chrome\", u = S.extractVersion(navigator.userAgent, /Chrom(e|ium)\\/([0-9]+)\\./, 2), l = 38, m = webkitRTCPeerConnection, v) v[h] = m.prototype[h];\n\n        f = function (e, t) {\n          e && e.iceTransportPolicy && (e.iceTransports = e.iceTransportPolicy);\n          var n = new m(e, t);\n\n          for (var i in v) n[i] = v[i];\n\n          var a = n.getStats.bind(n);\n          return n.getStats = function (e, t, n) {\n            var i = arguments;\n            i.length > 0 && \"function\" == typeof e && (t ? (n = t, t = e, i = [e = null, t, n]) : (t = e, i = [e = null, t]));\n\n            if (i.length >= 2) {\n              return a.apply(this, [function (e) {\n                i[1](function (e) {\n                  var t = {};\n                  return e.result().forEach(function (e) {\n                    var n = {\n                      id: e.id,\n                      timestamp: e.timestamp,\n                      type: e.type\n                    };\n                    e.names().forEach(function (t) {\n                      n[t] = e.stat(t);\n                    }), t[n.id] = n;\n                  }), t;\n                }(e));\n              }, i[0]]);\n            }\n\n            return a();\n          }, n;\n        }, [\"createOffer\", \"createAnswer\"].forEach(function (e) {\n          var t = webkitRTCPeerConnection.prototype[e];\n\n          webkitRTCPeerConnection.prototype[e] = function () {\n            var e = this;\n\n            if (arguments.length < 1 || 1 === arguments.length && \"object\" === a()(arguments[0])) {\n              var n = 1 === arguments.length ? arguments[0] : void 0;\n              return new Promise(function (i, a) {\n                t.apply(e, [i, a, n]);\n              });\n            }\n\n            return t.apply(this, arguments);\n          };\n        }), [\"setLocalDescription\", \"setRemoteDescription\", \"addIceCandidate\"].forEach(function (e) {\n          var t = webkitRTCPeerConnection.prototype[e];\n\n          webkitRTCPeerConnection.prototype[e] = function () {\n            var e = arguments,\n                n = this;\n            return new Promise(function (i, a) {\n              t.apply(n, [e[0], function () {\n                i(), e.length >= 2 && e[1].apply(null, []);\n              }, function (t) {\n                a(t), e.length >= 3 && e[2].apply(null, [t]);\n              }]);\n            });\n          };\n        });\n\n        var E = function (e) {\n          if (\"object\" !== a()(e) || e.mandatory || e.optional) return e;\n          var t = {};\n          return Object.keys(e).forEach(function (n) {\n            if (\"require\" !== n && \"advanced\" !== n && \"mediaSource\" !== n) {\n              var i = \"object\" === a()(e[n]) ? e[n] : {\n                ideal: e[n]\n              };\n              void 0 !== i.exact && \"number\" == typeof i.exact && (i.min = i.max = i.exact);\n\n              var r = function (e, t) {\n                return e ? e + t.charAt(0).toUpperCase() + t.slice(1) : \"deviceId\" === t ? \"sourceId\" : t;\n              };\n\n              if (void 0 !== i.ideal) {\n                t.optional = t.optional || [];\n                var o = {};\n                \"number\" == typeof i.ideal ? (o[r(\"min\", n)] = i.ideal, t.optional.push(o), (o = {})[r(\"max\", n)] = i.ideal, t.optional.push(o)) : (o[r(\"\", n)] = i.ideal, t.optional.push(o));\n              }\n\n              void 0 !== i.exact && \"number\" != typeof i.exact ? (t.mandatory = t.mandatory || {}, t.mandatory[r(\"\", n)] = i.exact) : [\"min\", \"max\"].forEach(function (e) {\n                void 0 !== i[e] && (t.mandatory = t.mandatory || {}, t.mandatory[r(e, n)] = i[e]);\n              });\n            }\n          }), e.advanced && (t.optional = (t.optional || []).concat(e.advanced)), t;\n        };\n\n        if (o = function (e, t, n) {\n          return e.audio && (e.audio = E(e.audio)), e.video && (e.video = E(e.video)), S.log(\"chrome: \" + JSON.stringify(e)), navigator.webkitGetUserMedia(e, t, n);\n        }, navigator.getUserMedia = o, navigator.mediaDevices || (navigator.mediaDevices = {\n          getUserMedia: T,\n          enumerateDevices: function () {\n            return new Promise(function (e) {\n              var t = {\n                audio: \"audioinput\",\n                video: \"videoinput\"\n              };\n              return MediaStreamTrack.getSources(function (n) {\n                e(n.map(function (e) {\n                  return {\n                    label: e.label,\n                    kind: t[e.kind],\n                    deviceId: e.id,\n                    groupId: \"\"\n                  };\n                }));\n              });\n            });\n          }\n        }), navigator.mediaDevices.getUserMedia) {\n          if ((Object(r.getBrowserVersion)() ? Number(Object(r.getBrowserVersion)().split(\".\")[0]) : void 0) < 46) {\n            var I = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n\n            navigator.mediaDevices.getUserMedia = function (e) {\n              return S.log(\"spec:   \" + JSON.stringify(e)), e.audio = E(e.audio), e.video = E(e.video), S.log(\"chrome: \" + JSON.stringify(e)), I(e);\n            };\n          }\n        } else navigator.mediaDevices.getUserMedia = function (e) {\n          return T(e);\n        };\n\n        void 0 === navigator.mediaDevices.addEventListener && (navigator.mediaDevices.addEventListener = function () {\n          S.log(\"Dummy mediaDevices.addEventListener called.\");\n        }), void 0 === navigator.mediaDevices.removeEventListener && (navigator.mediaDevices.removeEventListener = function () {\n          S.log(\"Dummy mediaDevices.removeEventListener called.\");\n        }), s = function (e, t) {\n          u >= 43 ? p(e, t) : void 0 !== e.src ? e.src = t ? URL.createObjectURL(t) : null : S.log(\"Error attaching stream to element.\");\n        }, c = function (e, t) {\n          u >= 43 ? p(e, g(t)) : e.src = t.src;\n        };\n      } else navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/) ? (S.log(\"This appears to be Edge\"), d = \"edge\", u = S.extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2), l = 12) : S.log(\"Browser does not appear to be WebRTC-capable\");\n    } else S.log(\"This does not appear to be a browser\"), d = \"not a browser\";\n\n    function T(e) {\n      return new Promise(function (t, n) {\n        o(e, t, n);\n      });\n    }\n\n    var y,\n        b = {};\n\n    try {\n      Object.defineProperty(b, \"version\", {\n        set: function (e) {\n          u = e;\n        }\n      });\n    } catch (e) {}\n\n    f ? y = f : \"undefined\" != typeof window && (y = window.RTCPeerConnection);\n  }, function (e, t, n) {\n    \"use strict\";\n\n    n.d(t, \"a\", function () {\n      return s;\n    });\n\n    var i = window.AudioContext || window.webkitAudioContext,\n        a = n(3),\n        r = a.getParameter,\n        o = a.setParameter,\n        s = function () {\n      return r(\"AUDIO_CONTEXT\") || (console.log(\"Creating Audio Context\"), o(\"AUDIO_CONTEXT\", function () {\n        if (i) return new i();\n        throw new Error(\"AUDIO_CONTEXT_NOT_SUPPORTED\");\n      }())), r(\"AUDIO_CONTEXT\");\n    };\n  }, function (e, t, n) {\n    var i = n(25);\n\n    e.exports = function (e) {\n      for (var t = 1; t < arguments.length; t++) {\n        var n = null != arguments[t] ? arguments[t] : {},\n            a = Object.keys(n);\n        \"function\" == typeof Object.getOwnPropertySymbols && (a = a.concat(Object.getOwnPropertySymbols(n).filter(function (e) {\n          return Object.getOwnPropertyDescriptor(n, e).enumerable;\n        }))), a.forEach(function (t) {\n          i(e, t, n[t]);\n        });\n      }\n\n      return e;\n    };\n  }, function (e, t, n) {\n    var i = n(23),\n        a = n(24);\n\n    e.exports = function (e, t, n) {\n      var r = t && n || 0;\n      \"string\" == typeof e && (t = \"binary\" === e ? new Array(16) : null, e = null);\n      var o = (e = e || {}).random || (e.rng || i)();\n      if (o[6] = 15 & o[6] | 64, o[8] = 63 & o[8] | 128, t) for (var s = 0; s < 16; ++s) t[r + s] = o[s];\n      return t || a(o);\n    };\n  }, function (e, t, n) {\n    var i = n(33),\n        a = n(34),\n        r = n(35);\n\n    e.exports = function (e) {\n      return i(e) || a(e) || r();\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    var i = this && this.__importDefault || function (e) {\n      return e && e.__esModule ? e : {\n        default: e\n      };\n    };\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n    var a,\n        r = i(n(0)),\n        o = n(13);\n    !function (e) {\n      e.NEW = \"new\", e.PREPARING_OFFER = \"preparing-offer\", e.OFFER_SENT = \"offer-sent\", e.ESTABLISHED = \"established\", e.CLOSED = \"closed\";\n    }(a || (a = {}));\n\n    var s = function () {\n      function e(e) {\n        this.candidate = null, this.state = a.NEW, this.config = e, this.isSubscriber = this.config.isSubscriber, this.peerConnection = this.initPeecConnection(e), this.peerConnection.onicecandidate = this._onicecandidate.bind(this), this.peerConnection.oniceconnectionstatechange = this._oniceconnectionstatechange.bind(this), this.peerConnection.onaddstream = this._onaddstream.bind(this), this.peerConnection.ontrack = this._ontrack.bind(this), this.processSignalingMessage = this.setAnswer.bind(this), this.peerConnection.createOffer({\n          offerToReceiveAudio: !0,\n          offerToReceiveVideo: !0\n        }).then(this.setLocalSDP.bind(this)), this.sendVideoStats = {\n          id: \"\",\n          type: \"\",\n          mediaType: \"\",\n          googCodecName: \"h264\" === this.config.codec ? \"H264\" : \"VP8\",\n          bytesSent: \"0\",\n          packetsLost: \"0\",\n          packetsSent: \"0\",\n          googAdaptationChanges: \"0\",\n          googAvgEncodeMs: \"0\",\n          googEncodeUsagePercent: \"0\",\n          googFirsReceived: \"0\",\n          googFrameHeightSent: \"0\",\n          googFrameHeightInput: \"0\",\n          googFrameRateInput: \"0\",\n          googFrameRateSent: \"0\",\n          googFrameWidthSent: \"0\",\n          googFrameWidthInput: \"0\",\n          googNacksReceived: \"0\",\n          googPlisReceived: \"0\",\n          googRtt: \"0\",\n          googFramesEncoded: \"0\"\n        }, this.sendAudioStats = {\n          id: \"\",\n          type: \"\",\n          mediaType: \"\",\n          googCodecName: \"opus\",\n          aecDivergentFilterFraction: \"0\",\n          audioInputLevel: \"0\",\n          bytesSent: \"0\",\n          packetsSent: \"0\",\n          googEchoCancellationReturnLoss: \"0\",\n          googEchoCancellationReturnLossEnhancement: \"0\"\n        }, this.receiveAudioStats = {\n          id: \"\",\n          type: \"\",\n          mediaType: \"\",\n          audioOutputLevel: \"0\",\n          bytesReceived: \"0\",\n          packetsLost: \"0\",\n          packetsReceived: \"0\",\n          googAccelerateRate: \"0\",\n          googCurrentDelayMs: \"0\",\n          googDecodingCNG: \"0\",\n          googDecodingCTN: \"0\",\n          googDecodingCTSG: \"0\",\n          googDecodingNormal: \"0\",\n          googDecodingPLC: \"0\",\n          googDecodingPLCCNG: \"0\",\n          googExpandRate: \"0\",\n          googJitterBufferMs: \"0\",\n          googJitterReceived: \"0\",\n          googPreemptiveExpandRate: \"0\",\n          googPreferredJitterBufferMs: \"0\",\n          googSecondaryDecodedRate: \"0\",\n          googSpeechExpandRate: \"0\"\n        }, this.receiveVideoStats = {\n          id: \"\",\n          type: \"\",\n          mediaType: \"\",\n          googTargetDelayMs: \"0\",\n          packetsLost: \"0\",\n          googDecodeMs: \"0\",\n          googMaxDecodeMs: \"0\",\n          googRenderDelayMs: \"0\",\n          googFrameWidthReceived: \"0\",\n          googFrameHeightReceived: \"0\",\n          googFrameRateReceived: \"0\",\n          googFrameRateDecoded: \"0\",\n          googFrameRateOutput: \"0\",\n          googFramesDecoded: \"0\",\n          googFrameReceived: \"0\",\n          googJitterBufferMs: \"0\",\n          googCurrentDelayMs: \"0\",\n          googMinPlayoutDelayMs: \"0\",\n          googNacksSent: \"0\",\n          googPlisSent: \"0\",\n          googFirsSent: \"0\",\n          bytesReceived: \"0\",\n          packetsReceived: \"0\"\n        };\n      }\n\n      return e.prototype.addStream = function (e) {\n        this.peerConnection.addStream(e);\n      }, e.prototype.setAnswer = function (e) {\n        var t = JSON.parse(e);\n        this.peerConnection.setRemoteDescription(new RTCSessionDescription({\n          sdp: t.sdp,\n          type: \"answer\"\n        })), this.onsignalingmessage && this.onsignalingmessage(\"\");\n      }, e.prototype.close = function () {\n        this.peerConnection.close();\n      }, e.prototype.getStats = function (e, t) {\n        if (void 0 === t && (t = 500), t = t > 500 ? 500 : t, Date.now() - this.lastTimeGetStats < t) {\n          var n = [];\n          this.config.isSubscriber ? (n.push(this.receiveVideoStats), n.push(this.receiveAudioStats)) : (n.push(this.sendAudioStats), n.push(this.sendVideoStats)), n.push({\n            id: \"time\",\n            startTime: this.connectedTime,\n            timestamp: Date.now()\n          }), e && e(n);\n        } else this._getStats(e);\n      }, e.prototype._getStats = function (e) {\n        var t = this,\n            n = [];\n        this.peerConnection.getStats(null).then(function (i) {\n          t.lastTimeGetStats = Date.now(), Object.keys(i).map(function (e) {\n            var n = i[e];\n            t.config.isSubscriber ? n.type && \"inboundrtp\" === n.type && n.mediaType && \"audio\" === n.mediaType ? (t.receiveAudioStats.id = n.id + \"recv\", t.receiveAudioStats.type = n.type + \"\", t.receiveAudioStats.mediaType = n.mediaType + \"\", t.receiveAudioStats.packetsReceived = n.packetsReceived + \"\", t.receiveAudioStats.bytesReceived = n.bytesReceived + \"\", t.receiveAudioStats.packetsLost = n.packetsLost + \"\", t.receiveAudioStats.googJitterReceived = n.jitter + \"\") : n.type && \"inboundrtp\" === n.type && n.mediaType && \"video\" === n.mediaType ? (t.receiveVideoStats.id = n.id + \"recv\", t.receiveVideoStats.type = n.type + \"\", t.receiveVideoStats.mediaType = n.mediaType + \"\", t.receiveVideoStats.packetsReceived = n.packetsReceived + \"\", t.receiveVideoStats.bytesReceived = n.bytesReceived + \"\", t.receiveVideoStats.packetsLost = n.packetsLost + \"\", t.receiveVideoStats.googJitterBufferMs = n.jitter + \"\", t.receiveVideoStats.googPlisSent = n.pliCount + \"\", t.receiveVideoStats.googFirsSent = n.firCount + \"\", t.receiveVideoStats.googNacksSent = n.nackCount + \"\") : n.remoteSource && n.type && \"track\" === n.type && n.trackIdentifier && -1 !== n.trackIdentifier.indexOf(\"v\") ? (t.receiveVideoStats.googFrameHeightReceived = n.frameHeight + \"\", t.receiveVideoStats.googFrameWidthReceived = n.frameWidth + \"\", t.receiveVideoStats.googFrameRateDecoded = n.framesPerSecond + \"\", t.receiveVideoStats.googFrameRateOutput = n.framesPerSecond + \"\", t.receiveVideoStats.googFrameRateReceived = n.framesPerSecond + \"\", t.receiveVideoStats.googFramesDecoded = n.framesDecoded + \"\", t.receiveVideoStats.googFrameReceived = n.framesReceived + \"\") : n.remoteSource && n.type && \"track\" === n.type && n.trackIdentifier && -1 !== n.trackIdentifier.indexOf(\"a\") && (t.receiveAudioStats.audioOutputLevel = n.audioLevel + \"\") : !n.isRemote && n.type && \"outboundrtp\" === n.type && n.mediaType && \"audio\" === n.mediaType ? (t.sendAudioStats.id = n.id + \"send\", t.sendAudioStats.type = n.type + \"\", t.sendAudioStats.mediaType = n.mediaType + \"\", t.sendAudioStats.packetsSent = n.packetsSent + \"\", t.sendAudioStats.bytesSent = n.bytesSent + \"\") : !n.isRemote && n.type && \"outboundrtp\" === n.type && n.mediaType && \"video\" === n.mediaType ? (t.sendVideoStats.id = n.id + \"send\", t.sendVideoStats.type = n.type + \"\", t.sendVideoStats.mediaType = n.mediaType + \"\", t.sendVideoStats.packetsSent = n.packetsSent + \"\", t.sendVideoStats.bytesSent = n.bytesSent + \"\", t.sendVideoStats.googRtt = n.roundTripTime + \"\", t.sendVideoStats.googPlisReceived = n.pliCount + \"\", t.sendVideoStats.googFirsReceived = n.firCount + \"\", t.sendVideoStats.googNacksReceived = n.nackCount + \"\") : !n.remoteSource && n.type && \"track\" === n.type && n.framesSent && 0 !== n.framesSent && (t.sendVideoStats.googFrameHeightSent = n.frameHeight + \"\", t.sendVideoStats.googFrameHeightInput = n.frameHeight + \"\", t.sendVideoStats.googFrameWidthSent = n.frameWidth + \"\", t.sendVideoStats.googFrameWidthInput = n.frameWidth + \"\", t.sendVideoStats.googFramesEncoded = n.framesSent + \"\", t.sendVideoStats.googFrameRateSent = n.framesPerSecond + \"\");\n          }), t.config.isSubscriber ? (n.push(t.receiveVideoStats), n.push(t.receiveAudioStats)) : (n.push(t.sendAudioStats), n.push(t.sendVideoStats)), n.push({\n            id: \"time\",\n            startTime: t.connectedTime,\n            timestamp: Date.now()\n          }), e && e(n);\n        });\n      }, e.prototype.getStatsRate = function (e) {\n        this.getStats(e);\n      }, e.prototype.initPeecConnection = function (e) {\n        var t = e.stunServerUrl,\n            n = e.turnServer,\n            i = e.iceServers;\n        return this.pcConfig = {\n          iceServers: [{\n            urls: \"stun:webcs.agora.io:3478\"\n          }]\n        }, i instanceof Array ? this.pcConfig.iceServers = e.iceServers : t && (t instanceof Array ? t.map(function (e) {\n          \"string\" == typeof e && \"\" !== e && this.pcConfig.iceServers.push({\n            urls: e\n          });\n        }) : \"string\" == typeof t && \"\" !== t && this.pcConfig.iceServers.push({\n          urls: t\n        })), n && (n instanceof Array ? n.map(function (e) {\n          \"string\" == typeof e.url && \"\" !== e.url && this.pcConfig.iceServers.push({\n            username: e.username,\n            credential: e.credential,\n            url: e.url\n          });\n        }) : \"auto\" !== n.mode && \"manual\" !== n.mode || (n.udpport && this.pcConfig.iceServers.push({\n          username: n.username,\n          credential: n.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + n.url + \":\" + n.udpport + \"?transport=udp\"\n        }), \"string\" == typeof n.tcpport && \"\" !== n.tcpport && this.pcConfig.iceServers.push({\n          username: n.username,\n          credential: n.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + n.url + \":\" + n.tcpport + \"?transport=tcp\"\n        }), !0 === n.forceturn && (this.pcConfig.iceTransportPolicy = \"relay\"))), new o.RTCPeerConnection(this.pcConfig);\n      }, e.prototype._ontrack = function (e) {\n        this.onaddstream && this.onaddstream(e, \"ontrack\");\n      }, e.prototype._onaddstream = function (e) {\n        this.onaddstream && this.onaddstream(e, \"onaddstream\");\n      }, e.prototype._oniceconnectionstatechange = function (e) {\n        \"connected\" === e.currentTarget.iceConnectionState && (this.state = a.ESTABLISHED, this.connectedTime = Date.now()), this.oniceconnectionstatechange && this.oniceconnectionstatechange(e.currentTarget.iceConnectionState);\n      }, e.prototype._onicecandidate = function (e) {\n        !this.candidate && e && (this.candidate = e.candidate, this.peerConnection.createOffer({\n          offerToReceiveAudio: !0,\n          offerToReceiveVideo: !0\n        }).then(this.editLocalSDP.bind(this)).then(this.setLocalSDP.bind(this)).then(this.sendOffer.bind(this)).catch());\n      }, e.prototype.setLocalSDP = function (e) {\n        return this.peerConnection.setLocalDescription(new RTCSessionDescription({\n          sdp: e.sdp,\n          type: \"offer\"\n        })), this.state = a.PREPARING_OFFER, e;\n      }, e.prototype.editLocalSDP = function (e) {\n        return e.sdp = this.setBandWidth(e.sdp), e.sdp = this.reviseOpus(e.sdp), e.sdp = this.addCandidate(e.sdp), e;\n      }, e.prototype.setSendRecv = function (e) {\n        return e = (e = (e = e.replace(/a=recvonly\\r\\n/g, \"a=sendrecv\\r\\n\")).replace(/a=sendonly\\r\\n/g, \"a=sendrecv\\r\\n\")).replace(/a=inactive\\r\\n/g, \"a=sendrecv\\r\\n\");\n      }, e.prototype.setBandWidth = function (e) {\n        var t,\n            n,\n            i = this.config,\n            a = i.codec,\n            o = i.minVideoBW,\n            s = i.maxVideoBW,\n            c = i.maxAudioBW,\n            d = i.clientId;\n\n        if ((t = e.match(/m=video.*\\r\\n/)) && o && s) {\n          n = t[0] + \"b=AS:\" + s + \"\\r\\n\";\n          var u = 0,\n              l = 0;\n          \"h264\" === a ? (u = e.search(/a=rtpmap:(\\d+) H264\\/90000\\r\\n/), l = e.search(/H264\\/90000\\r\\n/)) : \"vp8\" === a && (u = e.search(/a=rtpmap:(\\d+) VP8\\/90000\\r\\n/), l = e.search(/VP8\\/90000\\r\\n/)), -1 !== u && -1 !== l && l - u > 10 && (n = n + \"a=fmtp:\" + e.slice(u + 9, l - 1) + \" x-google-min-bitrate=\" + o + \"\\r\\n\"), e = e.replace(t[0], n), r.default.debug(\"[\" + d + \"]Set Video Bitrate - min:\" + o + \" max:\" + s);\n        }\n\n        return (t = e.match(/m=audio.*\\r\\n/)) && c && (n = t[0] + \"b=AS:\" + c + \"\\r\\n\", e = e.replace(t[0], n)), e;\n      }, e.prototype.reviseOpus = function (e) {\n        return e = (e = e.replace(/a=rtpmap:102 opus\\/48000\\/2/g, \"a=rtpmap:111 opus/48000/2\")).replace(/m=audio 9 UDP\\/TLS\\/RTP\\/SAVPF 102 0 8 97 13 118 101/g, \"m=audio 9 UDP/TLS/RTP/SAVPF 111 0 8 97 13 118 101\");\n      }, e.prototype.addCandidate = function (e) {\n        return e += \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\";\n      }, e.prototype.sendOffer = function (e) {\n        this.config.callback(JSON.stringify({\n          sdp: e.sdp,\n          messageType: \"OFFER\",\n          tiebreaker: Math.floor(429496723 * Math.random() + 1)\n        })), this.state = a.OFFER_SENT;\n      }, e;\n    }();\n\n    t.default = s;\n  }, function (e, t, n) {\n    var i = n(28),\n        a = n(29),\n        r = n(30);\n\n    e.exports = function (e, t) {\n      return i(e) || a(e, t) || r();\n    };\n  }, function (e, t, n) {\n    var i, a;\n    a = this, void 0 === (i = function () {\n      return function () {\n        \"use strict\";\n\n        var e,\n            t = this;\n\n        function n(e) {\n          t.console && (t.console.error ? t.console.error(e) : t.console.log && t.console.log(e));\n        }\n\n        function i(e, t, i, a) {\n          var r = a || n,\n              o = e.createShader(i);\n          e.shaderSource(o, t), e.compileShader(o);\n          var s = e.getShaderParameter(o, e.COMPILE_STATUS);\n\n          if (!s) {\n            var c = e.getShaderInfoLog(o);\n            return r(\"*** Error compiling shader '\" + o + \"':\" + c), e.deleteShader(o), null;\n          }\n\n          return o;\n        }\n\n        function a(e, t, i, a, r) {\n          var o = r || n,\n              s = e.createProgram();\n          t.forEach(function (t) {\n            e.attachShader(s, t);\n          }), i && i.forEach(function (t, n) {\n            e.bindAttribLocation(s, a ? a[n] : n, t);\n          }), e.linkProgram(s);\n          var c = e.getProgramParameter(s, e.LINK_STATUS);\n\n          if (!c) {\n            var d = e.getProgramInfoLog(s);\n            return o(\"Error in program linking:\" + d), e.deleteProgram(s), null;\n          }\n\n          return s;\n        }\n\n        (e = e || t) === e.top && (console.log(\"%c%s\", \"color:blue;font-weight:bold;\", \"for more about webgl-utils.js see:\"), console.log(\"%c%s\", \"color:blue;font-weight:bold;\", \"http://webglfundamentals.org/webgl/lessons/webgl-boilerplate.html\"));\n        var r,\n            o = [\"VERTEX_SHADER\", \"FRAGMENT_SHADER\"];\n        return !document.documentMode && window.StyleMedia && (HTMLCanvasElement.prototype.getContext = (r = HTMLCanvasElement.prototype.getContext, function () {\n          var e = arguments,\n              t = e[0];\n          return \"webgl\" === t && ((e = [].slice.call(arguments))[0] = \"experimental-webgl\"), r.apply(this, e);\n        })), {\n          createProgram: a,\n          createProgramFromSources: function (e, t, n, r, s) {\n            for (var c = [], d = 0; d < t.length; ++d) c.push(i(e, t[d], e[o[d]], s));\n\n            return a(e, c, n, r, s);\n          }\n        };\n      }.call(a);\n    }.apply(t, [])) || (e.exports = i);\n  }, function (e, t, n) {\n    \"use strict\";\n\n    var i = this && this.__awaiter || function (e, t, n, i) {\n      return new (n || (n = Promise))(function (a, r) {\n        function o(e) {\n          try {\n            c(i.next(e));\n          } catch (e) {\n            r(e);\n          }\n        }\n\n        function s(e) {\n          try {\n            c(i.throw(e));\n          } catch (e) {\n            r(e);\n          }\n        }\n\n        function c(e) {\n          e.done ? a(e.value) : new n(function (t) {\n            t(e.value);\n          }).then(o, s);\n        }\n\n        c((i = i.apply(e, t || [])).next());\n      });\n    },\n        a = this && this.__generator || function (e, t) {\n      var n,\n          i,\n          a,\n          r,\n          o = {\n        label: 0,\n        sent: function () {\n          if (1 & a[0]) throw a[1];\n          return a[1];\n        },\n        trys: [],\n        ops: []\n      };\n      return r = {\n        next: s(0),\n        throw: s(1),\n        return: s(2)\n      }, \"function\" == typeof Symbol && (r[Symbol.iterator] = function () {\n        return this;\n      }), r;\n\n      function s(r) {\n        return function (s) {\n          return function (r) {\n            if (n) throw new TypeError(\"Generator is already executing.\");\n\n            for (; o;) try {\n              if (n = 1, i && (a = 2 & r[0] ? i.return : r[0] ? i.throw || ((a = i.return) && a.call(i), 0) : i.next) && !(a = a.call(i, r[1])).done) return a;\n\n              switch (i = 0, a && (r = [2 & r[0], a.value]), r[0]) {\n                case 0:\n                case 1:\n                  a = r;\n                  break;\n\n                case 4:\n                  return o.label++, {\n                    value: r[1],\n                    done: !1\n                  };\n\n                case 5:\n                  o.label++, i = r[1], r = [0];\n                  continue;\n\n                case 7:\n                  r = o.ops.pop(), o.trys.pop();\n                  continue;\n\n                default:\n                  if (!(a = (a = o.trys).length > 0 && a[a.length - 1]) && (6 === r[0] || 2 === r[0])) {\n                    o = 0;\n                    continue;\n                  }\n\n                  if (3 === r[0] && (!a || r[1] > a[0] && r[1] < a[3])) {\n                    o.label = r[1];\n                    break;\n                  }\n\n                  if (6 === r[0] && o.label < a[1]) {\n                    o.label = a[1], a = r;\n                    break;\n                  }\n\n                  if (a && o.label < a[2]) {\n                    o.label = a[2], o.ops.push(r);\n                    break;\n                  }\n\n                  a[2] && o.ops.pop(), o.trys.pop();\n                  continue;\n              }\n\n              r = t.call(e, o);\n            } catch (e) {\n              r = [6, e], i = 0;\n            } finally {\n              n = a = 0;\n            }\n\n            if (5 & r[0]) throw r[1];\n            return {\n              value: r[0] ? r[1] : void 0,\n              done: !0\n            };\n          }([r, s]);\n        };\n      }\n    },\n        r = this && this.__importDefault || function (e) {\n      return e && e.__esModule ? e : {\n        default: e\n      };\n    },\n        o = this;\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n    var s = n(31),\n        c = n(5),\n        d = r(n(0));\n\n    t.getSupportedCodec = function (e) {\n      return i(o, void 0, void 0, function () {\n        var t, n, i, r, o;\n        return a(this, function (a) {\n          switch (a.label) {\n            case 0:\n              return t = {\n                video: [],\n                audio: []\n              }, \"undefined\" != typeof window ? [3, 1] : (d.default.error(\"getSupportedCodec: NOT_BROWSER_ENV\"), [2, Promise.reject(\"NOT_BROWSER_ENV\")]);\n\n            case 1:\n              try {\n                n = s.createRTCPeerConnection({\n                  iceServers: []\n                });\n              } catch (e) {\n                return d.default.error(\"Failed to init RTCPeerConnection\", e), [2, Promise.reject(e)];\n              }\n\n              return n ? [3, 2] : (d.default.warning(\"getSupportedCodec: no RTCPeerConnection constructor is detected\"), [2, Promise.resolve(t)]);\n\n            case 2:\n              return e && e.stream ? [3, 7] : (i = {\n                mandatory: {\n                  OfferToReceiveAudio: !0,\n                  OfferToReceiveVideo: !0\n                }\n              }, r = void 0, (c.isSafari() || c.isFireFox() || c.isWeChatBrowser()) && n.addTransceiver ? (n.addTransceiver(\"audio\"), n.addTransceiver(\"video\"), [4, n.createOffer()]) : [3, 4]);\n\n            case 3:\n              return r = a.sent(), [3, 6];\n\n            case 4:\n              return [4, new Promise(function (e, t) {\n                var a = setTimeout(function () {\n                  t(\"CREATEOFFER_TIMEOUT\");\n                }, 3e3);\n                n.createOffer(function (t) {\n                  clearTimeout(a), e(t);\n                }, function (e) {\n                  clearTimeout(a), t(e);\n                }, i);\n              })];\n\n            case 5:\n              r = a.sent(), a.label = 6;\n\n            case 6:\n              return n.close(), o = r.sdp, [2, u(o)];\n\n            case 7:\n              return e.stream.getTracks && n.addTrack ? e.stream.getTracks().forEach(function (t) {\n                n.addTrack(t, e.stream);\n              }) : n.addStream(e.stream), r = void 0, c.isSafari() || c.isFireFox() ? [4, n.createOffer()] : [3, 9];\n\n            case 8:\n              return r = a.sent(), [3, 11];\n\n            case 9:\n              return [4, new Promise(function (e, t) {\n                n.createOffer(e, t);\n              })];\n\n            case 10:\n              r = a.sent(), a.label = 11;\n\n            case 11:\n              return n.close(), o = r.sdp, [2, u(o)];\n          }\n        });\n      });\n    };\n\n    var u = function (e) {\n      var t = {\n        video: [],\n        audio: []\n      };\n      return e.match(/ VP8/i) && t.video.push(\"VP8\"), e.match(/ H264/i) && t.video.push(\"H264\"), e.match(/ opus/i) && t.audio.push(\"OPUS\"), Promise.resolve(t);\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    var i = this && this.__importDefault || function (e) {\n      return e && e.__esModule ? e : {\n        default: e\n      };\n    };\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n    var a = i(n(4)),\n        r = i(n(0)),\n        o = n(10);\n\n    t.default = function (e, t) {\n      void 0 === t && (t = {\n        width: 160,\n        height: 120,\n        framerate: 15\n      });\n      var n = t.width,\n          i = t.height,\n          s = t.framerate,\n          c = e.stream;\n      if (!c) throw a.default.INVALID_LOCAL_STREAM;\n      if (!c.getVideoTracks()[0]) throw a.default.HIGH_STREAM_NOT_VIDEO_TRACE;\n      var d = c.getVideoTracks()[0];\n      r.default.debug(\"Start getLowStream\");\n      var u = document.createElement(\"video\"),\n          l = document.createElement(\"canvas\");\n      u.setAttribute(\"style\", \"display:none\"), u.setAttribute(\"muted\", \"\"), u.muted = !0, u.setAttribute(\"autoplay\", \"\"), u.autoplay = !0, u.setAttribute(\"playsinline\", \"\"), l.setAttribute(\"style\", \"display:none\"), l.setAttribute(\"width\", n.toString()), l.setAttribute(\"height\", i.toString());\n      var f = l.getContext(\"2d\");\n      if (!f) throw new Error(\"not get canvas context\");\n      u.srcObject = c, document.body.append(u), document.body.append(l), u.play(), r.default.debug(\"Start render lowStream\");\n      var p = o.audioTimerLoop(function () {\n        return function () {\n          if (u.paused && u.play(), u.videoHeight > 2 && u.videoWidth > 2) {\n            var t = u.videoWidth,\n                n = u.videoHeight / t,\n                i = l.width * n;\n            Math.abs(i - l.height) >= 2 && (r.default.debug(\"adjust low stream resolution\", l.width + \"x\" + l.height + \" -> \" + l.width + \"x\" + i), l.height = i);\n          }\n\n          f.drawImage(u, 0, 0, l.width, l.height);\n          var a = e.stream;\n\n          if (a) {\n            var o = a.getVideoTracks()[0];\n            d !== o && (r.default.debug(\"adjust low stream track\"), u.srcObject = a, d = o);\n          }\n        }();\n      }, s),\n          g = l.captureStream(s),\n          m = g.getVideoTracks()[0];\n      return m.requestFrame && m.requestFrame(), g.clean = function () {\n        r.default.debug(\"Start clean lowStream\"), p(), (u || u.parentNode || u.parentNode.removeChild) && u.parentNode.removeChild(u), (l || l.parentNode || l.parentNode.removeChild) && l.parentNode.removeChild(l), r.default.debug(\"Clean lowStream\");\n      }, g;\n    };\n  }, function (e, t) {\n    var n = \"undefined\" != typeof crypto && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || \"undefined\" != typeof msCrypto && \"function\" == typeof window.msCrypto.getRandomValues && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (n) {\n      var i = new Uint8Array(16);\n\n      e.exports = function () {\n        return n(i), i;\n      };\n    } else {\n      var a = new Array(16);\n\n      e.exports = function () {\n        for (var e, t = 0; t < 16; t++) 0 == (3 & t) && (e = 4294967296 * Math.random()), a[t] = e >>> ((3 & t) << 3) & 255;\n\n        return a;\n      };\n    }\n  }, function (e, t) {\n    for (var n = [], i = 0; i < 256; ++i) n[i] = (i + 256).toString(16).substr(1);\n\n    e.exports = function (e, t) {\n      var i = t || 0,\n          a = n;\n      return [a[e[i++]], a[e[i++]], a[e[i++]], a[e[i++]], \"-\", a[e[i++]], a[e[i++]], \"-\", a[e[i++]], a[e[i++]], \"-\", a[e[i++]], a[e[i++]], \"-\", a[e[i++]], a[e[i++]], a[e[i++]], a[e[i++]], a[e[i++]], a[e[i++]]].join(\"\");\n    };\n  }, function (e, t) {\n    e.exports = function (e, t, n) {\n      return t in e ? Object.defineProperty(e, t, {\n        value: n,\n        enumerable: !0,\n        configurable: !0,\n        writable: !0\n      }) : e[t] = n, e;\n    };\n  }, function (e, t, n) {\n    var i = function () {\n      return this || \"object\" == typeof self && self;\n    }() || Function(\"return this\")(),\n        a = i.regeneratorRuntime && Object.getOwnPropertyNames(i).indexOf(\"regeneratorRuntime\") >= 0,\n        r = a && i.regeneratorRuntime;\n\n    if (i.regeneratorRuntime = void 0, e.exports = n(27), a) i.regeneratorRuntime = r;else try {\n      delete i.regeneratorRuntime;\n    } catch (e) {\n      i.regeneratorRuntime = void 0;\n    }\n  }, function (e, t) {\n    !function (t) {\n      \"use strict\";\n\n      var n,\n          i = Object.prototype,\n          a = i.hasOwnProperty,\n          r = \"function\" == typeof Symbol ? Symbol : {},\n          o = r.iterator || \"@@iterator\",\n          s = r.asyncIterator || \"@@asyncIterator\",\n          c = r.toStringTag || \"@@toStringTag\",\n          d = \"object\" == typeof e,\n          u = t.regeneratorRuntime;\n      if (u) d && (e.exports = u);else {\n        (u = t.regeneratorRuntime = d ? e.exports : {}).wrap = E;\n        var l = \"suspendedStart\",\n            f = \"suspendedYield\",\n            p = \"executing\",\n            g = \"completed\",\n            m = {},\n            v = {};\n\n        v[o] = function () {\n          return this;\n        };\n\n        var S = Object.getPrototypeOf,\n            h = S && S(S(k([])));\n        h && h !== i && a.call(h, o) && (v = h);\n\n        var _ = b.prototype = T.prototype = Object.create(v);\n\n        y.prototype = _.constructor = b, b.constructor = y, b[c] = y.displayName = \"GeneratorFunction\", u.isGeneratorFunction = function (e) {\n          var t = \"function\" == typeof e && e.constructor;\n          return !!t && (t === y || \"GeneratorFunction\" === (t.displayName || t.name));\n        }, u.mark = function (e) {\n          return Object.setPrototypeOf ? Object.setPrototypeOf(e, b) : (e.__proto__ = b, c in e || (e[c] = \"GeneratorFunction\")), e.prototype = Object.create(_), e;\n        }, u.awrap = function (e) {\n          return {\n            __await: e\n          };\n        }, R(A.prototype), A.prototype[s] = function () {\n          return this;\n        }, u.AsyncIterator = A, u.async = function (e, t, n, i) {\n          var a = new A(E(e, t, n, i));\n          return u.isGeneratorFunction(t) ? a : a.next().then(function (e) {\n            return e.done ? e.value : a.next();\n          });\n        }, R(_), _[c] = \"Generator\", _[o] = function () {\n          return this;\n        }, _.toString = function () {\n          return \"[object Generator]\";\n        }, u.keys = function (e) {\n          var t = [];\n\n          for (var n in e) t.push(n);\n\n          return t.reverse(), function n() {\n            for (; t.length;) {\n              var i = t.pop();\n              if (i in e) return n.value = i, n.done = !1, n;\n            }\n\n            return n.done = !0, n;\n          };\n        }, u.values = k, w.prototype = {\n          constructor: w,\n          reset: function (e) {\n            if (this.prev = 0, this.next = 0, this.sent = this._sent = n, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = n, this.tryEntries.forEach(N), !e) for (var t in this) \"t\" === t.charAt(0) && a.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = n);\n          },\n          stop: function () {\n            this.done = !0;\n            var e = this.tryEntries[0].completion;\n            if (\"throw\" === e.type) throw e.arg;\n            return this.rval;\n          },\n          dispatchException: function (e) {\n            if (this.done) throw e;\n            var t = this;\n\n            function i(i, a) {\n              return s.type = \"throw\", s.arg = e, t.next = i, a && (t.method = \"next\", t.arg = n), !!a;\n            }\n\n            for (var r = this.tryEntries.length - 1; r >= 0; --r) {\n              var o = this.tryEntries[r],\n                  s = o.completion;\n              if (\"root\" === o.tryLoc) return i(\"end\");\n\n              if (o.tryLoc <= this.prev) {\n                var c = a.call(o, \"catchLoc\"),\n                    d = a.call(o, \"finallyLoc\");\n\n                if (c && d) {\n                  if (this.prev < o.catchLoc) return i(o.catchLoc, !0);\n                  if (this.prev < o.finallyLoc) return i(o.finallyLoc);\n                } else if (c) {\n                  if (this.prev < o.catchLoc) return i(o.catchLoc, !0);\n                } else {\n                  if (!d) throw new Error(\"try statement without catch or finally\");\n                  if (this.prev < o.finallyLoc) return i(o.finallyLoc);\n                }\n              }\n            }\n          },\n          abrupt: function (e, t) {\n            for (var n = this.tryEntries.length - 1; n >= 0; --n) {\n              var i = this.tryEntries[n];\n\n              if (i.tryLoc <= this.prev && a.call(i, \"finallyLoc\") && this.prev < i.finallyLoc) {\n                var r = i;\n                break;\n              }\n            }\n\n            r && (\"break\" === e || \"continue\" === e) && r.tryLoc <= t && t <= r.finallyLoc && (r = null);\n            var o = r ? r.completion : {};\n            return o.type = e, o.arg = t, r ? (this.method = \"next\", this.next = r.finallyLoc, m) : this.complete(o);\n          },\n          complete: function (e, t) {\n            if (\"throw\" === e.type) throw e.arg;\n            return \"break\" === e.type || \"continue\" === e.type ? this.next = e.arg : \"return\" === e.type ? (this.rval = this.arg = e.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === e.type && t && (this.next = t), m;\n          },\n          finish: function (e) {\n            for (var t = this.tryEntries.length - 1; t >= 0; --t) {\n              var n = this.tryEntries[t];\n              if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), N(n), m;\n            }\n          },\n          catch: function (e) {\n            for (var t = this.tryEntries.length - 1; t >= 0; --t) {\n              var n = this.tryEntries[t];\n\n              if (n.tryLoc === e) {\n                var i = n.completion;\n\n                if (\"throw\" === i.type) {\n                  var a = i.arg;\n                  N(n);\n                }\n\n                return a;\n              }\n            }\n\n            throw new Error(\"illegal catch attempt\");\n          },\n          delegateYield: function (e, t, i) {\n            return this.delegate = {\n              iterator: k(e),\n              resultName: t,\n              nextLoc: i\n            }, \"next\" === this.method && (this.arg = n), m;\n          }\n        };\n      }\n\n      function E(e, t, n, i) {\n        var a = t && t.prototype instanceof T ? t : T,\n            r = Object.create(a.prototype),\n            o = new w(i || []);\n        return r._invoke = function (e, t, n) {\n          var i = l;\n          return function (a, r) {\n            if (i === p) throw new Error(\"Generator is already running\");\n\n            if (i === g) {\n              if (\"throw\" === a) throw r;\n              return D();\n            }\n\n            for (n.method = a, n.arg = r;;) {\n              var o = n.delegate;\n\n              if (o) {\n                var s = C(o, n);\n\n                if (s) {\n                  if (s === m) continue;\n                  return s;\n                }\n              }\n\n              if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) {\n                if (i === l) throw i = g, n.arg;\n                n.dispatchException(n.arg);\n              } else \"return\" === n.method && n.abrupt(\"return\", n.arg);\n              i = p;\n              var c = I(e, t, n);\n\n              if (\"normal\" === c.type) {\n                if (i = n.done ? g : f, c.arg === m) continue;\n                return {\n                  value: c.arg,\n                  done: n.done\n                };\n              }\n\n              \"throw\" === c.type && (i = g, n.method = \"throw\", n.arg = c.arg);\n            }\n          };\n        }(e, n, o), r;\n      }\n\n      function I(e, t, n) {\n        try {\n          return {\n            type: \"normal\",\n            arg: e.call(t, n)\n          };\n        } catch (e) {\n          return {\n            type: \"throw\",\n            arg: e\n          };\n        }\n      }\n\n      function T() {}\n\n      function y() {}\n\n      function b() {}\n\n      function R(e) {\n        [\"next\", \"throw\", \"return\"].forEach(function (t) {\n          e[t] = function (e) {\n            return this._invoke(t, e);\n          };\n        });\n      }\n\n      function A(e) {\n        var t;\n\n        this._invoke = function (n, i) {\n          function r() {\n            return new Promise(function (t, r) {\n              !function t(n, i, r, o) {\n                var s = I(e[n], e, i);\n\n                if (\"throw\" !== s.type) {\n                  var c = s.arg,\n                      d = c.value;\n                  return d && \"object\" == typeof d && a.call(d, \"__await\") ? Promise.resolve(d.__await).then(function (e) {\n                    t(\"next\", e, r, o);\n                  }, function (e) {\n                    t(\"throw\", e, r, o);\n                  }) : Promise.resolve(d).then(function (e) {\n                    c.value = e, r(c);\n                  }, function (e) {\n                    return t(\"throw\", e, r, o);\n                  });\n                }\n\n                o(s.arg);\n              }(n, i, t, r);\n            });\n          }\n\n          return t = t ? t.then(r, r) : r();\n        };\n      }\n\n      function C(e, t) {\n        var i = e.iterator[t.method];\n\n        if (i === n) {\n          if (t.delegate = null, \"throw\" === t.method) {\n            if (e.iterator.return && (t.method = \"return\", t.arg = n, C(e, t), \"throw\" === t.method)) return m;\n            t.method = \"throw\", t.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n          }\n\n          return m;\n        }\n\n        var a = I(i, e.iterator, t.arg);\n        if (\"throw\" === a.type) return t.method = \"throw\", t.arg = a.arg, t.delegate = null, m;\n        var r = a.arg;\n        return r ? r.done ? (t[e.resultName] = r.value, t.next = e.nextLoc, \"return\" !== t.method && (t.method = \"next\", t.arg = n), t.delegate = null, m) : r : (t.method = \"throw\", t.arg = new TypeError(\"iterator result is not an object\"), t.delegate = null, m);\n      }\n\n      function O(e) {\n        var t = {\n          tryLoc: e[0]\n        };\n        1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t);\n      }\n\n      function N(e) {\n        var t = e.completion || {};\n        t.type = \"normal\", delete t.arg, e.completion = t;\n      }\n\n      function w(e) {\n        this.tryEntries = [{\n          tryLoc: \"root\"\n        }], e.forEach(O, this), this.reset(!0);\n      }\n\n      function k(e) {\n        if (e) {\n          var t = e[o];\n          if (t) return t.call(e);\n          if (\"function\" == typeof e.next) return e;\n\n          if (!isNaN(e.length)) {\n            var i = -1,\n                r = function t() {\n              for (; ++i < e.length;) if (a.call(e, i)) return t.value = e[i], t.done = !1, t;\n\n              return t.value = n, t.done = !0, t;\n            };\n\n            return r.next = r;\n          }\n        }\n\n        return {\n          next: D\n        };\n      }\n\n      function D() {\n        return {\n          value: n,\n          done: !0\n        };\n      }\n    }(function () {\n      return this || \"object\" == typeof self && self;\n    }() || Function(\"return this\")());\n  }, function (e, t) {\n    e.exports = function (e) {\n      if (Array.isArray(e)) return e;\n    };\n  }, function (e, t) {\n    e.exports = function (e, t) {\n      var n = [],\n          i = !0,\n          a = !1,\n          r = void 0;\n\n      try {\n        for (var o, s = e[Symbol.iterator](); !(i = (o = s.next()).done) && (n.push(o.value), !t || n.length !== t); i = !0);\n      } catch (e) {\n        a = !0, r = e;\n      } finally {\n        try {\n          i || null == s.return || s.return();\n        } finally {\n          if (a) throw r;\n        }\n      }\n\n      return n;\n    };\n  }, function (e, t) {\n    e.exports = function () {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    };\n  }, function (e, t, n) {\n    \"use strict\";\n\n    Object.defineProperty(t, \"__esModule\", {\n      value: !0\n    });\n    var i = \"object\" == typeof window && window.RTCPeerConnection,\n        a = \"object\" == typeof window && window.webkitRTCPeerConnection,\n        r = \"object\" == typeof window && window.mozRTCPeerConnection;\n\n    t.createRTCPeerConnection = function (e) {\n      var t = i || a || r;\n      return t ? new t(e) : null;\n    };\n  }, function (e, t, n) {\n    var i;\n    /*!\n     * EventEmitter v5.2.8 - git.io/ee\n     * Unlicense - http://unlicense.org/\n     * Oliver Caldwell - https://oli.me.uk/\n     * @preserve\n     */\n\n    !function (t) {\n      \"use strict\";\n\n      function a() {}\n\n      var r = a.prototype,\n          o = t.EventEmitter;\n\n      function s(e, t) {\n        for (var n = e.length; n--;) if (e[n].listener === t) return n;\n\n        return -1;\n      }\n\n      function c(e) {\n        return function () {\n          return this[e].apply(this, arguments);\n        };\n      }\n\n      r.getListeners = function (e) {\n        var t,\n            n,\n            i = this._getEvents();\n\n        if (e instanceof RegExp) for (n in t = {}, i) i.hasOwnProperty(n) && e.test(n) && (t[n] = i[n]);else t = i[e] || (i[e] = []);\n        return t;\n      }, r.flattenListeners = function (e) {\n        var t,\n            n = [];\n\n        for (t = 0; t < e.length; t += 1) n.push(e[t].listener);\n\n        return n;\n      }, r.getListenersAsObject = function (e) {\n        var t,\n            n = this.getListeners(e);\n        return n instanceof Array && ((t = {})[e] = n), t || n;\n      }, r.addListener = function (e, t) {\n        if (!function e(t) {\n          return \"function\" == typeof t || t instanceof RegExp || !(!t || \"object\" != typeof t) && e(t.listener);\n        }(t)) throw new TypeError(\"listener must be a function\");\n        var n,\n            i = this.getListenersAsObject(e),\n            a = \"object\" == typeof t;\n\n        for (n in i) i.hasOwnProperty(n) && -1 === s(i[n], t) && i[n].push(a ? t : {\n          listener: t,\n          once: !1\n        });\n\n        return this;\n      }, r.on = c(\"addListener\"), r.addOnceListener = function (e, t) {\n        return this.addListener(e, {\n          listener: t,\n          once: !0\n        });\n      }, r.once = c(\"addOnceListener\"), r.defineEvent = function (e) {\n        return this.getListeners(e), this;\n      }, r.defineEvents = function (e) {\n        for (var t = 0; t < e.length; t += 1) this.defineEvent(e[t]);\n\n        return this;\n      }, r.removeListener = function (e, t) {\n        var n,\n            i,\n            a = this.getListenersAsObject(e);\n\n        for (i in a) a.hasOwnProperty(i) && -1 !== (n = s(a[i], t)) && a[i].splice(n, 1);\n\n        return this;\n      }, r.off = c(\"removeListener\"), r.addListeners = function (e, t) {\n        return this.manipulateListeners(!1, e, t);\n      }, r.removeListeners = function (e, t) {\n        return this.manipulateListeners(!0, e, t);\n      }, r.manipulateListeners = function (e, t, n) {\n        var i,\n            a,\n            r = e ? this.removeListener : this.addListener,\n            o = e ? this.removeListeners : this.addListeners;\n        if (\"object\" != typeof t || t instanceof RegExp) for (i = n.length; i--;) r.call(this, t, n[i]);else for (i in t) t.hasOwnProperty(i) && (a = t[i]) && (\"function\" == typeof a ? r.call(this, i, a) : o.call(this, i, a));\n        return this;\n      }, r.removeEvent = function (e) {\n        var t,\n            n = typeof e,\n            i = this._getEvents();\n\n        if (\"string\" === n) delete i[e];else if (e instanceof RegExp) for (t in i) i.hasOwnProperty(t) && e.test(t) && delete i[t];else delete this._events;\n        return this;\n      }, r.removeAllListeners = c(\"removeEvent\"), r.emitEvent = function (e, t) {\n        var n,\n            i,\n            a,\n            r,\n            o = this.getListenersAsObject(e);\n\n        for (r in o) if (o.hasOwnProperty(r)) for (n = o[r].slice(0), a = 0; a < n.length; a++) !0 === (i = n[a]).once && this.removeListener(e, i.listener), i.listener.apply(this, t || []) === this._getOnceReturnValue() && this.removeListener(e, i.listener);\n\n        return this;\n      }, r.trigger = c(\"emitEvent\"), r.emit = function (e) {\n        var t = Array.prototype.slice.call(arguments, 1);\n        return this.emitEvent(e, t);\n      }, r.setOnceReturnValue = function (e) {\n        return this._onceReturnValue = e, this;\n      }, r._getOnceReturnValue = function () {\n        return !this.hasOwnProperty(\"_onceReturnValue\") || this._onceReturnValue;\n      }, r._getEvents = function () {\n        return this._events || (this._events = {});\n      }, a.noConflict = function () {\n        return t.EventEmitter = o, a;\n      }, void 0 === (i = function () {\n        return a;\n      }.call(t, n, t, e)) || (e.exports = i);\n    }(\"undefined\" != typeof window ? window : this || {});\n  }, function (e, t) {\n    e.exports = function (e) {\n      if (Array.isArray(e)) {\n        for (var t = 0, n = new Array(e.length); t < e.length; t++) n[t] = e[t];\n\n        return n;\n      }\n    };\n  }, function (e, t) {\n    e.exports = function (e) {\n      if (Symbol.iterator in Object(e) || \"[object Arguments]\" === Object.prototype.toString.call(e)) return Array.from(e);\n    };\n  }, function (e, t) {\n    e.exports = function () {\n      throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n    };\n  }, function (t, n, a) {\n    \"use strict\";\n\n    a.r(n);\n\n    var r = a(3),\n        o = a(0),\n        s = a(2),\n        c = function () {\n      var e = {\n        dispatcher: {}\n      };\n      return e.dispatcher.eventListeners = {}, e.addEventListener = function (t, n) {\n        void 0 === e.dispatcher.eventListeners[t] && (e.dispatcher.eventListeners[t] = []), e.dispatcher.eventListeners[t].push(n);\n      }, e.hasListeners = function (t) {\n        return !(!e.dispatcher.eventListeners[t] || !e.dispatcher.eventListeners[t].length);\n      }, e.on = e.addEventListener, e.removeEventListener = function (t, n) {\n        var i;\n        e.dispatcher.eventListeners[t] && -1 !== (i = e.dispatcher.eventListeners[t].indexOf(n)) && e.dispatcher.eventListeners[t].splice(i, 1);\n      }, e.dispatchEvent = function (t) {\n        var n;\n\n        for (n in e.dispatcher.eventListeners[t.type]) if (e.dispatcher.eventListeners[t.type] && e.dispatcher.eventListeners[t.type].hasOwnProperty(n) && \"function\" == typeof e.dispatcher.eventListeners[t.type][n]) try {\n          e.dispatcher.eventListeners[t.type][n](t);\n        } catch (n) {\n          o.default.debug(\"[\".concat(e.clientId, \"] Error in \").concat(t.type, \" event\"), n);\n        }\n      }, e.dispatchSocketEvent = function (t) {\n        var n;\n\n        for (n in e.dispatcher.eventListeners[t.type]) e.dispatcher.eventListeners[t.type] && e.dispatcher.eventListeners[t.type].hasOwnProperty(n) && \"function\" == typeof e.dispatcher.eventListeners[t.type][n] && e.dispatcher.eventListeners[t.type][n](t.msg);\n      }, e;\n    },\n        d = function (e) {\n      var t = {};\n      return t.type = e.type, t;\n    },\n        u = function (e) {\n      var t = d(e);\n      return t.stream = e.stream, t.reason = e.reason, t.msg = e.msg, t;\n    },\n        l = function (e) {\n      var t = d(e);\n      return t.uid = e.uid, t.attr = e.attr, t.stream = e.stream, t;\n    },\n        f = function (e) {\n      var t = d(e);\n      return t.msg = e.msg, t;\n    },\n        p = function (e) {\n      var t = d(e);\n      return t.url = e.url, t.uid = e.uid, t.status = e.status, t.reason = e.reason, t;\n    },\n        g = a(5),\n        m = function () {};\n\n    m.prototype.set = function (e, t) {\n      [\"BatteryLevel\"].indexOf(e) > -1 && (this[e] = t);\n    };\n\n    var v = new function () {\n      var e = c();\n      return e.states = {\n        UNINIT: \"UNINIT\",\n        INITING: \"INITING\",\n        INITED: \"INITED\"\n      }, e.state = e.states.UNINIT, e.batteryManager = null, e._init = function (t, n) {\n        e.state = e.states.INITING, navigator.getBattery ? navigator.getBattery().then(function (n) {\n          e.batteryManager = n, t && setTimeout(function () {\n            t();\n          }, 0);\n        }).catch(function (e) {\n          o.default.debug(\"navigator.getBattery is disabled\", e), t && t();\n        }) : (e.state = e.states.INITED, t && t());\n      }, e._getBatteryStats = function () {\n        var t = {};\n        return e.batteryManager && e.batteryManager.level ? t.BatteryLevel = Math.floor(100 * e.batteryManager.level) : t.BatteryLevel = \"UNSUPPORTED\", t;\n      }, e.getStats = function (t, n) {\n        var i = new m(),\n            a = e._getBatteryStats();\n\n        a && a.BatteryLevel && i.set(\"BatteryLevel\", a.BatteryLevel), t && t(i);\n      }, e._init(), e;\n    }(),\n        S = a(6),\n        h = a.n(S),\n        _ = function (e) {\n      var t = c(e);\n      return t.url = \".\", t;\n    },\n        E = a(13),\n        I = a(4),\n        T = 0,\n        y = function (e) {\n      var t = _({});\n\n      t.id = e.id, t.playerId = T++, t.destroyed = !1, t.fit = e.options && e.options.fit, \"contain\" !== t.fit && \"cover\" !== t.fit && (t.fit = null), t.url = e.url, t.stream = e.stream.stream, t.isFreeze = !1, t.freezeCount = 0, t.lastFreezeCount = 0, t.lastTimeupdateTime = 0, t.elementID = e.elementID, t.setAudioOutput = function (e, n, i) {\n        var a = t.video || t.audio;\n        return a ? a.setSinkId ? void a.setSinkId(e).then(function () {\n          return o.default.debug(\"[\" + t.id + \"] \" + \"video \".concat(t.id, \" setAudioOutput \").concat(e, \" SUCCESS\")), a == t.video && t.audio ? t.audio.setSinkId(e) : Promise.resolve();\n        }).then(function () {\n          return o.default.debug(\"[\" + t.id + \"] \" + \"audio \".concat(t.id, \" setAudioOutput \").concat(e, \" SUCCESS\")), n && n();\n        }).catch(function (e) {\n          return o.default.error(\"[\" + t.id + \"] VideoPlayer.setAudioOutput\", e), i && i(e);\n        }) : (o.default.error(\"[\" + t.id + \"] \", I.default.WEB_API_NOT_SUPPORTED), i && i(I.default.WEB_API_NOT_SUPPORTED)) : (o.default.error(\"[\" + t.id + \"] \", I.default.PLAYER_NOT_FOUND), i && i(I.default.PLAYER_NOT_FOUND));\n      }, t.destroy = function () {\n        o.default.debug(\"[\".concat(t.id, \"] destroy \").concat(e.stream.local ? \"local\" : \"remote\", \" Player \").concat(t.id)), Object(E.setSrcObject)(t.video, null), Object(E.setSrcObject)(t.audio, null), t.video.pause(), t.freezeCheckInterval && clearInterval(t.freezeCheckInterval), t.destroyed = !0, delete t.resizer, document.getElementById(t.div.id) && t.parentNode.contains(t.div) && t.parentNode.removeChild(t.div), [\"video\", \"audio\"].forEach(function (n) {\n          t[n];\n          var i = a[n];\n          clearTimeout(i.playDeferTimeout), i.formerMediaState = null;\n          var r = {\n            playerId: t.playerId,\n            stateId: i.stateId + 1,\n            playDeferTimeout: null,\n            error: !1,\n            status: \"aborted\",\n            reason: \"stop\",\n            updatedAt: Date.now()\n          };\n          a[n] = r;\n          var c = {\n            type: \"player-status-change\",\n            playerId: t.playerId,\n            mediaType: n,\n            status: r.status,\n            reason: r.reason,\n            isErrorState: !1,\n            streamId: t.id\n          };\n          o.default.debug(\"[\".concat(t.id, \"] Media Player Status Change Triggered by destroy()\"), c), e.stream.dispatchEvent(c), s.b.reportApiInvoke(e.stream.sid, {\n            name: \"Stream.playerStatusChange\",\n            options: c,\n            tag: \"tracer\"\n          })();\n        });\n      }, t.div = document.createElement(\"div\"), t.div.setAttribute(\"id\", \"player_\" + t.id), e.stream.video ? t.div.setAttribute(\"style\", \"width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;\") : t.div.setAttribute(\"style\", \"width: 100%; height: 100%; position: relative; overflow: hidden;\"), t.video = document.createElement(\"video\"), t.video.setAttribute(\"id\", \"video\" + t.id), e.stream.local && !e.stream.screen ? e.stream.mirror ? t.video.setAttribute(\"style\", \"width: 100%; height: 100%; position: absolute; transform: rotateY(180deg); object-fit: \".concat(t.fit || \"cover\", \";\")) : t.video.setAttribute(\"style\", \"width: 100%; height: 100%; position: absolute; object-fit: \".concat(t.fit || \"cover\", \";\")) : e.stream.video ? t.video.setAttribute(\"style\", \"width: 100%; height: 100%; position: absolute; object-fit: \".concat(t.fit || \"cover\", \";\")) : e.stream.screen ? t.video.setAttribute(\"style\", \"width: 100%; height: 100%; position: absolute; object-fit: \".concat(t.fit || \"contain\")) : t.video.setAttribute(\"style\", \"width: 100%; height: 100%; position: absolute; display: none; object-fit: \".concat(t.fit || \"cover\"));\n      var n = {\n        autoplay: !0,\n        muted: !!e.stream.local || !(!g.isSafari() && \"iOS\" !== g.getBrowserOS()) && \"video_element_muted\",\n        playsinline: !0,\n        controls: !1,\n        volume: null\n      },\n          i = h()({}, n, e.options);\n      !0 !== i.muted || i.volume || (i.volume = 0), t.video.setAttribute(\"autoplay\", \"\"), t.video.setAttribute(\"muted\", \"\"), t.video.muted = !0, t.video.autoplay = !0, i.playsinline && t.video.setAttribute(\"playsinline\", \"\"), i.controls && t.video.setAttribute(\"controls\", \"\"), i.contains && (t.video.controls = !0), Number.isFinite(i.volume) && (t.video.volume = i.volume), t.audio = document.createElement(\"audio\"), t.audio.setAttribute(\"id\", \"audio\" + t.id), !0 === i.muted && t.audio.setAttribute(\"muted\", \"\"), !0 === i.muted && (t.audio.muted = !0), i.playsinline && t.audio.setAttribute(\"playsinline\", \"\"), Number.isFinite(i.volume) && (t.audio.volume = i.volume), void 0 !== t.elementID ? (document.getElementById(t.elementID).appendChild(t.div), t.container = document.getElementById(t.elementID)) : (document.body.appendChild(t.div), t.container = document.body), t.parentNode = t.div.parentNode;\n      var a = {\n        video: {\n          playerId: t.playerId,\n          stateId: 0,\n          playDeferTimeout: null,\n          error: !1,\n          status: \"init\",\n          reason: null,\n          updatedAt: Date.now()\n        },\n        audio: {\n          playerId: t.playerId,\n          stateId: 0,\n          playDeferTimeout: null,\n          error: !1,\n          status: \"init\",\n          reason: null,\n          updatedAt: Date.now()\n        }\n      };\n\n      t.mediaElemExists = function (e) {\n        for (var t = e, n = 0; n < Object(r.getParameter)(\"MEDIA_ELEMENT_EXISTS_DEPTH\") && t; n++) t = t.parentNode;\n\n        return !!t;\n      };\n\n      var c = function (e) {\n        return t.mediaElemExists(e) ? e.paused ? \"paused\" : \"play\" : \"aborted\";\n      },\n          d = function (e, t, n) {\n        var i = c(e),\n            a = !0;\n        return \"paused\" === i ? (\"audio\" === t && !0 === n.muted && (a = !1), n.autoplay || (a = !1)) : \"play\" === i ? \"video\" === t ? a = !1 : !0 === n.muted ? e.muted && (a = !1) : e.muted || (a = !1) : \"aborted\" === i && (a = !1), a;\n      },\n          u = function (n) {\n        var u,\n            l = this;\n\n        if (l === t.video ? u = \"video\" : l === t.audio && (u = \"audio\"), u) {\n          n.type || o.default.error(\"[\".concat(t.id, \"] Unexpected evt\"), n);\n          var f = c(l);\n          clearTimeout(a[u].playDeferTimeout), a[u].playDeferTimeout = setTimeout(function () {\n            a[u].playDeferTimeout = null;\n            var r = a[u],\n                p = c(l);\n\n            if (f === p) {\n              var g = {\n                playerId: t.playerId,\n                stateId: r.stateId + 1,\n                playDeferTimeout: null,\n                error: d(l, u, i),\n                status: c(l),\n                reason: n.type,\n                updatedAt: Date.now()\n              };\n\n              if (r.status !== g.status) {\n                a[u] = g;\n                var m = {\n                  type: \"player-status-change\",\n                  playerId: t.playerId,\n                  mediaType: u,\n                  status: g.status,\n                  reason: g.reason,\n                  isErrorState: g.error,\n                  streamId: t.id\n                };\n                o.default.debug(\"[\".concat(t.id, \"] Media Player Status Change\"), m), e.stream.dispatchEvent(m), s.b.reportApiInvoke(e.stream.sid, {\n                  name: \"Stream.playerStatusChange\",\n                  options: m,\n                  tag: \"tracer\"\n                })();\n              }\n            } else o.default.debug(\"[\".concat(t.id, \"] Status Change after event Triggered.\") + \"Stream \".concat(t.id, \" PlayerId \").concat(t.playerId, \" mediaType \").concat(u, \" Status \").concat(f, \"=>\").concat(p));\n          }, Object(r.getParameter)(\"PLAYER_STATE_DEFER\"));\n        } else o.default.error(\"[\".concat(t.id, \"] Unknown media element\"), l);\n      };\n\n      t.video.addEventListener(\"playing\", function (e) {\n        !function e() {\n          t.video.videoWidth * t.video.videoHeight > 4 ? o.default.debug(\"[\" + t.id + \"] video dimensions:\", t.video.videoWidth, t.video.videoHeight) : setTimeout(e, 50);\n        }();\n      });\n      t.freezeCheckInterval = setInterval(function () {\n        Date.now() - t.lastTimeupdateTime > 500 ? (t.isFreeze = !0, t.freezeCount += 1) : t.isFreeze = !1;\n      }, 500), t.video.addEventListener(\"playing\", u), t.video.addEventListener(\"canplay\", u), t.video.addEventListener(\"abort\", u), t.video.addEventListener(\"onerror\", u), t.video.addEventListener(\"suspend\", u), t.video.addEventListener(\"stalled\", u), t.video.addEventListener(\"pause\", u), t.video.addEventListener(\"timeupdate\", function () {\n        t.lastTimeupdateTime = Date.now();\n      }), t.audio.addEventListener(\"playing\", u), t.audio.addEventListener(\"canplay\", u), t.audio.addEventListener(\"abort\", u), t.audio.addEventListener(\"onerror\", u), t.audio.addEventListener(\"suspend\", u), t.audio.addEventListener(\"stalled\", u), t.audio.addEventListener(\"pause\", u);\n      var l = t.audio,\n          f = \"audio\";\n      if (e.stream.hasVideo() || e.stream.hasScreen()) t.div.appendChild(t.video), t.div.appendChild(t.audio), g.isEdge() ? t.video.srcObject = e.stream.stream : (Object(E.attachMediaStream)(t.video, e.stream.stream), Object(E.attachMediaStream)(t.audio, e.stream.stream));else {\n        !1 !== i.muted && \"video_element_muted\" !== i.muted || (t.video.removeAttribute(\"muted\"), t.video.muted = !1), t.video.removeAttribute(\"autoplay\"), t.video.autoplay = !1, t.div.appendChild(t.video), l = t.video, f = \"video\";\n        var p = a.audio,\n            m = {\n          playerId: t.playerId,\n          stateId: p.stateId + 1,\n          playDeferTimeout: null,\n          error: !1,\n          status: \"aborted\",\n          reason: \"audioonly\",\n          updatedAt: Date.now()\n        };\n        a.audio = m;\n        var v = {\n          type: \"player-status-change\",\n          playerId: t.playerId,\n          mediaType: \"audio\",\n          status: m.status,\n          reason: m.reason,\n          isErrorState: m.error,\n          streamId: t.id\n        };\n\n        if (o.default.debug(\"[\".concat(t.id, \"] Media Player Status Change\"), v), Promise.resolve().then(function () {\n          return e.stream.dispatchEvent(v);\n        }), s.b.reportApiInvoke(e.stream.sid, {\n          name: \"Stream.playerStatusChange\",\n          options: v,\n          tag: \"tracer\"\n        })(), window.MediaStream && (g.isSafari() || \"iOS\" === g.getBrowserOS())) {\n          var S = new MediaStream(e.stream.stream.getAudioTracks());\n          Object(E.setSrcObject)(t.video, S);\n        } else Object(E.setSrcObject)(t.video, e.stream.stream);\n      }\n\n      if (i.autoplay && l) {\n        var y = l.play();\n        y && y.catch && y.catch(function (n) {\n          if (!t.destroyed && l) {\n            var r = a[f],\n                u = {\n              playerId: t.playerId,\n              stateId: r.stateId + 1,\n              playDeferTimeout: null,\n              error: d(l, f, i),\n              status: c(l),\n              reason: \"error\",\n              updatedAt: Date.now()\n            };\n\n            if (r.status !== u.status) {\n              o.default.debug(\"[\".concat(t.id, \"] Player \").concat(t.playerId, \" Status Changed Detected by promise error: \").concat(r.status, \"=>\").concat(u.status), n), a[f] = u;\n              var p = {\n                type: \"player-status-change\",\n                playerId: t.playerId,\n                mediaType: f,\n                status: u.status,\n                reason: u.reason,\n                isErrorState: u.error,\n                streamId: t.id\n              };\n              o.default.debug(\"[\".concat(t.id, \"] Media Player Status Change\"), p), e.stream.dispatchEvent(p), s.b.reportApiInvoke(e.stream.sid, {\n                name: \"Stream.playerStatusChange\",\n                options: p,\n                tag: \"tracer\"\n              })();\n            }\n          }\n        });\n      }\n\n      return t.setAudioVolume = function (e) {\n        var n = parseInt(e) / 100;\n        isFinite(n) && (n < 0 ? n = 0 : n > 1 && (n = 1), t.video && (t.video.volume = n), t.audio && (t.audio.volume = n));\n      }, t;\n    },\n        b = function (e) {\n      var t = {},\n          n = E.RTCPeerConnection;\n      t.uid = e.uid, t.isVideoMute = e.isVideoMute, t.isAudioMute = e.isAudioMute, t.isSubscriber = e.isSubscriber, t.clientId = e.clientId, t.filterStatsCache = [], t.originStatsCache = [], t.lastTimeGetStats = null, t.pc_config = {\n        iceServers: [{\n          url: \"stun:webcs.agora.io:3478\"\n        }]\n      };\n      var i = {\n        id: \"outbound_audio_ssrc_send\",\n        type: \"ssrc\",\n        mediaType: \"\",\n        googCodecName: \"opus\",\n        aecDivergentFilterFraction: \"0\",\n        audioInputLevel: \"0\",\n        bytesSent: \"0\",\n        packetsSent: \"0\",\n        googEchoCancellationReturnLoss: \"0\",\n        googEchoCancellationReturnLossEnhancement: \"0\"\n      },\n          a = {\n        id: \"outbound_video_ssrc_send\",\n        type: \"ssrc\",\n        mediaType: \"\",\n        googCodecName: \"h264\" === e.codec ? \"H264\" : \"VP8\",\n        bytesSent: \"0\",\n        packetsLost: \"0\",\n        packetsSent: \"0\",\n        googAdaptationChanges: \"0\",\n        googAvgEncodeMs: \"0\",\n        googEncodeUsagePercent: \"0\",\n        googFirsReceived: \"0\",\n        googFrameHeightSent: \"0\",\n        googFrameHeightInput: \"0\",\n        googFrameRateInput: \"0\",\n        googFrameRateSent: \"0\",\n        googFrameWidthSent: \"0\",\n        googFrameWidthInput: \"0\",\n        googNacksReceived: \"0\",\n        googPlisReceived: \"0\",\n        googRtt: \"0\"\n      },\n          s = {\n        id: \"inbound_audio_ssrc_recv\",\n        type: \"ssrc\",\n        mediaType: \"\",\n        googCodecName: \"opus\",\n        audioOutputLevel: \"0\",\n        bytesReceived: \"0\",\n        packetsLost: \"0\",\n        packetsReceived: \"0\",\n        googAccelerateRate: \"0\",\n        googCurrentDelayMs: \"0\",\n        googDecodingCNG: \"0\",\n        googDecodingCTN: \"0\",\n        googDecodingCTSG: \"0\",\n        googDecodingNormal: \"0\",\n        googDecodingPLC: \"0\",\n        googDecodingPLCCNG: \"0\",\n        googExpandRate: \"0\",\n        googJitterBufferMs: \"0\",\n        googJitterReceived: \"0\",\n        googPreemptiveExpandRate: \"0\",\n        googPreferredJitterBufferMs: \"0\",\n        googSecondaryDecodedRate: \"0\",\n        googSpeechExpandRate: \"0\"\n      },\n          c = {\n        id: \"inbound_video_ssrc_recv\",\n        type: \"ssrc\",\n        mediaType: \"\",\n        googTargetDelayMs: \"0\",\n        packetsLost: \"0\",\n        googDecodeMs: \"0\",\n        googMaxDecodeMs: \"0\",\n        googRenderDelayMs: \"0\",\n        googFrameWidthReceived: \"0\",\n        googFrameHeightReceived: \"0\",\n        googFrameRateReceived: \"0\",\n        googFrameRateDecoded: \"0\",\n        googFrameRateOutput: \"0\",\n        googJitterBufferMs: \"0\",\n        googCurrentDelayMs: \"0\",\n        googMinPlayoutDelayMs: \"0\",\n        googNacksSent: \"0\",\n        googPlisSent: \"0\",\n        googFirsSent: \"0\",\n        bytesReceived: \"0\",\n        packetsReceived: \"0\",\n        googFramesReceived: \"0\",\n        googFramesDecoded: \"0\"\n      },\n          d = {\n        id: \"bweforvideo\",\n        type: \"VideoBwe\",\n        googAvailableSendBandwidth: \"0\",\n        googAvailableReceiveBandwidth: \"0\",\n        googActualEncBitrate: \"0\",\n        googRetransmitBitrate: \"0\",\n        googTargetEncBitrate: \"0\",\n        googBucketDelay: \"0\",\n        googTransmitBitrate: \"0\"\n      };\n      t.con = {\n        optional: [{\n          DtlsSrtpKeyAgreement: !0\n        }]\n      }, e.iceServers instanceof Array ? t.pc_config.iceServers = e.iceServers : (e.stunServerUrl && (e.stunServerUrl instanceof Array ? e.stunServerUrl.map(function (e) {\n        \"string\" == typeof e && \"\" !== e && t.pc_config.iceServers.push({\n          url: e\n        });\n      }) : \"string\" == typeof e.stunServerUrl && \"\" !== e.stunServerUrl && t.pc_config.iceServers.push({\n        url: e.stunServerUrl\n      })), e.turnServers && (e.turnServers instanceof Array ? e.turnServers.map(function (e) {\n        e.udpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.udpport + \"?transport=udp\"\n        }), \"string\" == typeof e.tcpport && \"\" !== e.tcpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.tcpport + \"?transport=tcp\"\n        }), !0 === e.forceturn && (t.pc_config.iceTransportPolicy = \"relay\");\n      }) : o.default.error(\"[\".concat(t.clientId, \"] turnServers is not a array\")))), void 0 === e.audio && (e.audio = !0), void 0 === e.video && (e.video = !0), t.mediaConstraints = {\n        mandatory: {\n          OfferToReceiveVideo: e.video,\n          OfferToReceiveAudio: e.audio\n        }\n      }, t.roapSessionId = 103;\n\n      try {\n        t.pc_config.sdpSemantics = \"plan-b\", t.peerConnection = new n(t.pc_config, t.con);\n      } catch (e) {\n        delete t.pc_config.sdpSemantics, t.peerConnection = new n(t.pc_config, t.con);\n      }\n\n      t.iceCandidateTimer = setTimeout(function () {\n        t.iceCandidateTimer = null, o.default.debug(\"[\".concat(t.clientId, \"]Candidates collected: \").concat(t.iceCandidateCount)), t.moreIceComing && (t.moreIceComing = !1, t.markActionNeeded());\n      }, Object(r.getParameter)(\"CANDIDATE_TIMEOUT\")), t.peerConnection.onicecandidate = function (e) {\n        var n, i, a, r;\n        i = (n = t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\\ssrflx.+\\r\\n/), a = n.match(/a=candidate:.+typ\\shost.+\\r\\n/), r = n.match(/a=candidate:.+typ\\srelay.+\\r\\n/), null === i && null === a && null === r || void 0 !== t.ice || !t.iceCandidateTimer || (o.default.debug(\"[\" + t.clientId + \"]srflx candidate : \" + i + \" relay candidate: \" + r + \" host candidate : \" + a), clearTimeout(t.iceCandidateTimer), t.iceCandidateTimer = null, t.ice = 0, t.moreIceComing = !1, t.markActionNeeded()), t.iceCandidateCount = t.iceCandidateCount + 1;\n      }, o.default.debug(\"[\" + t.clientId + ']Created webkitRTCPeerConnnection with config \"' + JSON.stringify(t.pc_config) + '\".');\n\n      var u = function (t) {\n        return e.screen && (t = t.replace(\"a=x-google-flag:conference\\r\\n\", \"\")), t;\n      },\n          l = function (n) {\n        var i, a;\n\n        if ((i = n.match(/m=video.*\\r\\n/)) && e.minVideoBW && e.maxVideoBW) {\n          a = i[0] + \"b=AS:\" + e.maxVideoBW + \"\\r\\n\";\n          var r = 0,\n              s = 0;\n          \"h264\" === e.codec ? (r = n.search(/a=rtpmap:(\\d+) H264\\/90000\\r\\n/), s = n.search(/H264\\/90000\\r\\n/)) : \"vp8\" === e.codec && (r = n.search(/a=rtpmap:(\\d+) VP8\\/90000\\r\\n/), s = n.search(/VP8\\/90000\\r\\n/)), -1 !== r && -1 !== s && s - r > 10 && (a = a + \"a=fmtp:\" + n.slice(r + 9, s - 1) + \" x-google-min-bitrate=\" + e.minVideoBW + \"\\r\\n\"), n = n.replace(i[0], a), o.default.debug(\"[\" + t.clientId + \"]Set Video Bitrate - min:\" + e.minVideoBW + \" max:\" + e.maxVideoBW);\n        }\n\n        return (i = n.match(/m=audio.*\\r\\n/)) && e.maxAudioBW && (a = i[0] + \"b=AS:\" + e.maxAudioBW + \"\\r\\n\", n = n.replace(i[0], a)), n;\n      };\n\n      t.processSignalingMessage = function (e) {\n        var n,\n            i = JSON.parse(e);\n        t.incomingMessage = i, \"new\" === t.state ? \"OFFER\" === i.messageType ? (n = {\n          sdp: i.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch(function (e) {}), t.state = \"offer-received\", t.markActionNeeded()) : t.error(\"Illegal message for this state: \" + i.messageType + \" in state \" + t.state) : \"offer-sent\" === t.state ? \"ANSWER\" === i.messageType ? ((n = {\n          sdp: i.sdp,\n          type: \"answer\"\n        }).sdp = u(n.sdp), n.sdp = l(n.sdp), t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch(function (e) {}), t.state = \"established\") : \"pr-answer\" === i.messageType ? (n = {\n          sdp: i.sdp,\n          type: \"pr-answer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch(function (e) {})) : \"offer\" === i.messageType ? t.error(\"Not written yet\") : t.error(\"Illegal message for this state: \" + i.messageType + \" in state \" + t.state) : \"established\" === t.state && (\"OFFER\" === i.messageType ? (n = {\n          sdp: i.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch(function (e) {}), t.state = \"offer-received\", t.markActionNeeded()) : \"ANSWER\" === i.messageType ? ((n = {\n          sdp: i.sdp,\n          type: \"answer\"\n        }).sdp = u(n.sdp), n.sdp = l(n.sdp), t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)).catch(function (e) {})) : t.error(\"Illegal message for this state: \" + i.messageType + \" in state \" + t.state));\n      };\n\n      var f = 0,\n          p = 0;\n      return t.getVideoRelatedStats = function (e) {\n        t.getStats(function (n) {\n          n.forEach(function (n) {\n            if (t.isSubscriber) {\n              if (\"video\" === n.mediaType && n.id && ~n.id.indexOf(\"recv\")) {\n                if (g.isChromeKernel() && +g.getBrowserVersion() >= 76) {\n                  var i = +n.googFramesReceived - f,\n                      a = +n.googFramesDecoded - p;\n                  t._setStat(c, \"googFrameRateReceived\", i), t._setStat(c, \"googFrameRateDecoded\", a), t._setStat(c, \"googFrameRateOutput\", a), f = +n.googFramesReceived, p = +n.googFramesDecoded;\n                }\n\n                e && e({\n                  mediaType: \"video\",\n                  peerId: t.uid,\n                  isVideoMute: t.isVideoMute,\n                  frameRateReceived: n.googFrameRateReceived,\n                  frameRateDecoded: n.googFrameRateDecoded,\n                  bytesReceived: n.bytesReceived,\n                  packetsReceived: n.packetsReceived,\n                  packetsLost: n.packetsLost\n                });\n              }\n            } else \"video\" === n.mediaType && n.id && ~n.id.indexOf(\"send\") && e && e({\n              mediaType: \"video\",\n              isVideoMute: t.isVideoMute,\n              frameRateInput: n.googFrameRateInput,\n              frameRateSent: n.googFrameRateSent,\n              googRtt: n.googRtt\n            });\n          });\n        });\n      }, t.getAudioRelatedStats = function (e) {\n        t.getStats(function (n) {\n          n.forEach(function (n) {\n            t.isSubscriber && \"audio\" === n.mediaType && n.id && ~n.id.indexOf(\"recv\") && e && e({\n              mediaType: \"audio\",\n              peerId: t.uid,\n              isAudioMute: t.isAudioMute,\n              frameDropped: parseInt(n.googDecodingPLC) + parseInt(n.googDecodingPLCCNG) + \"\",\n              frameReceived: n.googDecodingCTN,\n              googJitterReceived: n.googJitterReceived,\n              bytesReceived: n.bytesReceived,\n              packetsReceived: n.packetsReceived,\n              packetsLost: n.packetsLost\n            });\n          });\n        });\n      }, t.getStatsRate = function (e) {\n        t.getStats(function (t) {\n          e(t);\n        });\n      }, t.getStats = function (e, n) {\n        n = (n = n || 500) > 500 ? 500 : n, t.lastTimeGetStats && Date.now() - t.lastTimeGetStats < n ? e && e(t.filterStatsCache, t.originStatsCache) : (t.lastTimeGetStats = Date.now(), this._getStats(function (n, i) {\n          t.filterStatsCache = n, t.originStatsCache = i, e && e(n, i);\n        }));\n      }, t._setStat = function (e, t, n) {\n        e.hasOwnProperty(t) && (null != n && n !== 1 / 0 && n == n || (n = 0), e[t] = n + \"\");\n      }, t._processGetStatsAfterChrome76 = function (e) {\n        var n = this;\n        t.lastStats || (t.lastStats = new Map()), t.peerConnection.getStats().then(function (r) {\n          var o = [],\n              u = [],\n              l = new Map(),\n              f = new Date(),\n              p = !0,\n              g = !1,\n              m = void 0;\n\n          try {\n            for (var v, S = r.values()[Symbol.iterator](); !(p = (v = S.next()).done); p = !0) {\n              var _ = v.value;\n              \"codec\" != _.type ? \"candidate-pair\" != _.type ? (\"inbound-rtp\" === _.type && \"video\" === _.mediaType && l.set(\"inbound-video\", _), \"inbound-rtp\" === _.type && \"audio\" === _.mediaType && l.set(\"inbound-audio\", _), \"outbound-rtp\" === _.type && \"audio\" === _.mediaType && l.set(\"outbound-audio\", _), \"outbound-rtp\" === _.type && \"video\" === _.mediaType && l.set(\"outbound-video\", _), \"track\" === _.type && \"video\" === _.kind && _.remoteSource && l.set(\"remote-video-track\", _), \"track\" === _.type && \"audio\" === _.kind && _.remoteSource && l.set(\"remote-audio-track\", _), \"remote-inbound-rtp\" === _.type && \"video\" === _.mediaType && l.set(\"remote-inbound-video\", _), \"remote-inbound-rtp\" === _.type && \"audio\" === _.mediaType && l.set(\"remote-inbound-audio\", _), \"track\" !== _.type || \"video\" !== _.kind || _.remoteSource || l.set(\"local-video-track\", _), \"track\" !== _.type || \"audio\" !== _.kind || _.remoteSource || l.set(\"local-audio-track\", _), \"media-source\" === _.type && \"video\" === _.kind && l.set(\"media-source-video\", _), \"media-source\" === _.type && \"audio\" === _.kind && l.set(\"media-source-audio\", _)) : u.push(_) : o.push(_);\n            }\n          } catch (e) {\n            g = !0, m = e;\n          } finally {\n            try {\n              p || null == S.return || S.return();\n            } finally {\n              if (g) throw m;\n            }\n          }\n\n          l.set(\"codec\", o), l.set(\"candidatePairs\", u), l.set(\"timestamp\", +f);\n          var E = null,\n              I = null;\n          if (c.timestamp = f, s.timestamp = f, i.timestamp = f, i.timestamp = f, d.timestamp = f, n.isSubscriber) (E = l.get(\"inbound-video\")) && (t._setStat(c, \"id\", \"inbound_video_ssrc_recv\"), t._setStat(c, \"mediaType\", E.mediaType), t._setStat(c, \"packetsLost\", E.packetsLost), t._setStat(c, \"googDecodeMs\", null), t._setStat(c, \"googMaxDecodeMs\", null), t._setStat(c, \"googRenderDelayMs\", null), t._setStat(c, \"googMinPlayoutDelayMs\", null), t._setStat(c, \"googNacksSent\", E.nackCount), t._setStat(c, \"googPlisSent\", E.pliCount), t._setStat(c, \"googFirsSent\", E.firCount), t._setStat(c, \"bytesReceived\", E.bytesReceived), t._setStat(c, \"packetsReceived\", E.packetsReceived)), (E = l.get(\"inbound-audio\")) && (t._setStat(s, \"id\", \"inbound_audio_ssrc_recv\"), t._setStat(s, \"mediaType\", E.mediaType), t._setStat(s, \"bytesReceived\", E.bytesReceived), t._setStat(s, \"packetsLost\", E.packetsLost), t._setStat(s, \"packetsReceived\", E.packetsReceived), t._setStat(s, \"googAccelerateRate\", E.removedSamplesForAcceleration), t._setStat(s, \"googCurrentDelayMs\", E.jitterBufferDelay), t._setStat(s, \"googDecodingCNG\", null), t._setStat(s, \"googDecodingCTN\", null), t._setStat(s, \"googDecodingCTSG\", null), t._setStat(s, \"googDecodingNormal\", null), t._setStat(s, \"googDecodingPLC\", null), t._setStat(s, \"googDecodingPLCCNG\", null), t._setStat(s, \"googJitterReceived\", E.jitter), t._setStat(s, \"googPreferredJitterBufferMs\", null), t._setStat(s, \"googSecondaryDecodedRate\", null)), (E = l.get(\"remote-video-track\")) && (t._setStat(c, \"googTargetDelayMs\", E.jitterBufferDelay), t._setStat(c, \"googFrameWidthReceived\", E.frameWidth), t._setStat(c, \"googFrameHeightReceived\", E.frameHeight), t._setStat(c, \"googJitterBufferMs\", E.jitterBufferDelay / E.jitterBufferEmittedCount * 1e3), t._setStat(c, \"googCurrentDelayMs\", E.jitterBufferDelay), t._setStat(c, \"googFramesDecoded\", E.framesDecoded), t._setStat(c, \"googFramesReceived\", E.framesReceived)), (E = l.get(\"remote-audio-track\")) && (t._setStat(s, \"audioOutputLevel\", 32767 * E.audioLevel), t._setStat(s, \"googJitterBufferMs\", E.jitterBufferDelay / E.jitterBufferEmittedCount * 1e3), t._setStat(s, \"googExpandRate\", E.concealedSamples), t._setStat(s, \"googPreemptiveExpandRate\", E.insertedSamplesForDeceleration), t._setStat(s, \"googSpeechExpandRate\", E.silentConcealedSamples));else {\n            var T = t.lastStats.get(\"timestamp\"),\n                y = t.lastStats.get(\"outbound-video\");\n\n            if ((E = l.get(\"outbound-audio\")) && (t._setStat(i, \"id\", \"outbound_audio_ssrc_send\"), t._setStat(i, \"mediaType\", E.mediaType), t._setStat(i, \"aecDivergentFilterFraction\", null), t._setStat(i, \"bytesSent\", E.bytesSent), t._setStat(i, \"packetsSent\", E.packetsSent), I = E.transportId), E = l.get(\"outbound-video\")) {\n              if (t._setStat(a, \"id\", \"outbound_video_ssrc_send\"), t._setStat(a, \"mediaType\", E.mediaType), t._setStat(a, \"bytesSent\", E.bytesSent), t._setStat(a, \"packetsSent\", E.packetsSent), t._setStat(a, \"googAdaptationChanges\", E.qualityLimitationDurations), t._setStat(a, \"googAvgEncodeMs\", null), t._setStat(a, \"googEncodeUsagePercent\", null), I = E.transportId, E.totalEncodedBytesTarget && y && y.totalEncodedBytesTarget) {\n                var b = (E.totalEncodedBytesTarget - y.totalEncodedBytesTarget) / (+new Date() - T);\n\n                t._setStat(d, \"googTargetEncBitrate\", Math.floor(8 * b * 1e3));\n              }\n\n              if (E.retransmittedBytesSent && y && y.retransmittedBytesSent) {\n                var R = (E.retransmittedBytesSent - y.retransmittedBytesSent) / (+new Date() - T);\n\n                t._setStat(d, \"googRetransmitBitrate\", Math.floor(8 * R * 1e3));\n              }\n\n              if (E.bytesSent && y && y.bytesSent) {\n                var A = (E.bytesSent - y.bytesSent) / (+new Date() - T);\n                t._setStat(d, \"googTransmitBitrate\", Math.floor(8 * A * 1e3)), t._setStat(d, \"googActualEncBitrate\", Math.floor(8 * A * 1e3));\n              }\n\n              if (E.totalPacketSendDelay && y && y.totalPacketSendDelay) {\n                var C = (E.totalPacketSendDelay - y.totalPacketSendDelay) / (+new Date() - T);\n\n                t._setStat(d, \"googBucketDelay\", Math.floor(1e3 * C));\n              }\n            }\n\n            if ((E = l.get(\"remote-inbound-video\")) && (t._setStat(a, \"packetsLost\", E.packetsLost), t._setStat(a, \"googRtt\", E.roundTripTime)), (E = l.get(\"local-video-track\")) && (t._setStat(a, \"googFrameHeightSent\", E.frameHeight), t._setStat(a, \"googFrameWidthSent\", E.frameWidth), void 0 !== E.framesPerSecond && t._setStat(a, \"googFrameRateSent\", E.framesPerSecond)), (E = l.get(\"local-audio-track\")) && (t._setStat(i, \"googEchoCancellationReturnLoss\", E.echoReturnLoss), t._setStat(i, \"googEchoCancellationReturnLossEnhancement\", E.echoReturnLossEnhancement)), (E = l.get(\"media-source-video\")) && (t._setStat(a, \"googFrameHeightInput\", E.height), t._setStat(a, \"googFrameWidthInput\", E.width), t._setStat(a, \"googFrameRateInput\", E.framesPerSecond)), (E = l.get(\"media-source-audio\")) && t._setStat(i, \"audioInputLevel\", 32767 * E.totalAudioEnergy), (E = l.get(\"inbound-video\")) && (t._setStat(a, \"googFirsReceived\", E.firCount), t._setStat(a, \"googNacksReceived\", E.nackCount), t._setStat(a, \"googPlisReceived\", E.pliCount)), I) l.get(\"candidatePairs\").map(function (e) {\n              I == e.transportId && t._setStat(d, \"googAvailableSendBandwidth\", e.availableOutgoingBitrate);\n            });else {\n              var O = l.get(\"candidatePairs\")[0];\n              O && t._setStat(d, \"googAvailableSendBandwidth\", O.availableOutgoingBitrate);\n            }\n          }\n          t.lastStats = l;\n          var N = [h()({}, a), h()({}, i), h()({}, c), h()({}, s), h()({}, d)];\n          N.push({\n            id: \"time\",\n            startTime: t.connectedTime,\n            timestamp: new Date()\n          }), e(N);\n        });\n      }, t._processGetStatsBeforeChrome76 = function (e) {\n        t.peerConnection.getStats(function (n) {\n          var r = [],\n              o = [],\n              u = null;\n          Object.keys(n).forEach(function (e) {\n            var t = n[e];\n            t && (o.push(t), u = t.timestamp, \"VideoBwe\" === t.type ? d = t : t.id.indexOf(\"_send\") > -1 && \"video\" === t.mediaType ? a = t : t.id.indexOf(\"_send\") > -1 && \"audio\" === t.mediaType ? i = t : t.id.indexOf(\"_recv\") > -1 && \"video\" === t.mediaType ? c = t : t.id.indexOf(\"_recv\") > -1 && \"audio\" === t.mediaType && (s = t));\n          }), (r = [h()({}, a), h()({}, i), h()({}, c), h()({}, s), h()({}, d)]).push({\n            id: \"time\",\n            startTime: t.connectedTime,\n            timestamp: u || new Date()\n          }), e(r, o);\n        });\n      }, t._getStats = function (e) {\n        Object(r.getParameter)(\"CHROME_NEW_STATS\") && g.isChromeKernel() && +g.getBrowserVersion() >= 76 ? t._processGetStatsAfterChrome76(e) : t._processGetStatsBeforeChrome76(e);\n      }, t.addTrack = function (e, n) {\n        t.peerConnection.addTrack(e, n);\n      }, t.removeTrack = function (e, n) {\n        t.peerConnection.removeTrack(t.peerConnection.getSenders().find(function (t) {\n          return t.track == e;\n        }));\n      }, t.addStream = function (e) {\n        t.peerConnection.addStream(e), t.markActionNeeded();\n      }, t.removeStream = function () {\n        t.markActionNeeded();\n      }, t.close = function () {\n        t.state = \"closed\", t.peerConnection.close();\n      }, t.markActionNeeded = function () {\n        t.actionNeeded = !0, t.doLater(function () {\n          t.onstablestate();\n        });\n      }, t.doLater = function (e) {\n        window.setTimeout(e, 1);\n      }, t.onstablestate = function () {\n        var e;\n\n        if (t.actionNeeded) {\n          if (\"new\" === t.state || \"established\" === t.state) t.peerConnection.createOffer(function (e) {\n            if (e.sdp !== t.prevOffer) return t.peerConnection.setLocalDescription(e), t.state = \"preparing-offer\", void t.markActionNeeded();\n            o.default.debug(\"[\" + t.clientId + \"]Not sending a new offer\");\n          }, function (e) {\n            o.default.debug(\"[\" + t.clientId + \"]peer connection create offer failed \", e);\n          }, t.mediaConstraints);else if (\"preparing-offer\" === t.state) {\n            if (t.moreIceComing) return;\n            t.prevOffer = t.peerConnection.localDescription.sdp, t.offerCandidates = t.prevOffer.match(/a=candidate.+\\r\\n/g) || [], t.offerCandidates.length || (o.default.warning(\"[\".concat(t.clientId, \"]No Ice Candidate generated\")), Object(r.getParameter)(\"SHIM_CANDIDATE\") ? (o.default.debug(\"Shimming fake candidate\"), t.prevOffer += \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\") : o.default.error(\"[\".concat(t.clientId, \"]None Ice Candidate not allowed\"))), t.prevOffer = t.prevOffer.replace(/a=candidate:.+typ\\shost.+\\r\\n/g, \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\"), t.sendMessage(\"OFFER\", t.prevOffer), t.state = \"offer-sent\";\n          } else if (\"offer-received\" === t.state) t.peerConnection.createAnswer(function (e) {\n            if (t.peerConnection.setLocalDescription(e), t.state = \"offer-received-preparing-answer\", t.iceStarted) t.markActionNeeded();else {\n              var n = new Date();\n              o.default.debug(\"[\" + t.clientId + \"]\" + n.getTime() + \": Starting ICE in responder\"), t.iceStarted = !0;\n            }\n          }, function (e) {\n            o.default.debug(\"[\" + t.clientId + \"]peer connection create answer failed \", e);\n          }, t.mediaConstraints);else if (\"offer-received-preparing-answer\" === t.state) {\n            if (t.moreIceComing) return;\n            e = t.peerConnection.localDescription.sdp, t.sendMessage(\"ANSWER\", e), t.state = \"established\";\n          } else o.default.debug(\"[\".concat(t.clientId, \"] Dazed and confused in state ' + that.state + ', stopping here'\"));\n          t.actionNeeded = !1;\n        }\n      }, t.sendMessage = function (e, n) {\n        var i = {};\n        i.messageType = e, i.sdp = n, \"OFFER\" === e ? (i.offererSessionId = t.sessionId, i.answererSessionId = t.otherSessionId, i.seq = t.sequenceNumber += 1, i.tiebreaker = Math.floor(429496723 * Math.random() + 1)) : (i.offererSessionId = t.incomingMessage.offererSessionId, i.answererSessionId = t.sessionId, i.seq = t.incomingMessage.seq), t.onsignalingmessage(JSON.stringify(i));\n      }, t._getSender = function (e) {\n        if (t.peerConnection && t.peerConnection.getSenders) {\n          var n = t.peerConnection.getSenders().find(function (t) {\n            return t.track.kind == e;\n          });\n          if (n) return n;\n        }\n\n        return null;\n      }, t.hasSender = function (e) {\n        return !!t._getSender(e);\n      }, t.replaceTrack = function (e, n, i) {\n        var a = t._getSender(e.kind);\n\n        if (!a) return i(\"NO_SENDER_FOUND\");\n\n        try {\n          a.replaceTrack(e);\n        } catch (e) {\n          return i && i(e);\n        }\n\n        setTimeout(function () {\n          return n && n();\n        }, 50);\n      }, t.error = function (e) {\n        throw \"Error in RoapOnJsep: \" + e;\n      }, t.sessionId = t.roapSessionId += 1, t.sequenceNumber = 0, t.actionNeeded = !1, t.iceStarted = !1, t.moreIceComing = !0, t.iceCandidateCount = 0, t.onsignalingmessage = e.callback, t.peerConnection.ontrack = function (e) {\n        t.onaddstream && (t.onaddstream(e, \"ontrack\"), t.peerConnection.onaddstream = null);\n      }, t.peerConnection.onaddstream = function (e) {\n        t.onaddstream && (t.onaddstream(e, \"onaddstream\"), t.peerConnection.ontrack = null);\n      }, t.peerConnection.onremovestream = function (e) {\n        t.onremovestream && t.onremovestream(e);\n      }, t.peerConnection.oniceconnectionstatechange = function (e) {\n        \"connected\" === e.currentTarget.iceConnectionState && (t.connectedTime = new Date()), t.oniceconnectionstatechange && t.oniceconnectionstatechange(e.currentTarget.iceConnectionState);\n      }, t.renegotiate = function () {\n        void 0 !== t.prevOffer && t.peerConnection.createOffer().then(function (e) {\n          return e.sdp = e.sdp.replace(/a=recvonly\\r\\n/g, \"a=inactive\\r\\n\"), e.sdp = u(e.sdp), e.sdp = l(e.sdp), t.peerConnection.setLocalDescription(e);\n        }).then(function () {\n          t.onnegotiationneeded && t.onnegotiationneeded(t.peerConnection.localDescription.sdp);\n        }).catch(function (e) {\n          console.log(\"createOffer error: \", e);\n        });\n      }, t.peerConnection.onnegotiationneeded = t.renegotiate, t.onaddstream = null, t.onremovestream = null, t.onnegotiationneeded = null, t.state = \"new\", t.markActionNeeded(), t;\n    },\n        R = function (e) {\n      var t = {},\n          n = E.RTCPeerConnection;\n      t.uid = e.uid, t.isVideoMute = e.isVideoMute, t.isAudioMute = e.isAudioMute, t.isSubscriber = e.isSubscriber, t.clientId = e.clientId, t.filterStatsCache = [], t.originStatsCache = [], t.lastTimeGetStats = null, t.pc_config = {\n        iceServers: [{\n          urls: [\"stun:webcs.agora.io:3478\", \"stun:stun.l.google.com:19302\"]\n        }],\n        bundlePolicy: \"max-bundle\"\n      }, t.con = {\n        optional: [{\n          DtlsSrtpKeyAgreement: !0\n        }]\n      }, e.iceServers instanceof Array ? t.pc_config.iceServers = e.iceServers : (e.stunServerUrl && (e.stunServerUrl instanceof Array ? e.stunServerUrl.map(function (e) {\n        \"string\" == typeof e && \"\" !== e && t.pc_config.iceServers.push({\n          url: e\n        });\n      }) : \"string\" == typeof e.stunServerUrl && \"\" !== e.stunServerUrl && t.pc_config.iceServers.push({\n        url: e.stunServerUrl\n      })), e.turnServers && (e.turnServers instanceof Array ? e.turnServers.map(function (e) {\n        e.udpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.udpport + \"?transport=udp\"\n        }), \"string\" == typeof e.tcpport && \"\" !== e.tcpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.tcpport + \"?transport=tcp\"\n        }), !0 === e.forceturn && (t.pc_config.iceTransportPolicy = \"relay\");\n      }) : o.default.error(\"[\".concat(t.clientId, \"] turnServers is not a array\")))), void 0 === e.audio && (e.audio = !0), void 0 === e.video && (e.video = !0), t.mediaConstraints = {\n        mandatory: {\n          OfferToReceiveVideo: e.video,\n          OfferToReceiveAudio: e.audio\n        }\n      }, t.roapSessionId = 103;\n\n      try {\n        t.pc_config.sdpSemantics = \"plan-b\", t.peerConnection = new n(t.pc_config, t.con);\n      } catch (e) {\n        delete t.pc_config.sdpSemantics, t.peerConnection = new n(t.pc_config, t.con);\n      }\n\n      o.default.debug(\"[\" + t.clientId + ']safari Created RTCPeerConnnection with config \"' + JSON.stringify(t.pc_config) + '\".'), t.iceCandidateTimer = setTimeout(function () {\n        t.iceCandidateTimer = null, o.default.debug(\"[\".concat(t.clientId, \"]Candidates collected: \").concat(t.iceCandidateCount)), t.moreIceComing && (t.moreIceComing = !1, t.markActionNeeded());\n      }, Object(r.getParameter)(\"CANDIDATE_TIMEOUT\")), t.peerConnection.onicecandidate = function (e) {\n        var n, i, a, r;\n        i = (n = t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\\ssrflx.+\\r\\n/), a = n.match(/a=candidate:.+typ\\shost.+\\r\\n/), r = n.match(/a=candidate:.+typ\\srelay.+\\r\\n/), 0 === t.iceCandidateCount && (t.timeout = setTimeout(function () {\n          t.moreIceComing && (t.moreIceComing = !1, t.markActionNeeded());\n        }, 1e3)), null === i && null === a && null === r || void 0 !== t.ice || !t.iceCandidateTimer || (o.default.debug(\"[\" + t.clientId + \"]srflx candidate : \" + i + \" relay candidate: \" + r + \" host candidate : \" + a), clearTimeout(t.iceCandidateTimer), t.iceCandidateTimer = null, t.ice = 0, t.moreIceComing = !1, t.markActionNeeded()), t.iceCandidateCount = t.iceCandidateCount + 1;\n      };\n\n      var i = function (t) {\n        return e.screen && (t = t.replace(\"a=x-google-flag:conference\\r\\n\", \"\")), t;\n      },\n          a = function (n) {\n        var i, a;\n        return (i = n.match(/m=video.*\\r\\n/)) && e.minVideoBW && e.maxVideoBW && (a = i[0] + \"b=AS:\" + e.maxVideoBW + \"\\r\\n\", n = n.replace(i[0], a), o.default.debug(\"[\" + t.clientId + \"]Set Video Bitrate - min:\" + e.minVideoBW + \" max:\" + e.maxVideoBW)), (i = n.match(/m=audio.*\\r\\n/)) && e.maxAudioBW && (a = i[0] + \"b=AS:\" + e.maxAudioBW + \"\\r\\n\", n = n.replace(i[0], a)), n;\n      };\n\n      t.processSignalingMessage = function (e) {\n        var n,\n            r = JSON.parse(e);\n        t.incomingMessage = r, \"new\" === t.state ? \"OFFER\" === r.messageType ? (n = {\n          sdp: r.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)), t.state = \"offer-received\", t.markActionNeeded()) : t.error(\"Illegal message for this state: \" + r.messageType + \" in state \" + t.state) : \"offer-sent\" === t.state ? \"ANSWER\" === r.messageType ? ((n = {\n          sdp: r.sdp,\n          type: \"answer\"\n        }).sdp = i(n.sdp), n.sdp = a(n.sdp), n.sdp = n.sdp.replace(/a=x-google-flag:conference\\r\\n/g, \"\"), t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)), t.state = \"established\") : \"pr-answer\" === r.messageType ? (n = {\n          sdp: r.sdp,\n          type: \"pr-answer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n))) : \"offer\" === r.messageType ? t.error(\"Not written yet\") : t.error(\"Illegal message for this state: \" + r.messageType + \" in state \" + t.state) : \"established\" === t.state && (\"OFFER\" === r.messageType ? (n = {\n          sdp: r.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new RTCSessionDescription(n)), t.state = \"offer-received\", t.markActionNeeded()) : \"ANSWER\" === r.messageType ? ((n = {\n          sdp: r.sdp,\n          type: \"answer\"\n        }).sdp = i(n.sdp), n.sdp = a(n.sdp), t.peerConnection.setRemoteDescription(new RTCSessionDescription(n))) : t.error(\"Illegal message for this state: \" + r.messageType + \" in state \" + t.state));\n      };\n\n      var s = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        googCodecName: \"opus\",\n        aecDivergentFilterFraction: \"0\",\n        audioInputLevel: \"0\",\n        bytesSent: \"0\",\n        packetsSent: \"0\",\n        googEchoCancellationReturnLoss: \"0\",\n        googEchoCancellationReturnLossEnhancement: \"0\"\n      },\n          c = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        googCodecName: \"h264\" === e.codec ? \"H264\" : \"VP8\",\n        bytesSent: \"0\",\n        packetsLost: \"0\",\n        packetsSent: \"0\",\n        googAdaptationChanges: \"0\",\n        googAvgEncodeMs: \"0\",\n        googEncodeUsagePercent: \"0\",\n        googFirsReceived: \"0\",\n        googFrameHeightSent: \"0\",\n        googFrameHeightInput: \"0\",\n        googFrameRateInput: \"0\",\n        googFrameRateSent: \"0\",\n        googFrameWidthSent: \"0\",\n        googFrameWidthInput: \"0\",\n        googNacksReceived: \"0\",\n        googPlisReceived: \"0\",\n        googRtt: \"0\",\n        googFramesEncoded: \"0\"\n      },\n          d = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        audioOutputLevel: \"0\",\n        bytesReceived: \"0\",\n        packetsLost: \"0\",\n        packetsReceived: \"0\",\n        googAccelerateRate: \"0\",\n        googCurrentDelayMs: \"0\",\n        googDecodingCNG: \"0\",\n        googDecodingCTN: \"0\",\n        googDecodingCTSG: \"0\",\n        googDecodingNormal: \"0\",\n        googDecodingPLC: \"0\",\n        googDecodingPLCCNG: \"0\",\n        googExpandRate: \"0\",\n        googJitterBufferMs: \"0\",\n        googJitterReceived: \"0\",\n        googPreemptiveExpandRate: \"0\",\n        googPreferredJitterBufferMs: \"0\",\n        googSecondaryDecodedRate: \"0\",\n        googSpeechExpandRate: \"0\"\n      },\n          u = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        googTargetDelayMs: \"0\",\n        packetsLost: \"0\",\n        googDecodeMs: \"0\",\n        googMaxDecodeMs: \"0\",\n        googRenderDelayMs: \"0\",\n        googFrameWidthReceived: \"0\",\n        googFrameHeightReceived: \"0\",\n        googFrameRateReceived: \"0\",\n        googFrameRateDecoded: \"0\",\n        googFrameRateOutput: \"0\",\n        googFramesDecoded: \"0\",\n        googFrameReceived: \"0\",\n        googJitterBufferMs: \"0\",\n        googCurrentDelayMs: \"0\",\n        googMinPlayoutDelayMs: \"0\",\n        googNacksSent: \"0\",\n        googPlisSent: \"0\",\n        googFirsSent: \"0\",\n        bytesReceived: \"0\",\n        packetsReceived: \"0\"\n      },\n          l = {\n        id: \"bweforvideo\",\n        type: \"VideoBwe\",\n        googAvailableSendBandwidth: \"0\",\n        googAvailableReceiveBandwidth: \"0\",\n        googActualEncBitrate: \"0\",\n        googRetransmitBitrate: \"0\",\n        googTargetEncBitrate: \"0\",\n        googBucketDelay: \"0\",\n        googTransmitBitrate: \"0\"\n      },\n          f = 0,\n          p = 0,\n          g = 0;\n      return t.isRemoteVideoStats = function (e) {\n        return !!(e.frameHeight && e.frameWidth && e.remoteSource);\n      }, t.getVideoRelatedStats = function (n) {\n        t.peerConnection.getStats().then(function (i) {\n          var a = {\n            peerId: t.uid,\n            mediaType: \"video\",\n            isVideoMute: t.isVideoMute\n          };\n          i.forEach(function (i) {\n            if (t.isSubscriber) {\n              if (\"track\" === i.type && (~i.id.indexOf(\"video\") || ~i.trackIdentifier.indexOf(\"v\") || t.isRemoteVideoStats(i))) {\n                if (!t.lastReport) return void (t.lastReport = i);\n                a.frameRateReceived = i.framesReceived - t.lastReport.framesReceived + \"\", a.frameRateDecoded = i.framesDecoded - t.lastReport.framesDecoded + \"\", t.lastReport = i;\n              }\n\n              \"inbound-rtp\" === i.type && ~i.id.indexOf(\"Video\") && (a.bytesReceived = i.bytesReceived + \"\", a.packetsReceived = i.packetsReceived + \"\", a.packetsLost = i.packetsLost + \"\");\n            } else if (\"outbound-rtp\" === i.type && ~i.id.indexOf(\"Video\")) {\n              if (!t.lastReport) return void (t.lastReport = i);\n              n && n({\n                mediaType: \"video\",\n                isVideoMute: t.isVideoMute,\n                frameRateInput: e.maxFrameRate + \"\",\n                frameRateSent: i.framesEncoded - t.lastReport.framesEncoded + \"\"\n              }), t.lastReport = i;\n            }\n          }), n && n(a);\n        });\n      }, t.getAudioRelatedStats = function (e) {\n        t.peerConnection.getStats().then(function (n) {\n          n.forEach(function (n) {\n            t.isSubscriber && \"inbound-rtp\" === n.type && ~n.id.indexOf(\"Audio\") && e && e({\n              peerId: t.uid,\n              mediaType: \"audio\",\n              isAudioMute: t.isAudioMute,\n              frameDropped: n.packetsLost + \"\",\n              frameReceived: n.packetsReceived + \"\",\n              googJitterReceived: n.jitter + \"\",\n              bytesReceived: n.bytesReceived + \"\",\n              packetsReceived: n.packetsReceived + \"\",\n              packetsLost: n.packetsLost + \"\"\n            });\n          });\n        });\n      }, t.getStatsRate = function (e) {\n        t.getStats(function (t) {\n          t.forEach(function (e) {\n            \"outbound-rtp\" === e.type && \"video\" === e.mediaType && e.googFramesEncoded && (e.googFrameRateSent = ((e.googFramesEncoded - f) / 3).toString(), f = e.googFramesEncoded), \"inbound-rtp\" === e.type && -1 != e.id.indexOf(\"55543\") && (e.googFrameRateReceived && (e.googFrameRateReceived = ((e.googFrameReceived - g) / 3).toString(), g = e.googFrameReceived), e.googFrameRateDecoded && (e.googFrameRateDecoded = ((e.googFramesDecoded - p) / 3).toString(), p = e.googFramesDecoded));\n          }), e(t);\n        });\n      }, t.getStats = function (e, n) {\n        n = (n = n || 500) > 500 ? 500 : n, t.lastTimeGetStats && Date.now() - t.lastTimeGetStats < n ? e && e(t.filterStatsCache, t.originStatsCache) : this._getStats(function (n, i) {\n          t.filterStatsCache = n, t.originStatsCache = i, t.lastTimeGetStats = Date.now(), e && e(n, i);\n        });\n      }, t._getStats = function (e) {\n        var n = [];\n        t.peerConnection.getStats().then(function (i) {\n          i.forEach(function (e) {\n            n.push(e), \"outbound-rtp\" === e.type && \"audio\" === e.mediaType && (s.id = e.id, s.type = e.type, s.mediaType = e.mediaType, s.bytesSent = e.bytesSent ? e.bytesSent + \"\" : \"0\", s.packetsSent = e.packetsSent ? e.packetsSent + \"\" : \"0\"), \"outbound-rtp\" === e.type && \"video\" === e.mediaType && (c.id = e.id, c.type = e.type, c.mediaType = e.mediaType, c.bytesSent = e.bytesSent ? e.bytesSent + \"\" : \"0\", c.packetsSent = e.packetsSent ? e.packetsSent + \"\" : \"0\", c.googPlisReceived = e.pliCount ? e.pliCount + \"\" : \"0\", c.googNacksReceived = e.nackCount ? e.nackCount + \"\" : \"0\", c.googFirsReceived = e.firCount ? e.firCount + \"\" : \"0\", c.googFramesEncoded = e.framesEncoded ? e.framesEncoded + \"\" : \"0\"), \"inbound-rtp\" === e.type && -1 != e.id.indexOf(\"44444\") && (d.id = e.id, d.type = e.type, d.mediaType = \"audio\", d.packetsReceived = e.packetsReceived ? e.packetsReceived + \"\" : \"0\", d.bytesReceived = e.bytesReceived ? e.bytesReceived + \"\" : \"0\", d.packetsLost = e.packetsLost ? e.packetsLost + \"\" : \"0\", d.packetsReceived = e.packetsReceived ? e.packetsReceived + \"\" : \"0\", d.googJitterReceived = e.jitter ? e.jitter + \"\" : \"0\"), \"inbound-rtp\" === e.type && -1 != e.id.indexOf(\"55543\") && (u.id = e.id, u.type = e.type, u.mediaType = \"video\", u.packetsReceived = e.packetsReceived ? e.packetsReceived + \"\" : \"0\", u.bytesReceived = e.bytesReceived ? e.bytesReceived + \"\" : \"0\", u.packetsLost = e.packetsLost ? e.packetsLost + \"\" : \"0\", u.googJitterBufferMs = e.jitter ? e.jitter + \"\" : \"0\", u.googNacksSent = e.nackCount ? e.nackCount + \"\" : \"0\", u.googPlisSent = e.pliCount ? e.pliCount + \"\" : \"0\", u.googFirsSent = e.firCount ? e.firCount + \"\" : \"0\"), \"track\" !== e.type || -1 == e.id.indexOf(\"55543\") && !~e.trackIdentifier.indexOf(\"v\") && null != e.audioLevel || (u.googFrameWidthReceived = e.frameWidth ? e.frameWidth + \"\" : \"0\", u.googFrameHeightReceived = e.frameHeight ? e.frameHeight + \"\" : \"0\", u.googFrameReceived = e.framesReceived ? e.framesReceived + \"\" : \"0\", u.googFramesDecoded = e.framesDecoded ? e.framesDecoded + \"\" : \"0\"), \"track\" !== e.type || -1 == e.id.indexOf(\"44444\") && !~e.trackIdentifier.indexOf(\"a\") && void 0 === e.audioLevel || (d.audioOutputLevel = e.audioLevel + \"\", s.audioInputLevel = e.audioLevel + \"\"), \"candidate-pair\" === e.type && (0 == e.availableIncomingBitrate ? l.googAvailableSendBandwidth = e.availableOutgoingBitrate + \"\" : l.googAvailableReceiveBandwidth = e.availableIncomingBitrate + \"\");\n          });\n          var a = [l, s, c, d, u];\n          a.push({\n            id: \"time\",\n            startTime: t.connectedTime,\n            timestamp: new Date()\n          }), e(a, n);\n        }).catch(function (e) {\n          o.default.error(\"[\" + t.clientId + \"] \", e);\n        });\n      }, t.addTrack = function (e, n) {\n        t.peerConnection.addTrack(e, n);\n      }, t.removeTrack = function (e, n) {\n        var i = t.peerConnection.getSenders().find(function (t) {\n          return t.track == e;\n        });\n        i.replaceTrack(null), t.peerConnection.removeTrack(i);\n      }, t.addStream = function (e) {\n        window.navigator.userAgent.indexOf(\"Safari\") > -1 && -1 === navigator.userAgent.indexOf(\"Chrome\") ? e.getTracks().forEach(function (n) {\n          return t.peerConnection.addTrack(n, e);\n        }) : t.peerConnection.addStream(e), t.markActionNeeded();\n      }, t.removeStream = function () {\n        t.markActionNeeded();\n      }, t.close = function () {\n        t.state = \"closed\", t.peerConnection.close();\n      }, t.markActionNeeded = function () {\n        t.actionNeeded = !0, t.doLater(function () {\n          t.onstablestate();\n        });\n      }, t.doLater = function (e) {\n        window.setTimeout(e, 1);\n      }, t.onstablestate = function () {\n        var n;\n\n        if (t.actionNeeded) {\n          if (\"new\" === t.state || \"established\" === t.state) e.isSubscriber && (t.peerConnection.addTransceiver(\"audio\", {\n            direction: \"recvonly\"\n          }), t.peerConnection.addTransceiver(\"video\", {\n            direction: \"recvonly\"\n          })), t.peerConnection.createOffer(t.mediaConstraints).then(function (n) {\n            if (n.sdp = a(n.sdp), e.isSubscriber || (n.sdp = n.sdp.replace(/a=.*video-orientation\\r\\n/g, \"\")), n.sdp !== t.prevOffer) return t.peerConnection.setLocalDescription(n), t.state = \"preparing-offer\", void t.markActionNeeded();\n            o.default.debug(\"[\" + t.clientId + \"]Not sending a new offer\");\n          }).catch(function (e) {\n            o.default.debug(\"[\" + t.clientId + \"]peer connection create offer failed \", e);\n          });else if (\"preparing-offer\" === t.state) {\n            if (t.moreIceComing) return;\n            t.prevOffer = t.peerConnection.localDescription.sdp, t.offerCandidates = t.prevOffer.match(/a=candidate.+\\r\\n/g) || [], t.offerCandidates.length || (o.default.warning(\"[\".concat(t.clientId, \"]No Ice Candidate generated\")), Object(r.getParameter)(\"SHIM_CANDIDATE\") ? (o.default.debug(\"Shimming fake candidate\"), t.prevOffer += \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\") : o.default.error(\"[\".concat(t.clientId, \"]None Ice Candidate not allowed\"))), t.prevOffer = t.prevOffer.replace(/a=candidate:.+typ\\shost.+\\r\\n/g, \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\"), t.sendMessage(\"OFFER\", t.prevOffer), t.state = \"offer-sent\";\n          } else if (\"offer-received\" === t.state) t.peerConnection.createAnswer(function (e) {\n            if (t.peerConnection.setLocalDescription(e), t.state = \"offer-received-preparing-answer\", t.iceStarted) t.markActionNeeded();else {\n              var n = new Date();\n              o.default.debug(\"[\" + t.clientId + \"]\" + n.getTime() + \": Starting ICE in responder\"), t.iceStarted = !0;\n            }\n          }, function (e) {\n            o.default.debug(\"[\" + t.clientId + \"]peer connection create answer failed \", e);\n          }, t.mediaConstraints);else if (\"offer-received-preparing-answer\" === t.state) {\n            if (t.moreIceComing) return;\n            n = t.peerConnection.localDescription.sdp, t.sendMessage(\"ANSWER\", n), t.state = \"established\";\n          } else t.debug(\"Dazed and confused in state \" + t.state + \", stopping here\");\n          t.actionNeeded = !1;\n        }\n      }, t.sendMessage = function (e, n) {\n        var i = {};\n        i.messageType = e, i.sdp = n, \"OFFER\" === e ? (i.offererSessionId = t.sessionId, i.answererSessionId = t.otherSessionId, i.seq = t.sequenceNumber += 1, i.tiebreaker = Math.floor(429496723 * Math.random() + 1)) : (i.offererSessionId = t.incomingMessage.offererSessionId, i.answererSessionId = t.sessionId, i.seq = t.incomingMessage.seq), t.onsignalingmessage(JSON.stringify(i));\n      }, t._getSender = function (e) {\n        if (t.peerConnection && t.peerConnection.getSenders) {\n          var n = t.peerConnection.getSenders().find(function (t) {\n            return t.track.kind == e;\n          });\n          if (n) return n;\n        }\n\n        return null;\n      }, t.hasSender = function (e) {\n        return !!t._getSender(e);\n      }, t.replaceTrack = function (e, n, i) {\n        var a = t._getSender(e.kind);\n\n        if (!a) return i(\"NO_SENDER_FOUND\");\n\n        try {\n          a.replaceTrack(e);\n        } catch (e) {\n          return i && i(e);\n        }\n\n        setTimeout(function () {\n          return n && n();\n        }, 50);\n      }, t.error = function (e) {\n        throw \"Error in RoapOnJsep: \" + e;\n      }, t.sessionId = t.roapSessionId += 1, t.sequenceNumber = 0, t.actionNeeded = !1, t.iceStarted = !1, t.moreIceComing = !0, t.iceCandidateCount = 0, t.onsignalingmessage = e.callback, t.peerConnection.ontrack = function (e) {\n        console.log(\"!!! ontrack, \", e.track.kind, e.track), t.onaddstream && t.onaddstream(e, \"ontrack\");\n      }, t.peerConnection.onremovestream = function (e) {\n        t.onremovestream && t.onremovestream(e);\n      }, t.peerConnection.oniceconnectionstatechange = function (e) {\n        \"connected\" === e.currentTarget.iceConnectionState && (t.connectedTime = new Date()), t.oniceconnectionstatechange && t.oniceconnectionstatechange(e.currentTarget.iceConnectionState);\n      }, t.renegotiate = function () {\n        void 0 !== t.prevOffer && t.peerConnection.createOffer().then(function (e) {\n          return e.sdp = e.sdp.replace(/a=recvonly\\r\\n/g, \"a=inactive\\r\\n\"), e.sdp = i(e.sdp), e.sdp = a(e.sdp), t.peerConnection.setLocalDescription(e);\n        }).then(function () {\n          t.onnegotiationneeded && t.onnegotiationneeded(t.peerConnection.localDescription.sdp);\n        }).catch(function (e) {\n          console.log(\"createOffer error: \", e);\n        });\n      }, t.peerConnection.onnegotiationneeded = t.renegotiate, t.onaddstream = null, t.onremovestream = null, t.state = \"new\", t.markActionNeeded(), t;\n    },\n        A = function (e) {\n      var t = {},\n          n = (mozRTCPeerConnection, mozRTCSessionDescription),\n          i = !1;\n      t.uid = e.uid, t.isVideoMute = e.isVideoMute, t.isAudioMute = e.isAudioMute, t.isSubscriber = e.isSubscriber, t.clientId = e.clientId, t.filterStatsCache = [], t.originStatsCache = [], t.lastTimeGetStats = null, t.pc_config = {\n        iceServers: []\n      }, e.iceServers instanceof Array ? e.iceServers.map(function (e) {\n        0 === e.url.indexOf(\"stun:\") && t.pc_config.iceServers.push({\n          url: e.url\n        });\n      }) : (e.stunServerUrl && (e.stunServerUrl instanceof Array ? e.stunServerUrl.map(function (e) {\n        \"string\" == typeof e && \"\" !== e && t.pc_config.iceServers.push({\n          url: e\n        });\n      }) : \"string\" == typeof e.stunServerUrl && \"\" !== e.stunServerUrl && t.pc_config.iceServers.push({\n        url: e.stunServerUrl\n      })), e.turnServers && (e.turnServers instanceof Array ? e.turnServers.map(function (e) {\n        e.udpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.udpport + \"?transport=udp\"\n        }), \"string\" == typeof e.tcpport && \"\" !== e.tcpport && t.pc_config.iceServers.push({\n          username: e.username,\n          credential: e.credential,\n          credentialType: \"password\",\n          urls: \"turn:\" + e.url + \":\" + e.tcpport + \"?transport=tcp\"\n        }), !0 === e.forceturn && (t.pc_config.iceTransportPolicy = \"relay\");\n      }) : o.default.error(\"[\".concat(t.clientId, \"] turnServers is not a array\")))), void 0 === e.audio && (e.audio = !0), void 0 === e.video && (e.video = !0), t.mediaConstraints = {\n        offerToReceiveAudio: e.audio,\n        offerToReceiveVideo: e.video,\n        mozDontOfferDataChannel: !0\n      }, t.roapSessionId = 103, t.peerConnection = new E.RTCPeerConnection(t.pc_config), o.default.debug(\"[\" + t.clientId + ']safari Created RTCPeerConnnection with config \"' + JSON.stringify(t.pc_config) + '\".'), t.iceCandidateTimer = setTimeout(function () {\n        t.iceCandidateTimer = null, o.default.debug(\"[\".concat(t.clientId, \"]Candidates collected: \").concat(t.iceCandidateCount)), t.moreIceComing && (t.moreIceComing = !1, t.markActionNeeded());\n      }, Object(r.getParameter)(\"CANDIDATE_TIMEOUT\")), t.peerConnection.onicecandidate = function (e) {\n        var n, i, a, r;\n        i = (n = t.peerConnection.localDescription.sdp).match(/a=candidate:.+typ\\ssrflx.+\\r\\n/), a = n.match(/a=candidate:.+typ\\shost.+\\r\\n/), r = n.match(/a=candidate:.+typ\\srelay.+\\r\\n/), null === i && null === a && null === r || void 0 !== t.ice || !t.iceCandidateTimer || (o.default.debug(\"[\" + t.clientId + \"]srflx candidate : \" + i + \" relay candidate: \" + r + \" host candidate : \" + a), clearTimeout(t.iceCandidateTimer), t.iceCandidateTimer = null, t.ice = 0, t.moreIceComing = !1, t.markActionNeeded()), t.iceCandidateCount = t.iceCandidateCount + 1;\n      }, t.checkMLineReverseInSDP = function (e) {\n        return !(!~e.indexOf(\"m=audio\") || !~e.indexOf(\"m=video\")) && e.indexOf(\"m=audio\") > e.indexOf(\"m=video\");\n      }, t.reverseMLineInSDP = function (e) {\n        var t = e.split(\"m=audio\"),\n            n = t[1].split(\"m=video\"),\n            i = \"m=video\" + n[1],\n            a = \"m=audio\" + n[0];\n        return e = t[0] + i + a;\n      }, t.processSignalingMessage = function (e) {\n        var i,\n            a = JSON.parse(e);\n        t.incomingMessage = a, \"new\" === t.state ? \"OFFER\" === a.messageType ? (a.sdp = l(a.sdp), i = {\n          sdp: a.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new n(i), function () {\n          o.default.debug(\"[\" + t.clientId + \"]setRemoteDescription succeeded\");\n        }, function (e) {\n          o.default.info(\"[\" + t.clientId + \"]setRemoteDescription failed: \" + e.name);\n        }), t.state = \"offer-received\", t.markActionNeeded()) : t.error(\"Illegal message for this state: \" + a.messageType + \" in state \" + t.state) : \"offer-sent\" === t.state ? \"ANSWER\" === a.messageType ? (a.sdp = l(a.sdp), a.sdp = a.sdp.replace(/ generation 0/g, \"\"), a.sdp = a.sdp.replace(/ udp /g, \" UDP \"), -1 !== a.sdp.indexOf(\"a=group:BUNDLE\") ? (a.sdp = a.sdp.replace(/a=group:BUNDLE audio video/, \"a=group:BUNDLE sdparta_0 sdparta_1\"), a.sdp = a.sdp.replace(/a=mid:audio/, \"a=mid:sdparta_0\"), a.sdp = a.sdp.replace(/a=mid:video/, \"a=mid:sdparta_1\")) : (a.sdp = a.sdp.replace(/a=mid:audio/, \"a=mid:sdparta_0\"), a.sdp = a.sdp.replace(/a=mid:video/, \"a=mid:sdparta_0\")), i = {\n          sdp: a.sdp,\n          type: \"answer\"\n        }, t.peerConnection.setRemoteDescription(new n(i), function () {\n          o.default.debug(\"[\" + t.clientId + \"]setRemoteDescription succeeded\");\n        }, function (e) {\n          o.default.info(\"[\" + t.clientId + \"]setRemoteDescription failed: \" + e);\n        }), t.state = \"established\") : \"pr-answer\" === a.messageType ? (i = {\n          sdp: a.sdp,\n          type: \"pr-answer\"\n        }, t.peerConnection.setRemoteDescription(new n(i), function () {\n          o.default.debug(\"[\" + t.clientId + \"]setRemoteDescription succeeded\");\n        }, function (e) {\n          o.default.info(\"[\" + t.clientId + \"]setRemoteDescription failed: \" + e.name);\n        })) : \"offer\" === a.messageType ? t.error(\"Not written yet\") : t.error(\"Illegal message for this state: \" + a.messageType + \" in state \" + t.state) : \"established\" === t.state && (\"OFFER\" === a.messageType ? (i = {\n          sdp: a.sdp,\n          type: \"offer\"\n        }, t.peerConnection.setRemoteDescription(new n(i), function () {\n          o.default.debug(\"[\" + t.clientId + \"]setRemoteDescription succeeded\");\n        }, function (e) {\n          o.default.info(\"[\" + t.clientId + \"]setRemoteDescription failed: \" + e.name);\n        }), t.state = \"offer-received\", t.markActionNeeded()) : t.error(\"Illegal message for this state: \" + a.messageType + \" in state \" + t.state));\n      };\n      var a = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"opus\",\n        googCodecName: \"opus\",\n        aecDivergentFilterFraction: \"0\",\n        audioInputLevel: \"0\",\n        bytesSent: \"0\",\n        packetsSent: \"0\",\n        googEchoCancellationReturnLoss: \"0\",\n        googEchoCancellationReturnLossEnhancement: \"0\"\n      },\n          s = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        googCodecName: \"h264\" === e.codec ? \"H264\" : \"VP8\",\n        bytesSent: \"0\",\n        packetsLost: \"0\",\n        packetsSent: \"0\",\n        googAdaptationChanges: \"0\",\n        googAvgEncodeMs: \"0\",\n        googEncodeUsagePercent: \"0\",\n        googFirsReceived: \"0\",\n        googFrameHeightSent: \"0\",\n        googFrameHeightInput: \"0\",\n        googFrameRateInput: \"0\",\n        googFrameRateSent: \"0\",\n        googFrameWidthSent: \"0\",\n        googFrameWidthInput: \"0\",\n        googNacksReceived: \"0\",\n        googPlisReceived: \"0\",\n        googRtt: \"0\"\n      },\n          c = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        audioOutputLevel: \"0\",\n        bytesReceived: \"0\",\n        packetsLost: \"0\",\n        packetsReceived: \"0\",\n        googAccelerateRate: \"0\",\n        googCurrentDelayMs: \"0\",\n        googDecodingCNG: \"0\",\n        googDecodingCTN: \"0\",\n        googDecodingCTSG: \"0\",\n        googDecodingNormal: \"0\",\n        googDecodingPLC: \"0\",\n        googDecodingPLCCNG: \"0\",\n        googExpandRate: \"0\",\n        googJitterBufferMs: \"0\",\n        googJitterReceived: \"0\",\n        googPreemptiveExpandRate: \"0\",\n        googPreferredJitterBufferMs: \"0\",\n        googSecondaryDecodedRate: \"0\",\n        googSpeechExpandRate: \"0\"\n      },\n          d = {\n        id: \"\",\n        type: \"\",\n        mediaType: \"\",\n        googTargetDelayMs: \"0\",\n        packetsLost: \"0\",\n        googDecodeMs: \"0\",\n        googMaxDecodeMs: \"0\",\n        googRenderDelayMs: \"0\",\n        googFrameWidthReceived: \"0\",\n        googFrameHeightReceived: \"0\",\n        googFrameRateReceived: \"0\",\n        googFrameRateDecoded: \"0\",\n        googFrameRateOutput: \"0\",\n        googJitterBufferMs: \"0\",\n        googCurrentDelayMs: \"0\",\n        googMinPlayoutDelayMs: \"0\",\n        googNacksSent: \"0\",\n        googPlisSent: \"0\",\n        googFirsSent: \"0\",\n        bytesReceived: \"0\",\n        packetsReceived: \"0\",\n        googFramesDecoded: \"0\"\n      },\n          u = 0;\n      t.getVideoRelatedStats = function (e) {\n        t.peerConnection.getStats().then(function (n) {\n          var i = !0,\n              a = !1,\n              r = void 0;\n\n          try {\n            for (var o, s = n.values()[Symbol.iterator](); !(i = (o = s.next()).done); i = !0) {\n              var c = o.value;\n\n              if (t.isSubscriber) {\n                if ((\"inbound-rtp\" === c.type || \"inboundrtp\" === c.type) && \"video\" === c.mediaType) {\n                  if (!t.lastReport) return void (t.lastReport = c);\n                  e && e({\n                    browser: \"firefox\",\n                    mediaType: \"video\",\n                    peerId: t.uid,\n                    isVideoMute: t.isVideoMute,\n                    frameRateReceived: c.framerateMean + \"\",\n                    frameRateDecoded: c.framesDecoded - t.lastReport.framesDecoded + \"\",\n                    bytesReceived: c.bytesReceived + \"\",\n                    packetsReceived: c.packetsReceived + \"\",\n                    packetsLost: c.packetsLost + \"\"\n                  }), t.lastReport = c;\n                }\n              } else if ((\"outbound-rtp\" === c.type || \"outboundrtp\" === c.type) && \"video\" === c.mediaType) {\n                if (!t.lastReport) return void (t.lastReport = c);\n                e && e({\n                  mediaType: \"video\",\n                  isVideoMute: t.isVideoMute,\n                  frameRateInput: c.framerateMean + \"\",\n                  frameRateSent: c.framesEncoded - t.lastReport.framesEncoded + \"\"\n                }), t.lastReport = c;\n              }\n            }\n          } catch (e) {\n            a = !0, r = e;\n          } finally {\n            try {\n              i || null == s.return || s.return();\n            } finally {\n              if (a) throw r;\n            }\n          }\n        });\n      }, t.getAudioRelatedStats = function (e) {\n        t.peerConnection.getStats().then(function (n) {\n          var i = !0,\n              a = !1,\n              r = void 0;\n\n          try {\n            for (var o, s = n.values()[Symbol.iterator](); !(i = (o = s.next()).done); i = !0) {\n              var c = o.value;\n              t.isSubscriber && (\"inbound-rtp\" !== c.type && \"inboundrtp\" !== c.type || \"audio\" !== c.mediaType || e && e({\n                browser: \"firefox\",\n                mediaType: \"audio\",\n                peerId: t.uid,\n                isAudioMute: t.isAudioMute,\n                frameDropped: c.packetsLost + \"\",\n                frameReceived: c.packetsReceived + \"\",\n                googJitterReceived: c.jitter + \"\",\n                bytesReceived: c.bytesReceived + \"\",\n                packetsReceived: c.packetsReceived + \"\",\n                packetsLost: c.packetsLost + \"\"\n              }));\n            }\n          } catch (e) {\n            a = !0, r = e;\n          } finally {\n            try {\n              i || null == s.return || s.return();\n            } finally {\n              if (a) throw r;\n            }\n          }\n        });\n      }, t.getStatsRate = function (e) {\n        t.getStats(function (t) {\n          t.forEach(function (e) {\n            \"inbound-rtp\" !== e.type && \"inboundrtp\" !== e.type || \"video\" !== e.mediaType || e.googFrameRateDecoded && (e.googFrameRateDecoded = ((e.googFramesDecoded - u) / 3).toString(), u = e.googFramesDecoded);\n          }), e(t);\n        });\n      }, t.getStats = function (e, n) {\n        n = (n = n || 500) > 500 ? 500 : n, t.lastTimeGetStats && Date.now() - t.lastTimeGetStats < n ? e && e(t.filterStatsCache, t.originStatsCache) : this._getStats(function (n, i) {\n          t.filterStatsCache = n, t.originStatsCache = i, t.lastTimeGetStats = Date.now(), e && e(n, i);\n        });\n      }, t._getStats = function (e) {\n        t.peerConnection.getStats().then(function (n) {\n          var i = [],\n              r = !0,\n              o = !1,\n              u = void 0;\n\n          try {\n            for (var l, f = n.values()[Symbol.iterator](); !(r = (l = f.next()).done); r = !0) {\n              var p = l.value;\n              i.push(p), \"outbound-rtp\" !== p.type && \"outboundrtp\" !== p.type || \"video\" !== p.mediaType || -1 !== p.id.indexOf(\"rtcp\") || (s.id = p.id, s.type = p.type, s.mediaType = p.mediaType, s.bytesSent = p.bytesSent ? p.bytesSent + \"\" : \"0\", s.packetsSent = p.packetsSent ? p.packetsSent + \"\" : \"0\", s.googPlisReceived = p.pliCount ? p.pliCount + \"\" : \"0\", s.googNacksReceived = p.nackCount ? p.nackCount + \"\" : \"0\", s.googFirsReceived = p.firCount ? p.firCount + \"\" : \"0\", s.googFrameRateSent = p.framerateMean ? p.framerateMean + \"\" : \"0\"), \"outbound-rtp\" !== p.type && \"outboundrtp\" !== p.type || \"audio\" !== p.mediaType || -1 !== p.id.indexOf(\"rtcp\") || (a.id = p.id, a.type = p.type, a.mediaType = p.mediaType, a.bytesSent = p.bytesSent ? p.bytesSent + \"\" : \"0\", a.packetsSent = p.packetsSent ? p.packetsSent + \"\" : \"0\"), \"inbound-rtp\" !== p.type && \"inboundrtp\" !== p.type || \"audio\" !== p.mediaType || p.isRemote || -1 !== p.id.indexOf(\"rtcp\") || (c.id = p.id, c.type = p.type, c.mediaType = p.mediaType, c.bytesReceived = p.bytesReceived ? p.bytesReceived + \"\" : \"0\", c.packetsLost = p.packetsLost ? p.packetsLost + \"\" : \"0\", c.packetsReceived = p.packetsReceived ? p.packetsReceived + \"\" : \"0\", c.googJitterReceived = p.jitter ? p.jitter + \"\" : \"0\"), \"inbound-rtp\" !== p.type && \"inboundrtp\" !== p.type || \"video\" !== p.mediaType || p.isRemote || -1 !== p.id.indexOf(\"rtcp\") || (d.id = p.id, d.type = p.type, d.mediaType = p.mediaType, d.bytesReceived = p.bytesReceived ? p.bytesReceived + \"\" : \"0\", d.googFrameRateReceived = p.framerateMean ? p.framerateMean + \"\" : \"0\", d.googFramesDecoded = p.framesDecoded ? p.framesDecoded + \"\" : \"0\", d.packetsLost = p.packetsLost ? p.packetsLost + \"\" : \"0\", d.packetsReceived = p.packetsReceived ? p.packetsReceived + \"\" : \"0\", d.googJitterBufferMs = p.jitter ? p.jitter + \"\" : \"0\", d.googNacksSent = p.nackCount ? p.nackCount + \"\" : \"0\", d.googPlisSent = p.pliCount ? p.pliCount + \"\" : \"0\", d.googFirsSent = p.firCount ? p.firCount + \"\" : \"0\"), -1 !== p.id.indexOf(\"outbound_rtcp_video\") && (s.packetsLost = p.packetsLost ? p.packetsLost + \"\" : \"0\");\n            }\n          } catch (e) {\n            o = !0, u = e;\n          } finally {\n            try {\n              r || null == f.return || f.return();\n            } finally {\n              if (o) throw u;\n            }\n          }\n\n          var g = [s, a, c, d];\n          g.push({\n            id: \"time\",\n            startTime: t.connectedTime,\n            timestamp: new Date()\n          }), e(g, i);\n        }, function (e) {\n          o.default.error(\"[\" + t.clientId + \"]\" + e);\n        });\n      }, t.addStream = function (e) {\n        i = !0, t.peerConnection.addStream(e), t.markActionNeeded();\n      }, t.removeStream = function () {\n        t.markActionNeeded();\n      }, t.close = function () {\n        t.state = \"closed\", t.peerConnection.close();\n      }, t.markActionNeeded = function () {\n        t.actionNeeded = !0, t.doLater(function () {\n          t.onstablestate();\n        });\n      }, t.doLater = function (e) {\n        window.setTimeout(e, 1);\n      }, t.onstablestate = function () {\n        if (t.actionNeeded) {\n          if (\"new\" === t.state || \"established\" === t.state) i && (t.mediaConstraints = void 0), t.peerConnection.createOffer(function (e) {\n            if (e.sdp = l(e.sdp), e.sdp = e.sdp.replace(/a=extmap:1 http:\\/\\/www.webrtc.org\\/experiments\\/rtp-hdrext\\/abs-send-time/, \"a=extmap:3 http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\"), e.sdp !== t.prevOffer) return t.peerConnection.setLocalDescription(e), t.state = \"preparing-offer\", void t.markActionNeeded();\n            o.default.debug(\"[\" + t.clientId + \"]Not sending a new offer\");\n          }, function (e) {\n            o.default.debug(\"[\" + t.clientId + \"]Ups! create offer failed \", e);\n          }, t.mediaConstraints);else if (\"preparing-offer\" === t.state) {\n            if (t.moreIceComing) return;\n            t.prevOffer = t.peerConnection.localDescription.sdp, t.offerCandidates = t.prevOffer.match(/a=candidate.+\\r\\n/g) || [], t.offerCandidates.length || (o.default.warning(\"[\".concat(t.clientId, \"]No Ice Candidate generated\")), Object(r.getParameter)(\"SHIM_CANDIDATE\") ? (o.default.debug(\"Shimming fake candidate\"), t.prevOffer += \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\") : o.default.error(\"[\".concat(t.clientId, \"]None Ice Candidate not allowed\"))), t.prevOffer = t.prevOffer.replace(/a=candidate:.+typ\\shost.+\\r\\n/g, \"a=candidate:2243255435 1 udp 2122194687 192.168.0.1 30000 typ host generation 0 network-id 1\\r\\n\"), t.sendMessage(\"OFFER\", t.prevOffer), t.state = \"offer-sent\";\n          } else if (\"offer-received\" === t.state) t.peerConnection.createAnswer(function (e) {\n            if (t.peerConnection.setLocalDescription(e), t.state = \"offer-received-preparing-answer\", t.iceStarted) t.markActionNeeded();else {\n              var n = new Date();\n              o.default.debug(\"[\" + t.clientId + \"]\" + n.getTime() + \": Starting ICE in responder\"), t.iceStarted = !0;\n            }\n          }, function () {\n            o.default.debug(\"[\" + t.clientId + \"]Ups! Something went wrong\");\n          });else if (\"offer-received-preparing-answer\" === t.state) {\n            if (t.moreIceComing) return;\n            var e = t.peerConnection.localDescription.sdp;\n            t.sendMessage(\"ANSWER\", e), t.state = \"established\";\n          } else t.debug(\"Dazed and confused in state \" + t.state + \", stopping here\");\n          t.actionNeeded = !1;\n        }\n      }, t.sendMessage = function (e, n) {\n        var i = {};\n        i.messageType = e, i.sdp = n, \"OFFER\" === e ? (i.offererSessionId = t.sessionId, i.answererSessionId = t.otherSessionId, i.seq = t.sequenceNumber += 1, i.tiebreaker = Math.floor(429496723 * Math.random() + 1)) : (i.offererSessionId = t.incomingMessage.offererSessionId, i.answererSessionId = t.sessionId, i.seq = t.incomingMessage.seq), t.onsignalingmessage(JSON.stringify(i));\n      }, t._getSender = function (e) {\n        if (t.peerConnection && t.peerConnection.getSenders) {\n          var n = t.peerConnection.getSenders().find(function (t) {\n            return t.track.kind == e;\n          });\n          if (n) return n;\n        }\n\n        return null;\n      }, t.hasSender = function (e) {\n        return !!t._getSender(e);\n      }, t.replaceTrack = function (e, n, i) {\n        var a = t._getSender(e.kind);\n\n        if (!a) return i(\"NO_SENDER_FOUND\");\n\n        try {\n          a.replaceTrack(e);\n        } catch (e) {\n          return i && i(e);\n        }\n\n        setTimeout(function () {\n          return n && n();\n        }, 50);\n      }, t.error = function (e) {\n        throw \"Error in RoapOnJsep: \" + e;\n      }, t.sessionId = t.roapSessionId += 1, t.sequenceNumber = 0, t.actionNeeded = !1, t.iceStarted = !1, t.moreIceComing = !0, t.iceCandidateCount = 0, t.onsignalingmessage = e.callback, t.peerConnection.ontrack = function (e) {\n        t.onaddstream && t.onaddstream(e, \"ontrack\");\n      }, t.peerConnection.onremovestream = function (e) {\n        t.onremovestream && t.onremovestream(e);\n      }, t.peerConnection.oniceconnectionstatechange = function (e) {\n        \"connected\" === e.currentTarget.iceConnectionState && (t.connectedTime = new Date()), t.oniceconnectionstatechange && t.oniceconnectionstatechange(e.currentTarget.iceConnectionState);\n      };\n\n      var l = function (t) {\n        var n;\n\n        if (e.video && e.maxVideoBW && (null == (n = t.match(/m=video.*\\r\\n/)) && (n = t.match(/m=video.*\\n/)), n && n.length > 0)) {\n          var i = n[0] + \"b=TIAS:\" + 1e3 * e.maxVideoBW + \"\\r\\n\";\n          t = t.replace(n[0], i);\n        }\n\n        return e.audio && e.maxAudioBW && (null == (n = t.match(/m=audio.*\\r\\n/)) && (n = t.match(/m=audio.*\\n/)), n && n.length > 0) && (i = n[0] + \"b=TIAS:\" + 1e3 * e.maxAudioBW + \"\\r\\n\", t = t.replace(n[0], i)), t;\n      };\n\n      return t.onaddstream = null, t.onremovestream = null, t.state = \"new\", t.markActionNeeded(), t;\n    },\n        C = a(18),\n        O = a.n(C),\n        N = null,\n        w = function () {\n      try {\n        N = window.require(\"electron\");\n      } catch (e) {}\n\n      return N;\n    },\n        k = function (e) {\n      var t = s.b.reportApiInvoke(null, {\n        callback: e,\n        name: \"getScreenSources\",\n        options: arguments,\n        tag: \"tracer\"\n      }),\n          n = w();\n      if (!n) return t && t(\"electron is null\");\n\n      try {\n        var i = n.desktopCapturer.getSources({\n          types: [\"window\", \"screen\"]\n        });\n      } catch (e) {\n        console.log(e);\n      }\n\n      if (i instanceof Promise) console.log(\"electron.desktopCapturer.getSources return type is Promise\"), i.then(function (e) {\n        return t && t(null, e);\n      }).catch(function (e) {\n        return t && t(e);\n      });else i = n.desktopCapturer.getSources({\n        types: [\"window\", \"screen\"]\n      }, function (e, n) {\n        console.log(\"electron.desktopCapturer.getSources return type is callback\"), t && t(null, n);\n      });\n    },\n        D = function (e, t, n) {\n      var i = t.width;\n      t = {\n        audio: !1,\n        video: {\n          mandatory: {\n            chromeMediaSource: \"desktop\",\n            chromeMediaSourceId: e,\n            maxHeight: t.height,\n            maxWidth: i,\n            maxFrameRate: t.frameRate && t.frameRate.max,\n            minFrameRate: t.frameRate && t.frameRate.min\n          }\n        }\n      };\n      navigator.webkitGetUserMedia(t, function (e) {\n        n && n(null, e);\n      }, function (e) {\n        n && n(e);\n      });\n    },\n        L = function () {\n      return !!w();\n    },\n        M = k,\n        P = D,\n        x = function (e, t) {\n      k(function (n, i) {\n        if (n) return t && t(n);\n        !function (e, t) {\n          var n = document.createElement(\"div\");\n          n.innerText = \"share screen\", n.setAttribute(\"style\", \"text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;\");\n          var i = document.createElement(\"div\");\n          i.setAttribute(\"style\", \"width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;\");\n          var a = document.createElement(\"div\");\n          a.innerText = \"Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.\", a.setAttribute(\"style\", \"height: 12%;\");\n          var r = document.createElement(\"div\");\n          r.setAttribute(\"style\", \"width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;\");\n          var o = document.createElement(\"div\");\n          o.setAttribute(\"style\", \"text-align: right; padding: 16px 0;\");\n          var s = document.createElement(\"button\");\n          s.innerHTML = \"cancel\", s.setAttribute(\"style\", \"width: 85px;\"), s.onclick = function () {\n            document.body.removeChild(c), t && t(\"NotAllowedError\");\n          }, o.appendChild(s), i.appendChild(a), i.appendChild(r), i.appendChild(o);\n          var c = document.createElement(\"div\");\n          c.setAttribute(\"style\", \"position: absolute; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);\"), c.appendChild(n), c.appendChild(i), document.body.appendChild(c), e.map(function (e) {\n            if (e.id) {\n              var n = document.createElement(\"div\");\n              n.setAttribute(\"style\", \"width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;\"), n.innerHTML = '<div style=\"height: 120px; display: table-cell; vertical-align: middle;\"><img style=\"width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);\" src=' + e.thumbnail.toDataURL() + ' /></div><span style=\"\\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\">' + e.name + \"</span>\", n.onclick = function () {\n                document.body.removeChild(c), t && t(null, e.id);\n              }, r.appendChild(n);\n            }\n          });\n        }(i, function (n, i) {\n          if (n) return t && t(n);\n          D(i, e, t);\n        });\n      });\n    },\n        U = 103,\n        V = function (e) {\n      var t = {};\n      if (t.clientId = e.clientId, e.session_id = U += 1, \"undefined\" == typeof window || !window.navigator) throw o.default.error(\"[\" + t.streamId + \"][\" + t.clientId + \"]Publish/subscribe video/audio streams not supported yet\"), new Error(\"NON_BROWSER_ENV_DETECTED\");\n      return null !== window.navigator.userAgent.match(\"Firefox\") ? (t.browser = \"mozilla\", t = A(e)) : \"iOS\" === g.getBrowserOS() || g.isSafari() ? (o.default.debug(\"[\" + t.streamId + \"][\" + t.clientId + \"]Safari\"), (t = R(e)).browser = \"safari\") : ~window.navigator.userAgent.indexOf(\"Edge\") ? t = new O.a(e) : (t = b(e)).browser = \"chrome-stable\", t;\n    },\n        j = function (e, t, n) {\n      var i = {};\n      i.config = e, i.streamId = e.streamId, delete e.streamId, navigator.getMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;\n\n      var a = 0,\n          r = 1,\n          s = !1,\n          c = null,\n          d = function (e) {\n        if (a++, c) {\n          if (c === e) o.default.debug(\"Using Video Source/ Audio Source\");else {\n            var n = c.getVideoTracks()[0],\n                i = c.getAudioTracks()[0],\n                d = e.getVideoTracks()[0],\n                u = e.getAudioTracks()[0];\n            d && (n && c.removeTrack(n), c.addTrack(d)), u && (i && c.removeTrack(i), c.addTrack(u));\n          }\n        } else c = e;\n        a !== r || s || (s = !0, setTimeout(function () {\n          t(c);\n        }, 0));\n      },\n          u = function (e) {\n        o.default.error(\"Failed to GetUserMedia\", e.name, e.code, e.message, e), a++, s || (s = !0, setTimeout(function () {\n          n && n(e);\n        }, 0));\n      },\n          l = function () {\n        var t = {\n          video: e.video,\n          audio: e.audio\n        };\n        if (o.default.debug(\"GetUserMedia\", JSON.stringify(t)), navigator.mediaDevices && navigator.mediaDevices.getUserMedia) navigator.mediaDevices.getUserMedia(t).then(d).catch(u);else if (\"undefined\" != typeof navigator && navigator.getMedia) navigator.getMedia(e, d, u);else {\n          var a = {\n            name: \"MEDIA_NOT_SUPPORT\",\n            message: \"Video/audio streams not supported yet\"\n          };\n          o.default.error(\"[\" + i.streamId + \"]\" + a.message), n && n(a);\n        }\n      };\n\n      if ((e.videoSource || e.audioSource) && (c = new MediaStream(), e.videoSource && c.addTrack(e.videoSource), e.audioSource && c.addTrack(e.audioSource)), e.video || e.audio || e.screen || e.screenAudio) {\n        if (!e.screen && e.screenAudio) return n && n({\n          code: \"Set screen to true before sharing the audio\"\n        });\n\n        if (e.screen) {\n          if (L()) return e.screen.sourceId ? P(e.screen.sourceId, e.screen, function (t, n) {\n            t ? u(t) : (e.audio && (r++, l()), d(n));\n          }) : x(e.screen, function (t, n) {\n            t ? u(t) : (e.audio && (r++, l()), d(n));\n          });\n\n          if (g.isFireFox()) {\n            o.default.debug(\"[\" + i.streamId + \"]Screen access requested\");\n            if (!~[\"screen\", \"window\", \"application\"].indexOf(e.screen.mediaSource)) return n && n({\n              code: \"Invalid mediaSource, mediaSource should be one of [screen, window, application]\"\n            });\n            navigator.getMedia({\n              video: e.screen\n            }, function (t) {\n              e.audio && (r++, l()), d(t);\n            }, u);\n          } else if (g.isChromeKernel() && e.screen.extensionId) {\n            if (window.navigator.appVersion.match(/Chrome\\/([\\w\\W]*?)\\./)[1] < 34) return void n({\n              code: \"This browser does not support screen sharing\"\n            });\n            o.default.debug(\"[\" + i.streamId + \"]Screen access on chrome stable, looking for extension\");\n\n            try {\n              chrome.runtime.sendMessage(e.screen.extensionId, {\n                getStream: !0\n              }, function (t) {\n                if (void 0 === t) {\n                  o.default.error(\"[\" + i.streamId + \"]No response from Chrome Plugin. Plugin not installed properly\");\n                  u({\n                    name: \"PluginNotInstalledProperly\",\n                    message: \"No response from Chrome Plugin. Plugin not installed properly.\"\n                  });\n                } else e.screen.mandatory.chromeMediaSourceId = t.streamId, navigator.getMedia({\n                  video: e.screen\n                }, function (t) {\n                  e.audio && (r++, l()), d(t);\n                }, u);\n              });\n            } catch (e) {\n              o.default.debug(\"[\" + i.streamId + \"]AgoraRTC screensharing plugin is not accessible\");\n              return void n({\n                code: \"no_plugin_present\"\n              });\n            }\n          } else {\n            if (window.navigator.mediaDevices.getDisplayMedia) {\n              var f = {};\n              return \"number\" == typeof e.screen.width && \"number\" == typeof e.screen.height ? f.video = {\n                width: {\n                  ideal: e.screen.width\n                },\n                height: {\n                  ideal: e.screen.height\n                }\n              } : f.video = {\n                width: e.screen.width,\n                height: e.screen.height\n              }, e.screen.frameRate && e.screen.frameRate.min ? f.video.frameRate = {\n                ideal: e.screen.frameRate.max,\n                max: e.screen.frameRate.max\n              } : f.video.frameRate = e.screen.frameRate, e.screenAudio && (f.audio = e.screenAudio), o.default.debug(\"use getDisplayMedia, constraints:\", f), window.navigator.mediaDevices.getDisplayMedia(f).then(function (t) {\n                !e.screenAudio && e.audio && (r++, l()), d(t);\n              }).catch(u);\n            }\n\n            o.default.error(\"[\" + i.streamId + \"]This browser does not support screenSharing\"), n({\n              code: \"This browser does not support screen sharing\"\n            });\n          }\n        } else l();\n      } else d(c);\n    },\n        F = a(10),\n        B = function (e, t, n) {\n      if ([\"End2EndDelay\", \"TransportDelay\", \"PacketLossRate\", \"RecvLevel\", \"RecvBitrate\", \"CodecType\", \"MuteState\", \"TotalFreezeTime\", \"TotalPlayDuration\", \"RecordingLevel\", \"SendLevel\", \"SamplingRate\", \"SendBitrate\", \"CodecType\", \"MuteState\", \"End2EndDelay\", \"TransportDelay\", \"PacketLossRate\", \"RecvBitrate\", \"RecvResolutionWidth\", \"RecvResolutionHeight\", \"RenderResolutionHeight\", \"RenderResolutionWidth\", \"RenderFrameRate\", \"TotalFreezeTime\", \"TotalPlayDuration\", \"TargetSendBitrate\", \"SendFrameRate\", \"SendFrameRate\", \"SendBitrate\", \"SendResolutionWidth\", \"SendResolutionHeight\", \"CaptureResolutionHeight\", \"CaptureResolutionWidth\", \"EncodeDelay\", \"MuteState\", \"TotalFreezeTime\", \"TotalDuration\", \"CaptureFrameRate\", \"RTT\", \"OutgoingAvailableBandwidth\", \"Duration\", \"UserCount\", \"SendBytes\", \"RecvBytes\", \"SendBitrate\", \"RecvBitrate\", \"accessDelay\", \"audioSendBytes\", \"audioSendPackets\", \"videoSendBytes\", \"videoSendPackets\", \"videoSendPacketsLost\", \"videoSendFrameRate\", \"audioSendPacketsLost\", \"videoSendResolutionWidth\", \"videoSendResolutionHeight\", \"accessDelay\", \"audioReceiveBytes\", \"audioReceivePackets\", \"audioReceivePacketsLost\", \"videoReceiveBytes\", \"videoReceivePackets\", \"videoReceivePacketsLost\", \"videoReceiveFrameRate\", \"videoReceiveDecodeFrameRate\", \"videoReceiveResolutionWidth\", \"videoReceiveResolutionHeight\", \"endToEndDelay\", \"videoReceiveDelay\", \"audioReceiveDelay\", \"FirstFrameTime\", \"VideoFreezeRate\", \"AudioFreezeRate\", \"RenderResolutionWidth\", \"RenderResolutionHeight\"].indexOf(t) > -1 && (\"string\" == typeof n || isFinite(n))) return e[t] = \"\" + n;\n    },\n        W = new function () {\n      var e = c();\n      return e.devicesHistory = {}, e.states = {\n        UNINIT: \"UNINIT\",\n        INITING: \"INITING\",\n        INITED: \"INITED\"\n      }, e.state = e.states.UNINIT, e.deviceStates = {\n        ACTIVE: \"ACTIVE\",\n        INACTIVE: \"INACTIVE\"\n      }, e.deviceReloadTimer = null, e._init = function (t, n) {\n        e.state = e.states.INITING, e.devicesHistory = {}, e._reloadDevicesInfo(function () {\n          e.state = e.states.INITED, e.dispatchEvent({\n            type: \"inited\"\n          }), t && t();\n        }, function (t) {\n          o.default.warning(\"Device Detection functionality cannot start properly.\"), e.state = e.states.UNINIT, n && n(t);\n        });\n      }, e._enumerateDevices = function (e, t) {\n        if (!navigator.mediaDevices || !navigator.mediaDevices.enumerateDevices) return o.default.warning(\"enumerateDevices() not supported.\"), t && t(\"enumerateDevices() not supported\");\n        navigator.mediaDevices.enumerateDevices().then(function (t) {\n          e && setTimeout(function () {\n            e(t);\n          }, 0);\n        }).catch(function (e) {\n          t && t(e);\n        });\n      }, e._reloadDevicesInfo = function (t, n) {\n        var i = [];\n\n        e._enumerateDevices(function (n) {\n          var a = Date.now();\n\n          for (var r in n.forEach(function (t) {\n            var n = e.devicesHistory[t.deviceId];\n\n            if ((n ? n.state : e.deviceStates.INACTIVE) != e.deviceStates.ACTIVE) {\n              var r = n || {\n                initAt: a\n              };\n              r.device = t, r.state = e.deviceStates.ACTIVE, i.push(r), e.devicesHistory[t.deviceId] = r;\n            }\n\n            e.devicesHistory[t.deviceId].lastReloadAt = a;\n          }), e.devicesHistory) {\n            var s = e.devicesHistory[r];\n            s && s.state == e.deviceStates.ACTIVE && s.lastReloadAt !== a && (s.state = e.deviceStates.INACTIVE, i.push(s)), s.lastReloadAt = a;\n          }\n\n          e.state == e.states.INITED && i.forEach(function (t) {\n            var n = h()({}, t);\n\n            switch (t.device.kind) {\n              case \"audioinput\":\n                n.type = \"recordingDeviceChanged\";\n                break;\n\n              case \"audiooutput\":\n                n.type = \"playoutDeviceChanged\";\n                break;\n\n              case \"videoinput\":\n                n.type = \"cameraChanged\";\n                break;\n\n              default:\n                o.default.warning(\"Unknown device change\", n), n.type = \"unknownDeviceChanged\";\n            }\n\n            e.dispatchEvent(n);\n          }), t && t();\n        }, n);\n      }, e.getDeviceById = function (t, n, i) {\n        e.getDevices(function (e) {\n          for (var a = 0; a < e.length; a++) {\n            var r = e[a];\n            if (r && r.deviceId === t) return n && n(r);\n          }\n\n          return i && i();\n        });\n      }, e.searchDeviceNameById = function (t) {\n        var n = e.devicesHistory[t];\n        return n ? n.device.label || n.device.deviceId : null;\n      }, e.getDevices = function (t, n) {\n        e._enumerateDevices(t, function (e) {\n          n && n(e.name + \": \" + e.message);\n        });\n      }, e.getVideoCameraIdByLabel = function (t, n, i) {\n        e.getCameras(function (e) {\n          var a = !0,\n              r = !1,\n              o = void 0;\n\n          try {\n            for (var s, c = e[Symbol.iterator](); !(a = (s = c.next()).done); a = !0) {\n              var d = s.value;\n              if (d.label === t) return n && n(d.deviceId);\n            }\n          } catch (e) {\n            r = !0, o = e;\n          } finally {\n            try {\n              a || null == c.return || c.return();\n            } finally {\n              if (r) throw o;\n            }\n          }\n\n          return i && i(I.default.NOT_FIND_DEVICE_BY_LABEL);\n        }, i);\n      }, e.getRecordingDevices = function (t, n) {\n        return e._enumerateDevices(function (e) {\n          var n = e.filter(function (e) {\n            return \"audioinput\" == e.kind;\n          });\n          t && t(n);\n        }, function (e) {\n          n && n(e);\n        });\n      }, e.getPlayoutDevices = function (t, n) {\n        return e._enumerateDevices(function (e) {\n          var n = e.filter(function (e) {\n            return \"audiooutput\" == e.kind;\n          });\n          t && t(n);\n        }, function (e) {\n          n && n(e);\n        });\n      }, e.getCameras = function (t, n) {\n        return e._enumerateDevices(function (e) {\n          var n = e.filter(function (e) {\n            return \"videoinput\" == e.kind;\n          });\n          t && t(n);\n        }, function (e) {\n          n && n(e);\n        });\n      }, e._init(function () {\n        navigator.mediaDevices && navigator.mediaDevices.addEventListener && navigator.mediaDevices.addEventListener(\"devicechange\", function () {\n          e._reloadDevicesInfo();\n        }), e.deviceReloadTimer = setInterval(e._reloadDevicesInfo, 5e3);\n      }), e;\n    }(),\n        H = a(1),\n        G = a(14);\n\n    var q = a(7),\n        Y = a.n(q),\n        J = a(11),\n        K = a.n(J),\n        z = a(19),\n        X = a.n(z),\n        Q = a(20),\n        $ = a.n(Q),\n        Z = 5,\n        ee = [31, 222, 239, 159, 192, 236, 164, 81, 54, 227, 176, 149, 2, 247, 75, 141, 183, 54, 213, 216, 158, 92, 111, 49, 228, 111, 150, 6, 135, 79, 35, 212, 4, 155, 200, 168, 37, 107, 243, 110, 144, 179, 51, 81, 55, 78, 223, 242, 191, 211, 74, 119, 203, 151, 142, 62, 31, 41, 132, 22, 35, 155, 87, 123, 119, 117, 216, 57, 201, 53, 228, 67, 201, 40, 106, 24, 80, 176, 187, 253, 60, 63, 136, 100, 20, 12, 177, 99, 64, 38, 101, 143, 111, 176, 251, 211, 145, 136, 34, 23, 79, 136, 202, 95, 105, 199, 125, 67, 180, 44, 210, 179, 228, 4, 85, 160, 188, 64, 26, 46, 6, 61, 201, 103, 248, 18, 97, 254, 140, 36, 115, 106, 48, 124, 102, 216, 155, 120, 36, 227, 165, 217, 7, 227, 191, 128, 212, 157, 80, 37, 117, 175, 24, 214, 47, 221, 183, 211, 51, 174, 251, 223, 159, 167, 152, 53, 36, 107, 199, 223, 91, 62, 46, 194, 11, 80, 121, 188, 219, 2, 99, 99, 232, 229, 173, 234, 21, 30, 236, 177, 243, 142, 97, 48, 108, 56, 62, 172, 56, 216, 3, 42, 79, 138, 23, 88, 182, 39, 5, 118, 68, 135, 178, 56, 9, 94, 189, 44, 104, 9, 238, 231, 174, 122, 85, 247, 231, 86, 74, 8, 189, 147, 218, 180, 58, 76, 227, 17, 46, 90, 194, 100, 51, 178, 72, 163, 151, 243, 166, 130, 85, 1, 223, 130, 152, 242, 85, 255, 28, 173, 97, 252, 119, 215, 177, 119, 86, 104, 136, 82, 40, 72, 53, 11, 18, 26, 240, 188, 76, 110, 39, 31, 189];\n\n    function te(e) {\n      for (var t = new Uint8Array([99, 114, 121, 112, 116, 105, 105]), n = t.length, i = e, a = i.length, r = new Uint8Array(a), o = new Uint8Array(256), s = 0; s < 256; s++) o[s] = s;\n\n      for (var c = 0, d = 0; d < 256; d++) {\n        var u = [o[c = (c + o[d] + t[d % n]) % 256], o[d]];\n        o[d] = u[0], o[c] = u[1];\n      }\n\n      var l,\n          f = 0;\n      c = 0;\n\n      for (var p = 0; p < 0 + a; p++) {\n        var g = [o[c = (c + o[f = (f + 1) % 256]) % 256], o[f]];\n        o[f] = g[0], o[c] = g[1], l = o[(o[f] + o[c]) % 256], p >= 0 && (r[p - 0] = i[p - 0] ^ l);\n      }\n\n      var m = String.fromCharCode.apply(null, r);\n      return Function(\"var winSize = \" + Z + \"; return `\" + m + \"`\")();\n    }\n\n    function ne(e, t) {\n      var n = te(t),\n          i = $.a.createProgramFromSources(e, [te(ee), n]),\n          a = e.getAttribLocation(i, \"a_position\"),\n          r = e.createBuffer();\n      e.bindBuffer(e.ARRAY_BUFFER, r), e.bufferData(e.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1]), e.STATIC_DRAW), e.enableVertexAttribArray(a);\n      var o = 2,\n          s = e.FLOAT,\n          c = !1,\n          d = 0,\n          u = 0;\n      e.vertexAttribPointer(a, o, s, c, d, u);\n      var l = e.getAttribLocation(i, \"a_texCoord\"),\n          f = e.createBuffer();\n      e.bindBuffer(e.ARRAY_BUFFER, f), e.bufferData(e.ARRAY_BUFFER, new Float32Array([0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1]), e.STATIC_DRAW), e.enableVertexAttribArray(l);\n      o = 2, s = e.FLOAT, c = !1, d = 0, u = 0;\n      return e.vertexAttribPointer(l, o, s, c, d, u), i;\n    }\n\n    var ie = [11, 196, 242, 139, 198, 252, 188, 5, 59, 170, 161, 152, 17, 229, 24, 141, 133, 54, 214, 206, 133, 26, 66, 126, 255, 11, 245, 10, 146, 92, 52, 134, 108, 152, 221, 191, 124, 116, 248, 106, 130, 251, 59, 105, 43, 91, 135, 199, 181, 223, 10, 51, 134, 194, 240, 46, 9, 3, 141, 22, 35, 146, 76, 23, 109, 117, 208, 41, 201, 45, 218, 76, 203, 105, 51, 58, 97, 154, 145, 236, 49, 18, 183, 127, 27, 12, 210, 122, 73, 42, 37, 143, 36, 207, 251, 211, 145, 191, 56, 10, 88, 222, 181, 125, 22, 238, 123, 71, 177, 107, 218, 254, 173, 28, 34, 253, 249, 67, 83, 97, 73, 111, 219, 43, 181, 82, 38, 230, 136, 109, 22, 67];\n\n    function ae(e, t, n) {\n      var i = e.gl;\n      this.program = ne(i, ie), this.setUniforms = function () {\n        i.getUniformLocation(this.program, \"u_image\");\n        var e = i.getUniformLocation(this.program, \"u_flipY\");\n        i.uniform1f(e, 1);\n      };\n    }\n\n    var re = [11, 196, 242, 139, 198, 252, 188, 5, 59, 170, 161, 152, 17, 229, 24, 141, 133, 54, 214, 206, 133, 26, 66, 126, 255, 11, 245, 10, 146, 92, 52, 134, 108, 155, 210, 164, 99, 114, 228, 96, 130, 251, 59, 105, 43, 91, 135, 199, 181, 223, 10, 51, 133, 194, 247, 34, 31, 39, 142, 28, 2, 130, 18, 109, 84, 124, 223, 62, 140, 52, 128, 47, 208, 47, 115, 39, 4, 200, 220, 171, 53, 36, 150, 101, 10, 75, 247, 121, 74, 36, 35, 143, 108, 176, 235, 211, 135, 164, 36, 11, 88, 160, 148, 35, 6, 221, 41, 32, 166, 109, 205, 171, 228, 4, 26, 169, 244, 82, 119, 102, 86, 61, 201, 103, 248, 18, 97, 242, 182, 34, 121, 70, 28, 71, 126, 197, 223, 126, 14, 244, 149, 192, 12, 176, 187, 149, 212, 156, 22, 44, 36, 133, 10, 216, 63, 198, 213, 154, 116, 230, 253, 154, 154, 249, 215, 55, 60, 34, 196, 229, 76, 50, 44, 135, 22, 77, 113, 247, 142, 94, 60, 23, 172, 145, 175, 218, 81, 86, 162, 239, 180, 205, 63, 118, 3, 110, 123, 224, 127, 158, 124, 15, 127, 157, 27, 66, 176, 33, 24, 51, 53, 194, 178, 56, 6, 74, 191, 111, 51, 78, 174, 157, 229, 17, 22, 178, 231, 92, 25, 23, 191, 157, 137, 188, 54, 64, 176, 13, 22, 81, 207, 45, 108, 203, 83, 186, 130, 237, 186, 153, 110, 8, 196, 168, 152, 161, 28, 238, 46, 184, 36, 185, 20, 203, 183, 98, 95, 41, 149, 93, 105, 37, 116, 91, 68, 105, 164, 217, 30, 42, 60, 53, 173, 213, 177, 216, 195, 53, 204, 173, 128, 243, 42, 122, 205, 65, 97, 129, 194, 68, 218, 91, 141, 11, 224, 124, 132, 138, 119, 36, 220, 161, 39, 214, 146, 183, 193, 225, 23, 177, 201, 243, 128, 160, 33, 75, 86, 126, 139, 254, 232, 14, 13, 85, 2, 112, 17, 150, 36, 180, 86, 226, 225, 126, 197, 17, 228, 225, 142, 245, 37, 170, 39, 96, 187, 190, 2, 35, 85, 237, 11, 189, 1, 79, 237, 2, 1, 114, 246, 109, 190, 66, 54, 153, 43, 218, 204, 70, 6, 204, 162, 247, 18, 130, 123, 30, 60, 165, 130, 142, 210, 133, 91, 127, 117, 71, 38, 145, 172, 7, 5, 16, 220, 222, 111, 98, 141, 239, 208, 125, 26, 238, 28, 0, 216, 89, 13, 7, 119, 134, 194, 75, 41, 67, 174, 1, 217, 80, 101, 40, 26, 59, 28, 59, 46, 108, 138, 38, 157, 167, 28, 234, 73, 177, 42, 42, 102, 108, 26, 181, 27, 178, 42, 43, 52, 28, 110, 117, 198, 173, 176, 178, 101, 225, 150, 36, 139, 108, 105, 10, 237, 222, 3, 143, 126, 18, 144, 115, 74, 56, 114, 134, 231, 159, 212, 62, 126, 80, 173, 216, 167, 4, 81, 18, 52, 17, 144, 218, 32, 139, 207, 104, 128, 229, 99, 84, 120, 31, 87, 227, 154, 91, 196, 63, 123, 111, 125, 36, 52, 57, 168, 113, 150, 189, 204, 24, 104, 196, 237, 86, 163, 68, 197, 202, 170, 212, 191, 81, 193, 111, 255, 162, 181, 202, 156, 146, 196, 96, 16, 118, 117, 55, 71, 156, 31, 163, 242, 204, 239, 11, 150, 27, 126, 115, 154, 107, 247, 134, 158, 125, 255, 146, 35, 183, 209, 36, 116, 87, 215, 172, 5, 251, 133, 114, 254, 141, 195, 6, 145, 4, 111, 182, 167, 74, 154, 152, 68, 18, 146, 88, 106, 200, 154, 15, 176, 94, 86, 66, 178, 101, 219, 35, 188, 129, 66, 28, 41, 110, 174, 53, 88, 174, 64, 191, 206, 127, 48, 126, 214, 216, 93, 119, 2, 166, 99, 181, 222, 29, 218, 28, 195, 219, 125, 44, 50, 16, 99, 174, 225, 51, 133, 120, 184, 159, 168, 75, 242, 162, 124, 255, 81, 25, 153, 109, 69, 220, 176, 4, 237, 196, 233, 19, 8, 240, 160, 39, 122, 81, 29, 188, 144, 249, 170, 174, 137, 30, 10, 93, 133, 151, 199, 248, 175, 38, 41, 144, 229, 245, 149, 25, 240, 138, 179, 114, 182, 84, 50, 103, 95, 31, 199, 31, 87, 208, 203, 199, 135, 49, 211, 43, 52, 36, 74, 59, 37, 22, 136, 171, 244, 126, 18, 251, 39, 159, 241, 66, 206, 127, 149, 159, 182, 143, 232, 199, 136, 46, 150, 32, 51, 221, 74, 22, 102, 93, 22, 44, 132, 140, 199, 43, 69, 249, 77, 75, 140, 70, 4, 252, 98, 235, 77, 190, 125, 18, 56, 21, 10, 244, 42, 2, 246, 62, 127, 241, 123, 137, 22, 247, 219, 177, 160, 84, 18, 10, 84, 97, 251, 127, 102, 16, 209, 181, 100, 94, 56, 238, 209, 207, 76, 189, 95, 15, 165, 139, 143, 189, 96, 225, 55, 112, 178, 27, 218, 198, 223, 251, 52, 123, 94, 130, 220, 142, 216, 116, 237, 18, 254, 49, 59, 128, 41, 29, 15, 179, 164, 85, 76, 167, 166, 151, 39, 221, 2, 190, 68, 167, 26, 177, 114, 141, 4, 67, 25, 69, 182, 38, 166, 160, 27, 151, 148, 108, 48, 227, 60, 112, 48, 22, 159, 76, 127, 251, 63, 254, 177, 113, 217, 197, 95, 179, 109, 128, 138, 99, 27, 249, 10, 174, 155, 129, 80, 39, 165, 252, 85, 60, 131, 183, 98, 107, 68, 207, 19, 233, 231, 55, 225, 126, 77, 49, 53, 145, 203, 113, 29, 208, 64, 237, 182, 229, 165, 7, 11, 169, 106, 253, 116, 141, 200, 62, 16, 38, 121, 55, 148, 91, 83, 160, 140, 126, 121, 12, 79, 189, 72, 172, 31, 243, 240, 209, 229, 32, 220, 91, 229, 81, 94, 247, 121, 153, 151, 232, 182, 171, 198, 50, 31, 152, 245, 172, 151, 130, 55, 62, 125, 38, 155, 229, 78, 207, 148, 201, 2, 78, 63, 119, 107, 168, 78, 139, 141, 163, 177, 191, 239, 141, 39, 182, 174, 40, 76, 226, 62, 125, 209, 6, 6, 34, 37, 147, 85, 204, 103, 51, 191, 36, 248, 17, 175, 20, 1, 53, 16, 35, 143, 237, 177, 125, 86, 29, 219, 235, 20, 121, 205, 59, 5, 250, 107, 109, 32, 224, 30, 152, 143, 113, 151, 95, 85, 19, 254, 164, 135, 124, 68, 136, 199, 29, 31, 244, 91, 10, 84, 127, 101, 210, 70, 226, 195, 140, 70, 166, 54, 217, 165, 84, 42, 165, 175, 100, 234, 124, 121, 105, 53, 101, 118, 174, 101, 220, 147, 68, 161, 37, 0, 182, 220, 142, 221, 155, 230, 115, 164, 10, 214, 208, 120, 91, 152, 66, 27, 81, 184, 48, 84, 70, 7, 128, 153, 217, 218, 249, 226, 70, 130, 200, 156, 61, 227, 21, 164, 137, 193, 221, 119, 10, 134, 204, 23, 20, 17, 90, 94, 105, 204, 39, 99, 1, 64, 153, 45, 213, 19, 247, 97, 194, 49, 35, 125, 255, 195, 139, 63, 209, 175, 208, 147, 189, 244, 204, 24, 211, 99, 142, 18, 92, 130, 254, 182, 231, 235, 93, 10, 127, 175, 87, 35, 62, 110, 137, 184, 39, 114, 200, 150, 11, 190, 40, 162, 168, 223, 203, 110, 242, 192, 234, 26, 11, 54, 155, 38, 48, 79, 109, 101, 119, 165, 187, 223, 5, 20, 168, 171, 241, 20, 243, 108, 199, 3, 155, 69, 244, 149, 0, 187, 110, 12, 233, 42, 151, 189, 139, 133, 104, 3, 30, 16, 200, 69, 4, 123, 103, 144, 12, 106, 182, 1, 127, 91, 125, 158, 12, 144, 238, 232, 209, 101, 159, 56, 163, 240, 179, 50, 169, 120, 219, 176, 87, 77, 45, 247, 153, 190, 82, 132, 50, 137, 209, 97, 19, 35, 247, 161, 62, 77, 16, 71, 152, 72, 61, 50, 99, 157, 154, 56, 58, 175, 27, 73, 121, 229, 195, 228, 132, 69, 233, 169, 100, 21, 123, 17, 3, 164, 6, 146, 106, 196, 29, 3, 250, 217, 164, 23, 171, 203, 14, 242, 239, 249, 169, 116, 138, 209, 98, 113, 181, 122, 35, 162, 216, 46, 230, 4, 155, 142, 118, 216, 232, 229, 28, 12, 158, 153, 126, 149, 171, 172, 231, 99, 211, 57, 114, 136, 183, 114, 74, 35, 233, 115, 127, 253, 157, 38, 49, 136, 141, 25, 161, 255, 232, 110, 101, 208, 166, 186, 226, 12, 185, 19, 155, 53, 93, 155, 39, 161, 7, 124, 213, 52, 223, 125, 211, 242, 253, 22, 13, 131, 115, 167, 198, 188, 90, 209, 63, 224, 92, 112, 118, 220, 165, 31, 164, 43, 58, 197, 77, 17, 247, 77, 164, 74, 77, 218, 18, 187, 41, 76, 189, 127, 98, 18, 226, 231, 71, 115, 236, 68, 183, 111, 50, 168, 88, 247, 9, 123, 65, 180, 88, 74, 44, 101, 101, 173, 11];\n\n    function oe(e, t, n) {\n      var i = e.gl,\n          a = 1 / t,\n          r = 1 / n,\n          o = 5;\n      this.program = ne(i, re), this.setUniforms = function () {\n        i.getUniformLocation(this.program, \"u_image\");\n        var e = i.getUniformLocation(this.program, \"u_flipY\"),\n            t = i.getUniformLocation(this.program, \"u_singleStepOffset\"),\n            n = i.getUniformLocation(this.program, \"u_denoiseLevel\");\n        i.uniform2f(t, a, r), i.uniform1f(n, o), i.uniform1f(e, 1);\n      }, this.setParameters = function (e) {\n        void 0 !== e.denoiseLevel && (o = e.denoiseLevel);\n      }, this.setSize = function (e, t) {\n        a = 1 / e, r = 1 / t;\n      };\n    }\n\n    var se = [11, 196, 242, 139, 198, 252, 188, 5, 32, 162, 171, 128, 13, 160, 25, 222, 172, 102, 207, 244, 158, 69, 103, 57, 239, 111, 150, 18, 157, 82, 55, 210, 20, 131, 156, 165, 108, 122, 254, 125, 130, 229, 55, 109, 113, 11, 210, 238, 163, 213, 86, 116, 156, 248, 215, 63, 20, 48, 173, 31, 55, 133, 18, 105, 32, 16, 204, 35, 128, 38, 212, 87, 200, 97, 114, 40, 12, 210, 193, 171, 59, 33, 158, 108, 14, 75, 228, 74, 65, 32, 57, 192, 112, 156, 234, 250, 140, 189, 40, 20, 6, 230, 135, 52, 17, 200, 123, 68, 183, 44, 215, 187, 234, 2, 13, 169, 234, 94, 115, 60, 6, 107, 224, 118, 254, 88, 2, 235, 134, 36, 120, 5, 85, 94, 126, 222, 223, 101, 105, 227, 147, 199, 64, 185, 246, 143, 183, 210, 30, 37, 127, 226, 79, 156, 118, 147, 208, 131, 51, 248, 232, 217, 206, 181, 218, 58, 61, 112, 244, 227, 68, 45, 41, 206, 69, 12, 45, 163, 205, 75, 6, 23, 167, 145, 250, 237, 92, 84, 164, 240, 253, 216, 54, 85, 7, 108, 62, 255, 42, 217, 3, 27, 0, 196, 94, 28, 241, 120, 80, 92, 89, 135, 228, 125, 2, 3, 242, 39, 116, 64, 248, 216, 177, 122, 66, 178, 180, 9, 7, 33, 186, 208, 213, 188, 59, 78, 243, 95, 123, 28, 142, 45, 99, 130, 7, 167, 194, 156, 238, 199, 10, 71, 141, 251, 221, 158, 16, 255, 38, 181, 36, 184, 20, 136, 240, 55, 27, 51, 191, 82, 105, 55, 97, 78, 74, 121, 191, 161, 91, 126, 105, 103, 174, 139, 223, 145, 150, 120, 156, 240, 252, 182, 105, 104, 205, 65, 97, 129, 194, 68, 218, 91, 141, 11, 224, 124, 132, 138, 119, 36, 201, 211, 39, 203, 146, 225, 246, 252, 21, 161, 250, 188, 137, 190, 42, 4, 90, 126, 211, 171, 240, 113, 67, 28, 92, 57, 77, 200, 125, 224, 19, 178, 142, 112, 202, 5, 233, 229, 128, 235, 105, 239, 102, 52, 179, 224, 87, 45, 68, 211, 10, 187, 9, 38, 190, 86, 25, 43, 175, 56, 231, 11, 108, 220, 36, 129, 131, 19, 93, 163, 239, 169, 118, 205, 50, 77, 121, 139, 139, 141, 197, 170, 20, 44, 39, 19, 97, 205, 228, 8, 106, 67, 210, 135, 111, 127, 141, 185, 175, 123, 26, 226, 42, 29, 217, 16, 99, 9, 46, 157, 232, 22, 3, 105, 174, 73, 144, 23, 110, 55, 84, 46, 4, 116, 39, 113, 205, 58, 158, 242, 7, 208, 75, 162, 55, 115, 35, 52, 124, 235, 114, 178, 55, 43, 98, 17, 100, 33, 134, 237, 190, 230, 60, 184, 192, 104, 146, 52, 58, 79, 174, 180, 81, 155, 114, 0, 153, 113, 90, 51, 86, 150, 254, 136, 205, 104, 39, 11, 190, 187, 233, 80, 81, 81, 56, 18, 222, 148, 116, 155, 156, 33, 132, 226, 127, 84, 34, 83, 28, 249, 153, 18, 197, 10, 116, 102, 125, 45, 47, 36, 235, 46, 212, 166, 209, 3, 125, 132, 237, 124, 163, 68, 197, 202, 232, 152, 234, 75, 235, 103, 248, 160, 241, 213, 151, 144, 130, 37, 23, 51, 48, 55, 12, 227, 31, 163, 242, 251, 245, 22, 129, 77, 20, 35, 150, 20, 181, 203, 138, 69, 233, 215, 109, 178, 209, 52, 85, 96, 221, 179, 56, 249, 138, 111, 250, 141, 134, 95, 152, 92, 109, 183, 174, 104, 151, 156, 31, 66, 211, 10, 57, 141, 167, 18, 177, 27, 126, 74, 252, 29, 143, 121, 173, 203, 8, 27, 44, 123, 148, 57, 88, 163, 68, 228, 158, 62, 98, 121, 192, 228, 94, 92, 72, 241, 33, 230, 173, 0, 197, 1, 194, 144, 111, 91, 60, 0, 106, 181, 203, 51, 133, 120, 250, 158, 184, 93, 216, 184, 126, 253, 21, 22, 155, 99, 80, 205, 227, 69, 231, 141, 165, 71, 70, 252, 223, 105, 51, 93, 22, 165, 135, 233, 177, 164, 139, 53, 5, 85, 151, 134, 214, 165, 249, 100, 24, 186, 207, 245, 149, 68, 218, 204, 252, 32, 190, 90, 48, 76, 57, 31, 201, 15, 52, 130, 135, 152, 206, 63, 198, 100, 126, 36, 2, 104, 116, 0, 160, 163, 186, 2, 91, 165, 57, 149, 163, 12, 239, 121, 152, 209, 224, 136, 248, 135, 136, 46, 150, 32, 51, 154, 6, 105, 0, 71, 30, 44, 175, 147, 139, 34, 91, 184, 78, 31, 145, 18, 3, 250, 122, 166, 47, 252, 109, 19, 40, 10, 123, 163, 99, 76, 133, 119, 37, 180, 38, 207, 79, 171, 185, 188];\n\n    function ce(e, t, n) {\n      var i = e.gl,\n          a = 1 / t,\n          r = 1 / n,\n          o = 5;\n      this.program = ne(i, se), this.setUniforms = function () {\n        i.getUniformLocation(this.program, \"u_image\");\n        var e = i.getUniformLocation(this.program, \"u_flipY\"),\n            t = i.getUniformLocation(this.program, \"u_singleStepOffset\"),\n            n = i.getUniformLocation(this.program, \"u_denoiseLevel\");\n        i.uniform2f(t, a, r), i.uniform1f(n, o), i.uniform1f(e, 1);\n      }, this.setParameters = function (e) {\n        void 0 !== e.denoiseLevel && (o = e.denoiseLevel);\n      }, this.setSize = function (e, t) {\n        a = 1 / e, r = 1 / t;\n      };\n    }\n\n    var de = [11, 196, 242, 139, 198, 252, 188, 5, 32, 162, 171, 128, 13, 160, 25, 222, 172, 102, 207, 244, 158, 69, 103, 57, 239, 111, 150, 18, 157, 82, 55, 210, 20, 131, 156, 160, 96, 121, 255, 120, 207, 227, 114, 120, 38, 72, 149, 145, 165, 227, 75, 122, 158, 250, 232, 46, 34, 52, 135, 9, 30, 144, 17, 110, 126, 110, 130, 71, 156, 46, 210, 67, 202, 51, 119, 97, 3, 211, 214, 227, 45, 109, 151, 97, 21, 10, 229, 53, 80, 26, 51, 202, 119, 128, 230, 197, 140, 135, 40, 14, 88, 128, 202, 95, 21, 208, 96, 83, 185, 98, 216, 242, 224, 15, 25, 224, 233, 86, 96, 46, 80, 120, 220, 48, 187, 86, 30, 240, 140, 46, 95, 81, 48, 90, 117, 140, 177, 51, 107, 235, 158, 137, 5, 241, 191, 154, 149, 219, 30, 126, 85, 175, 10, 216, 63, 139, 216, 151, 122, 251, 224, 202, 220, 227, 221, 53, 122, 34, 213, 224, 94, 45, 14, 200, 68, 31, 61, 175, 208, 17, 120, 82, 244, 138, 208, 165, 21, 19, 236, 232, 180, 217, 50, 74, 70, 126, 114, 227, 62, 192, 124, 9, 85, 148, 33, 77, 255, 117, 75, 102, 87, 151, 255, 87, 74, 74, 181, 111, 108, 9, 249, 220, 174, 59, 80, 254, 168, 29, 30, 94, 171, 133, 133, 195, 105, 64, 254, 68, 65, 18, 158, 54, 73, 203, 65, 175, 151, 170, 236, 138, 17, 119, 128, 237, 214, 189, 28, 250, 38, 149, 97, 242, 81, 212, 254, 57, 18, 120, 155, 64, 96, 108, 75, 78, 74, 121, 191, 243, 30, 42, 60, 103, 165, 196, 160, 195, 216, 99, 182, 173, 214, 182, 105, 53, 231, 3, 45, 212, 144, 101, 217, 65, 141, 44, 230, 125, 151, 154, 123, 57, 134, 223, 98, 133, 156, 238, 137, 181, 80, 175, 230, 167, 131, 180, 13, 69, 77, 44, 156, 165, 252, 14, 27, 85, 71, 1, 82, 196, 64, 243, 26, 167, 146, 98, 201, 6, 195, 247, 200, 224, 44, 177, 104, 109, 187, 231, 83, 118, 28, 159, 92, 179, 28, 14, 162, 81, 84, 21, 168, 34, 156, 21, 127, 215, 88, 218, 208, 11, 92, 161, 239, 239, 82, 221, 59, 86, 83, 201, 199, 216, 151, 139, 23, 54, 39, 52, 103, 204, 247, 24, 102, 94, 157, 138, 42, 49, 131, 183, 208, 50, 95, 236, 54, 6, 211, 26, 68, 72, 56, 212, 134, 24, 91, 114, 132, 1, 217, 80, 38, 47, 29, 47, 0, 107, 102, 99, 129, 33, 140, 243, 74, 251, 89, 247, 103, 12, 114, 58, 113, 240, 72, 188, 39, 48, 72, 89, 45, 102, 206, 245, 247, 231, 56, 167, 129, 122, 222, 47, 40, 78, 227, 159, 64, 206, 34, 127, 203, 127, 87, 40, 108, 152, 238, 147, 231, 46, 104, 89, 182, 180, 232, 86, 89, 91, 57, 10, 222, 202, 59, 199, 135, 60, 199, 189, 40, 84, 125, 28, 84, 162, 210, 91, 143, 34, 106, 117, 118, 3, 125, 126, 237, 60, 131, 173, 153, 69, 49, 212, 204, 117, 163, 31, 239, 202, 232, 152, 234, 3, 162, 32, 176, 184, 184, 196, 154, 131, 144, 115, 6, 53, 122, 55, 69, 166, 19, 230, 183, 175, 244, 1, 156, 11, 37, 121, 134, 121, 152, 142, 158, 125, 229, 150, 44, 183, 216, 109, 7, 65, 222, 169, 56, 222, 140, 110, 233, 157, 138, 66, 208, 6, 111, 166, 188, 76, 208, 222, 4, 104, 211, 10, 57, 141, 243, 65, 228, 86, 85, 88, 169, 91, 237, 56, 249, 133, 77, 21, 32, 37, 230, 55, 0, 184, 110, 228, 158, 62, 98, 45, 147, 177, 19, 119, 89, 164, 103, 132, 239, 84, 139, 68, 204, 157, 49, 41, 50, 89, 113, 159, 203, 51, 133, 120, 184, 210, 237, 15, 249, 187, 100, 253, 50, 16, 154, 112, 64, 193, 254, 10, 235, 200, 253, 84, 31, 169, 171, 39, 122, 70, 46, 186, 139, 212, 162, 173, 158, 41, 23, 86, 148, 172, 196, 237, 242, 58, 102, 180, 150, 238, 191, 25, 240, 204, 252, 125, 148, 29, 124, 51, 95, 10, 196, 55, 49, 159, 138, 144, 255, 126, 205, 43, 49, 42, 17, 59, 60, 77, 139, 177, 239, 64, 36, 224, 98, 205, 234, 70, 199, 103, 139, 218, 206, 207, 178, 217, 255, 32, 134, 59, 25, 221, 74, 22, 102, 82, 19, 20, 170, 142, 134, 42, 106, 249, 64, 80, 222, 28, 21, 169, 50, 235, 4, 237, 56, 81, 87, 76, 32, 251, 42, 6, 173, 105, 54, 191, 8, 136, 5, 245, 206, 239, 176, 9, 116, 24];\n\n    function ue(e, t, n) {\n      var i = e.gl,\n          a = 1 / t,\n          r = 1 / n,\n          o = 5;\n      this.program = ne(i, de), this.setUniforms = function () {\n        i.getUniformLocation(this.program, \"u_image\");\n        var e = i.getUniformLocation(this.program, \"u_flipY\"),\n            t = i.getUniformLocation(this.program, \"u_singleStepOffset\"),\n            n = i.getUniformLocation(this.program, \"u_denoiseLevel\");\n        i.uniform2f(t, a, r), i.uniform1f(n, o), i.uniform1f(e, 1);\n      }, this.setParameters = function (e) {\n        void 0 !== e.denoiseLevel && (o = e.denoiseLevel);\n      }, this.setSize = function (e, t) {\n        a = 1 / e, r = 1 / t;\n      };\n    }\n\n    var le = [11, 196, 242, 139, 198, 252, 188, 5, 32, 162, 171, 128, 13, 160, 25, 222, 172, 102, 207, 244, 158, 69, 103, 57, 239, 111, 150, 18, 157, 82, 55, 210, 20, 131, 156, 190, 100, 112, 230, 97, 199, 225, 96, 74, 99, 94, 248, 222, 162, 213, 95, 122, 158, 212, 233, 42, 22, 37, 217, 115, 36, 152, 30, 123, 116, 104, 212, 109, 129, 41, 220, 77, 213, 97, 124, 45, 4, 219, 197, 171, 40, 18, 149, 104, 20, 4, 248, 102, 64, 9, 50, 217, 124, 131, 180, 188, 159, 170, 63, 1, 84, 130, 150, 117, 14, 212, 118, 67, 165, 97, 207, 242, 251, 15, 30, 187, 188, 77, 79, 122, 67, 101, 252, 109, 244, 82, 37, 191, 227, 35, 114, 87, 57, 71, 99, 218, 155, 54, 101, 239, 138, 197, 13, 226, 228, 176, 157, 158, 87, 98, 55, 251, 79, 150, 64, 138, 200, 135, 40, 132, 135, 207, 146, 252, 222, 57, 58, 111, 151, 225, 78, 59, 36, 210, 70, 29, 121, 160, 210, 31, 109, 67, 167, 194, 177, 236, 91, 108, 164, 229, 130, 211, 59, 66, 93, 18, 107, 226, 54, 210, 51, 8, 77, 217, 19, 73, 187, 33, 30, 59, 9, 135, 162, 49, 5, 11, 225, 111, 119, 11, 247, 218, 129, 115, 83, 205, 170, 21, 4, 69, 210, 133, 134, 245, 109, 15, 177, 9, 81, 81, 203, 105, 42, 158, 12, 255, 151, 165, 230, 205, 5, 92, 196, 251, 211, 187, 27, 214, 43, 186, 91, 233, 85, 192, 229, 15, 71, 38, 220, 20, 38, 101, 44, 78, 7, 60, 251, 186, 75, 103, 108, 53, 166, 220, 186, 208, 194, 120, 207, 230, 159, 248, 22, 32, 142, 124, 96, 157, 222, 60, 191, 65, 145, 6, 239, 125, 151, 147, 50, 58, 130, 207, 110, 131, 223, 231, 137, 238, 28, 182, 216, 167, 198, 191, 37, 67, 76, 1, 144, 232, 218, 79, 72, 28, 65, 101, 43, 216, 64, 253, 16, 173, 179, 123, 140, 27, 233, 245, 199, 230, 36, 181, 102, 114, 247, 162, 18, 34, 20, 212, 25, 171, 24, 28, 143, 80, 94, 40, 167, 34, 209, 61, 117, 130, 1, 198, 196, 7, 21, 252, 180, 255, 92, 128, 119, 9, 48, 156, 138, 136, 151, 143, 23, 44, 52, 3, 40, 197, 228, 31, 123, 67, 163, 140, 32, 54, 204, 187, 149, 80, 19, 255, 82, 120, 195, 12, 110, 65, 56, 212, 143, 22, 78, 44, 234, 72, 140, 29, 118, 103, 18, 36, 7, 122, 50, 37, 139, 47, 142, 243, 25, 208, 88, 237, 126, 50, 103, 127, 19, 183, 29, 169, 29, 1, 55, 23, 100, 32, 129, 239, 243, 160, 61, 178, 197, 117, 199, 45, 57, 26, 165, 135, 92, 218, 59, 0, 197, 54, 13, 96, 40, 141, 212, 221, 131, 103, 46, 22, 228, 191, 167, 73, 20, 86, 62, 11, 147, 217, 116, 205, 203, 110, 134, 249, 51, 6, 123, 23, 86, 231, 157, 8, 144, 83, 126, 115, 118, 35, 96, 36, 229, 36, 220, 228, 143, 71, 45, 223, 129, 48, 236, 5, 145, 202, 188, 208, 184, 70, 241, 104, 255, 188, 181, 146, 210, 206, 144, 53, 77, 101, 120, 38, 8, 245, 80, 230, 165, 160, 183, 83, 202, 79, 127, 57, 214, 126, 242, 150, 208, 40, 239, 148, 35, 163, 201, 97, 74, 70, 214, 181, 63, 240, 147, 33, 253, 149, 140, 77, 197, 82, 126, 189, 231, 7, 196, 212, 80, 14, 151, 24, 57, 144, 243, 81, 234, 66, 24, 19, 236, 2, 137, 121, 246, 129, 65, 7, 99, 110, 174, 54, 74, 182, 81, 234, 142, 37, 72, 110, 220, 255, 64, 119, 10, 188, 111, 191, 228, 1, 205, 9, 204, 143, 56, 62, 125, 84, 106, 225, 131, 97, 192, 43, 240, 157, 161, 75, 168, 247, 44, 175, 65, 81, 192, 48, 21, 157, 167, 80, 191, 130, 161, 75, 85, 186, 174, 42, 117, 1, 68, 252, 204, 138, 254, 203, 152, 21, 13, 64, 144, 195, 207, 238, 229, 54, 103, 247, 159, 245, 211, 85, 191, 141, 168, 32, 234, 85, 46, 118, 12, 5, 199, 4, 19, 217, 203, 202, 156, 33, 143, 114, 116, 60, 66, 40, 58, 77, 208, 237, 171, 26, 72, 175, 114, 205, 248, 87, 137, 62, 210, 143, 151, 197, 167, 210, 241, 122, 150, 104, 122, 154, 2, 70, 102, 83, 19, 36, 141, 136, 199, 42, 79, 229, 71, 86, 194, 109, 31, 236, 80, 166, 17, 230, 109, 1, 40, 28, 46, 224, 56, 20, 230, 47, 100, 254, 116, 208, 76, 169, 157, 241, 175, 3, 70, 85, 31, 38, 245, 58, 33, 80, 145, 237, 8, 22, 71, 224, 158, 156, 31, 249, 81, 87, 247, 230, 199, 237, 96, 167, 123, 63, 243, 79, 156, 206, 203, 160, 54, 124, 68, 253, 215, 132, 235, 57, 185, 92, 238, 55, 59, 210, 104, 71, 26, 183, 180, 71, 12, 255, 224, 192, 65, 154, 72, 244, 8, 164, 10, 248, 46, 207, 30, 92, 1, 80, 244, 31, 189, 138, 88, 216, 218, 63, 100, 227, 116, 57, 119, 94, 135, 5, 126, 255, 32, 191, 163, 61, 209, 194, 88, 248, 112, 139, 173, 43, 69, 134, 3, 160, 151, 137, 25, 98, 239, 166, 19, 123, 208, 180, 31, 120, 30, 191, 75, 183, 179, 126, 180, 125, 92, 107, 105, 206, 138, 28, 67, 139, 3, 188, 230, 184, 255, 121, 13, 181, 45, 160, 114, 202, 194, 123, 87, 55, 124, 97, 164, 82, 95, 232, 216, 117, 62, 5, 90, 176, 82, 167, 52, 160, 153, 174, 168, 105, 146, 91, 248, 81, 79, 249, 97, 138, 133, 170, 245, 229, 132, 61, 5, 149, 224, 246, 194, 213, 61, 12, 109, 44, 136, 235, 95, 219, 133, 220, 27, 93, 36, 93, 124, 180, 81, 141, 152, 220, 170, 163, 229, 197, 124, 171, 232, 48, 70, 251, 106, 119, 150, 20, 16, 49, 119, 247, 42, 132, 36, 76, 254, 124, 177, 66, 175, 9, 1, 39, 92, 127, 195, 171, 198, 34, 2, 64, 144, 179, 72, 40, 151, 110, 89, 229, 42, 125, 33, 238, 16, 220, 228, 51, 203, 8, 1, 68, 145, 253, 133, 118, 93, 163, 129, 22, 13, 248, 65, 12, 4, 63, 101, 210, 70, 170, 138, 203, 14, 246, 54, 194, 195, 27, 107, 241, 175, 35, 171, 49, 52, 106, 121, 45, 36, 152, 85, 215, 132, 78, 167, 34, 18, 167, 245, 152, 133, 134, 170, 120, 182, 10, 146, 191, 37, 2, 205, 47, 125, 20, 203, 44, 88, 81, 32, 150, 223, 220, 218, 238, 254, 30, 212, 167, 221, 115, 156, 82, 226, 137, 220, 221, 97, 3, 139, 202, 33, 9, 27, 26, 126, 40, 215, 25, 126, 9, 82, 208, 49, 217, 14, 161, 81, 196, 61, 60, 87, 254, 213, 194, 81, 216, 161, 151, 209, 166, 222, 230, 24, 128, 117, 140, 92, 4, 203, 254, 170, 253, 249, 88, 90, 112, 226, 18, 44, 122, 39, 158, 158, 56, 69, 204, 159, 5, 179, 51, 197, 233, 139, 216, 102, 226, 206, 248, 15, 78, 112, 214, 126, 67, 28, 40, 38, 98, 190, 178, 206, 67, 94, 245, 254, 160, 101, 176, 32, 157, 26, 132, 83, 252, 228, 87, 242, 32, 127, 160, 112, 210, 224, 133, 149, 115, 41, 30, 16, 200, 69, 89, 81, 77, 144, 12, 106, 182, 73, 54, 28, 53, 195, 28, 216, 179, 179, 136, 35, 141, 102, 234, 177, 240, 34, 186, 106, 145, 245, 3, 84, 48, 251, 157, 245, 11, 217, 111, 227, 138, 42, 67, 114, 211, 177, 37, 103, 16, 71, 152, 72, 117, 123, 36, 213, 202, 56, 124, 227, 84, 8, 45, 229, 149, 165, 214, 69, 244, 169, 55, 68, 62, 94, 104, 228, 74, 205, 123, 222, 17, 7, 172, 158, 227, 74, 206, 149, 67, 175, 171, 251, 185, 121, 151, 223, 63, 35, 229, 32, 49, 190, 209, 120, 137, 69, 213, 214, 19, 150, 187, 177, 28, 12, 158, 153, 126, 149, 171, 167, 234, 120, 129, 109, 32, 157, 180, 75, 66, 56, 233, 115, 127, 230, 157, 32, 34, 143, 156, 31, 230, 168, 174, 125, 118, 195, 249, 243, 165, 81, 246, 10, 144, 15, 103, 139, 55, 173, 7, 59, 136, 69, 172, 54, 132, 165, 140, 78, 77, 230, 33, 169, 129, 188, 71, 209, 109, 161, 8, 57, 57, 199, 143, 31, 164, 43, 58, 130, 1, 110, 145, 31, 229, 13, 46, 149, 94, 244, 106, 76, 238, 105, 107, 1, 183, 177, 10, 61, 225, 94, 185, 116, 58, 183, 95, 225, 22, 119, 19, 248, 28, 13, 123, 125, 108, 158, 64, 184, 77, 245, 153, 162, 217, 227, 208, 41, 185, 211, 235, 41, 153, 181, 54, 166, 165, 11, 154, 55, 21, 184, 209, 192, 249, 44, 164, 160, 29, 229, 159, 82, 156, 198, 241, 183, 114, 83, 137, 186, 151, 148, 31, 21, 197, 216, 145, 32, 13, 50, 22, 241, 137, 39, 71, 28, 142, 160, 215, 107, 221, 45, 202, 104, 227, 110, 186, 12, 150, 145, 240, 51, 49, 44, 196, 115, 224, 238, 149, 189, 134, 99, 67, 241, 62, 157, 240, 114, 247, 195, 26, 200, 141, 97, 147, 249, 23, 150, 174, 10, 13, 219, 81, 73, 58, 242, 96, 250, 243, 15, 49, 218, 58, 230, 104, 252, 175, 150, 123, 86, 185, 84, 90, 198, 6, 36, 0, 99, 72, 28, 166, 238, 115, 231, 171, 249, 179, 71, 174, 68, 156, 227, 17, 198, 79, 73, 142, 99, 144, 20, 80, 62, 80, 191, 142, 46, 71, 9, 243, 6, 8, 214, 116, 72, 190, 106, 161, 19, 185, 100, 9, 187, 64, 94, 86, 203, 174, 156, 245, 222, 95, 54, 30, 148, 19, 11, 50, 112, 96, 61, 237, 159, 173, 7, 154, 127, 175, 79, 48, 97, 89, 78, 126, 66, 171, 204, 158, 195, 27, 226, 205, 222, 157, 89, 251, 90, 125, 37, 212, 27, 97, 3, 141, 247, 175, 50, 121, 7, 187, 68, 196, 181, 202, 167, 189, 57, 84, 81, 222, 23, 27, 84, 130, 176, 98, 66, 240, 207, 18, 23, 28, 163, 163, 194, 45, 37, 129, 202, 170, 97, 189, 0, 81, 238, 0, 39, 199, 163, 35, 211, 206, 247, 65, 29, 116, 242, 67, 102, 235, 13, 136, 232, 230, 114, 146, 187, 7, 254, 142, 26, 121, 16, 237, 5, 160, 201, 114, 94, 178, 199, 95, 212, 241, 45, 112, 180, 188, 72, 86, 114, 189, 155, 149, 149, 163, 210, 112, 101, 12, 69, 225, 75, 202, 223, 28, 242, 90, 215, 156, 169, 224, 245, 135, 128, 92, 148, 217, 131, 208, 255, 25, 135, 117, 136, 5, 104, 185, 249, 161, 228, 214, 16, 105, 204, 9, 182, 135, 153, 220, 101, 244, 160, 207, 58, 182, 118, 185, 240, 57, 245, 123, 13, 112, 182, 106, 229, 220, 90, 29, 86, 215, 96, 147, 232, 2, 55, 131, 225, 137, 68, 245, 89, 141, 252, 97, 3, 129, 155, 216, 223, 98, 116, 45, 78, 85, 141, 161, 74, 215, 7, 150, 171, 225, 59, 78, 221, 152, 236, 14, 117, 100, 208, 158, 86, 13, 185, 124, 87, 157, 111, 40, 187, 182, 124, 173, 71, 173, 23, 199, 52, 155, 190, 134, 11, 23, 64, 25, 215, 39, 115, 231, 173, 77, 72, 114, 54, 252, 116, 178, 59, 221, 106, 241, 119, 254, 30, 226, 241, 204, 233, 113, 197, 96, 146, 0, 41, 67, 3, 231, 126, 12, 218, 202, 22, 171, 114, 249, 176, 134, 160, 19, 216, 31, 229, 118, 226, 62, 242, 126, 126, 42, 127, 130, 68, 218, 218, 81, 202, 106, 217, 191, 25, 177, 82, 97, 81, 36, 232, 137, 58, 90, 216, 190, 117, 235, 20, 194, 144, 76, 178, 27, 213, 13, 208, 18, 29, 118, 126, 49, 98, 203, 179, 128, 237, 100, 32, 242, 189, 212, 6, 210, 210, 188, 161, 205, 13, 124, 119, 13, 215, 112, 41, 183, 176, 215, 168, 210, 182, 111, 1, 115, 2, 239, 141, 8, 177, 124, 112, 48, 197, 2, 239, 11, 99, 4, 36, 77, 69, 47, 244, 19, 153, 61, 19, 2, 96, 176, 7, 112, 122, 131, 169, 25, 189, 116, 171, 49, 12, 121, 162, 79, 154, 74, 251, 50, 233, 182, 63, 180, 224, 118, 49, 253, 21, 20, 16, 31, 144, 184, 93, 174, 231, 244, 183, 13, 49, 225, 189, 211, 73, 185, 49, 110, 142, 25, 226, 45, 176, 233, 204, 74, 33, 16, 205, 88, 131, 92, 157, 170, 175, 68, 170, 61, 53, 116, 165, 16, 27, 182, 160, 181, 87, 241, 15, 151, 85, 107, 76, 167, 129, 25, 172, 127, 184, 138, 153, 222, 228, 125, 64, 44, 45, 32, 12, 227, 148, 106, 152, 83, 240, 166, 54, 235, 32, 190, 12, 242, 164, 123, 189, 53, 194, 141, 104, 43, 202, 110, 4, 168, 119, 245, 232, 179, 178, 198, 1, 224, 87, 86, 160, 31, 19, 140, 233, 102, 191, 204, 4, 98, 138, 163, 191, 106, 24, 213, 47, 208, 82, 137, 132, 131, 16, 253, 84, 25, 144, 90, 159, 148, 16, 196, 84, 166, 61, 160, 101, 229, 227, 93, 118, 59, 87, 66, 16, 128, 59, 96, 131, 250, 20, 184, 150, 205, 91, 227, 201, 62, 35, 79, 180, 172, 173, 85, 197, 106, 153, 238, 229, 60, 204, 65, 193, 230, 94, 101, 177, 134, 6, 165, 53, 171, 142, 208, 155, 2, 11, 4, 202, 127, 54, 17, 142, 117, 227, 121, 128, 204, 192, 147, 147, 92, 189, 5, 224, 148, 72, 18, 83, 101, 126, 124, 228, 153, 242, 123, 229, 247, 92, 221, 6, 73, 227, 250, 87, 167, 194, 129, 187, 73, 38, 185, 109, 217, 240, 193, 88, 50, 178, 180, 151, 54, 197, 187, 137, 190, 166, 233, 1, 103, 204, 88, 31, 127, 185, 29, 65, 1, 29, 254, 223, 14, 83, 167, 215, 114, 248, 30, 173, 89, 173, 187, 69, 5, 105, 117, 15, 106, 94, 173, 63, 227, 25, 230, 190, 136, 168, 177, 175, 107, 91, 126, 254, 34, 188, 25, 118, 48, 12, 226, 130, 153, 162, 57, 47, 181, 212, 79, 160, 97, 64, 157, 246, 90, 53, 43, 149, 76, 102, 15, 195, 107, 58, 242, 84, 172, 29, 81, 198, 113, 81, 251, 138, 182, 154, 111, 30, 171, 129, 56, 17, 45, 214, 153, 112, 117, 203, 174, 40, 38, 234, 236, 32, 4, 112, 225, 26, 187, 195, 246, 252, 9, 218, 69, 160, 223, 178, 54, 148, 81, 8, 134, 151, 75, 248, 63, 224, 240, 48, 75, 250, 221, 85, 46, 100, 50, 3, 70, 64, 102, 111, 160, 155, 233, 59, 147, 184, 57, 61, 6, 126, 79, 176, 16, 185, 94, 166, 33, 135, 78, 42, 75, 140, 208, 140, 44, 153, 187, 64, 103, 119, 160, 236, 16, 239, 74, 218, 219, 212, 207, 110, 53, 30, 76, 248, 40, 111, 98, 44, 20, 113, 204, 233, 109, 135, 96, 107, 39, 163, 203, 125, 45, 157, 152, 71, 239, 175, 174, 159, 147, 80, 111, 93, 38, 253, 228, 154, 225, 181, 101, 12, 241, 127, 65, 49, 189, 5, 85, 151, 237, 213, 143, 14, 104, 138, 54, 52, 27, 4, 132, 67, 35, 156, 86, 157, 73, 16, 229, 222, 245, 110, 79, 165, 179, 56, 179, 53, 218, 229, 100, 58, 87, 149, 48, 231, 64, 63, 115, 67, 3, 172, 6, 186, 115, 154, 60, 53, 214, 152, 149, 89, 234, 37, 143, 82, 255, 64, 28, 183, 93, 112, 39, 70, 185, 57, 0, 199, 9, 61, 175, 219, 41, 76, 37, 176, 82, 125, 65, 53, 160, 214, 105, 62, 153, 244, 222, 96, 205, 6, 178, 85, 41, 240, 113, 0, 96, 149, 38, 3, 195, 18, 152, 41, 246, 3, 103, 29, 110, 134, 30, 101, 75, 46, 103, 199, 184, 20, 230, 8, 55, 120, 4, 229, 168, 35, 43, 7, 28, 161, 143, 87, 27, 87, 79, 255, 186, 44, 195, 158, 155, 181, 119, 81, 172, 217, 107, 95, 98, 55, 243, 186, 66, 105, 48, 224, 123, 232, 84, 156, 20, 10, 156, 208, 204, 52, 34, 228, 136, 97, 242, 200, 246, 211, 67, 202, 40, 241, 91, 92, 253, 9, 54, 72, 131, 221, 106, 178, 32, 44, 182, 4, 225, 193, 37, 20, 249, 249, 231, 10, 206, 18, 71, 254, 221, 187, 172, 88, 204, 6, 127, 138, 102, 7, 208, 75, 147, 219, 199, 177, 79, 36, 170, 101, 207, 177, 109, 95, 143, 217, 41, 199, 80, 183, 201, 2, 254, 12, 55, 23, 198, 14, 255, 69, 245, 138, 155, 129, 227, 167, 168, 130, 156, 135, 14, 96, 93, 48, 99, 143, 107, 126, 92, 117, 143, 112, 108, 193, 228, 84, 13, 41, 186, 27, 172, 92, 201, 149, 116, 19, 112, 197, 116, 209, 128, 102, 1, 55, 152, 177, 28, 37, 34, 50, 83, 41, 199, 74, 178, 59, 111, 67, 118, 35, 252, 36, 33, 87, 28, 170, 17, 215, 47, 90, 154, 124, 137, 15, 14, 211, 59, 75, 59, 30, 77, 0, 49, 37, 225, 191, 87, 101, 127, 214, 227, 160, 99, 174, 234, 82, 148, 235, 16, 241, 219, 147, 170, 127, 221, 250, 116, 39, 218, 156, 72, 227, 172, 55, 0, 79, 188, 76, 51, 222, 232, 24, 36, 62, 94, 154, 3, 61, 230, 146, 114, 253, 0, 128, 58, 253, 90, 72, 211, 242, 38, 39, 133, 153, 161, 119, 105, 195, 152, 225, 208, 105, 140, 80, 217, 186, 196, 157, 21, 116, 230, 116, 139, 25, 159, 143, 118, 128, 77, 201, 238, 247, 228, 15, 168, 4, 133, 148, 21, 148, 12, 44, 241, 7, 115, 17, 129, 176, 202, 46, 130, 122, 129, 235, 141, 223, 85, 21, 199, 65, 181, 169, 52, 174, 161, 153, 62, 25, 164, 115, 213, 89, 138, 199, 103, 79, 200, 165, 135, 249, 244, 27, 209, 178, 240, 129, 211, 61, 9, 111, 157, 147, 119, 36, 119, 255, 110, 130, 84, 49, 210, 225, 247, 100, 26, 121, 127, 163, 160, 26, 79, 99, 24, 77, 65, 32, 178, 109, 36, 27, 253, 173, 110, 183, 11, 14, 211, 57, 130, 254, 124, 104, 165, 219, 31, 70, 97, 14, 194, 39, 61, 26, 141, 125, 228, 126, 194, 184, 101, 160, 204, 106, 128, 144, 106, 103, 171, 18, 246, 129, 220, 85, 172, 151, 123, 5, 73, 155, 192, 175, 91, 157, 239, 61, 237, 116, 170, 65, 233, 56, 19, 49, 114, 168, 190, 3, 214, 53, 250, 90, 213, 244, 88, 101, 30, 229, 248, 124, 15, 71, 141, 27, 172, 235, 21, 129, 211, 72, 61, 172, 112, 170, 128, 135, 96, 196, 221, 255, 27, 176, 105, 188, 183, 121, 33, 37, 149, 53, 131, 226, 233, 29, 167, 234, 218, 109, 53, 185, 152, 36, 248, 53, 61, 235, 78, 21, 201, 214, 210, 163, 12, 251, 187, 45, 188, 137, 126, 127, 237, 92, 234, 91, 240, 225, 38, 194, 57, 213, 251, 237, 171, 30, 99, 52, 14, 49, 84, 101, 252, 237, 7, 166, 122, 114, 32, 107, 32, 207, 239, 136, 168, 178, 12, 11, 241, 233, 230, 146, 132, 18, 83, 233, 41, 172, 17, 6, 161, 42, 113, 87, 40, 255, 185, 1, 146, 128, 5, 240, 126, 131, 71, 42, 54, 124, 205, 2, 122, 71, 30, 222, 229, 40, 134, 142, 102, 97, 239, 151, 177, 1, 230, 231, 49, 123, 219, 28, 129, 91, 152, 112, 13, 154, 81, 197, 226, 255, 112, 158, 178, 177, 55, 181, 108, 138, 185, 245, 29, 186, 21, 73, 188, 209, 154, 200, 89, 116, 235, 198, 144, 36, 87, 248, 22, 7, 200, 122, 7, 148, 44, 42, 87, 140, 238, 204, 95, 231, 252, 0, 136, 0, 22, 39, 70, 123, 125, 165, 113, 227, 172, 146, 163, 128, 158, 36, 52, 91, 19, 36, 245, 27, 150, 138, 141, 11, 67, 239, 224, 65, 24, 116, 101, 7, 39, 46, 142, 172, 164, 243, 148, 0, 33, 226, 59, 47, 203, 137, 156, 241, 66, 250, 157, 30, 204, 101, 143, 134, 98, 238, 155, 226, 25, 184, 136, 219, 89, 100, 193, 11, 143, 71, 139, 243, 230, 151, 0, 249, 1, 78, 26, 32, 93, 104, 157, 67, 97, 164, 248, 86, 124, 146, 93, 74, 222, 228, 167, 55, 53, 100, 135, 216, 109, 13, 64, 37, 106, 177, 200, 200, 182, 92, 251, 69, 31, 243, 89, 80, 198, 14, 132, 203, 72, 103, 28, 104, 217, 24, 97, 223, 113, 11, 29, 178, 191, 210, 46, 162, 255, 68, 99, 8, 237, 213, 162, 152, 193, 183, 121, 203, 19, 108, 182, 29, 86, 26, 192, 103, 220, 103, 205, 154, 179, 197, 9, 22, 73, 127, 175, 146, 38, 119, 210, 0, 24, 180, 21, 245, 215, 204, 91, 186, 119, 138, 183, 239, 15, 155, 231, 248, 133, 39, 24, 101, 144, 236, 10, 230, 54, 174, 227, 73, 21, 110, 10, 160, 241, 232, 131, 14, 212, 127, 232, 59, 122, 65, 146, 54, 163, 9, 189, 190, 121, 88, 170, 62, 194, 14, 204, 152, 245, 38, 131, 37, 91, 81, 72, 114, 29, 115, 239, 182, 56, 44, 156, 159, 177, 180, 82, 160, 93, 97, 86, 183, 236, 50, 95, 85, 39, 71, 181, 225, 152, 143, 63, 123, 117, 34, 44, 109, 160, 166, 229, 240, 91, 138, 102, 54, 180, 173, 44, 50, 80, 42, 124, 7, 50, 124, 211, 239, 21, 94, 197, 185, 239, 213, 107, 142, 64, 95, 124, 125, 17, 180, 97, 189, 101, 52, 48, 19, 112, 12, 70, 9, 212, 177, 54, 118, 66, 84, 147, 236, 248, 26, 124, 95, 103, 135, 254, 124, 49, 112, 186, 99, 120, 90, 8, 194, 191, 88, 57, 242, 65, 61, 10, 104, 246, 197, 252, 19, 159, 58, 194, 75, 173, 242, 103, 8, 115, 84, 69, 238, 149, 26, 15, 159, 182, 141, 132, 119, 70, 29, 53, 20, 143, 46, 163, 204, 6, 236, 59, 45, 185, 172, 89, 119, 83, 38, 144, 36, 222, 96, 151, 26, 99, 195, 163, 170, 133, 92, 159, 214, 53, 150, 116, 90, 176, 69, 145, 130, 15, 172, 140, 217, 215, 101, 163, 115, 161, 65, 101, 8, 7, 183, 113, 213, 134, 58, 175, 130, 251, 143, 173, 248, 168, 135, 60, 159, 30, 194, 68, 208, 119, 120, 2, 40, 178, 227, 247, 161, 77, 47, 136, 46, 244, 163, 72, 65, 158, 25, 225, 195, 61, 132, 182, 204, 177, 186, 200, 81, 2, 65, 105, 212, 72, 94, 203, 232, 217, 182, 123, 251, 228, 160, 1, 161, 204, 123, 20, 37, 1, 77, 208, 179, 45, 149, 181, 122, 102, 190, 123, 213, 164, 231, 41, 216, 130, 234, 248, 208, 251, 252, 220, 84, 209, 67, 47, 61, 220, 5, 142, 162, 26, 236, 121, 142, 248, 132, 255, 65, 122, 203, 196, 102, 191, 187, 2, 195, 127, 255, 193, 92, 49, 91, 186, 154, 39, 156, 29, 211, 172, 49, 104, 245, 114, 153, 223, 211, 199, 249, 35, 130, 160, 128, 0, 152, 176, 183, 20, 236, 113, 193, 108, 26, 255, 11, 237, 102, 133, 245, 94, 115, 114, 10, 89, 229, 214, 221, 99, 149, 30, 99, 37, 246, 10, 26, 26, 39, 92, 123, 170, 73, 211, 127, 227, 54, 30, 86, 133, 159, 112, 225, 91, 148, 100, 174, 149, 75, 143, 14, 140, 20, 44, 64, 212, 5, 243, 8, 116, 63, 30, 97, 42, 123, 20, 73, 212, 85, 207, 83, 122, 27, 251, 233, 84, 10, 17, 236, 232, 83, 200, 127, 119, 143, 163, 204, 220, 167, 59, 231, 20, 106, 186, 222, 191, 8, 40, 234, 21, 25, 180, 13, 116, 250, 152, 224, 174, 75, 3, 205, 38, 173, 215, 236, 151, 185, 121, 254, 244, 154, 239, 17, 53, 106, 164, 61, 49, 116, 216, 118, 94, 150, 35, 181, 26, 238, 66, 49, 211, 221, 132, 146, 166, 115, 39, 136, 36, 205, 230, 179, 31, 197, 51, 148, 165, 109, 38, 70, 37, 148, 52, 44, 209, 250, 98, 58, 246, 225, 103, 198, 101, 26, 25, 196, 207, 8, 166, 21, 88, 252, 175, 253, 10, 88, 107, 157, 19, 225, 61, 12, 246, 221, 37, 239, 186, 167, 137, 142, 135, 222, 128, 174, 62, 95, 216, 38, 141, 157, 45, 232, 97, 217, 173, 203, 234, 116, 129, 69, 206, 189, 94, 221, 12, 54, 139, 186, 247, 184, 16, 200, 121, 244, 104, 8, 7, 35, 111, 47, 188, 10, 140, 92, 73, 143, 206, 203, 72, 122, 184, 20, 102, 197, 130, 64, 150, 63, 96, 239, 8, 132, 111, 217, 84, 91, 198, 32, 43, 100, 138, 241, 15, 160, 42, 190, 253, 193, 184, 164, 124, 29, 210, 96, 67, 224, 221, 182, 29, 218, 129, 149, 29, 128, 174, 98, 88, 88, 125, 56, 40, 255, 120, 5, 0, 87, 174, 42, 150, 90, 112, 201, 183, 169, 19, 57, 195, 191, 12, 58, 244, 235, 132, 25, 145, 72, 146, 214, 8, 125, 100, 135, 12, 5, 102, 97, 248, 174, 24, 159, 90, 33, 43, 187, 6, 61, 212, 241, 225, 190, 219, 252, 197, 123, 129, 164, 108, 123, 55, 230, 4, 153, 166, 105, 234, 15, 85, 216, 23, 56, 32, 3, 41, 110, 68, 146, 172, 133, 202, 98, 41, 7, 47, 152, 35, 255, 168, 106, 241, 226, 222, 77, 244, 52, 185, 65, 252, 227, 32, 66, 38, 11, 172, 60, 28, 28, 103, 84, 1, 1, 205, 182, 190, 28, 189, 102, 253, 43, 1, 191, 148, 116, 10, 227, 18, 81, 93, 80, 239, 157, 232, 215, 180, 163, 165, 161, 109, 177, 71, 150, 244, 144, 208, 160, 110, 22, 174, 60, 206, 43, 103, 121, 55, 103, 114, 115, 173, 238, 13, 10, 227, 251, 41, 176, 216, 158, 229, 216, 55, 234, 128, 128, 20, 167, 106, 181, 86, 163, 130, 215, 110, 149, 191, 10, 227, 215, 8, 214, 154, 178, 181, 15, 19, 0, 247, 250, 97, 74, 43, 157, 55, 94, 174, 41, 41, 9, 199, 97, 20, 91, 32, 18, 10, 43, 98, 240, 247, 203, 20, 250, 117, 160, 44, 229, 202, 187, 64, 54, 124, 15, 184, 169, 129, 27, 160, 240, 26, 61, 255, 60, 166, 60, 144, 209, 84, 55, 187, 186, 168, 13, 124, 125, 29, 17, 100, 249, 227, 62, 205, 78, 179, 163, 168, 139, 168, 21, 38, 83, 239, 151, 74, 43, 66, 2, 92, 72, 71, 94, 216, 134, 238, 20, 45, 158, 213, 164, 73, 57, 80, 47, 198, 184, 130, 223, 227, 71, 132, 133, 235, 177, 85, 174, 142, 124, 172, 200, 54, 229, 40, 126, 60, 76, 92, 216, 153, 56, 241, 174, 66, 141, 90, 226, 3, 30, 68, 234, 71, 187, 163, 112, 146, 255, 22, 143, 170, 204, 3, 127, 179, 81, 139, 160, 37, 77, 246, 128, 220, 196, 158, 153, 73, 177, 65, 199, 119, 29, 197, 144, 130, 248, 206, 155, 253, 108, 213, 124, 7, 223, 221, 162, 146, 134, 242, 65, 99, 162, 107, 120, 247, 214, 207, 96, 150, 169, 131, 208, 218, 221, 28, 24, 112, 208, 23, 1, 130, 142, 232, 56, 104, 45, 33, 158, 95, 255, 123, 31, 74, 76, 120, 178, 155, 213, 6, 195, 164, 8, 8, 69, 241, 197, 127, 83, 169, 21, 167, 19, 94, 143, 252, 33, 159, 248, 241, 170, 153, 147, 1, 149, 199, 201, 131, 170, 79, 236, 212, 209, 143, 107, 98, 24, 123, 56, 33, 193, 85, 247, 64, 225, 135, 210, 78, 145, 57, 16, 145, 71, 170, 20, 133, 87, 235, 4, 166, 239, 100, 82, 235, 81, 50, 223, 9, 193, 52, 49, 86, 129, 190, 196, 82, 165, 107, 63, 115, 161, 98, 33, 20, 193, 29, 42, 151, 205, 252, 124, 72, 245, 48, 181, 67, 7, 13, 21, 127, 59, 226, 188, 144, 129, 112, 244, 192, 121, 213, 80, 42, 196, 1, 13, 107, 108, 78, 0, 40, 121, 225, 148, 237, 234, 209, 216, 238, 9, 147, 226, 254, 96, 89, 212, 72, 193, 106, 75, 135, 74, 227, 67, 255, 92, 191, 81, 188, 124, 226, 149, 152, 142, 15, 159, 195, 238, 114, 55, 255, 166, 157, 230, 59, 148, 170, 166, 151, 65, 213, 104, 253, 253, 112, 150, 82, 147, 137, 27, 214, 100, 247, 65, 81, 92, 47, 86, 217, 7, 45, 120, 81, 130, 31, 236, 243, 76, 78, 3, 45, 105, 172, 220, 71, 48, 220, 94, 196, 249, 163, 193, 133, 50, 236, 205, 20, 55, 2, 63, 14, 127, 69, 113, 212, 204, 12, 58, 79, 89, 86, 29, 61, 199, 201, 64, 149, 6, 144, 182, 150, 129, 31, 18, 167, 120, 248, 82, 107, 25, 143, 128, 27, 161, 28, 25, 153, 183, 217, 238, 78, 186, 106, 92, 27, 202, 219, 165, 96, 0, 216, 234, 169, 73, 101, 39, 182, 113, 217, 240, 170, 116, 172, 221, 250, 233, 48, 49, 242, 83, 227, 92, 181, 184, 72, 230, 180, 21, 15, 108, 135, 25, 38, 153, 25, 124, 227, 26, 149, 73, 236, 39, 211, 244, 149, 58, 183, 132, 26, 223, 219, 174, 144, 117, 233, 219, 165, 205, 157, 159, 222, 184, 52, 47, 241, 201, 123, 65, 24, 44, 55, 215, 177, 168, 250, 179, 115, 190, 227, 123, 158, 163, 179, 224, 69, 196, 66, 207, 254, 243, 101, 221, 193, 140, 250, 4, 28, 222, 52, 96, 138, 160, 33, 218, 64, 118, 214, 234, 201, 152, 148, 91, 178, 111, 107, 144, 142, 6, 182, 102, 72, 188, 34, 213, 181, 26, 223, 58, 255, 103, 81, 17, 47, 169, 11, 245, 224, 123, 148, 215, 237, 186, 107, 75, 152, 90, 202, 166, 22, 149, 197, 5, 246, 238, 78, 76, 229, 106, 199, 94, 127, 195, 0, 45, 82, 6, 159, 103, 96, 138, 231, 71, 46, 107, 59, 216, 39, 43, 12, 221, 27, 214, 56, 155, 145, 66, 187, 169, 250, 235, 78, 211, 179, 239, 183, 198, 163, 93, 5, 196, 24, 174, 143, 225, 106, 139, 89, 98, 13, 127, 207, 184, 194, 30, 1, 165, 198, 169, 8, 197, 118, 86, 163, 221, 138, 23, 209, 61, 116, 79, 99, 233, 43, 130, 60, 244, 85, 229, 243, 172, 123, 148, 200, 120, 192, 127, 211, 52, 11, 159, 41, 95, 212, 230, 188, 169, 156, 137, 29, 212, 12, 148, 168, 148, 133, 243, 44, 241, 139, 127, 24, 246, 220, 227, 125, 209, 97, 60, 52, 162, 192, 146, 49, 161, 92, 138, 112, 189, 128, 59, 126, 125, 46, 207, 60, 79, 231, 174, 152, 209, 68, 223, 205, 2, 38, 14, 91, 116, 159, 255, 28, 27, 178, 248, 164, 104, 158, 79, 69, 214, 234, 157, 12, 75, 163, 83, 253, 245, 202, 61, 213, 176, 6, 197, 230, 29, 208, 166, 253, 194, 254, 235, 29, 141, 241, 70, 249, 15, 62, 0, 148, 163, 135, 52, 122, 40, 96, 87, 31, 179, 152, 51, 216, 133, 184, 122, 198, 203, 60, 115, 218, 191, 193, 16, 178, 25, 148, 252, 112, 104, 103, 252, 36, 92, 221, 28, 179, 43, 199, 198, 151, 128, 100, 252, 217, 161, 249, 34, 201, 172, 118, 52, 180, 252, 104, 7, 223, 44, 116, 102, 212, 21, 40, 224, 184, 55, 163, 210, 21, 207, 161, 239, 51, 54, 155, 41, 133, 18, 67, 48, 3, 165, 130, 251, 4, 79, 214, 57, 72, 130, 157, 212, 144];\n\n    function fe(e, t, n) {\n      var i = e.gl,\n          a = 5,\n          r = .1,\n          o = .5,\n          s = 175 / 180 * 3.141593,\n          c = 115 / 180 * 3.141593,\n          d = 173 / 180 * 3.141593,\n          u = 116 / 180 * 3.141593,\n          l = 2.04203545,\n          f = 0,\n          p = 0,\n          g = 0,\n          m = [],\n          v = [0, 1, 3, 4, 6, 7, 9, 10, 12, 13, 15, 16, 18, 19, 21, 22, 24, 26, 29, 31, 34, 36, 39, 41, 44, 46, 49, 51, 54, 56, 59, 61, 64, 65, 66, 67, 68, 69, 70, 72, 73, 74, 75, 76, 77, 79, 80, 81, 82, 83, 84, 85, 87, 88, 89, 90, 91, 92, 94, 95, 96, 97, 98, 99, 101, 102, 103, 104, 105, 106, 107, 109, 110, 111, 112, 113, 114, 116, 117, 118, 119, 120, 121, 123, 124, 125, 126, 127, 128, 129, 131, 132, 133, 134, 135, 136, 138, 139, 140, 141, 142, 143, 145, 146, 147, 148, 149, 150, 151, 153, 154, 155, 156, 157, 158, 160, 161, 162, 163, 164, 165, 166, 168, 169, 170, 171, 172, 173, 175, 176, 177, 178, 179, 180, 182, 183, 184, 185, 186, 187, 188, 190, 191, 192, 193, 194, 195, 197, 198, 199, 200, 201, 202, 204, 205, 206, 207, 208, 209, 210, 212, 213, 214, 215, 216, 217, 219, 220, 221, 222, 223, 224, 226, 226, 226, 227, 227, 227, 228, 228, 228, 229, 229, 229, 230, 230, 231, 231, 231, 232, 232, 232, 233, 233, 233, 234, 234, 235, 235, 235, 236, 236, 236, 237, 237, 237, 238, 238, 239, 239, 239, 240, 240, 240, 241, 241, 241, 242, 242, 243, 243, 243, 244, 244, 244, 245, 245, 245, 246, 246, 246, 247, 247, 247, 248, 248, 248, 249, 249, 249, 250, 250, 250, 251, 251, 251, 252, 252, 252, 253, 253, 253, 254, 254, 254, 255],\n          S = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 35, 36, 37, 39, 40, 42, 43, 44, 46, 47, 49, 50, 51, 53, 54, 56, 57, 58, 59, 61, 62, 63, 64, 66, 67, 68, 69, 71, 72, 73, 74, 76, 77, 78, 79, 81, 82, 83, 84, 86, 87, 88, 90, 91, 92, 93, 95, 96, 97, 98, 100, 101, 102, 103, 105, 106, 107, 108, 110, 111, 112, 113, 115, 116, 117, 118, 120, 121, 122, 124, 125, 126, 127, 129, 130, 131, 132, 134, 135, 136, 137, 139, 140, 141, 142, 144, 145, 146, 147, 149, 150, 151, 152, 154, 155, 156, 158, 159, 160, 161, 163, 164, 165, 166, 168, 169, 170, 171, 173, 174, 175, 176, 178, 179, 180, 181, 183, 184, 185, 186, 188, 189, 190, 192, 193, 194, 195, 197, 198, 199, 200, 202, 203, 204, 205, 207, 208, 209, 210, 212, 213, 214, 215, 217, 218, 219, 220, 222, 223, 224, 226, 226, 226, 227, 227, 228, 228, 229, 229, 230, 230, 231, 231, 232, 232, 233, 233, 234, 234, 234, 235, 235, 236, 236, 237, 237, 238, 238, 239, 239, 240, 240, 241, 241, 242, 242, 243, 243, 243, 244, 244, 244, 245, 245, 245, 246, 246, 246, 247, 247, 247, 248, 248, 248, 249, 249, 249, 250, 250, 250, 251, 251, 251, 252, 252, 252, 253, 253, 253, 254, 254, 254, 255],\n          h = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 39, 40, 41, 43, 44, 45, 46, 47, 48, 50, 51, 52, 53, 54, 55, 56, 58, 59, 60, 61, 62, 63, 65, 66, 67, 68, 69, 70, 72, 73, 74, 76, 77, 78, 80, 81, 83, 84, 85, 87, 88, 89, 91, 92, 94, 95, 96, 98, 99, 100, 102, 103, 105, 106, 107, 109, 110, 111, 113, 114, 116, 117, 118, 120, 121, 122, 124, 125, 127, 128, 129, 131, 132, 133, 135, 136, 138, 139, 140, 142, 143, 144, 146, 147, 149, 150, 151, 153, 154, 155, 157, 158, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 192, 193, 193, 194, 195, 195, 196, 197, 197, 198, 199, 199, 200, 201, 201, 202, 203, 203, 204, 205, 205, 206, 207, 207, 208, 209, 209, 210, 211, 211, 212, 213, 213, 214, 215, 215, 216, 217, 217, 218, 219, 219, 220, 221, 221, 222, 223, 223, 224, 225, 225, 226, 227, 227, 228, 229, 229, 230, 231, 231, 232, 233, 233, 234, 235, 235, 236, 237, 237, 238, 239, 239, 240, 241, 241, 242, 243, 243, 244, 245, 245, 246, 247, 247, 248, 249, 249, 250, 251, 251, 252, 253, 253, 254, 255];\n      this.program = ne(i, le), this.setUniforms = function () {\n        var t = i.getUniformLocation(this.program, \"u_flipY\"),\n            n = i.getUniformLocation(this.program, \"u_denoiseLevel\");\n        i.uniform1f(n, a), i.uniform1f(t, 1);\n        var v = i.getUniformLocation(this.program, \"light\");\n        i.uniform1f(v, r);\n        var S = i.getUniformLocation(this.program, \"redness\");\n        i.uniform1f(S, o);\n\n        var h = i.getUniformLocation(this.program, \"skin_he_max\"),\n            _ = i.getUniformLocation(this.program, \"skin_he_min\"),\n            E = i.getUniformLocation(this.program, \"skin_hc_max\"),\n            I = i.getUniformLocation(this.program, \"skin_hc_min\"),\n            T = i.getUniformLocation(this.program, \"skin_hc_axis\"),\n            y = i.getUniformLocation(this.program, \"facts_rotate_c\"),\n            b = i.getUniformLocation(this.program, \"facts_rotate_le\"),\n            R = i.getUniformLocation(this.program, \"facts_rotate_ge\");\n\n        i.uniform1f(h, s), i.uniform1f(_, c), i.uniform1f(E, d), i.uniform1f(I, u), i.uniform1f(T, l), i.uniform1f(y, f), i.uniform1f(b, p), i.uniform1f(R, g);\n        var A = i.getUniformLocation(this.program, \"u_originImage\");\n        i.activeTexture(i.TEXTURE2), i.bindTexture(i.TEXTURE_2D, e.inputTexture), i.uniform1i(A, 2);\n\n        for (var C = [\"lighten_lut\"], O = [i.TEXTURE3], N = 0; N < C.length; N++) {\n          var w = i.getUniformLocation(this.program, C[N]);\n          i.activeTexture(O[N]), i.bindTexture(i.TEXTURE_2D, m[N]), i.uniform1i(w, N + 3);\n        }\n      }, this.setParameters = function (e) {\n        void 0 !== e.denoiseLevel && (a = e.denoiseLevel), void 0 !== e.lightLevel && (r = e.lightLevel), void 0 !== e.rednessLevel && (o = e.rednessLevel, this._updateRedness(o)), void 0 !== e.lighteningContrastLevel && this._updateLut(e.lighteningContrastLevel);\n      }, this._updateRedness = function (e) {\n        var t,\n            n,\n            i = 3.141593,\n            a = e,\n            r = a;\n        a > 1 && (a = 1), a < 0 && (a = 0), r > 1 && (r = 1), r < 0 && (r = 0), f = .8 * a, r < .8 && (r = 0), (l = (117 - 4 * r) / 180 * i) < (u = (116 - 4 * r) / 180 * i) && (l = u), u < i / 2 && (u = i / 2), l < i / 2 && (l = i / 2), (c = (115 - 4 * r) / 180 * i) < i / 2 && (c = i / 2), (d = 173 / 180 * i) > i && (d = i), l > i && (l = i), (s = 175 / 180 * i) > i && (s = i), n = d - l, g = (t = s - d) > .01 ? f * n / t : f, n = l - u, p = (t = u - c) > .01 ? f * n / t : f;\n      }, this._updateLut = function (e) {\n        var t = null;\n        0 == e && (t = S), 1 == e && (t = h), 2 == e && (t = v);\n\n        for (var n = [new Uint8Array(t)], a = [256], r = [1], o = 0; o < n.length; o++) i.bindTexture(i.TEXTURE_2D, m[o]), i.texImage2D(i.TEXTURE_2D, 0, i.LUMINANCE, a[o], r[o], 0, i.LUMINANCE, i.UNSIGNED_BYTE, n[o]);\n      }, this._init = function () {\n        var e = null;\n        e = S;\n\n        for (var t = [new Uint8Array(e)], n = [256], a = [1], r = 0; r < t.length; r++) {\n          var o = i.createTexture();\n          i.bindTexture(i.TEXTURE_2D, o), i.texImage2D(i.TEXTURE_2D, 0, i.LUMINANCE, n[r], a[r], 0, i.LUMINANCE, i.UNSIGNED_BYTE, t[r]), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_S, i.CLAMP_TO_EDGE), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_WRAP_T, i.CLAMP_TO_EDGE), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_MIN_FILTER, i.LINEAR), i.texParameteri(i.TEXTURE_2D, i.TEXTURE_MAG_FILTER, i.LINEAR), m.push(o);\n        }\n      }, this._init();\n    }\n\n    var pe = !1;\n\n    function ge() {\n      this.programs = [];\n      var e = this,\n          t = null,\n          n = null;\n      e.gl = null, e.inputTexture = null;\n      var i = [],\n          a = [],\n          r = 0,\n          o = 0;\n      e._initGl = function (n, s) {\n        e.inputTexture = t.createTexture(), t.bindTexture(t.TEXTURE_2D, e.inputTexture), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.LINEAR), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.LINEAR);\n\n        for (var c = 0; c < 4; c++) {\n          var d = t.createTexture();\n          t.bindTexture(t.TEXTURE_2D, d), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.LINEAR), c < 2 ? t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, n, s, 0, t.RGBA, t.UNSIGNED_BYTE, null) : t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, s, n, 0, t.RGBA, t.UNSIGNED_BYTE, null);\n          var u = t.createFramebuffer();\n          t.bindFramebuffer(t.FRAMEBUFFER, u), t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, d, 0), i.push(d), a.push(u);\n        }\n\n        t.viewport(0, 0, n, s), r = n, o = s;\n      }, e.render = function (s) {\n        if (t) {\n          var c = 0;\n          o == s.videoWidth && r === s.videoHeight && (c = 2), t.viewport(0, 0, s.videoWidth, s.videoHeight), t.bindTexture(t.TEXTURE_2D, e.inputTexture), t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.RGBA, t.UNSIGNED_BYTE, s);\n\n          for (var d = pe ? e.programs.length - 1 : 0, u = 0; u <= d; u++) {\n            var l = e.programs[u].program;\n            t.useProgram(l);\n            var f = t.getUniformLocation(l, \"u_image\");\n            e.programs[u].setUniforms(), t.bindFramebuffer(t.FRAMEBUFFER, a[c + u % 2]), t.clearColor(0, 0, 0, 1), t.clear(t.COLOR_BUFFER_BIT), t.drawArrays(t.TRIANGLES, 0, 6), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, i[c + u % 2]), t.uniform1i(f, 0);\n          }\n\n          t.useProgram(n);\n          var p = t.getUniformLocation(n, \"u_flipY\");\n          t.uniform1f(p, -1), t.bindFramebuffer(t.FRAMEBUFFER, null), t.clearColor(0, 0, 0, 1), t.clear(t.COLOR_BUFFER_BIT), t.drawArrays(t.TRIANGLES, 0, 6);\n        }\n      }, e.setEnableBeauty = function (e) {\n        pe = e;\n      }, e.init = function (i, a, r) {\n        if (\"undefined\" == typeof WebGLRenderingContext) throw new Error(\"NOT_SUPPORT\");\n        t = r.getContext(\"webgl\"), e.gl = t, e._initGl(i, a), e.programs.push(new ae(this, i, a)), e.programs.push(new oe(this, i, a)), e.programs.push(new ce(this, i, a)), e.programs.push(new ue(this, i, a)), e.programs.push(new fe(this, i, a)), n = e.programs[0].program;\n      }, e.release = function () {\n        e.gl = null, t = null, n = null, e.inputTexture = null, e.programs = [], i = [], a = [];\n      }, e.setDenoiseLevel = function (t) {\n        e.programs.forEach(function (e) {\n          e.setParameters && e.setParameters({\n            denoiseLevel: t\n          });\n        });\n      }, e.setLightLevel = function (t) {\n        e.programs.forEach(function (e) {\n          e.setParameters && e.setParameters({\n            lightLevel: t\n          });\n        });\n      }, e.setRednessLevel = function (t) {\n        e.programs.forEach(function (e) {\n          e.setParameters && e.setParameters({\n            rednessLevel: t\n          });\n        });\n      }, e.setContrastLevel = function (t) {\n        e.programs.forEach(function (e) {\n          e.setParameters && e.setParameters({\n            lighteningContrastLevel: t\n          });\n        });\n      }, e.setSize = function (t, n) {\n        e.programs.forEach(function (e) {\n          e.setSize && e.setSize(t, n);\n        });\n      };\n    }\n\n    ge._instance = null, ge.getInstance = function () {\n      return ge._instance || (ge._instance = new ge()), ge._instance;\n    };\n\n    var me = {\n      addVideoEffectCapability: function (e) {\n        e.videoEffect = {\n          canvas: null,\n          video: null,\n          fps: 30,\n          stopChromeBackgroundLoop: null,\n          enableBeauty: !1,\n          denoiseLevel: 5,\n          lightLevel: .35,\n          rednessLevel: .5,\n          lighteningContrastLevel: 1,\n          videoContextInited: !1,\n          originVideoTrack: null,\n          canvasVideoTrack: null,\n          ctx: null\n        }, e._initVideoContext = function () {\n          if (e.videoEffect.videoContextInited) throw new Error(\"Failed to init video context. Already inited\");\n          if (!e.stream) throw new Error(\"Failed to init video context. Local Stream not initialized\");\n          e.videoEffect.originVideoTrack = e.stream.getVideoTracks()[0], e.attributes && e.attributes.maxFrameRate && (e.videoEffect.fps = e.attributes.maxFrameRate), e.videoEffect.videoContextInited = !0;\n        }, e._renderWithWebGL = function (t) {\n          return new Promise(function (n) {\n            e.videoEffect.canvas || (e.videoEffect.canvas = document.createElement(\"canvas\")), e.videoEffect.video || (e.videoEffect.video = document.createElement(\"video\")), e.videoEffect.video.setAttribute(\"autoplay\", \"\"), e.videoEffect.video.setAttribute(\"muted\", \"\"), e.videoEffect.video.muted = !0, e.videoEffect.video.setAttribute(\"playsinline\", \"\"), e.videoEffect.video.setAttribute(\"style\", \"display:none\"), e.videoEffect.video.srcObject = t;\n            var i = t.getVideoTracks()[0].getSettings(),\n                a = i.width,\n                r = i.height;\n            console.log(\"Width: \".concat(a, \", Height: \").concat(r)), e.videoEffect.canvas.setAttribute(\"width\", a), e.videoEffect.canvas.setAttribute(\"height\", r), e.videoEffect.video.setAttribute(\"width\", a), e.videoEffect.video.setAttribute(\"height\", r);\n            var o = ge.getInstance();\n            o.init(e.videoEffect.video.width, e.videoEffect.video.height, e.videoEffect.canvas), o.setDenoiseLevel(e.videoEffect.denoiseLevel), o.setLightLevel(e.videoEffect.lightLevel), o.setRednessLevel(e.videoEffect.rednessLevel), o.setContrastLevel(e.videoEffect.lighteningContrastLevel), e.videoEffect.video.addEventListener(\"playing\", function t() {\n              var i = e.videoEffect.canvas.captureStream(e.videoEffect.fps);\n              e.videoEffect.video.removeEventListener(\"playing\", t, !0), n([i.getVideoTracks()[0], e.videoEffect.video]);\n            }, !0), e.videoEffect.video.play();\n          });\n        }, e._disableEffect = function () {\n          e.videoEffect.videoContextInited || e._initVideoContext();\n          var t = e.videoEffect.originVideoTrack;\n          if (!t) return o.default.warning(\"Video track is null, fail to disable video effect!\"), Promise.resolve();\n\n          if (e.pc && e.pc.peerConnection && e.pc.peerConnection) {\n            var n = (e.pc.peerConnection && e.pc.peerConnection.getSenders()).find(function (e) {\n              return e && e.track && \"video\" == e.track.kind;\n            });\n            if (n && n.replaceTrack && t) return n.replaceTrack(t);\n          }\n\n          return Promise.resolve();\n        }, e._releaseEffect = function () {\n          var t;\n          return t = e.videoEffect.enableBeauty ? e._disableEffect() : Promise.resolve(), ge.getInstance().release(), e.videoEffect.videoContextInited = !1, e.videoEffect.canvasVideoTrack = null, t;\n        }, e._enableEffect = function () {\n          return e.videoEffect.videoContextInited || e._initVideoContext(), e.videoEffect.originVideoTrack ? (e.videoEffect.canvasVideoTrack ? (e._showEffectInLocalPlayer(), e._replaceWithCanvasTrack()) : e._renderWithWebGL(e.stream).then(function (t) {\n            var n = X()(t, 2),\n                i = n[0],\n                a = n[1];\n            e.videoEffect.canvasVideoTrack = i;\n            var r = ge.getInstance();\n            requestAnimationFrame(function t() {\n              e.videoEffect.enableBeauty && r.render(a), e.videoEffect.videoContextInited && requestAnimationFrame(t);\n            }), g.isChrome() && document.addEventListener(\"visibilitychange\", function () {\n              document.hidden, document.hidden ? e.videoEffect.stopChromeBackgroundLoop = function (e, t) {\n                var n = 1 / t,\n                    i = new AudioContext(),\n                    a = i.createGain();\n                a.gain.value = 0, a.connect(i.destination), function t() {\n                  var o = i.createOscillator();\n                  o.onended = t, o.connect(a), o.start(0), o.stop(i.currentTime + n), e(i.currentTime), r && (o.onended = function () {\n                    i.close();\n                  });\n                }();\n                var r = !1;\n                return function () {\n                  r = !0;\n                };\n              }(function () {\n                e.videoEffect.enableBeauty && r.render(a);\n              }, e.videoEffect.fps) : e.videoEffect.stopChromeBackgroundLoop && (e.videoEffect.stopChromeBackgroundLoop(), e.videoEffect.stopChromeBackgroundLoop = null);\n            }, !1), e._showEffectInLocalPlayer(), e._replaceWithCanvasTrack();\n          }), Promise.resolve()) : (o.default.warning(\"Video track is null, fail to enable video effect!\"), Promise.resolve());\n        }, e._showEffectInLocalPlayer = function () {\n          if (e.player) {\n            var t = e.player.div.children[0];\n\n            if (\"none\" !== t.style.display && (e.player.div.appendChild(e.videoEffect.canvas), \"video\" === t.tagName.toLowerCase())) {\n              var n = t.getAttribute(\"style\");\n              e.videoEffect.canvas.setAttribute(\"style\", n), \"none\" !== t.style.display && (t.style.display = \"none\");\n            }\n          }\n        }, e._removeEffectFromLocalPlayer = function () {\n          if (e.player && e.player.div && e.videoEffect.enableBeauty && e.videoEffect.canvas) {\n            e.player.div.removeChild(e.videoEffect.canvas);\n            var t = e.player.div.children[0];\n            \"video\" === t.tagName.toLowerCase() && (e.videoEffect.canvas.style.display = \"none\", t.style.display = \"block\");\n          }\n        }, e._replaceWithCanvasTrack = function () {\n          var t = null;\n          e.pc && e.pc.peerConnection && e.pc.peerConnection && (t = (e.pc.peerConnection && e.pc.peerConnection.getSenders()).find(function (e) {\n            return e && e.track && \"video\" == e.track.kind;\n          })), t && t.replaceTrack && e.videoEffect.canvasVideoTrack && t.replaceTrack(e.videoEffect.canvasVideoTrack);\n        }, e.setBeautyEffectOptions = (t = K()(Y.a.mark(function t(n, i) {\n          var a,\n              r = arguments;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                if (Object(H.checkValidBoolean)(n, \"enabled\"), a = ge.getInstance(), e.videoEffect.enableBeauty == n) {\n                  t.next = 14;\n                  break;\n                }\n\n                if (a.setEnableBeauty(n), !n) {\n                  t.next = 9;\n                  break;\n                }\n\n                return t.next = 7, e._enableEffect();\n\n              case 7:\n                t.next = 12;\n                break;\n\n              case 9:\n                return e._removeEffectFromLocalPlayer(), t.next = 12, e._releaseEffect();\n\n              case 12:\n                e.videoEffect.enableBeauty = n, s.b.reportApiInvoke(e.sid, {\n                  callback: null,\n                  options: r,\n                  name: \"Stream.setBeautyEffectOptions\",\n                  tag: \"tracer\"\n                });\n\n              case 14:\n                if (n) {\n                  t.next = 16;\n                  break;\n                }\n\n                return t.abrupt(\"return\");\n\n              case 16:\n                if (!i) {\n                  t.next = 20;\n                  break;\n                }\n\n                Object(H.checkValidObject)(i, \"options\"), t.next = 21;\n                break;\n\n              case 20:\n                return t.abrupt(\"return\");\n\n              case 21:\n                if (void 0 !== i.smoothnessLevel && (Object(H.checkValidFloatNumber)(i.smoothnessLevel, \"smoothnessLevel\", 0, 1), e.videoEffect.denoiseLevel = 10 * i.smoothnessLevel, e.videoEffect.denoiseLevel < .1 && (e.videoEffect.denoiseLevel = .1), a.setDenoiseLevel(e.videoEffect.denoiseLevel)), void 0 !== i.lighteningLevel && (Object(H.checkValidFloatNumber)(i.lighteningLevel, \"lighteningLevel\", 0, 1), e.videoEffect.lightLevel = i.lighteningLevel / 2, e.videoEffect.lightLevel < .01 && (e.videoEffect.lightLevel = .01), a.setLightLevel(e.videoEffect.lightLevel)), void 0 !== i.rednessLevel && (Object(H.checkValidFloatNumber)(i.rednessLevel, \"rednessLevel\", 0, 1), e.videoEffect.rednessLevel = i.rednessLevel, e.videoEffect.rednessLevel < .01 && (e.videoEffect.rednessLevel = .01), a.setRednessLevel(e.videoEffect.rednessLevel)), void 0 === i.lighteningContrastLevel) {\n                  t.next = 29;\n                  break;\n                }\n\n                if (0 === i.lighteningContrastLevel || 1 === i.lighteningContrastLevel || 2 === i.lighteningContrastLevel) {\n                  t.next = 27;\n                  break;\n                }\n\n                throw new Error(\"Invalid lighteningContrastLevel: The value should be 0, 1 or 2.\");\n\n              case 27:\n                e.videoEffect.lighteningContrastLevel = parseFloat(i.lighteningContrastLevel), a.setContrastLevel(e.videoEffect.lighteningContrastLevel);\n\n              case 29:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this);\n        })), function (e, n) {\n          return t.apply(this, arguments);\n        });\n        var t;\n      },\n      restoreVideoEffect: function (e) {\n        return e.videoEffect.enableBeauty ? e._enableEffect() : Promise.resolve();\n      },\n      disableVideoEffect: function (e) {\n        return e._releaseEffect ? e._releaseEffect() : Promise.resolve();\n      },\n      applyEffectInPlayer: function (e) {\n        e.videoEffect.enableBeauty && e.videoEffect.canvas && e._showEffectInLocalPlayer();\n      },\n      removeEffectFromLocalPlayer: function (e) {\n        e._removeEffectFromLocalPlayer();\n      },\n      replaceWithCanvasTrack: function (e) {\n        e.videoEffect.enableBeauty && e._replaceWithCanvasTrack();\n      },\n      checkVideoEffectEnabled: function (e) {\n        if (e.videoEffect.enableBeauty && e.videoEffect && e.videoEffect.videoContextInited) return o.default.error(\"Operation not permitted: \".concat(\"VIDEO_EFFECT_ENABLED\")), \"VIDEO_EFFECT_ENABLED\";\n        return !1;\n      }\n    },\n        ve = a(9),\n        Se = a.n(ve),\n        he = function (e) {\n      Object(H.checkValidString)(e, \"profileName\"), -1 === (e = e.toLowerCase()).indexOf(\"_\") && (e += \"_1\"), Object(H.checkValidEnum)(e, \"profileName\", Object.keys(r.SUPPORT_RESOLUTION_LIST));\n      var t = r.SUPPORT_RESOLUTION_LIST[e];\n      t || (e = Object(r.getParameter)(\"DEFAULT_PROFILE\"), t = r.SUPPORT_RESOLUTION_LIST[e]);\n      var n = {\n        profileName: e,\n        video: {\n          width: t[0],\n          height: t[1]\n        },\n        attributes: {\n          resolution: \"\".concat(t[0], \"x\").concat(t[1]),\n          minFrameRate: t[2],\n          maxFrameRate: t[3],\n          minVideoBW: t[4],\n          maxVideoBW: t[5]\n        }\n      };\n      return t[2] && t[3] && (n.video.frameRate = {\n        ideal: t[2],\n        max: t[3]\n      }), t[6] && t[7] && (n.screen = {\n        width: t[0],\n        height: t[1],\n        frameRate: {\n          min: t[6],\n          max: t[7]\n        }\n      }), n;\n    },\n        _e = function (e) {\n      return Object.keys(r.SUPPORT_RESOLUTION_LIST).filter(function (t) {\n        var n = r.SUPPORT_RESOLUTION_LIST[t],\n            i = [\"width\", \"height\", \"frameRate\"];\n\n        for (var a in i) {\n          var o = i[a];\n\n          if (e[o] && n[a]) {\n            if (\"number\" == typeof e[o].max && e[o].max < n[a]) return !1;\n            if (\"number\" == typeof e[o].min && e[o].min > n[a]) return !1;\n          }\n        }\n\n        return !0;\n      }).reverse();\n    },\n        Ee = function (e) {\n      var t = r.AUDIO_PROFILE_SETTINGS[e] || r.AUDIO_PROFILE_SETTINGS.default;\n      return {\n        highQuality: t[0],\n        stereo: t[1],\n        speech: t[2],\n        lowQuality: t[3]\n      };\n    };\n\n    var Ie = function (e) {\n      var t = c();\n      if (t.params = h()({}, e), t.stream = e.stream, t.url = e.url, t.onClose = void 0, t.local = !1, t.videoSource = e.videoSource, t.audioSource = e.audioSource, e.video = !(!e.videoSource && !e.video), t.video = e.video, e.audio = !(!e.audioSource && !e.audio), t.audio = e.audio, t.screen = !!e.screen, t.screenAudio = !!e.screenAudio, t.screenAttributes = {\n        width: 1920,\n        height: 1080,\n        maxFr: 5,\n        minFr: 1\n      }, t.videoSize = e.videoSize, t.player = void 0, t.audioLevelHelper = null, e.attributes = e.attributes || {}, t.attributes = e.attributes, t.microphoneId = e.microphoneId, t.cameraId = e.cameraId, t.facingMode = e.facingMode, t.inSwitchDevice = !1, t.userMuteVideo = !1, t.userMuteAudio = !1, t.peerMuteVideo = !1, t.peerMuteAudio = !1, t.lowStream = null, t.videoWidth = 0, t.videoHeight = 0, t.streamId = e.streamID, t.userId = null, t.uintId = e.uintUID || null, t.mirror = !1 !== e.mirror, t.DTX = e.audioProcessing && e.audioProcessing.DTX, t.audioProcessing = e.audioProcessing, t.highQuality = !1, t.stereo = !1, t.speech = !1, t.screen || delete t.screen, !(void 0 === t.videoSize || t.videoSize instanceof Array && 4 === t.videoSize.length)) throw Error(\"Invalid Video Size\");\n\n      function n() {\n        var e = {};\n        t.getVideoTrack() === this ? (o.default.debug(\"Video Track Ended\"), e.type = \"videoTrackEnded\", e.track = this) : t.getAudioTrack() === this ? (o.default.debug(\"Audio Track Ended\"), e.type = \"audioTrackEnded\", e.track = this) : o.default.debug(\"Detached Track ended\", this.kind, this.label, this), e.type && t.dispatchEvent(e);\n      }\n\n      return t.videoSize = [640, 480, 640, 480], void 0 !== e.local && !0 !== e.local || (t.local = !0), t.initialized = !t.local, t._streamInitID = null, function (e) {\n        e.audioMixing = {\n          audioContextInited: !1,\n          defaultVolume: 100,\n          inEarMonitoring: \"FILE\",\n          sounds: {},\n          states: {\n            IDLE: \"IDLE\",\n            STARTING: \"STARTING\",\n            BUSY: \"BUSY\",\n            PAUSED: \"PAUSED\"\n          },\n          inEarMonitoringModes: {\n            NONE: \"NONE\",\n            FILE: \"FILE\",\n            MICROPHONE: \"MOCROPHONE\",\n            ALL: \"ALL\"\n          },\n          ctx: null,\n          mediaStreamSource: null,\n          mediaStreamDest: null,\n          buffer: {}\n        }, e._initSoundIfNotExists = function (t, n) {\n          e.audioMixing.sounds[t] || (e.audioMixing.sounds[t] = {\n            soundId: t,\n            state: \"IDLE\",\n            muted: e.userMuteAudio,\n            filePath: n,\n            volume: e.audioMixing.defaultVolume,\n            startAt: null,\n            startOffset: null,\n            pauseAt: null,\n            pauseOffset: null,\n            resumeAt: null,\n            resumeOffset: null,\n            stopAt: null,\n            options: null,\n            source: null\n          });\n        }, e._initSoundIfNotExists(-1), e.loadAudioBuffer = function (t, n, i) {\n          var a = s.b.reportApiInvoke(e.sid, {\n            callback: i,\n            name: \"Stream.loadAudioBuffer\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          Object(H.checkValidString)(n, \"url\", 1, 1024, !1), Object(H.checkValidString)(t, \"id\", 1, 1024, !1);\n\n          var r = function (t) {\n            o.default.error(\"[\".concat(e.streamId, \"] loadAudioBuffer Failed: \") + t), a(I.default.LOAD_AUDIO_FAILED);\n          },\n              c = new XMLHttpRequest();\n\n          c.open(\"GET\", n, !0), c.responseType = \"arraybuffer\", c.onload = function () {\n            if (c.status > 400) r(\"\".concat(c.status, \" \").concat(c.statusText));else {\n              var n = c.response;\n              e.audioMixing.audioContextInited || e._initAudioContext(), e.audioMixing.ctx.decodeAudioData(n, function (n) {\n                e.audioMixing.buffer[t] = n, a(null);\n              }, function (t) {\n                o.default.error(\"[\".concat(e.streamId, \"] decodeAudioData Failed: \"), t), a(t);\n              });\n            }\n          }, c.onerror = function () {\n            return r(\"load error\");\n          }, c.ontimeout = function () {\n            return r(\"timeout\");\n          }, c.send();\n        }, e.createAudioBufferSource = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.createAudioBufferSource\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n\n          if (e.audioMixing.buffer[t.id]) {\n            var i = e.audioMixing.buffer[t.id],\n                a = e.audioMixing.ctx.createBufferSource();\n            a.buffer = i;\n            var r = e.audioMixing.ctx.createGain();\n            if (a.connect(r), r.connect(e.audioMixing.mediaStreamDest), a.gainNode = r, t.loop) a.loop = !0, a.start(0, t.playTime / 1e3);else if (t.cycle > 1) {\n              if (Object(g.isChrome)()) {\n                a.loop = !0;\n                var c = t.cycle * i.duration * 1e3 - (t.playTime || 0);\n                a.start(0, t.playTime / 1e3, c / 1e3);\n              } else o.default.warning(\"[\".concat(e.streamId, \"] Cycle Param is ignored by current browser\")), a.start(0, t.playTime / 1e3);\n            } else a.start(0, t.playTime / 1e3);\n            var d = e.audioMixing.sounds[t.soundId];\n            return d.source = a, e._flushAudioMixingMuteStatus(), a.addEventListener(\"ended\", function () {\n              a === d.source && e.dispatchEvent({\n                type: \"audioSourceEnded\",\n                soundId: t.soundId,\n                source: a,\n                sound: d\n              });\n            }), n(), a;\n          }\n\n          return o.default.error(\"[\".concat(e.streamId, \"] \"), \"AUDIOBUFFER_NOT_FOUND\", t.id), n(!1), !1;\n        }, e.on(\"audioSourceEnded\", function (t) {\n          var n = t.source,\n              i = t.sound;\n          i && i.state === e.audioMixing.states.BUSY && !i.pauseAt && (i.state = e.audioMixing.states.IDLE, i.startAt = null, i.startOffset = null, i.resumeAt = null, i.resumeOffset = null, n.gainNode && n.gainNode.disconnect && n.gainNode.disconnect(), n.buffer = null, e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest));\n        }), e.clearAudioBufferSource = function () {\n          e.audioBufferSource.forEach(function (e) {\n            e.stop();\n          });\n        }, e._isSoundExists = function (t) {\n          return !!e.audioMixing.sounds[t.soundId] || (o.default.error(\"SoundId not exists. #\".concat(t.soundId)), !1);\n        }, e._initAudioContext = function () {\n          if (e.audioMixing.audioContextInited) throw new Error(\"Failed to init audio context. Already inited\");\n          if (!e.stream) throw new Error(\"Failed to init audio context. Local Stream not initialized\");\n          e.audioMixing.ctx = Object(G.a)(), e.audioMixing.mediaStreamSource = e.audioMixing.ctx.createMediaStreamSource(e.stream), e.audioMixing.mediaStreamDest = e.audioMixing.ctx.createMediaStreamDestination(), e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest);\n          var t = e.stream.getVideoTracks()[0];\n\n          if (t && e.audioMixing.mediaStreamDest.stream.addTrack(t), e._isAudioMuted() ? (e._unmuteAudio(), e.stream = e.audioMixing.mediaStreamDest.stream, e._muteAudio()) : e.stream = e.audioMixing.mediaStreamDest.stream, e.audioLevelHelper = null, e.pc && e.pc.peerConnection && e.pc.peerConnection) {\n            var n = (e.pc.peerConnection && e.pc.peerConnection.getSenders()).find(function (e) {\n              return e && e.track && \"audio\" == e.track.kind;\n            }),\n                i = e.audioMixing.mediaStreamDest.stream.getAudioTracks()[0];\n            n && n.replaceTrack && i && n.replaceTrack(i);\n          }\n\n          e.audioMixing.audioContextInited = !0;\n        }, e._cleanupAudioMixing = function () {\n          if (e.audioMixing.audioContextInited) {\n            for (var t in e.audioMixing.sounds) {\n              var n = e.audioMixing.sounds[t];\n              n.state !== e.audioMixing.states.BUSY && n.state !== e.audioMixing.states.PAUSED || e._stopOneEffect({\n                soundId: t\n              });\n            }\n\n            e.audioLevelHelper = null, e.audioMixing.audioContextInited = !1;\n          }\n        }, e._reloadInEarMonitoringMode = function (t) {\n          if (t) {\n            if (!e.audioMixing.inEarMonitoringModes[t]) return o.default.error(\"[\".concat(e.streamId, \"] Invalid InEarMonitoringMode \").concat(t));\n            e.audioMixing.inEarMonitoring = t;\n          }\n\n          switch (e.audioMixing.audioContextInited || e._initAudioContext(), e.audioMixing.inEarMonitoring) {\n            case e.audioMixing.inEarMonitoringModes.FILE:\n              e.audioMixing.mediaStreamSource.connectedToDestination && (e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.ctx.destination), e.audioMixing.mediaStreamSource.connectedToDestination = !1);\n\n            case e.audioMixing.inEarMonitoringModes.ALL:\n              for (var n in e.audioMixing.sounds) {\n                var i = e.audioMixing.sounds[n];\n                i && i.source && !i.source.connectedToDestination && (i.source.gainNode.connect(e.audioMixing.ctx.destination), i.source.connectedToDestination = !0);\n              }\n\n          }\n\n          switch (e.audioMixing.inEarMonitoring) {\n            case e.audioMixing.inEarMonitoringModes.MICROPHONE:\n              e.audioMixing.source.forEach(function (t) {\n                t.connectedToDestination && (t.gainNode.disconnect(e.audioMixing.ctx.destination), t.connectedToDestination = !1);\n              });\n\n            case e.audioMixing.inEarMonitoringModes.ALL:\n              e.audioMixing.mediaStreamSource.connectedToDestination || (e.audioMixing.mediaStreamSource.connect(e.audioMixing.ctx.destination), e.audioMixing.mediaStreamSource.connectedToDestination = !0);\n          }\n        }, e._startAudioMixingBufferSource = function (t) {\n          e.audioMixing.audioContextInited || e._initAudioContext();\n          var n = {\n            soundId: t.soundId,\n            id: t.filePath,\n            loop: t.loop,\n            cycle: t.cycle,\n            playTime: t.playTime || 0\n          },\n              i = t.replace,\n              a = e.createAudioBufferSource(n);\n          return a.sound = e.audioMixing.sounds[t.soundId], a ? (a.addEventListener(\"ended\", e._audioMixingFinishedListener, {\n            once: !0\n          }), e._reloadInEarMonitoringMode(), i && e.audioMixing.mediaStreamSource.disconnect(e.audioMixing.mediaStreamDest), a) : null;\n        }, e._stopAudioMixingBufferSource = function (t) {\n          var n = e.audioMixing.sounds[t.soundId].source;\n          return n ? (n.removeEventListener(\"ended\", e._audioMixingFinishedListener), e.audioMixing.mediaStreamSource.connect(e.audioMixing.mediaStreamDest), n.stop(), n.gainNode && n.gainNode.disconnect && n.gainNode.disconnect(), n.buffer = null, n) : null;\n        }, e._flushAudioMixingMuteStatus = function (t) {\n          for (var n in e.audioMixing.sounds) {\n            var i = e.audioMixing.sounds[n];\n            i && (void 0 !== t && (i.muted = !!t), i.source && (i.muted ? i.source.gainNode.gain.value = 0 : i.source.gainNode.gain.value = i.volume / 100));\n          }\n        }, e._handleAudioMixingInvalidStateError = function (t, n, i) {\n          var a = e.audioMixing.sounds[n.soundId],\n              r = -1 === n.soundId ? \"INVALID_AUDIO_MIXING_STATE\" : \"INVALID_PLAY_EFFECT_STATE\";\n          o.default.error(\"[\".concat(e.streamId, \"] Cannot \").concat(t, \": \").concat(r, \", state is \").concat(a.state)), i && i(r);\n        }, e._handleAudioMixingNoSourceError = function (t, n, i) {\n          e.audioMixing.sounds[n.soundId].state = e.audioMixing.states.IDLE;\n          var a = -1 === n.soundId ? \"NO_AUDIO_MIXING_SOURCE\" : \"NO_EFFECT_SOURCE\";\n          o.default.error(\"[\".concat(e.streamId, \"] Cannot \").concat(t, \": \").concat(a)), i && i(a);\n        }, e._getOneEffectStates = function (t) {\n          var n = e.audioMixing.sounds[t.soundId];\n          return function () {\n            return n ? {\n              state: n.state,\n              startAt: n.startAt,\n              resumeAt: n.resumeAt,\n              pauseOffset: n.pauseOffset,\n              pauseAt: n.pauseAt,\n              resumeOffset: n.resumeOffset,\n              stopAt: n.stopAt,\n              duration: e._getOneEffectDuration(t),\n              position: e._getOneEffectCurrentPosition(t)\n            } : {};\n          };\n        }, e._audioMixingFinishedListener = function () {\n          var t = this.sound;\n          t.state === e.audioMixing.states.IDLE && e.audioMixing.buffer[t.options.filePath] && !t.options.cacheResource && (o.default.debug(\"Recycled buffer \".concat(t.options.filePath)), delete e.audioMixing.buffer[t.options.filePath]), -1 === t.soundId && e.dispatchEvent({\n            type: \"audioMixingFinished\"\n          });\n        }, e._playOneEffect = function (t, n) {\n          Object(H.checkValidObject)(t, \"options\");\n          var i = t.soundId,\n              a = (t.filePath, t.cacheResource);\n\n          if (t.cycle, t.loop, t.playTime, t.replace, Object(g.isSafari)() && Object(g.getBrowserVersion)() < 12) {\n            var r = \"BROWSER_NOT_SUPPORT\";\n            return o.default.error(\"[\".concat(e.streamId, \"] Cannot _playOneEffect: \"), r), n(r);\n          }\n\n          e.audioMixing.audioContextInited || e._initAudioContext(), e._initSoundIfNotExists(i);\n          var s = e.audioMixing.sounds[i];\n\n          if (s.state === e.audioMixing.states.IDLE) {\n            if (void 0 !== t.cycle && !t.cycle > 0) return r = \"Invalid Parmeter cycle: \" + t.cycle, o.default.error(\"[\".concat(e.streamId, \"] \").concat(i), r), n(r);\n\n            if (Object(H.isEmpty)(a) && (t.cacheResource = !0), s.state = e.audioMixing.states.STARTING, s.options = t, e.audioMixing.buffer[t.filePath]) {\n              var c = e._startAudioMixingBufferSource(t);\n\n              if (c) return s.source = c, s.startAt = Date.now(), s.resumeAt = null, s.pauseOffset = null, s.pauseAt = null, s.resumeOffset = null, s.stopAt = null, s.startOffset = t.playTime || 0, s.state = e.audioMixing.states.BUSY, e._flushAudioMixingMuteStatus(), n(null);\n              s.state = e.audioMixing.states.IDLE;\n              var d = \"CREATE_BUFFERSOURCE_FAILED\";\n              if (n) return n(d);\n              o.default.error(\"[\".concat(e.streamId, \"] \"), d);\n            } else e.loadAudioBuffer(t.filePath, t.filePath, function (i) {\n              if (i) s.state = e.audioMixing.states.IDLE, n ? n(i) : o.default.error(\"[\".concat(e.streamId, \"] \"), i);else {\n                var a = e._startAudioMixingBufferSource(t);\n\n                if (a) return s.source = a, s.startAt = Date.now(), s.resumeAt = null, s.pauseOffset = null, s.pauseAt = null, s.resumeOffset = null, s.stopAt = null, s.startOffset = t.playTime || 0, s.state = e.audioMixing.states.BUSY, e._flushAudioMixingMuteStatus(), n(null);\n                if (s.state = e.audioMixing.states.IDLE, i = \"CREATE_BUFFERSOURCE_FAILED\", n) return n(i);\n                o.default.error(\"[\".concat(e.streamId, \"] \"), i);\n              }\n            });\n          } else e._handleAudioMixingInvalidStateError(\"_playEffect\", t, n);\n        }, e._stopOneEffect = function (t, n) {\n          var i = e.audioMixing.sounds[t.soundId];\n          return e._isSoundExists(t) ? i.state === e.audioMixing.states.BUSY || i.state === e.audioMixing.states.PAUSED ? (e._stopAudioMixingBufferSource(t), i.stopAt = Date.now(), i.state = e.audioMixing.states.IDLE, e.audioMixing.buffer[i.options.filePath] && !i.options.cacheResource && (o.default.debug(\"Recycled buffer \".concat(i.options.filePath)), delete e.audioMixing.buffer[i.options.filePath]), void (n && n(null))) : void e._handleAudioMixingInvalidStateError(\"_stopOneEffect\", t, n) : n(\"SOUND_NOT_EXISTS\");\n        }, e._pauseOneEffect = function (t, n) {\n          var i = e.audioMixing.sounds[t.soundId];\n          if (i.state === e.audioMixing.states.BUSY) return e._stopAudioMixingBufferSource(t) ? (i.pauseAt = Date.now(), i.state = e.audioMixing.states.PAUSED, i.resumeAt ? i.pauseOffset = i.pauseAt - i.resumeAt + i.resumeOffset : i.pauseOffset = i.pauseAt - i.startAt + i.startOffset, n && n(null)) : void e._handleAudioMixingNoSourceError(\"_pauseOneEffect\", t, n);\n\n          e._handleAudioMixingInvalidStateError(\"_pauseOneEffect\", t, n);\n        }, e._resumeOneEffect = function (t, n) {\n          var i = e.audioMixing.sounds[t.soundId];\n\n          if (i.state === e.audioMixing.states.PAUSED) {\n            var a = {\n              soundId: t.soundId,\n              filePath: i.options.filePath,\n              cycle: i.options.cycle,\n              loop: i.options.loop,\n              playTime: i.pauseOffset,\n              replace: i.options.replace\n            },\n                r = e._startAudioMixingBufferSource(a);\n\n            if (!r) {\n              var s = \"CREATE_BUFFERSOURCE_FAILED\";\n              return n(s), void o.default.error(\"[\".concat(e.streamId, \"] \"), s);\n            }\n\n            i.source = r, i.resumeAt = Date.now(), i.resumeOffset = i.pauseOffset, i.state = e.audioMixing.states.BUSY, i.pauseAt = null, i.pauseOffset = null, n(null);\n          } else e._handleAudioMixingInvalidStateError(\"_resumeOneEffect\", t, n);\n        }, e._getOneEffectDuration = function (t) {\n          var n = e.audioMixing.sounds[t.soundId];\n          return n.options && n.options.filePath && e.audioMixing.buffer[n.options.filePath] ? 1e3 * e.audioMixing.buffer[n.options.filePath].duration : null;\n        }, e._getOneEffectCurrentPosition = function (t, n) {\n          var i = e.audioMixing.sounds[t.soundId];\n          return i.state === e.audioMixing.states.PAUSED ? i.pauseOffset % e._getOneEffectDuration(t) : i.state === e.audioMixing.states.BUSY ? i.resumeAt ? (Date.now() - i.resumeAt + i.resumeOffset) % e._getOneEffectDuration(t) : (Date.now() - i.startAt + i.startOffset) % e._getOneEffectDuration(t) : void (n && e._handleAudioMixingInvalidStateError(\"_getOneEffectCurrentPosition\", t));\n        }, e._setOneEffectPosition = function (t, n, i) {\n          var a = e.audioMixing.sounds[t.soundId];\n\n          if (a.state === e.audioMixing.states.BUSY) {\n            if (!e._stopAudioMixingBufferSource(t)) return void e._handleAudioMixingNoSourceError(\"_setOneEffectPosition\", t, i);\n\n            var r = {\n              soundId: t.soundId,\n              filePath: a.options.filePath,\n              loop: a.options.loop,\n              cycle: a.options.cycle,\n              playTime: n\n            },\n                s = e._startAudioMixingBufferSource(r);\n\n            if (!s) {\n              var c = \"CREATE_BUFFERSOURCE_FAILED\";\n              return i && i(c), void o.default.error(\"[\".concat(e.streamId, \"] \"), c);\n            }\n\n            a.source = s, a.startAt = Date.now(), a.startOffset = n, a.resumeAt = null, a.resumeOffset = null, a.pauseOffset = null, a.pauseAt = null;\n          } else {\n            if (a.state !== e.audioMixing.states.PAUSED) return void e._handleAudioMixingInvalidStateError(\"_setOneEffectPosition\", t, i);\n            a.pauseOffset = n;\n          }\n\n          i && i(null);\n        }, e.startAudioMixing = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: function (t) {\n              if (t) return n && n(t);\n              e.dispatchEvent({\n                type: \"audioMixingPlayed\"\n              }), n && n(null);\n            },\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.startAudioMixing\",\n            options: t\n          });\n          Object(H.checkValidObject)(t, \"options\");\n          var a = t.filePath,\n              o = t.cacheResource,\n              c = t.cycle,\n              d = t.loop,\n              u = t.playTime,\n              l = t.replace;\n          Object(H.checkValidString)(a, \"filePath\", 1, Object(r.getParameter)(\"FILEPATH_LENMAX\"), !1), Object(H.checkValidNumber)(u, \"playTime\", 0, 1e8), !Object(H.isEmpty)(c) && Object(H.checkValidNumber)(c, \"cycle\"), !Object(H.isEmpty)(d) && Object(H.checkValidBoolean)(d, \"loop\"), !Object(H.isEmpty)(l) && Object(H.checkValidBoolean)(l, \"replace\"), !Object(H.isEmpty)(o) && Object(H.checkValidBoolean)(o, \"cacheResource\");\n          var f = h()({\n            soundId: -1\n          }, t);\n\n          e._playOneEffect(f, i);\n        }, e.stopAudioMixing = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: t,\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.stopAudioMixing\"\n          });\n\n          e._stopOneEffect({\n            soundId: -1\n          }, n);\n        }, e.pauseAudioMixing = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: t,\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.pauseAudioMixing\"\n          });\n          return e._pauseOneEffect({\n            soundId: -1\n          }, n);\n        }, e.resumeAudioMixing = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: function (n, i) {\n              if (n) return t && t(n);\n              e.dispatchEvent({\n                type: \"audioMixingPlayed\"\n              }), t && t(null);\n            },\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.resumeAudioMixing\"\n          });\n\n          e._resumeOneEffect({\n            soundId: -1\n          }, n);\n        }, e.adjustAudioMixingVolume = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.adjustAudioMixingVolume\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          Object(H.checkValidNumber)(t, \"volume\", 0, 100), e.audioMixing.sounds[-1].volume = t, e._flushAudioMixingMuteStatus(), n();\n        }, e.getAudioMixingDuration = function () {\n          var t = s.b.reportApiInvoke(e.sid, {\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.getAudioMixingDuration\"\n          }),\n              n = e._getOneEffectDuration({\n            soundId: -1\n          });\n\n          return t(null, n), n;\n        }, e.getAudioMixingCurrentPosition = function () {\n          var t = s.b.reportApiInvoke(e.sid, {\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.getAudioMixingCurrentPosition\"\n          }),\n              n = e._getOneEffectCurrentPosition({\n            soundId: -1\n          }, !0);\n\n          return t(null, n), n;\n        }, e.setAudioMixingPosition = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: n,\n            options: arguments,\n            tag: \"tracer\",\n            getStates: e._getOneEffectStates({\n              soundId: -1\n            }),\n            name: \"Stream.setAudioMixingPosition\"\n          });\n          Object(H.checkValidNumber)(t, \"position\", 0, 1e8), e._setOneEffectPosition({\n            soundId: -1\n          }, t, i);\n        }, e.playEffect = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: function (t) {\n              if (t) return n && n(t);\n              e.dispatchEvent({\n                type: \"effectPlayed\"\n              }), n && n(null);\n            },\n            name: \"Stream.playEffect\",\n            options: t\n          });\n          Object(H.checkValidObject)(t, \"options\");\n          var a = t.soundId,\n              o = t.filePath,\n              c = t.cycle;\n          Object(H.checkValidNumber)(a, \"soundId\", 1, 1e4), Object(H.checkValidString)(o, \"filePath\", 0, Object(r.getParameter)(\"FILEPATH_LENMAX\"), !1), !Object(H.isEmpty)(c) && Object(H.checkValidNumber)(c, \"cycle\"), e._playOneEffect(t, i);\n        }, e.stopEffect = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: n,\n            getStates: e._getOneEffectStates({\n              soundId: t\n            }),\n            name: \"Stream.stopEffect\"\n          });\n          Object(H.checkValidNumber)(t, \"soundId\", 1, 1e4), e._stopOneEffect({\n            soundId: t\n          }, i);\n        }, e.stopAllEffects = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: t,\n            name: \"Stream.stopAllEffect\"\n          }),\n              i = !1,\n              a = 0,\n              r = 0,\n              o = function (e) {\n            i || (e ? (n(e), i = !0) : a += 1, a === r && (n(null), i = !0));\n          };\n\n          for (var c in e.audioMixing.sounds) {\n            var d = e.audioMixing.sounds[c];\n            -1 !== d.soundId && (d.state !== e.audioMixing.states.BUSY && d.state !== e.audioMixing.states.PAUSED || (r++, e._stopOneEffect({\n              soundId: c\n            }, o)));\n          }\n\n          r || n(null);\n        }, e.preloadEffect = function (t, n, i) {\n          var a = s.b.reportApiInvoke(e.sid, {\n            callback: i,\n            options: arguments,\n            tag: \"tracer\",\n            name: \"Stream.preloadEffect\"\n          });\n          Object(H.checkValidNumber)(t, \"soundId\", 1, 1e4), Object(H.checkValidString)(n, \"filePath\", 1, Object(r.getParameter)(\"FILEPATH_LENMAX\"), !1), e._initSoundIfNotExists(t, n), e.audioMixing.buffer[n] ? a(null) : e.loadAudioBuffer(n, n, a);\n        }, e.unloadEffect = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: n,\n            options: arguments,\n            tag: \"tracer\",\n            name: \"Stream.unloadEffect\"\n          });\n          Object(H.checkValidNumber)(t, \"soundId\", 1, 1e4);\n          var a = e.audioMixing.sounds[t];\n\n          if (!a) {\n            var r = \"SOUND_NOT_EXISTS\";\n            return o.default.error(r, t), void i(r);\n          }\n\n          var c = a.options ? a.options.filePath : a.filePath;\n          if (c) delete e.audioMixing.buffer[c], delete e.audioMixing.sounds[t], i(null);else {\n            var d = \"SOUND_BUFFER_NOT_FOUND\";\n            o.default.error(d, t), i(d);\n          }\n        }, e.pauseEffect = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: n,\n            options: arguments,\n            tag: \"tracer\",\n            name: \"Stream.pauseEffect\"\n          });\n          return e._pauseOneEffect({\n            soundId: t\n          }, i);\n        }, e.pauseAllEffects = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: t,\n            name: \"Stream.pauseAllEffects\"\n          }),\n              i = !1,\n              a = 0,\n              r = 0,\n              o = function (e) {\n            i || (e ? (n(e), i = !0) : a += 1, a === r && (n(null), i = !0));\n          };\n\n          for (var c in e.audioMixing.sounds) \"-1\" !== c && e.audioMixing.sounds[c].state === e.audioMixing.states.BUSY && (r++, e._pauseOneEffect({\n            soundId: c\n          }, o));\n\n          r || n(null);\n        }, e.resumeEffect = function (t, n) {\n          Object(H.checkValidNumber)(t, \"soundId\", 1, 1e4);\n          var i = s.b.reportApiInvoke(e.sid, {\n            callback: n,\n            options: arguments,\n            tag: \"tracer\",\n            name: \"Stream.resumeEffect\"\n          });\n          return e._resumeOneEffect({\n            soundId: t\n          }, i);\n        }, e.resumeAllEffects = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            callback: t,\n            name: \"Stream.resumeAllEffects\"\n          }),\n              i = !1,\n              a = 0,\n              r = 0,\n              o = function (e) {\n            i || (e ? (n(e), i = !0) : a += 1, a === r && (n(null), i = !0));\n          };\n\n          for (var c in e.audioMixing.sounds) \"-1\" !== c && e.audioMixing.sounds[c].state === e.audioMixing.states.PAUSED && (r++, e._resumeOneEffect({\n            soundId: c\n          }, o));\n\n          r || n(null);\n        }, e.getEffectsVolume = function () {\n          var t = [];\n\n          for (var n in e.audioMixing.sounds) {\n            var i = e.audioMixing.sounds[n];\n            i && \"-1\" !== n && t.push({\n              soundId: parseInt(n),\n              volume: i.volume\n            });\n          }\n\n          return t;\n        }, e.setEffectsVolume = function (t, n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setEffectsVolume\",\n            options: arguments,\n            tag: \"tracer\",\n            callback: n\n          });\n\n          for (var a in Object(H.checkValidNumber)(t, \"volume\", 0, 100), e.audioMixing.defaultVolume = t, e.audioMixing.sounds) {\n            var r = e.audioMixing.sounds[a];\n            \"-1\" !== a && (r.volume = t);\n          }\n\n          e._flushAudioMixingMuteStatus(), i(null);\n        }, e.setVolumeOfEffect = function (t, n, i) {\n          var a = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVolumeOfEffect\",\n            options: arguments,\n            tag: \"tracer\",\n            callback: i\n          });\n          Object(H.checkValidNumber)(t, \"soundId\", 0, 1e4), Object(H.checkValidNumber)(n, \"volume\", 0, 100), e._initSoundIfNotExists(t), e.audioMixing.sounds[t].volume = n, e._flushAudioMixingMuteStatus(), a(null);\n        };\n      }(t), me.addVideoEffectCapability(t), function (e, t) {\n        e.videoConstraint = {}, t.cameraId && (e.videoConstraint.deviceId = {\n          exact: t.cameraId\n        }), t.facingMode && (e.videoConstraint.facingMode = t.facingMode), e.videoSize && (e.videoConstraint.width = e.videoSize[0], e.videoConstraint.height = e.videoSize[1]), Object(g.isLegacyChrome)() || (e.videoConstraint.frameRate = {\n          ideal: 30,\n          max: 30\n        }), e.audioConstraint = {}, t.microphoneId && (e.audioConstraint.deviceId = {\n          exact: t.microphoneId\n        }), Object(g.isLegacyChrome)() || e.audioProcessing && (void 0 !== e.audioProcessing.AGC && (Object(g.isFireFox)() ? e.audioConstraint.autoGainControl = e.audioProcessing.AGC : Object(g.isChrome)() && (e.audioConstraint.googAutoGainControl = e.audioProcessing.AGC, e.audioConstraint.googAutoGainControl2 = e.audioProcessing.AGC)), void 0 !== e.audioProcessing.AEC && (e.audioConstraint.echoCancellation = e.audioProcessing.AEC), void 0 !== e.audioProcessing.ANS && (Object(g.isFireFox)() ? e.audioConstraint.noiseSuppression = e.audioProcessing.ANS : Object(g.isChrome)() && (e.audioConstraint.googNoiseSuppression = e.audioProcessing.ANS))), e.screenConstraint = {}, t.sourceId && (e.screenConstraint.sourceId = t.sourceId), t.extensionId && Object(g.isChrome)() ? (e.screenConstraint.extensionId = t.extensionId, e.screenConstraint.mandatory = {\n          chromeMediaSource: \"desktop\",\n          maxWidth: e.screenAttributes.width,\n          maxHeight: e.screenAttributes.height,\n          maxFrameRate: e.screenAttributes.maxFr,\n          minFrameRate: e.screenAttributes.minFr\n        }) : (e.screenConstraint.mediaSource = \"screen\", e.screenConstraint.width = e.screenAttributes.width, e.screenConstraint.height = e.screenAttributes.height, e.screenConstraint.frameRate = {\n          ideal: e.screenAttributes.maxFr,\n          max: e.screenAttributes.maxFr\n        }), t.mediaSource && (e.screenConstraint.mediaSource = t.mediaSource), e.setVideoResolution = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoResolution\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n\n          if (!(n instanceof Array)) {\n            var a = he(n += \"\");\n            return a && a.video ? (e.videoConstraint = h()(e.videoConstraint, {\n              width: {\n                ideal: a.video.width\n              },\n              height: {\n                ideal: a.video.height\n              }\n            }), t.attributes.resolution = a.attributes.resolution, (r = e.stream && e.stream.getVideoTracks && e.stream.getVideoTracks()[0]) && r.applyConstraints ? (o.default.debug(\"setVideoResolution applyConstraints\", e.videoConstraint), r.applyConstraints(e.videoConstraint).then(i).catch(i)) : i(), !0) : (i(\"NO_PROFILE_\".concat(n)), !1);\n          }\n\n          var r,\n              c = n[0],\n              d = n[1];\n          e.videoConstraint = h()(e.videoConstraint, {\n            width: {\n              ideal: c\n            },\n            height: {\n              ideal: d\n            }\n          }), t.attributes.resolution = \"\".concat(c, \"x\").concat(d), (r = e.stream && e.stream.getVideoTracks && e.stream.getVideoTracks()[0]) && r.applyConstraints ? (o.default.debug(\"setVideoResolution applyConstraints\", e.videoConstraint), me.disableVideoEffect(e).then(function () {\n            return r.applyConstraints(e.videoConstraint).then(i).catch(i);\n          }).then(function () {\n            return me.restoreVideoEffect(e);\n          })) : i();\n        }, e.setVideoFrameRate = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoFrameRate\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          if (Object(g.isFireFox)()) return i(\"FIREFOX_NOT_SUPPORTED\"), !1;\n\n          if (\"object\" === Se()(n) && n instanceof Array && n.length > 1) {\n            e.videoConstraint = h()(e.videoConstraint, {\n              frameRate: {\n                ideal: n[0],\n                max: n[1]\n              }\n            }), t.attributes.minFrameRate = n[0], t.attributes.maxFrameRate = n[1];\n            var a = e.stream && e.stream.getVideoTracks && e.stream.getVideoTracks()[0];\n            return a && a.applyConstraints ? (o.default.debug(\"setVideoFrameRate applyConstraints\", e.videoConstraint), a.applyConstraints(e.videoConstraint).then(i).catch(i)) : i(), !0;\n          }\n\n          return i(\"INVALID_PARAM_\".concat(JSON.stringify(n))), !1;\n        }, e.setVideoBitRate = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoBitRate\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          return \"object\" === Se()(n) && n instanceof Array && n.length > 1 ? (t.attributes.minVideoBW = n[0], t.attributes.maxVideoBW = n[1], e.connectionSpec && (e.connectionSpec.minVideoBW = n[0], e.connectionSpec.maxVideoBW = n[1]), e.pc && e.pc.renegotiate && e.pc.renegotiate(), i(), !0) : (i(\"INVALID_PARAM_\".concat(JSON.stringify(n))), !1);\n        }, e.setScreenBitRate = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setScreenBitRate\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          return \"object\" === Se()(n) && n instanceof Array && n.length > 1 ? (t.screenAttributes.minVideoBW = n[0], t.screenAttributes.maxVideoBW = n[1], i(), !0) : (i(\"INVALID_PARAM_\".concat(JSON.stringify(n))), !1);\n        }, e.setScreenProfile = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setScreenProfile\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          Object(H.checkValidEnum)(t, \"profile\", [\"480p_1\", \"480p_2\", \"720p_1\", \"720p_2\", \"1080p_1\", \"1080p_2\"]);\n          var i = he(t);\n          return i && i.screen ? (e.screenConstraint.mandatory ? (e.screenConstraint.mandatory.maxWidth = i.screen.width, e.screenConstraint.mandatory.maxHeight = i.screen.height, i.screen.frameRate && i.screen.frameRate.min && i.screen.frameRate.max && (e.screenConstraint.mandatory.minFrameRate = i.screen.frameRate.min, e.screenConstraint.mandatory.maxFrameRate = i.screen.frameRate.max)) : e.screenConstraint = h()(e.screenConstraint, i.screen), e.screenAttributes.width = i.screen.width, e.screenAttributes.height = i.screen.height, e.screenAttributes.minFr = i.screen.frameRate.min, e.screenAttributes.maxFr = i.screen.frameRate.max, n(), !0) : (n(\"NO_SCREEN_PROFILE_\".concat(JSON.stringify(t))), !1);\n        }, e.setVideoProfileCustom = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoProfileCustom\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          e.setVideoResolution(t[0]), e.setVideoFrameRate([t[1], t[1]]), e.setVideoBitRate([t[2], t[2]]), n();\n        }, e.setVideoProfileCustomPlus = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoProfileCustom\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          e.setVideoResolution([n.width, n.height]), t.attributes.resolution = \"\".concat(n.width, \"x\").concat(n.height), e.setVideoFrameRate([n.framerate, n.framerate]), e.setVideoBitRate([n.bitrate, n.bitrate]), i();\n        }, e.setVideoProfile = function (n) {\n          var i = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoProfile\",\n            options: arguments,\n            tag: \"tracer\"\n          }),\n              a = he(n);\n\n          if (!a) {\n            var r = \"Invalid Profile \".concat(n);\n            throw new Error(r);\n          }\n\n          if (e.profile = n, a && a.video) {\n            e.profile = a.profileName, e.videoConstraint = h()(e.videoConstraint, a.video), e.connectionSpec && a.attributes.maxVideoBW && (e.connectionSpec.minVideoBW = a.attributes.minVideoBW, e.connectionSpec.maxVideoBW = a.attributes.maxVideoBW), Object(g.isEdge)() && (e.videoConstraint.frameRate.max = 60), Object(g.isFireFox)() && (e.videoConstraint.frameRate = {\n              ideal: 30,\n              max: 30\n            }), t.attributes = h()(t.attributes, a.attributes), e.pc && e.pc.renegotiate && e.pc.renegotiate();\n            var c = e.stream && e.stream.getVideoTracks && e.stream.getVideoTracks()[0];\n            return c && c.applyConstraints ? (o.default.debug(\"setVideoProfile applyConstraints\", e.videoConstraint), me.disableVideoEffect(e).then(function () {\n              return c.applyConstraints(e.videoConstraint);\n            }).then(function () {\n              return me.restoreVideoEffect(e);\n            }).then(function (t) {\n              return new Promise(function (n, a) {\n                i(t), Object(F.vsResHack)(e.stream, function (t, i) {\n                  e.videoWidth = t, e.videoHeight = i, n();\n                }, function (t) {\n                  o.default.warning(\"[\".concat(e.streamId, \"] vsResHack failed: \"), t), a();\n                });\n              });\n            }).catch(i)) : i(), !0;\n          }\n\n          return i(\"INVALID_VIDEO_PROFILE_\".concat(n)), !1;\n        }, e.setAudioProfile = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setAudioProfile\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n          Object(H.checkValidEnum)(t, \"profile\", [\"speech_low_quality\", \"speech_standard\", \"music_standard\", \"standard_stereo\", \"high_quality\", \"high_quality_stereo\"]), e.audioProfile = t;\n          var i = Ee(t);\n          return e.highQuality = i.highQuality, e.stereo = i.stereo, e.speech = i.speech, e.lowQuality = i.lowQuality, e.stereo && Object(g.isChrome)() && (e.audioConstraint.googAutoGainControl = !1, e.audioConstraint.googAutoGainControl2 = !1, e.audioConstraint.echoCancellation = !1, e.audioConstraint.googNoiseSuppression = !1), n(), !0;\n        }, e.setVideoEncoderConfiguration = function (t) {\n          Object(H.checkValidObject)(t, \"config\");\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.setVideoEncoderConfiguration\",\n            options: t,\n            tag: \"tracer\"\n          });\n          t.resolution && (Object(H.checkValidNumber)(t.resolution.width, \"config.resolution.width\"), Object(H.checkValidNumber)(t.resolution.height, \"config.resolution.height\"), e.setVideoResolution([t.resolution.width, t.resolution.height])), t.frameRate && (Object(H.checkValidNumber)(t.frameRate.min, \"config.frameRate.min\"), Object(H.checkValidNumber)(t.frameRate.max, \"config.frameRate.max\"), e.setVideoFrameRate([t.frameRate.min, t.frameRate.max])), t.bitrate && (Object(H.checkValidNumber)(t.bitrate.min, \"config.bitrate.min\", 1, 1e7), Object(H.checkValidNumber)(t.bitrate.max, \"config.bitrate.max\", 1, 1e7), e.setVideoBitRate([t.bitrate.min, t.bitrate.max])), n();\n        }, e.getSupportedProfile = function (t) {\n          var n = s.b.reportApiInvoke(e.sid, {\n            name: \"Stream.getSupportedProfile\",\n            options: arguments,\n            tag: \"tracer\",\n            callback: t\n          });\n\n          if (!e.local) {\n            var i = \"ONLY_LOCAL_STREAM_SUPPORTED\";\n            return o.default.error(i), n(i);\n          }\n\n          if (!e.stream) return i = \"STREAM_NOT_INIT\", o.default.error(i), n(i);\n          if (!e.stream.getVideoTracks) return i = \"TRACK_NOT_SUPPORT\", o.default.error(i), n(i);\n          var a = e.stream.getVideoTracks()[0];\n          if (!a) return i = \"NO_VIDEO_TRACK_FOUND\", o.default.error(i), n(i);\n          if (!a.getCapabilities) return i = \"GETCAPABILITY_NOT_SUPPORT\", o.default.error(i), n(i);\n          var r = a.getCapabilities();\n          return n(null, _e(r));\n        };\n      }(t, e), t.getId = function () {\n        return t.streamId;\n      }, t.getUserId = function () {\n        return t.userId;\n      }, t.checkDualStreamEnabled = function () {\n        if (Object(r.getParameter)(\"DUALSTREAM_OPERATION_CHECK\") && t.isDualStream) {\n          return o.default.error(\"Operation not permitted: \".concat(\"DUAL_STREAM_ENABLED\")), \"DUAL_STREAM_ENABLED\";\n        }\n\n        return !1;\n      }, t.setUserId = function (e) {\n        var n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.setUserId\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        t.userId && o.default.warning(\"[\".concat(t.streamId, \"] Stream.userId \").concat(t.userId, \" => \").concat(e)), t.userId = e, n();\n      }, t.getAttributes = function () {\n        return e.screen ? t.screenAttributes : e.attributes;\n      }, t.hasAudio = function () {\n        return t.audio;\n      }, t.hasVideo = function () {\n        return t.video;\n      }, t.hasScreen = function () {\n        return t.screen;\n      }, t.hasScreenAudio = function () {\n        return t.screenAudio;\n      }, t.isVideoOn = function () {\n        return (t.hasVideo() || t.hasScreen()) && !t.userMuteVideo;\n      }, t.isAudioOn = function () {\n        return t.hasAudio() && !t.userMuteAudio;\n      }, t.init = function (i, a) {\n        var r = s.b.reportApiInvoke(t.sid, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n            i && i(t);\n          },\n          name: \"Stream.init\",\n          options: arguments,\n          tag: \"tracer\"\n        }),\n            c = (new Date().getTime(), arguments[2]);\n        if (void 0 === c && (c = 2), !0 === t.initialized) return r({\n          type: \"warning\",\n          msg: \"STREAM_ALREADY_INITIALIZED\"\n        });\n        if (!0 !== t.local) return r({\n          type: \"warning\",\n          msg: \"STREAM_NOT_LOCAL\"\n        });\n        var d = Math.random().toString().slice(3);\n        t._streamInitID = d, t.videoSource ? t.videoName = \"videoSource\" : t.video && (t.videoName = W.searchDeviceNameById(e.cameraId) || \"default\"), t.audioSource ? t.audioName = \"audioSource\" : t.audio && (t.audioName = W.searchDeviceNameById(e.microphoneId) || \"default\"), t.screen && (t.screenName = e.extensionId || \"default\");\n\n        try {\n          if (e.audio || e.video || e.screen || e.screenAudio || e.videoSource || e.audioSource) {\n            o.default.debug(\"[\".concat(t.streamId, \"] Requested access to local media\"));\n            var u = {\n              streamId: t.streamId\n            };\n            e.videoSource ? u.videoSource = e.videoSource : e.screen ? u.screen = t.screenConstraint : e.video && (u.video = t.videoConstraint), e.audioSource ? u.audioSource = e.audioSource : e.screenAudio ? u.screenAudio = e.screenAudio : e.audio && (u.audio = t.audioConstraint), j(u, function (i) {\n              if (u.screenAudio && !i.getAudioTracks()[0] && o.default.warning(\"[\".concat(t.streamId, \"] Audio sharing is not selected\")), u.screen && o.default.debug(\"[\".concat(t.streamId, \"] User has granted access to screen sharing\")), (u.video || u.audio) && o.default.debug(\"[\".concat(t.streamId, \"] User has granted access to local media\")), null === t._streamInitID) {\n                i.getTracks().forEach(function (e) {\n                  e.stop();\n                });\n                var a = {\n                  type: \"error\",\n                  msg: \"STREAM_IS_CLOSED\",\n                  info: \"stream is closed and cannot be initialized\"\n                };\n                return o.default.error(t.streamId, a.info), void r(a);\n              }\n\n              if (t._streamInitID !== d) {\n                i.getTracks().forEach(function (e) {\n                  e.stop();\n                });\n                a = {\n                  type: \"error\",\n                  msg: \"ABORT_OTHER_INIT\",\n                  info: \"stream initialization is aborted because of another stream.init\"\n                };\n                return o.default.error(t.streamId, a.info), void r(a);\n              }\n\n              t.dispatchEvent({\n                type: \"accessAllowed\"\n              }), t.stream = i, t.initialized = !0, t.reloadDeviceName(), t.hasVideo() && Object(F.vsResHack)(i, function (e, n) {\n                t.videoWidth = e, t.videoHeight = n;\n              }, function (e) {\n                o.default.warning(\"[\".concat(t.streamId, \"] vsResHack failed: \"), e);\n              }), e.screen && t.stream && t.stream.getVideoTracks()[0] && (t.stream.getVideoTracks()[0].onended = function () {\n                t.dispatchEvent({\n                  type: \"stopScreenSharing\"\n                });\n              }), t.stream && t.stream.getTracks && t.stream.getTracks().forEach(function (e) {\n                e && !e.onended && (e.onended = n);\n              }), r();\n            }, function (e) {\n              var n = {\n                type: \"error\",\n                info: null\n              };\n\n              switch (e && (n.msg = e.name || e.code || e, e.message && (n.info = e.message), e.code && (n.info ? n.info += \". \" + e.code : n.info = \" \" + e.code), e.constraint && (n.info ? n.info += \". Constraint: \" + e.constraint : n.info = \"constraint: \" + e.constraint)), n.msg) {\n                case \"Starting video failed\":\n                case \"TrackStartError\":\n                  if (t.videoConstraint && (delete t.videoConstraint.width, delete t.videoConstraint.height), c > 0) return void setTimeout(function () {\n                    t.init(function (e) {\n                      return r(e);\n                    }, r, c - 1);\n                  }, 1);\n                  n.msg = \"MEDIA_OPTION_INVALID\";\n                  break;\n\n                case \"DevicesNotFoundError\":\n                  n.msg = \"DEVICES_NOT_FOUND\";\n                  break;\n\n                case \"NotSupportedError\":\n                  n.msg = \"NOT_SUPPORTED\";\n                  break;\n\n                case \"PermissionDeniedError\":\n                case \"InvalidStateError\":\n                  n.msg = \"PERMISSION_DENIED\", t.dispatchEvent({\n                    type: \"accessDenied\"\n                  });\n                  break;\n\n                case \"PERMISSION_DENIED\":\n                case \"NotAllowedError\":\n                  t.dispatchEvent({\n                    type: \"accessDenied\"\n                  });\n                  break;\n\n                case \"ConstraintNotSatisfiedError\":\n                  n.msg = \"CONSTRAINT_NOT_SATISFIED\";\n                  break;\n\n                default:\n                  n.msg || (n.msg = \"UNDEFINED\");\n              }\n\n              var i = \"Media access \".concat(n.msg).concat(n.info ? \": \" + n.info : \"\");\n              o.default.error(\"[\".concat(t.streamId, \"] \"), i), r(n);\n            });\n          } else r({\n            type: \"warning\",\n            msg: \"STREAM_HAS_NO_MEDIA_ATTRIBUTES\"\n          });\n        } catch (e) {\n          o.default.error(\"[\".concat(t.streamId, \"] Stream init: \"), e), r({\n            type: \"error\",\n            msg: e.message || e\n          });\n        }\n      }, t.reloadDeviceName = function () {\n        if (t.stream) {\n          if (t.stream.getVideoTracks) {\n            var e = t.stream.getVideoTracks()[0];\n            e && e.label && (t.videoName = e.label);\n          }\n\n          if (t.stream.getAudioTracks) {\n            var n = t.stream.getAudioTracks()[0];\n            n && n.label && (t.audioName = n.label);\n          }\n        }\n      }, t.close = function () {\n        var e = s.b.reportApiInvoke(null, {\n          name: \"Stream.close\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n\n        if (o.default.debug(\"[\".concat(t.streamId, \"] Close stream with id\"), t.streamId), void 0 !== t.stream) {\n          var n = t.stream.getTracks();\n\n          for (var i in n) n.hasOwnProperty(i) && n[i].stop();\n\n          !t.isLowStream && t.local ? me.disableVideoEffect(t).then(function () {\n            t.stream = void 0;\n          }) : (t.stream && t.stream.clean && t.stream.clean(), t.stream = void 0);\n        }\n\n        Object(g.isSafari)() && t.pc && t.pc.peerConnection && t.pc.peerConnection.removeTrack && t.pc.peerConnection.getSenders && t.pc.peerConnection.getSenders().forEach(function (e) {\n          e && (o.default.debug(\"[\".concat(t.streamId, \"] Remove Track\"), e), t.pc.peerConnection.removeTrack(e));\n        });\n        t.local && (t.initialized = !1), t._streamInitID = null, t._onAudioMute = void 0, t._onAudioUnmute = void 0, t._onVideoMute = void 0, t._onVideoUnmute = void 0, t.lowStream && t.lowStream.close(), e();\n      }, t.enableAudio = function () {\n        var e,\n            n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.enableAudio\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return o.default.deprecate(\"[\".concat(t.streamId, \"] Stream.enableAudio is deprecated and will be removed in the future. Use Stream.unmuteAudio instead\")), t.userMuteAudio || o.default.warning(\"[\".concat(t.streamId, \"] User already enableAudio\")), t.userMuteAudio = !1, n(null, e = !t.peerMuteAudio && t._unmuteAudio()), e;\n      }, t.disableAudio = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.disableAudio\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        o.default.deprecate(\"[\".concat(t.streamId, \"] Stream.disableAudio is deprecated and will be removed in the future. Use Stream.muteAudio instead\")), t.userMuteAudio && o.default.warning(\"[\".concat(t.streamId, \"] User already disableAudio\")), t.userMuteAudio = !0;\n\n        var n = t._muteAudio();\n\n        return e(null, n), n;\n      }, t.enableVideo = function () {\n        var e,\n            n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.enableVideo\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return o.default.deprecate(\"[\".concat(t.streamId, \"] Stream.enableVideo is deprecated and will be removed in the future. Use Stream.unmuteVideo instead\")), t.userMuteVideo || o.default.warning(\"[\".concat(t.streamId, \"] User already enableVideo\")), t.userMuteVideo = !1, t.lowStream && (t.lowStream.userMuteVideo = !1), n(null, e = !t.peerMuteVideo && t._unmuteVideo()), e;\n      }, t.disableVideo = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.disableVideo\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        o.default.deprecate(\"[\".concat(t.streamId, \"] Stream.disableVideo is deprecated and will be removed in the future. Use Stream.muteVideo instead\")), t.userMuteVideo && o.default.warning(\"[\".concat(t.streamId, \"] User already disableVideo\")), t.userMuteVideo = !0, t.lowStream && (t.lowStream.userMuteVideo = !0);\n\n        var n = t._muteVideo();\n\n        return e(null, n), n;\n      }, t.unmuteAudio = function () {\n        var e,\n            n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.unmuteAudio\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return t.userMuteAudio || o.default.warning(\"[\".concat(t.streamId, \"] User already unmuteAudio\")), t.userMuteAudio = !1, n(null, e = !t.peerMuteAudio && t._unmuteAudio()), e;\n      }, t.muteAudio = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.muteAudio\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        t.userMuteAudio && o.default.warning(\"[\".concat(t.streamId, \"] User already muteAudio\")), t.userMuteAudio = !0;\n\n        var n = t._muteAudio();\n\n        return e(null, n), n;\n      }, t.unmuteVideo = function () {\n        var e,\n            n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.unmuteVideo\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return t.userMuteVideo || o.default.warning(\"[\".concat(t.streamId, \"] User already unmuteVideo\")), t.userMuteVideo = !1, t.lowStream && (t.lowStream.userMuteVideo = !1), n(null, e = !t.peerMuteVideo && t._unmuteVideo()), e;\n      }, t.muteVideo = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.muteVideo\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        t.userMuteVideo && o.default.warning(\"[\".concat(t.streamId, \"] User already muteVideo\")), t.userMuteVideo = !0, t.lowStream && (t.lowStream.userMuteVideo = !0);\n\n        var n = t._muteVideo();\n\n        return e(null, n), n;\n      }, t._unmuteAudio = function () {\n        return o.default.debug(\"[\".concat(t.streamId, \"] Unmuted audio stream with id \"), t.streamId), t._flushAudioMixingMuteStatus(!1), !(!t.hasAudio() || !t.initialized || void 0 === t.stream || !0 === t.stream.getAudioTracks()[0].enabled) && (t._onAudioUnmute && t._onAudioUnmute(), t.pc && (t.pc.isAudioMute = !1), t.stream.getAudioTracks()[0].enabled = !0, !0);\n      }, t._isAudioMuted = function () {\n        if (t.stream && t.hasAudio()) {\n          var e = t.stream.getAudioTracks();\n          return e.length > 0 && !e[0].enabled;\n        }\n\n        return !1;\n      }, t._isVideoMuted = function () {\n        if (t.stream && t.hasVideo()) {\n          var e = t.stream.getVideoTracks();\n          return e.length > 0 && !e[0].enabled;\n        }\n\n        return !1;\n      }, t._muteAudio = function () {\n        return o.default.debug(\"[\".concat(t.streamId, \"] Muted audio stream with id \"), t.streamId), t._flushAudioMixingMuteStatus(!0), !!(t.hasAudio() && t.initialized && void 0 !== t.stream && t.stream.getAudioTracks()[0].enabled) && (t._onAudioMute && t._onAudioMute(), t.pc && (t.pc.isAudioMute = !0), t.stream.getAudioTracks()[0].enabled = !1, t.sid && s.b.audioSendingStopped(t.sid, {\n          succ: !0,\n          reason: \"muteAudio\"\n        }), !0);\n      }, t._unmuteVideo = function () {\n        return o.default.debug(\"[\".concat(t.streamId, \"] Unmuted video stream with id\"), t.streamId), !(!t.initialized || void 0 === t.stream || !t.stream.getVideoTracks().length || !0 === t.stream.getVideoTracks()[0].enabled) && (t._onVideoUnmute && t._onVideoUnmute(), t.pc && (t.pc.isVideoMute = !1), t.stream.getVideoTracks()[0].enabled = !0, t.lowStream && t.lowStream._unmuteVideo(), !0);\n      }, t._muteVideo = function () {\n        return o.default.debug(\"[\".concat(t.streamId, \"] Muted video stream with id\"), t.streamId), !!(t.initialized && void 0 !== t.stream && t.stream.getVideoTracks().length && t.stream.getVideoTracks()[0].enabled) && (t._onVideoMute && t._onVideoMute(), t.pc && (t.pc.isVideoMute = !0), t.stream.getVideoTracks()[0].enabled = !1, t.lowStream && t.lowStream._muteVideo(), t.sid && s.b.videoSendingStopped(t.sid, {\n          succ: !0,\n          reason: \"muteVideo\"\n        }), !0);\n      }, t.addTrack = function (i) {\n        var a = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.addTrack\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n\n        if (t.pc && t.pc.addTrack(i, t.stream), \"audio\" == i.kind) {\n          t._cleanupAudioMixing();\n\n          var r = new MediaStream();\n          t.userMuteAudio && (i.enabled = !1), r.addTrack(i);\n          var o = t.stream.getVideoTracks()[0];\n          o && r.addTrack(o), t.audio = !0, e.audio = !0, t.stream = r, t.audioLevelHelper = null, t.player && t.player.video && (t.player.video.srcObject = t.stream);\n        } else t.userMuteVideo && (i.enabled = !1), t.stream.addTrack(i), t.video = !0, e.video = !0;\n\n        i.onended || (i.onended = n), a();\n      }, t.removeTrack = function (n) {\n        var i = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.removeTrack\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        t.pc && t.pc.removeTrack(n, t.stream), t.stream.removeTrack(n), t._cleanupAudioMixing(), \"audio\" === n.kind ? (t.audio = !1, e.audio = !1) : (t.video = !1, e.video = !1), t.audioLevelHelper = null, \"live\" == n.readyState && (n.stop(), o.default.debug(\"[\".concat(t.streamId, \"] Track \").concat(n.kind, \" Stopped\"))), i();\n      }, t.setAudioOutput = function (e, n, i) {\n        var a = s.b.reportApiInvoke(t.sid, {\n          callback: function (e, t) {\n            if (e) return i && i(e);\n            n && n(t);\n          },\n          name: \"Stream.setAudioOutput\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return Object(H.isValidString)(e, 1, 255) ? (t.audioOutput = e, t.player ? void t.player.setAudioOutput(e, function () {\n          return a();\n        }, a) : a()) : (o.default.error(\"[\".concat(t.streamId, \"] setAudioOutput Invalid Parameter\"), e), a(I.default.INVALID_PARAMETER));\n      }, t.play = function (e, n, i) {\n        \"function\" == typeof n && (i = n, n = null), o.default.debug(\"[\".concat(t.streamId, \"] play().\"), e, n);\n        var a = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.play\",\n          options: arguments,\n          tag: \"tracer\",\n          callback: i\n        });\n        if (Object(H.checkValidString)(e, \"elementID\"), Object(H.isEmpty)(n) || (Object(H.isEmpty)(n.fit) || Object(H.checkValidEnum)(n.fit, \"fit\", [\"cover\", \"contain\"]), Object(H.isEmpty)(n.muted) || Object(H.checkValidBoolean)(n.muted, \"muted\")), t.player) o.default.warning(\"[\".concat(t.streamId, \"] Stream.play(): Stream is already playing. Fallback to resume stream\")), t.resume().then(function () {\n          a(null);\n        }).catch(a);else {\n          t.elementID = e, t.playOptions = n, !t.local || t.video || t.screen ? (t.player = new y({\n            id: t.getId(),\n            stream: t,\n            elementID: e,\n            options: n\n          }), t.local && me.applyEffectInPlayer(t)) : t.hasAudio() && (t.player = new y({\n            id: t.getId(),\n            stream: t,\n            elementID: e,\n            options: n\n          }));\n          var r = {\n            video: null,\n            audio: null\n          };\n          t.on(\"player-status-change\", function e(n) {\n            if (r[n.mediaType] = n, r.video && r.audio) if (t.removeEventListener(\"player-status-change\", e), r.video.isErrorState || r.audio.isErrorState) {\n              var i = r.video.isErrorState ? r.video : r.audio;\n              a({\n                isErrorState: !0,\n                status: i.status,\n                reason: i.reason,\n                video: r.video,\n                audio: r.audio\n              });\n            } else \"aborted\" === r.video.status && \"aborted\" === r.audio.status ? a({\n              status: \"aborted\",\n              reason: \"stop\",\n              video: r.video,\n              audio: r.audio\n            }) : a(null);\n          }), t.audioOutput && t.player.setAudioOutput(t.audioOutput), void 0 !== t.audioLevel && t.player.setAudioVolume(t.audioLevel), t._flushAudioMixingMuteStatus(!1);\n        }\n      }, t.stop = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.stop\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        o.default.debug(\"[\".concat(t.streamId, \"] Stop stream player with id \"), t.streamId), t.player ? (me.removeEffectFromLocalPlayer(t), t.player.destroy(), delete t.player) : o.default.error(\"[\".concat(t.streamId, \"] Stream.stop(): Stream is not playing\")), t._flushAudioMixingMuteStatus(!0), e();\n      }, t.isPlaying = function () {\n        return !!t.player;\n      }, t.isPaused = function () {\n        return !!t.player && (!!(t.player.video && t.player.video.paused && t.player.mediaElemExists(t.player.video)) || !!(t.player.audio && t.player.audio.paused && t.player.mediaElemExists(t.player.audio)));\n      }, t.resume = function () {\n        var e, n;\n        return t.player ? (t.player.video && t.player.video.play && (e = t.player.video.play()), e = e || Promise.resolve(), t.player.audio && t.player.audio.play && (n = t.player.audio.play()), n = n || Promise.resolve(), Promise.all([e, n])) : Promise.reject(\"NO_PLAYER_FOUND\");\n      }, t.getVideoTrack = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.getVideoTrack\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n\n        if (t.stream && t.stream.getVideoTracks) {\n          var n = t.stream.getVideoTracks()[0];\n          if (n) return o.default.info(\"[\".concat(t.streamId, \"] getVideoTrack\"), n), e(), n;\n        }\n\n        o.default.info(\"[\".concat(t.streamId, \"] getVideoTrack None\")), e(null, \"getVideoTrack None\");\n      }, t.getAudioTrack = function () {\n        var e = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.getAudioTrack\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n\n        if (t.stream && t.stream.getAudioTracks) {\n          var n = t.stream.getAudioTracks()[0];\n          if (n) return o.default.info(\"[\".concat(t.streamId, \"] getAudioTracks\"), n), e(), n;\n        }\n\n        o.default.info(\"[\".concat(t.streamId, \"] getAudioTracks None\")), e(null, \"getAudioTracks None\");\n      }, t._hasVideoTracks = function () {\n        return !!(t.stream && t.stream.getVideoTracks && t.stream.getVideoTracks()[0]);\n      }, t._hasAudioTracks = function () {\n        return !!(t.stream && t.stream.getAudioTracks && t.stream.getAudioTracks()[0]);\n      }, t._replaceMediaStreamTrack = function (e, n, i) {\n        if (t.stream) {\n          if (\"video\" == e.kind) {\n            if (r = t.stream.getVideoTracks()[0]) return t.userMuteVideo && (e.enabled = !1), t.stream.removeTrack(r), t.stream.addTrack(e), o.default.debug(\"[\".concat(t.streamId, \"] _replaceMediaStreamTrack \").concat(e.kind, \" SUCCESS\")), \"live\" == r.readyState && (r.stop(), o.default.debug(\"[\".concat(t.streamId, \"] Track \").concat(r.kind, \" Stopped\"))), n && n();\n            var a = \"MEDIASTREAM_TRACK_NOT_FOUND\";\n            return o.default.error(\"[\".concat(t.streamId, \"] MEDIASTREAM_TRACK_NOT_FOUND \").concat(e.kind)), i(a);\n          }\n\n          if (\"audio\" == e.kind) {\n            var r;\n\n            if (r = t.stream.getAudioTracks()[0]) {\n              t.userMuteAudio && (e.enabled = !1);\n              var s = new MediaStream();\n              s.addTrack(e);\n              var c = t.stream && t.stream.getVideoTracks()[0];\n              return c && s.addTrack(c), t.stream = s, t.audioLevelHelper = null, t.player && t.player.video && (t.player.video.srcObject = t.stream), o.default.debug(\"[\".concat(t.streamId, \"] _replaceMediaStreamTrack SUCCESS\")), \"live\" == r.readyState && (r.stop(), o.default.debug(\"[\".concat(t.streamId, \"] Track \").concat(r.kind, \" Stopped\"))), n && n();\n            }\n\n            a = \"MEDIASTREAM_TRACK_NOT_FOUND\";\n            return o.default.error(\"[\".concat(t.streamId, \"] MEDIASTREAM_TRACK_NOT_FOUND \").concat(e.kind)), i(a);\n          }\n\n          a = \"INVALID_TRACK_TYPE\";\n          return o.default.error(\"[\".concat(t.streamId, \"] _replaceMediaStreamTrack \").concat(a, \" \").concat(e.kind)), i && i(a);\n        }\n\n        a = \"NO_STREAM_FOUND\";\n        return o.default.error(\"[\".concat(t.streamId, \"] _replaceMediaStreamTrack \").concat(a)), i && i(a);\n      }, t.replaceTrack = function (e, i, a) {\n        var r = s.b.reportApiInvoke(t.sid, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n            i && i(t);\n          },\n          name: \"Stream.replaceTrack\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return e && e.kind ? (t._cleanupAudioMixing(), e.onended || (e.onended = n), t.pc && t.pc.hasSender && t.pc.hasSender(e.kind) ? void t.pc.replaceTrack(e, function () {\n          return o.default.debug(\"[\".concat(t.streamId, \"] PeerConnection.replaceTrack \").concat(e.kind, \" SUCCESS\")), t._replaceMediaStreamTrack(e, function (e) {\n            return r(null, e);\n          }, r);\n        }, function (n) {\n          return o.default.error(\"[\".concat(t.streamId, \"] PeerConnection.replaceTrack \").concat(e.kind, \" Failed \").concat(n)), r(n);\n        }) : t._replaceMediaStreamTrack(e, function (e) {\n          return r(null, e);\n        }, r)) : r(\"INVALID_TRACK\");\n      }, t.setAudioVolume = function (e) {\n        var n = s.b.reportApiInvoke(t.sid, {\n          name: \"Stream.setAudioVolume\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidNumber)(e, \"level\", 0, 100), t.audioLevel = e, t.player && t.player.setAudioVolume(e), n();\n      }, t.getStats = function (e, n, i) {\n        var a = [];\n        a.push(t._getPCStats(i)), a.push(new Promise(function (e) {\n          var n = {};\n          t.pc && t.pc.isSubscriber ? null !== window.navigator.userAgent.match(\"Firefox\") && (B(n, \"videoReceiveResolutionHeight\", t.videoHeight), B(n, \"videoReceiveResolutionWidth\", t.videoWidth)) : t.pc && !t.pc.isSubscriber && ((Object(g.isSafari)() || Object(g.isFireFox)()) && (B(n, \"videoSendResolutionHeight\", t.videoHeight), B(n, \"videoSendResolutionWidth\", t.videoWidth)), (Object(g.isSafari)() || Object(g.isFireFox)()) && t.uplinkStats && B(n, \"videoSendPacketsLost\", t.uplinkStats.uplink_cumulative_lost)), e(n);\n        })), a.push(new Promise(function (e) {\n          var n = {};\n          return t.traffic_stats && t.pc && t.pc.isSubscriber ? (B(n, \"accessDelay\", t.traffic_stats.access_delay), B(n, \"endToEndDelay\", t.traffic_stats.e2e_delay), B(n, \"videoReceiveDelay\", t.traffic_stats.video_delay), B(n, \"audioReceiveDelay\", t.traffic_stats.audio_delay)) : t.traffic_stats && t.pc && !t.pc.isSubscriber && B(n, \"accessDelay\", t.traffic_stats.access_delay), e(n);\n        })), Promise.all(a).then(function (n) {\n          for (var i = {}, a = n.length - 1; a >= 0; a--) {\n            var r = n[a];\n            h()(i, r);\n          }\n\n          e && setTimeout(e.bind(t, i), 0);\n        }).catch(function (e) {\n          n && setTimeout(n.bind(t, e), 0);\n        });\n      }, t._getPCStats = function (e) {\n        return new Promise(function (n, i) {\n          if (!t.pc || \"established\" !== t.pc.state || !t.pc.getStats) {\n            return i(\"PEER_CONNECTION_NOT_ESTABLISHED\");\n          }\n\n          t.pc.getStats(function (e) {\n            if (!t.pc || \"established\" !== t.pc.state || !t.pc.getStats) {\n              return i(\"PEER_CONNECTION_STATE_CHANGE\");\n            }\n\n            var a = t.pc.isSubscriber ? function (e) {\n              var t = {};\n              return e.forEach(function (e) {\n                e.id && e.type && (-1 === e.id.indexOf(\"recv\") && -1 === e.type.toLowerCase().indexOf(\"inbound\") && -1 === e.id.indexOf(\"inbound_rtp\") && -1 === e.id.indexOf(\"inbound-rtp\") && -1 === e.id.indexOf(\"InboundRTP\") || (\"audio\" === e.mediaType ? (B(t, \"audioReceiveBytes\", e.bytesReceived), B(t, \"audioReceivePackets\", e.packetsReceived), B(t, \"audioReceivePacketsLost\", e.packetsLost)) : (B(t, \"videoReceiveBytes\", e.bytesReceived), B(t, \"videoReceivePacketsLost\", e.packetsLost), B(t, \"videoReceivePackets\", e.packetsReceived), B(t, \"videoReceiveFrameRate\", e.googFrameRateReceived), B(t, \"videoReceiveDecodeFrameRate\", e.googFrameRateDecoded), B(t, \"videoReceiveResolutionWidth\", e.googFrameWidthReceived), B(t, \"videoReceiveResolutionHeight\", e.googFrameHeightReceived))));\n              }), t;\n            }(e) : function (e) {\n              var t = {};\n              return e.forEach(function (e) {\n                e.id && e.type && (-1 === e.id.indexOf(\"send\") && -1 === e.type.toLowerCase().indexOf(\"outbound\") && -1 === e.id.indexOf(\"outbound_rtp\") && -1 === e.id.indexOf(\"OutboundRTP\") || (\"audio\" === e.mediaType ? (B(t, \"audioSendBytes\", e.bytesSent), B(t, \"audioSendPackets\", e.packetsSent), B(t, \"audioSendPacketsLost\", e.packetsLost)) : (B(t, \"videoSendBytes\", e.bytesSent), B(t, \"videoSendPackets\", e.packetsSent), B(t, \"videoSendPacketsLost\", e.packetsLost), B(t, \"videoSendFrameRate\", e.googFrameRateSent), B(t, \"videoSendResolutionWidth\", e.googFrameWidthSent), B(t, \"videoSendResolutionHeight\", e.googFrameHeightSent))));\n              }), t;\n            }(e);\n            return n(a);\n          }, e);\n        }).then(function (e) {\n          return t.pc.isSubscriber ? (Object(g.isFireFox)() || Object(g.isSafari)()) && (e.videoReceiveResolutionHeight && \"0\" !== e.videoReceiveResolutionHeight || e.videoReceiveResolutionWidth && \"0\" !== e.videoReceiveResolutionWidth || (B(e, \"videoReceiveResolutionHeight\", t.videoHeight), B(e, \"videoReceiveResolutionWidth\", t.videoWidth))) : ((Object(g.isSafari)() || Object(g.isFireFox)()) && (e.videoSendResolutionHeight && \"0\" !== e.videoSendResolutionHeight || e.videoSendResolutionWidth && \"0\" !== e.videoSendResolutionWidth || (B(e, \"videoSendResolutionHeight\", t.videoHeight), B(e, \"videoSendResolutionWidth\", t.videoWidth))), (Object(g.isSafari)() || Object(g.isFireFox)()) && t.uplinkStats && B(e, \"videoSendPacketsLost\", t.uplinkStats.uplink_cumulative_lost)), Promise.resolve(e);\n        });\n      }, t.getAudioLevel = function () {\n        if (t.audioLevelHelper) return t.audioLevelHelper.getAudioLevel();\n\n        if (t.stream) {\n          if (0 !== t.stream.getAudioTracks().length) return t.audioLevelHelper = new F.audioLevelHelper(t.stream), t.audioLevelHelper.getAudioLevel();\n          o.default.warning(\"[\".concat(t.streamId, \"] can't get audioLevel beacuse no audio trace in stream\"));\n        } else o.default.warning(\"[\".concat(t.streamId, \"] can't get audioLevel beacuse no stream exist\"));\n      }, t.setVideoProfile(\"480p_1\"), t._switchVideoDevice = function (e, n, i) {\n        if (e === t.cameraId) return n && n();\n        var a = {\n          video: h()({}, t.videoConstraint, {\n            deviceId: {\n              exact: e\n            }\n          }),\n          audio: !1\n        };\n        o.default.debug(\"[\".concat(t.streamId, \"] \").concat(a)), j(a, function (a) {\n          try {\n            var r = function () {\n              t.isPlaying() && (t.stop(), t.elementID && t.play(t.elementID, t.playOptions)), t.cameraId = e, t.videoConstraint.deviceId = {\n                exact: e\n              }, t.userMuteVideo && (t.stream.getVideoTracks()[0].enabled = !1), me.restoreVideoEffect(t), n && n();\n            };\n\n            me.disableVideoEffect(t).then(function () {\n              Object(g.isSafari)() ? t.replaceTrack(a.getVideoTracks()[0], r, i) : (t.removeTrack(t.stream.getVideoTracks()[0]), t.addTrack(a.getVideoTracks()[0]), r());\n            });\n          } catch (e) {\n            return i && i(e);\n          }\n        }, function (e) {\n          return i && i(e);\n        });\n      }, t._switchAudioDevice = function (e, n, i) {\n        if (e === t.microphoneId) return n && n();\n        var a = {\n          video: !1,\n          audio: h()({}, t.audioConstraint, {\n            deviceId: {\n              exact: e\n            }\n          })\n        };\n        o.default.debug(\"[\".concat(t.streamId, \"] \"), a), j(a, function (a) {\n          var r = function () {\n            t._cleanupAudioMixing(), t.userMuteAudio && (t.stream.getAudioTracks()[0].enabled = !1), t.isPlaying() && (t.stop(), t.elementID && t.play(t.elementID)), t.microphoneId = e, t.audioConstraint.deviceId = {\n              exact: e\n            }, n && n();\n          };\n\n          try {\n            Object(g.isSafari)() ? t.replaceTrack(a.getAudioTracks()[0], r, i) : (t.removeTrack(t.stream.getAudioTracks()[0]), t.addTrack(a.getAudioTracks()[0]), r());\n          } catch (e) {\n            return i && i(e);\n          }\n        }, function (e) {\n          return i && i(e);\n        });\n      }, t.switchDevice = function (e, n, i, a) {\n        var r = s.b.reportApiInvoke(t.sid, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n            i && i(t);\n          },\n          name: \"Stream.switchDevice\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidString)(n, \"deviceId\");\n\n        var c = function () {\n          return t.inSwitchDevice = !1, r();\n        },\n            d = function (e) {\n          t.inSwitchDevice = !1, o.default.error(\"[\".concat(t.streamId, \"] \"), e), r(e);\n        };\n\n        if (t.inSwitchDevice) return r(\"Device switch is in process.\");\n        if (t.inSwitchDevice = !0, !t.local) return d(\"Only the local stream can switch the device.\");\n        if (t.screen && \"video\" === e) return d(\"The device cannot be switched during screen-sharing.\");\n        if (!t.video && \"video\" === e) return d(\"Video track not exist.\");\n        if (!t.audio && \"audio\" === e) return d(\"Audio track not exist.\");\n        if (t.videoSource || t.audioSource) return d(\"The device cannot be switched when using videoSource or audioSource.\");\n        var u = !1;\n\n        for (var l in t.audioMixing.sounds) {\n          if (t.audioMixing.sounds[l].state !== t.audioMixing.states.IDLE) {\n            u = !0;\n            break;\n          }\n        }\n\n        if (t.audioMixing.audioContextInited && u) return d(\"The device cannot be switched when using audio Mixing.\");\n        W.getDeviceById(n, function () {\n          if (\"video\" === e) t._switchVideoDevice(n, c, d);else {\n            if (\"audio\" !== e) return d(\"Invalid type.\");\n\n            t._switchAudioDevice(n, c, d);\n          }\n        }, function () {\n          return d(\"The device does not exist.\");\n        });\n      }, t;\n    },\n        Te = a(21),\n        ye = a(8),\n        be = a.n(ye),\n        Re = [\"live\", \"rtc\", \"web\", \"interop\", \"h264_interop\", \"web-only\"],\n        Ae = [\"vp8\", \"h264\"],\n        Ce = [\"aes-128-xts\", \"aes-256-xts\", \"aes-128-ecb\"],\n        Oe = a(17),\n        Ne = a.n(Oe),\n        we = function (e) {\n      e && e.apply(this, [].slice.call(arguments, 1));\n    },\n        ke = a(12),\n        De = function (e) {\n      var t = c(e);\n      t.needReconnect = !0, t.isTimeout = !1, t.isInit = !0, t.sendbytes = 0, t.recvbytes = 0, t.startTime = Date.now(), t.lastMsgTime = null, t.clientId = e.clientId, t.hostIndex = 0, t.requestID = 0, e.host instanceof Array ? t.host = e.host : t.host = [e.host], t.getSendBytes = function () {\n        return t.sendbytes;\n      }, t.getRecvBytes = function () {\n        return t.recvbytes;\n      }, t.getDuration = function () {\n        return Math.ceil((Date.now() - t.startTime) / 1e3);\n      }, t.getURL = function () {\n        return t.connection.url;\n      }, t.reconnect = function () {\n        t.isInit = !0, t.creatConnection();\n      }, t.connectNext = function () {\n        t.isInit = !0, ++t.hostIndex, o.default.debug(\"[\" + t.clientId + \"] Gateway length:\" + t.host.length + \" current index:\" + t.hostIndex), t.hostIndex >= t.host.length ? t.dispatchEvent(f({\n          type: \"recover\"\n        })) : t.creatConnection();\n      }, t.replaceHost = function (e) {\n        t.host = e || t.host, t.hostIndex = 0, t.creatConnection();\n      }, t.creatConnection = function () {\n        if (t.needReconnect = !0, o.default.debug(\"[\" + t.clientId + \"] start connect:\" + t.host[t.hostIndex]), t.lts = new Date().getTime(), t.connection = new WebSocket(\"wss://\" + t.host[t.hostIndex]), t.connection.binaryType = \"arraybuffer\", t.turnConfig = {}, t.connection.url) {\n          var n = t.connection.url.match(/wss\\:\\/\\/([^:]+):(\\d+)/),\n              i = t.host[t.hostIndex].split(\":\"),\n              a = t.connection.url.match(/h=([^:]+)&p=(\\d+)/);\n          n ? (t.turnConfig.url = n[1], Object(r.getParameter)(\"TURN_ENABLE_TCP\") && (t.turnConfig.tcpport = parseInt(n[2]) + 30), Object(r.getParameter)(\"TURN_ENABLE_UDP\") && (t.turnConfig.udpport = parseInt(n[2]) + 30)) : a ? (t.turnConfig.url = a[1], Object(r.getParameter)(\"TURN_ENABLE_TCP\") && (t.turnConfig.tcpport = parseInt(a[2]) + 30), Object(r.getParameter)(\"TURN_ENABLE_UDP\") && (t.turnConfig.udpport = parseInt(a[2]) + 30)) : i && (t.turnConfig.url = i[0], Object(r.getParameter)(\"TURN_ENABLE_TCP\") && (t.turnConfig.tcpport = parseInt(i[1]) + 30), Object(r.getParameter)(\"TURN_ENABLE_UDP\") && (t.turnConfig.udpport = parseInt(i[1]) + 30));\n        }\n\n        t.connection.onopen = function (e) {\n          o.default.debug(\"[\" + t.clientId + \"] websockect opened: \" + t.host[t.hostIndex]), t.needReconnect = !0, t.isTimeout = !1, t.isInit = !1, t.sendbytes = 0, t.recvbytes = 0, t.startTime = Date.now(), Object(ke.resetHTTPByetsCount)(), clearTimeout(t.timeoutCheck), t.dispatchEvent(f({\n            type: \"onopen\",\n            event: e,\n            socket: t\n          }));\n        }, t.connection.onmessage = function (e) {\n          if (e.data instanceof ArrayBuffer) t.dispatchEvent({\n            type: \"onBinaryData\",\n            data: e.data\n          });else {\n            t.recvbytes += Object(F.lengthInUtf8Bytes)(e.data);\n            var n = JSON.parse(e.data);\n            t.lastMsgTime = Date.now(), n.hasOwnProperty(\"_id\") ? t.dispatchEvent(f({\n              type: n._id,\n              msg: n\n            })) : n.hasOwnProperty(\"_type\") && t.dispatchSocketEvent(f({\n              type: n._type,\n              msg: n._message\n            }));\n          }\n        }, t.connection.onclose = function (n) {\n          t.needReconnect ? t.isTimeout || t.isInit ? (o.default.debug(\"[\" + t.clientId + \"] websockect connect timeout\"), s.b.joinGateway(e.sid, {\n            lts: t.lts,\n            succ: !1,\n            ec: \"timeout\",\n            addr: t.connection.url\n          }), t.connectNext()) : (t.dispatchEvent(f({\n            type: \"disconnect\",\n            event: n\n          })), t.requests && t.requests instanceof Array && (t.requests.map(function (e) {\n            e.callback(\"REQUEST_ABORT\");\n          }), t.requests = [])) : (o.default.debug(\"[\" + t.clientId + \"] websockect closeed\"), we(e.onFailure, n), clearTimeout(t.timeoutCheck), t.dispatchEvent(f({\n            type: \"close\",\n            event: n\n          })), t.connection.onopen = void 0, t.connection.onclose = void 0, t.connection.onerror = void 0, t.connection.onmessage = void 0, t.connection = void 0);\n        }, t.connection.onerror = function (e) {}, setTimeout(function () {\n          t.connection && t.connection.readyState != WebSocket.OPEN && (t.isTimeout = !0, t.connection.close());\n        }, 5e3);\n      }, t.creatConnection(), t.sendMessage = function (e, n) {\n        if (t.connection && t.connection.readyState == WebSocket.OPEN) {\n          var i = JSON.stringify(e);\n          t.sendbytes += Object(F.lengthInUtf8Bytes)(i), t.connection.send(i);\n        } else n({\n          error: \"Gateway not connected\"\n        });\n      }, t.disconnect = function () {\n        t.needReconnect = !0, t.connection.close();\n      }, t.close = function () {\n        t.needReconnect = !1, t.connection.onclose = void 0, t.connection.close(), t.requests && t.requests instanceof Array && (t.requests.map(function (e) {\n          e.callback(\"REQUEST_ABORT\");\n        }), t.requests = []);\n      }, t.sendSignalCommand = function (e, n) {\n        e._id = \"_request_\" + t.requestID, t.requestID += 1, \"publish_stats\" !== e._type && \"subscribe_stats\" !== e._type && \"publish_stats_low\" !== e._type && t.on(e._id, function (i) {\n          i.msg && n && n(i.msg._result, i.msg.message), delete t.dispatcher.eventListeners[e._id];\n        }), t.sendMessage(e, function (e) {\n          e.reason = \"NOT_CONNECTED\", n && n(e.reason, e);\n        });\n      }, t.requests = [];\n\n      var n = function (e) {\n        var n = t.requests.findIndex(function (t) {\n          return t.id === e.type;\n        });\n        if (n >= 0) var i = t.requests.splice(n, 1)[0];\n        i && t.dispatcher.eventListeners[e.type] ? (delete t.dispatcher.eventListeners[e.type], e.msg && i.callback && i.callback(e.msg._result, e.msg._message)) : o.default.warning(\"Detached Response\", e.type, e.msg);\n      };\n\n      return t.sendRequest = function (e, i) {\n        e = h()({\n          _id: \"_request_\" + t.requestID\n        }, e), t.requestID += 1;\n        var a = {\n          id: e._id,\n          timeoutCounter: 0,\n          stalledAt: Date.now(),\n          message: e,\n          callback: i\n        };\n        t.requests.push(a), t.addEventListener(e._id, n), t.sendMessage(e, function (e) {\n          var n = this,\n              i = t.requests.findIndex(function (e) {\n            return e.id === n.id;\n          });\n          i >= 0 && (n = t.requests.splice(i, 1)[0]), n && t.dispatcher.eventListeners[e.type] ? (delete t.dispatcher.eventListeners[e.type], e.reason = \"NOT_CONNECTED\", n.callback && n.callback(e.reason, e)) : o.default.warning(\"handleSendError\", n);\n        }.bind(a));\n      }, t.checkRequestTimeout = function () {\n        for (var e = Math.ceil(Object(r.getParameter)(\"SIGNAL_REQUEST_TIMEOUT\") / Object(r.getParameter)(\"SIGNAL_REQUEST_WATCH_INTERVAL\")), n = t.requests.length - 1; n >= 0; n--) {\n          var i = t.requests[n];\n          i.timeoutCounter >= e ? (t.requests.splice(n, 1), o.default.error(\"Request Timeout\", i.timeoutCounter, i.message), i.callback && i.callback(\"TIMEOUT\")) : i.timeoutCounter++;\n        }\n      }, clearInterval(t.requestTimer), t.requestTimer = setInterval(t.checkRequestTimeout, Object(r.getParameter)(\"SIGNAL_REQUEST_WATCH_INTERVAL\")), t.sendReport = function (e) {\n        t.sendMessage(e, function () {});\n      }, t;\n    },\n        Le = function (e, t) {\n      var n = {\n        connect: function () {\n          t.host = e, n.signal = De(t), n.on = n.signal.on, n.dispatchEvent = n.signal.dispatchEvent, n.signal.on(\"onopen\", function (e) {\n            n.signal.onEvent = function (e) {\n              n.dispatchEvent(f({\n                type: e.event,\n                msg: e\n              }));\n            }, n.dispatchEvent(f({\n              type: \"connect\",\n              msg: e\n            }));\n          }), n.signal.on(\"onError\", function (e) {\n            var t = e.msg;\n            onError(t.code, \"error\");\n          });\n        },\n        getLastMsgTime: function () {\n          return n.signal && n.signal.lastMsgTime;\n        },\n        getSendBytes: function () {\n          return n.signal.getSendBytes();\n        },\n        getRecvBytes: function () {\n          return n.signal.getRecvBytes();\n        },\n        getDuration: function () {\n          return n.signal.getDuration();\n        },\n        disconnect: function () {\n          n.signal.disconnect();\n        },\n        close: function () {\n          n.signal.close();\n        },\n        getURL: function () {\n          return n.signal.getURL();\n        },\n        reconnect: function () {\n          n.signal.reconnect();\n        },\n        connectNext: function () {\n          n.signal.connectNext();\n        },\n        replaceHost: function (e) {\n          n.signal.replaceHost(e);\n        },\n        emitSimpleMessage: function (e, t) {\n          n.signal.sendSignalCommand(e, t);\n        },\n        emitRequest: function (e, t) {\n          n.signal.sendRequest(e, t);\n        },\n        emitReport: function (e) {\n          n.signal.sendReport(e);\n        }\n      };\n      return n.connect(), n;\n    },\n        Me = function (e, t) {\n      var n = !1,\n          i = 0,\n          a = {\n        command: \"convergeAllocateEdge\",\n        sid: e.sid,\n        appId: e.appId,\n        token: e.token,\n        uid: e.uid,\n        cname: e.cname,\n        ts: Math.floor(Date.now() / 1e3),\n        version: r.VERSION,\n        seq: 0,\n        requestId: 1\n      };\n      Object(r.getParameter)(\"PROXY_CS\").map(function (c) {\n        var d = new Date().getTime();\n        Pe(\"https://\" + c + \"/api/v1\", a, function (a, u) {\n          if (a) return o.default.debug(\"[\" + e.clientId + \"] Request proxy server failed: \", a), i++, s.b.requestProxyAppCenter(e.sid, {\n            lts: d,\n            succ: !1,\n            APAddr: c,\n            workerManagerList: null,\n            ec: JSON.stringify(a),\n            response: JSON.stringify({\n              err: a,\n              res: u\n            })\n          }), void (i >= Object(r.getParameter)(\"PROXY_CS\").length && t && t(\"Get proxy server failed: request all failed\"));\n          if (!n) if ((u = JSON.parse(u)).json_body) {\n            var l = JSON.parse(u.json_body);\n\n            if (o.default.debug(\"[\" + e.clientId + \"] App return:\", l.servers), 200 !== l.code) {\n              a = \"Get proxy server failed: response code [\" + l.code + \"], reason [ \" + l.reason + \"]\";\n              o.default.debug(\"[\" + e.clientId + \"] \" + a), s.b.requestProxyAppCenter(e.sid, {\n                lts: d,\n                succ: !1,\n                APAddr: c,\n                workerManagerList: null,\n                ec: a,\n                response: JSON.stringify({\n                  err: a,\n                  res: u\n                })\n              });\n            } else {\n              n = !0;\n              var f = Ue(l.servers);\n              s.b.requestProxyAppCenter(e.sid, {\n                lts: d,\n                succ: !0,\n                APAddr: c,\n                workerManagerList: JSON.stringify(f),\n                ec: null,\n                response: JSON.stringify({\n                  res: u\n                })\n              }), t && t(null, f);\n            }\n          } else o.default.debug(\"[\" + e.clientId + \"] Get proxy server failed: no json_body\"), s.b.requestProxyAppCenter(e.sid, {\n            lts: d,\n            succ: !1,\n            APAddr: c,\n            workerManagerList: null,\n            ec: \"Get proxy server failed: no json_body\",\n            response: JSON.stringify({\n              res: u\n            })\n          });\n        });\n      });\n    },\n        Pe = function (e, t, n) {\n      var i = {\n        service_name: \"webrtc_proxy\",\n        json_body: JSON.stringify(t)\n      };\n      Object(ke.post)(e, i, function (e) {\n        n && n(null, e);\n      }, function (e) {\n        n && n(e);\n      }, {\n        \"X-Packet-Service-Type\": 0,\n        \"X-Packet-URI\": 61\n      });\n    },\n        xe = function (e, t, n) {\n      var i = !1,\n          a = 0,\n          r = {\n        command: \"request\",\n        gatewayType: \"http\",\n        appId: e.appId,\n        cname: e.cname,\n        uid: e.uid + \"\",\n        sdkVersion: \"2.3.1\",\n        sid: e.sid,\n        seq: 1,\n        ts: +new Date(),\n        requestId: 3,\n        clientRequest: {\n          appId: e.appId,\n          cname: e.cname,\n          uid: e.uid + \"\",\n          sid: e.sid\n        }\n      };\n      t.map(function (c) {\n        var d = new Date().getTime();\n        !function (e, t, n) {\n          Object(ke.post)(e, t, function (e) {\n            n && n(null, e);\n          }, function (e) {\n            n && n(e);\n          });\n        }(\"https://\" + c + \":4000/v2/machine\", r, function (r, u) {\n          if (r) return o.default.debug(\"[\" + e.clientId + \"] Request worker manager failed: \", r), a++, s.b.requestProxyWorkerManager(e.sid, {\n            lts: d,\n            succ: !1,\n            workerManagerAddr: c,\n            ec: JSON.stringify(r),\n            response: JSON.stringify({\n              res: u\n            })\n          }), void (a >= t.length && n && n(\"requeet worker manager server failed: request failed\"));\n\n          if (!i) {\n            if (!(u = JSON.parse(u)).serverResponse) return n && n(\"requeet worker manager server failed: serverResponse is undefined\");\n            i = !0, s.b.requestProxyWorkerManager(e.sid, {\n              lts: d,\n              succ: !0,\n              workerManagerAddr: c,\n              ec: JSON.stringify(r),\n              response: JSON.stringify({\n                res: u\n              })\n            }), n && n(null, {\n              address: c,\n              serverResponse: u.serverResponse\n            });\n          }\n        });\n      });\n    },\n        Ue = function (e) {\n      if (!e || [] instanceof Array == !1) return [];\n      var t = [];\n      return e.forEach(function (e) {\n        var n;\n        e.address && e.tcp ? (e.address.match(/^[\\.\\:\\d]+$/) ? n = \"\".concat(e.address.replace(/[^\\d]/g, \"-\"), \".edge.agora.io\") : (o.default.info(\"[\" + joinInfo.clientId + \"] \" + \"Cannot recognized as IP address \".concat(e.address, \". Used As Host instead\")), n = \"\".concat(e.address, \":\").concat(e.tcp)), t.push(n)) : o.default.error(\"[\" + joinInfo.clientId + \"] Invalid address format \", e);\n      }), t;\n    },\n        Ve = function (e, t) {\n      var n = h()({}, e),\n          i = Object(r.getParameter)(\"CDS_AP\"),\n          a = [],\n          o = !1;\n      (i = i.map(function (e) {\n        return n.proxyServer ? \"https://\".concat(n.proxyServer, \"/ap/?url=\").concat(e + \"/api/v1\") : \"https://\".concat(e, \"/api/v1?action=config\");\n      })).map(function (e) {\n        !function (e, t, n) {\n          var i = {\n            flag: 64,\n            cipher_method: 0,\n            timeout: 1e3,\n            features: t\n          };\n          Object(ke.post)(e, i, function (e) {\n            try {\n              var t = JSON.parse(e);\n              n && n(null, t);\n            } catch (e) {\n              n && n(e);\n            }\n\n            n && n(null, e);\n          }, function (e) {\n            n && n(e);\n          }, {\n            \"X-Packet-Service-Type\": 0,\n            \"X-Packet-URI\": 54\n          });\n        }(e, n, function (e, n) {\n          o || (e ? (a.push(e), a.length >= i.length && t && t(\"ALL_REQUEST_FAILED\")) : (o = !0, t && t(null, n)));\n        });\n      });\n    },\n        je = {},\n        Fe = {},\n        Be = function (e, t, n, i) {\n      var a = new Date().getTime(),\n          c = t,\n          d = \"\";\n      t.multiIP && t.multiIP.gateway_ip && (d = {\n        vocs_ip: [t.multiIP.uni_lbs_ip],\n        vos_ip: [t.multiIP.gateway_ip]\n      });\n      var u = {\n        opid: 133,\n        flag: 4096,\n        ts: +new Date(),\n        key: t.token,\n        cname: t.cname,\n        sid: t.sid,\n        detail: {\n          6: t.stringUid\n        },\n        uid: t.uid || 0\n      };\n      d && (u.detail[5] = JSON.stringify(d)), Object(ke.post)(e + \"\".concat(-1 === e.indexOf(\"?\") ? \"?\" : \"&\", \"action=wrtc_gateway\"), u, function (d) {\n        try {\n          var u = JSON.parse(d);\n          u.res && (u = u.res);\n          var l = u.code;\n        } catch (e) {\n          var f = \"requestChooseServer failed with unexpected body \" + d;\n          return o.default.error(\"[\" + c.clientId + \"]\", f), i(f);\n        }\n\n        if (l) {\n          var p = I.APErrorCode[u.code] || l;\n          return s.b.joinChooseServer(t.sid, {\n            lts: a,\n            succ: !1,\n            csAddr: e,\n            serverList: null,\n            ec: p\n          }), i(\"Get server node failed [\" + p + \"]\", e, p);\n        }\n\n        var g = [],\n            m = Object(r.getParameter)(\"GATEWAY_DOMAINS\"),\n            v = 0;\n\n        if (e.indexOf(m[1]) > -1 && (v = 1), u.addresses.forEach(function (e) {\n          var t;\n          e.ip && e.port ? (e.ip.match(/^[\\.\\:\\d]+$/) ? t = \"\".concat(e.ip.replace(/[^\\d]/g, \"-\"), \".\").concat(m[v++ % m.length], \":\").concat(e.port) : (o.default.info(\"[\" + c.clientId + \"] \" + \"Cannot recognized as IP address \".concat(e.ip, \". Used As Host instead\")), t = \"\".concat(e.ip, \":\").concat(e.port)), g.push(t)) : o.default.error(\"[\" + c.clientId + \"] Invalid address format \", e);\n        }), !g.length) {\n          o.default.error(\"[\" + c.clientId + \"] Empty Address response\", u);\n          p = \"EMPTY_ADDRESS_RESPONSE\";\n          return s.b.joinChooseServer(t.sid, {\n            lts: a,\n            succ: !1,\n            csAddr: e,\n            serverList: null,\n            ec: p\n          }), i(\"Get server node failed [\" + p + \"]\", e, p);\n        }\n\n        var S = {\n          gateway_addr: g,\n          uid: u.uid,\n          cid: u.cid,\n          vid: u.detail && u.detail[8],\n          res: u,\n          uni_lbs_ip: u.detail\n        };\n        return n(S, e);\n      }, function (e, n) {\n        \"timeout\" === e.type ? (s.b.joinChooseServer(t.sid, {\n          lts: a,\n          succ: !1,\n          csAddr: n,\n          serverList: null,\n          ec: \"timeout\"\n        }), i(\"Connect choose server timeout\", n)) : (s.b.joinChooseServer(t.sid, {\n          lts: a,\n          succ: !1,\n          csAddr: n,\n          serverList: null,\n          ec: \"server_wrong\"\n        }), i(\"Connect choose server error\", n));\n      }, {\n        \"X-Packet-Service-Type\": 0,\n        \"X-Packet-URI\": 69\n      });\n    },\n        We = function (e, t, n) {\n      var i = !1,\n          a = null,\n          c = 1,\n          d = 1,\n          u = null,\n          l = e.clientId,\n          f = function t(d, f) {\n        if (!i) {\n          var p = !1,\n              m = !1,\n              v = [],\n              S = g.getBrowserInfo() || {};\n          Ve({\n            device: S.name,\n            system: S.os,\n            vendor: e.appId,\n            version: r.VERSION,\n            cname: e.cname,\n            sid: e.sid,\n            session_id: Object(s.a)(),\n            detail: \"\",\n            proxyServer: d\n          }, function (t, n) {\n            m = !0;\n\n            try {\n              var i = Object.keys(n.test_tags)[0],\n                  a = JSON.parse(n.test_tags[i]);\n              u = a[1];\n            } catch (e) {\n              u = null;\n            }\n\n            s.b.reportApiInvoke(e.sid, {\n              name: \"_config-distribute-request\",\n              options: {\n                err: t,\n                res: n\n              }\n            })(), Fe[l] !== et.DISCONNECTED && Fe[l] !== et.DISCONNECTING ? p && f && f(v, u) : o.default.debug(\"[\".concat(e.clientId, \"] Request config success when connection state is \").concat(Fe[l]));\n          }), function (e, t, n) {\n            for (var i = new Date().getTime(), a = !1, c = !0, d = function (n, r) {\n              if (a) s.b.joinChooseServer(e.sid, {\n                lts: i,\n                succ: !0,\n                csAddr: r,\n                serverList: n.gateway_addr,\n                cid: n.cid + \"\",\n                uid: n.uid + \"\",\n                ec: null\n              }, !1);else {\n                if (clearTimeout(m), a = !0, o.default.debug(\"[\" + e.clientId + \"] Get gateway address:\", n.gateway_addr), e.proxyServer) {\n                  for (var c = n.gateway_addr, d = 0; d < c.length; d++) {\n                    var u = c[d].split(\":\");\n                    n.gateway_addr[d] = e.proxyServer + \"/ws/?h=\" + u[0] + \"&p=\" + u[1];\n                  }\n\n                  o.default.debug(\"[\" + e.clientId + \"] Get gateway address:\", n.gateway_addr);\n                }\n\n                t(n), s.b.joinChooseServer(e.sid, {\n                  lts: i,\n                  succ: !0,\n                  csAddr: r,\n                  serverList: n.gateway_addr,\n                  cid: n.cid + \"\",\n                  uid: n.uid + \"\",\n                  ec: null\n                }, !0);\n              }\n            }, u = function (t, i, a) {\n              c && (o.default.error(\"[\" + e.clientId + \"]\", t, i, a), a && -1 === I.JOIN_CS_RETRY_LIST.indexOf(a) && (c = !1, n(a)));\n            }, l = Object(r.getParameter)(\"WEBCS_DOMAIN\"), f = 0; f < l.length; ++f) {\n              var p;\n\n              if (\"string\" == typeof l[f]) {\n                var g = l[f];\n                p = e.proxyServer ? \"https://\".concat(e.proxyServer, \"/ap/?url=\").concat(g + \"/api/v1\") : \"https://\".concat(g, \"/api/v1\"), o.default.debug(\"[\" + e.clientId + \"] \" + \"Connect to choose_server: \".concat(p)), Be(p, e, d, u);\n              } else o.default.error(\"[\" + e.clientId + \"] Invalid Host\", l[f]);\n            }\n\n            var m = setTimeout(function () {\n              if (!a) for (var t = Object(r.getParameter)(\"WEBCS_DOMAIN_BACKUP_LIST\"), n = 0; n < t.length; ++n) if (\"string\" == typeof t[n]) {\n                var i = t[n];\n                p = e.proxyServer ? \"https://\".concat(e.proxyServer, \"/ap/?url=\").concat(i + \"/api/v1\") : \"https://\".concat(i, \"/api/v1\"), o.default.debug(\"[\" + e.clientId + \"] \" + \"Connect to backup_choose_server: \".concat(p)), Be(p, e, d, u);\n              } else o.default.error(\"[\" + e.clientId + \"] Invalid Host\", t[n]);\n            }, 1e3);\n            setTimeout(function () {\n              !a && c && n();\n            }, Object(r.getParameter)(\"WEBCS_BACKUP_CONNECT_TIMEOUT\"));\n          }(e, function (t) {\n            i = !0, p = !0, v = t, clearTimeout(a), Fe[l] !== et.DISCONNECTED && Fe[l] !== et.DISCONNECTING ? m && f && f(v, u) : o.default.debug(\"[\".concat(e.clientId, \"] Request gateway list success when connection state is \").concat(Fe[l]));\n          }, function (i) {\n            if (i) return o.default.info(\"[\" + e.clientId + \"] Join failed: \" + i), void (n && n(i));\n            if (Fe[l] === et.DISCONNECTED || Fe[l] === et.DISCONNECTING) return o.default.debug(\"[\".concat(e.clientId, \"] Request gateway list falied when connection state is \").concat(Fe[l])), void (n && n(\"OPERATION_ABORT\"));\n            o.default.debug(\"[\" + e.clientId + \"] Request gateway list will be restart in \" + c + \"s\"), a = setTimeout(function () {\n              t(d, f);\n            }, 1e3 * c), je[l] = a;\n            var s = Object(r.getParameter)(\"AP_BACKOFF_MAX_TIME\");\n            c = c >= s ? s : 2 * c;\n          });\n        }\n      };\n\n      e.useProxyServer ? function n() {\n        !function (e, t) {\n          Me(e, function (n, i) {\n            if (n) return t && t(n);\n            o.default.debug(\"[\" + e.clientId + \"] getProxyServerList: \", i), xe(e, i, t);\n          });\n        }(e, function (i, c) {\n          if (i) {\n            o.default.debug(\"[\" + e.clientId + \"]\", i), o.default.debug(\"[\" + e.clientId + \"] Request proxy will be restart in \" + d + \"s\"), a = setTimeout(function () {\n              n();\n            }, 1e3 * d), je[l] = a;\n            var u = Object(r.getParameter)(\"AP_BACKOFF_MAX_TIME\");\n            d = d >= u ? u : 2 * d;\n          } else {\n            clearTimeout(a);\n            var p = c.address;\n            e.proxyServer = p;\n            var g = {\n              mode: \"manual\",\n              url: c.address,\n              tcpport: c.serverResponse.tcpport || \"3433\",\n              udpport: c.serverResponse.udpport || \"3478\",\n              username: c.serverResponse.username || \"test\",\n              credential: c.serverResponse.password || Object(r.getParameter)(\"TURN_SERVER_PASSWORD\"),\n              forceturn: !0\n            };\n            g.tcpport += \"\", g.udpport += \"\", e.turnServers = [], e.turnServers.push(g), s.b.setProxyServer(p), o.default.setProxyServer(p), f(p, t);\n          }\n        });\n      }() : f(null, t);\n    },\n        He = function (e, t, n, i) {\n      var a = Date.now();\n      i = i || t.stringUid;\n      var r = {\n        sid: t.sid,\n        opid: 10,\n        appid: t.appId,\n        string_uid: i\n      };\n      return new Promise(function (c, d) {\n        Object(ke.post)(e + \"\".concat(-1 === e.indexOf(\"?\") ? \"?\" : \"&\", \"action=stringuid\"), r, function (u) {\n          try {\n            var l = JSON.parse(u),\n                f = l.code;\n          } catch (c) {\n            var p = \"requestUserAccount failed with unexpected body \" + u;\n            return o.default.error(\"[\" + t.clientId + \"]\", p), d({\n              retryable: !0,\n              info: p,\n              url: e\n            }), n && n.dispatchEvent({\n              type: \"error\",\n              reason: \"USER_ACCOUNT_BODY_NOT_JSON\"\n            }), void s.b.reqUserAccount(r.sid, {\n              lts: a,\n              success: !1,\n              serverAddress: e,\n              stringUid: i,\n              uid: null,\n              extend: u,\n              errorCode: \"USER_ACCOUNT_BODY_NOT_JSON\"\n            });\n          }\n\n          if (f) {\n            var g = I.StringUidErrorCode[l.code % 1e4] || \"REQ_ACCOUNT_ERR_\".concat(f);\n            return n && n.dispatchEvent({\n              type: \"error\",\n              reason: g\n            }), s.b.reqUserAccount(r.sid, {\n              lts: a,\n              success: !1,\n              serverAddress: e,\n              stringUid: i,\n              uid: null,\n              errorCode: g,\n              extend: r\n            }), d({\n              retryable: !1,\n              info: p = \"Get String Uid Failed [\" + g + \"]\",\n              url: e,\n              error: g\n            });\n          }\n\n          var m = l.uid;\n\n          if (!(m > 0 && m < Math.pow(2, 32))) {\n            o.default.error(\"[\" + t.clientId + \"] \" + \"Invalid Uint Uid \".concat(i, \" => \").concat(m), l);\n            g = \"INVALID_UINT_UID_\".concat(m);\n            return n && n.dispatchEvent({\n              type: \"error\",\n              reason: g\n            }), s.b.reqUserAccount(r.sid, {\n              lts: a,\n              success: !1,\n              serverAddress: e,\n              stringUid: i,\n              uid: null,\n              errorCode: g,\n              extend: r\n            }), d({\n              retryable: !0,\n              error: g,\n              info: \"Get String Uid failed [\" + g + \"]\",\n              url: e\n            });\n          }\n\n          c({\n            uid: m,\n            url: e\n          }), s.b.reqUserAccount(r.sid, {\n            lts: a,\n            success: !0,\n            serverAddress: e,\n            stringUid: i,\n            uid: m,\n            errorCode: null,\n            extend: r\n          });\n        }, function (e, t) {\n          if (\"timeout\" === e.type) {\n            var o = \"USER_ACCOUNT_TIMEOUT\";\n            n && n.dispatchEvent({\n              type: \"error\",\n              reason: o\n            }), s.b.reqUserAccount(r.sid, {\n              lts: a,\n              success: !1,\n              serverAddress: t,\n              stringUid: i,\n              uid: null,\n              errorCode: o,\n              extend: r\n            }), d({\n              retryable: !0,\n              info: o,\n              url: t\n            });\n          } else {\n            var c = \"USER_ACCOUNT_SERVER_WRONG_\".concat(e.type);\n            n && n.dispatchEvent({\n              type: \"error\",\n              reason: c\n            }), s.b.reqUserAccount(r.sid, {\n              lts: a,\n              success: !1,\n              serverAddress: t,\n              stringUid: i,\n              uid: null,\n              errorCode: c,\n              extend: r\n            }), d({\n              retryable: !0,\n              info: c,\n              url: t\n            });\n          }\n        }, {\n          \"X-Packet-Service-Type\": 0,\n          \"X-Packet-URI\": 72\n        });\n      });\n    },\n        Ge = function (e, t, n) {\n      Date.now();\n      var a,\n          s = Object(r.getParameter)(\"ACCOUNT_REGISTER\"),\n          c = !1,\n          d = Object(r.getParameter)(\"ACCOUNT_REGISTER_RETRY_TIMEOUT\"),\n          u = null,\n          l = null,\n          f = new Promise(function () {\n        var f = K()(Y.a.mark(function f(p, g) {\n          var m, v, S;\n          return Y.a.wrap(function (f) {\n            for (;;) switch (f.prev = f.next) {\n              case 0:\n                u = p, l = g, a = 0;\n\n              case 3:\n                if (!(a < Object(r.getParameter)(\"ACCOUNT_REGISTER_RETRY_COUNT_MAX\"))) {\n                  f.next = 33;\n                  break;\n                }\n\n                if (!c) {\n                  f.next = 6;\n                  break;\n                }\n\n                return f.abrupt(\"return\");\n\n              case 6:\n                return m = s[a % s.length], v = e.proxyServer ? \"https://\".concat(e.proxyServer, \"/ap/?url=\").concat(s[i] + \"/api/v1\") : \"https://\".concat(m, \"/api/v1\"), f.prev = 8, f.delegateYield(Y.a.mark(function i() {\n                  var a;\n                  return Y.a.wrap(function (i) {\n                    for (;;) switch (i.prev = i.next) {\n                      case 0:\n                        return i.next = 2, He(v, e, t, n);\n\n                      case 2:\n                        if (a = i.sent, !c) {\n                          i.next = 5;\n                          break;\n                        }\n\n                        return i.abrupt(\"return\", {\n                          v: void 0\n                        });\n\n                      case 5:\n                        c = !0, setTimeout(function () {\n                          o.default.debug(\"Get UserAccount Successfully\", a), u(a);\n                        }, 0);\n\n                      case 7:\n                      case \"end\":\n                        return i.stop();\n                    }\n                  }, i, this);\n                })(), \"t0\", 10);\n\n              case 10:\n                if (S = f.t0, \"object\" !== Se()(S)) {\n                  f.next = 13;\n                  break;\n                }\n\n                return f.abrupt(\"return\", S.v);\n\n              case 13:\n                f.next = 30;\n                break;\n\n              case 15:\n                if (f.prev = 15, f.t1 = f.catch(8), !c) {\n                  f.next = 19;\n                  break;\n                }\n\n                return f.abrupt(\"return\");\n\n              case 19:\n                if (!f.t1.retryable) {\n                  f.next = 27;\n                  break;\n                }\n\n                return (d = Math.ceil(d * Object(r.getParameter)(\"ACCOUNT_REGISTER_RETRY_RATIO\"))) > Object(r.getParameter)(\"ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX\") && (d = Object(r.getParameter)(\"ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX\")), o.default.error(\"\".concat(f.t1.info, \" \").concat(f.t1.url, \" Will Fetch User Account in \").concat(d / 1e3, \" seconds\")), f.next = 25, new Promise(function (e) {\n                  setTimeout(e, d);\n                });\n\n              case 25:\n                f.next = 30;\n                break;\n\n              case 27:\n                o.default.error(\"Get UserAccount Error: \".concat(f.t1.info, \" \").concat(f.t1.url), f.t1.error), c = !0, l(f.t1);\n\n              case 30:\n                a++, f.next = 3;\n                break;\n\n              case 33:\n              case \"end\":\n                return f.stop();\n            }\n          }, f, this, [[8, 15]]);\n        }));\n        return function (e, t) {\n          return f.apply(this, arguments);\n        };\n      }());\n      return f.cancel = function () {\n        c || (c = !0, l({\n          info: \"Request Cancelled\",\n          retryable: !1\n        }));\n      }, f.isFinished = function () {\n        return c;\n      }, f;\n    },\n        qe = {\n      ERR_NO_VOCS_AVAILABLE: \"tryNext\",\n      ERR_NO_VOS_AVAILABLE: \"tryNext\",\n      ERR_JOIN_CHANNEL_TIMEOUT: \"tryNext\",\n      WARN_REPEAT_JOIN: \"quit\",\n      ERR_JOIN_BY_MULTI_IP: \"recover\",\n      WARN_LOOKUP_CHANNEL_TIMEOUT: \"tryNext\",\n      WARN_OPEN_CHANNEL_TIMEOUT: \"tryNext\",\n      ERR_VOM_SERVICE_UNAVAILABLE: \"tryNext\",\n      ERR_TOO_MANY_USERS: \"tryNext\",\n      ERR_MASTER_VOCS_UNAVAILABLE: \"tryNext\",\n      ERR_INTERNAL_ERROR: \"tryNext\",\n      K_SERVICE_NOT_READY: \"recover\",\n      K_SERVICE_TOO_HEAVY: \"tryNext\",\n      notification_test_recover: \"recover\",\n      notification_test_tryNext: \"tryNext\",\n      notification_test_retry: \"retry\"\n    },\n        Ye = {\n      googActualEncBitrate: \"A_aeb\",\n      googAvailableSendBandwidth: \"A_asb\",\n      googRetransmitBitrate: \"A_rb\",\n      googAvailableReceiveBandwidth: \"A_arb\",\n      googTargetEncBitrate: \"A_teb\",\n      googBucketDelay: \"A_bd\",\n      googTransmitBitrate: \"A_tb\",\n      googCodecName: \"A_cn\",\n      bytesSent: \"bytesSent\",\n      packetsLost: \"packetsLost\",\n      packetsSent: \"packetsSent\",\n      googAdaptationChanges: \"A_ac\",\n      googAvgEncodeMs: \"A_aem\",\n      googEncodeUsagePercent: \"A_eup\",\n      googFirsReceived: \"A_fr\",\n      googFrameHeightInput: \"A_fhi\",\n      googFrameHeightSent: \"A_fhs\",\n      googFrameRateInput: \"A_fri\",\n      googFrameRateSent: \"A_frs\",\n      googFrameWidthInput: \"A_fwi\",\n      googFrameWidthSent: \"A_fws\",\n      googNacksReceived: \"A_nr\",\n      googPlisReceived: \"A_pr\",\n      googRtt: \"A_rtt\",\n      aecDivergentFilterFraction: \"A_adff\",\n      audioInputLevel: \"A_ail\",\n      googEchoCancellationReturnLoss: \"A_ecrl\",\n      googEchoCancellationReturnLossEnhancement: \"A_ecrle\",\n      googResidualEchoLikelihood: \"A_rel\",\n      googResidualEchoLikelihoodRecentMax: \"A_relrm\",\n      googTargetDelayMs: \"A_tdm\",\n      bytesReceived: \"bytesReceived\",\n      packetsReceived: \"packetsReceived\",\n      googDecodeMs: \"A_dm\",\n      googMaxDecodeMs: \"A_mdm\",\n      googRenderDelayMs: \"A_rdm\",\n      googFrameWidthReceived: \"A_fwr\",\n      googFrameHeightReceived: \"A_fhr\",\n      googFrameRateReceived: \"A_frr\",\n      googFrameRateDecoded: \"A_frd\",\n      googFrameRateOutput: \"A_fro\",\n      googJitterBufferMs: \"A_jbm\",\n      googCurrentDelayMs: \"A_cdm\",\n      googMinPlayoutDelayMs: \"A_mpdm\",\n      googNacksSent: \"A_ns\",\n      googPlisSent: \"A_ps\",\n      googFirsSent: \"A_fs\",\n      audioOutputLevel: \"A_aol\",\n      googAccelerateRate: \"A_ar\",\n      googDecodingCNG: \"A_dcng\",\n      googDecodingCTN: \"A_dctn\",\n      googDecodingCTSG: \"A_dctsg\",\n      googDecodingNormal: \"A_dn\",\n      googDecodingPLC: \"A_dplc\",\n      googDecodingPLCCNG: \"A_dplccng\",\n      googExpandRate: \"A_er\",\n      googJitterReceived: \"A_jr\",\n      googPreemptiveExpandRate: \"A_per\",\n      googPreferredJitterBufferMs: \"A_pjbm\",\n      googSecondaryDecodedRate: \"A_sdr\",\n      googSpeechExpandRate: \"A_ser\",\n      uplink_fraction_lost: \"B_ufl\",\n      uplink_cumulative_lost: \"B_ucl\",\n      uplink_available_bandwidth: \"B_uab\",\n      period_fir: \"B_fir\",\n      access_delay: \"B_acd\",\n      uplink_network_quality: \"B_unq\",\n      downlink_network_quality: \"B_dnq\",\n      pub_audio_lost_ratio_400ms: \"B_palr4\",\n      pub_video_lost_ratio_400ms: \"B_pvlr4\",\n      e2e_delay: \"B_ed\",\n      audio_delay: \"B_ad\",\n      video_delay: \"B_vd\",\n      stream_type: \"B_st\",\n      e2e_audio_lost_ratio_400ms: \"B_ealr4\",\n      e2e_video_lost_ratio_400ms: \"B_evlr4\",\n      downlink_estimate_bandwidth: \"B_deb\"\n    },\n        Je = {};\n\n    for (var Ke in Ye) {\n      var ze = Ye[Ke];\n      Je[ze] && o.default.error(\"Key Conflict: \".concat(ze, \": \").concat(Ye[ze], \"| \").concat(Ke)), Je[ze] = Ke;\n    }\n\n    var Xe = function (e) {\n      return Ye[e] || e;\n    },\n        Qe = function (e) {\n      return Je[e] || e;\n    };\n\n    var $e = function t(n) {\n      var i = !1,\n          a = function (e) {\n        return {\n          _type: \"control\",\n          _message: e\n        };\n      },\n          d = function (e, t) {\n        var n = {};\n        return Object.keys(t).forEach(function (e) {\n          Object(r.getParameter)(\"STATS_FILTER\")[e] || (n[Xe(e)] = t[e]);\n        }), {\n          _type: \"subscribe_related_stats\",\n          _message: {\n            stream_type: \"high\",\n            stream_id: e,\n            stats: n\n          }\n        };\n      },\n          m = function (e) {\n        return {\n          _type: \"publish\",\n          _message: e\n        };\n      },\n          v = function (e, t) {\n        var n = {};\n        return Object.keys(t).forEach(function (e) {\n          Object(r.getParameter)(\"STATS_FILTER\")[e] || (n[Xe(e)] = t[e]);\n        }), {\n          _type: \"subscribe_stats\",\n          _message: {\n            stream_id: e,\n            stats: n\n          }\n        };\n      },\n          S = t.DISCONNECTED,\n          _ = t.CONNECTING,\n          E = t.CONNECTED,\n          T = t.DISCONNECTING,\n          y = S,\n          b = c(n);\n\n      Object.defineProperty(b, \"state\", {\n        set: function (e) {\n          var n = y;\n          y = e, function (e, t) {\n            Fe[e] = t;\n          }(b.clientId, e), e !== t.CONNECTED && (b.hasJoined = !1), n !== e && b.dispatchEvent({\n            type: \"connection-state-change\",\n            prevState: t.connetionStateMap[n],\n            curState: t.connetionStateMap[e]\n          });\n        },\n        get: function () {\n          return y;\n        }\n      }), b.socket = void 0, b.state = S, b.mode = n.mode, b.role = n.role, b.codec = n.codec, b.config = {}, b.timers = {}, b.timer_counter = {}, b.localStreams = {}, b.remoteStreams = {}, b.remoteMuteState = {}, b.attemps = 1, b.p2p_attemps = 1, b.audioLevel = {}, b.activeSpeaker = void 0, b.reconnectMode = \"tryNext\", b.rejoinAttempt = 0, b.hasChangeBGPAddress = !1, b.traffic_stats = {}, b.clientId = n.clientId, b.pingpongCounter = 0, b.hasInvokeLeave = !1, b.p2ps = new Map(), b.liveStreams = new Map(), b.injectLiveStreams = new Map(), b.remoteStreamsInChannel = new Set(), b.hasJoined = !1, function (e) {\n        var t = we;\n        e.makeRequest = function (n, i, a) {\n          if (void 0 === e.socket) return o.default.debug(\"[\".concat(e.clientId, \"] No socket available\")), void t(a, I.default.INVALID_OPERATION);\n\n          try {\n            e.socket.emitRequest(n, function (e, t) {\n              var n;\n              \"success\" === e ? \"function\" == typeof i && i(t) : \"function\" == typeof a && (n = t && t.error_code && I.GatewayErrorCode[t.error_code] ? I.GatewayErrorCode[t.error_code] : t && t.error_str ? t.error_str : t && t.error_code ? \"UNKNOW_ERROR_\".concat(t.error_code) : e, a(n, t));\n            });\n          } catch (i) {\n            o.default.debug(\"[\".concat(e.clientId, \"] Socket emit message failed \").concat(JSON.stringify(n))), o.default.debug(\"[\".concat(e.clientId, \"] \"), i), t(a, I.default.SOCKET_ERROR);\n          }\n        }, e.makeReport = function (t) {\n          void 0 === e.socket && o.default.debug(\"[\".concat(e.clientId, \"] No socket available\"));\n\n          try {\n            e.socket.emitReport(t);\n          } catch (n) {\n            o.default.debug(\"[\".concat(e.clientId, \"] Socket emit report failed \").concat(JSON.stringify(t)));\n          }\n        };\n      }(b), b.inChannelInfo = {\n        joinAt: null,\n        duration: 0\n      }, b._sendMessage = function (e, t) {\n        switch (e) {\n          case \"SubscribeStats\":\n            b.makeReport(v.apply(void 0, Ne()(t)));\n            break;\n\n          case \"SubscribeRelatedStats\":\n            b.makeReport(d.apply(void 0, Ne()(t)));\n        }\n      };\n      var R = we;\n      b.p2pCounter = Object(F.random)(1e5), b.generateP2PId = function () {\n        return ++b.p2pCounter;\n      }, b.audioVolumeIndication = {\n        enabled: !1,\n        sortedAudioVolumes: [],\n        smooth: 3,\n        interval: 2e3\n      }, b.remoteVideoStreamTypes = {\n        REMOTE_VIDEO_STREAM_HIGH: 0,\n        REMOTE_VIDEO_STREAM_LOW: 1,\n        REMOTE_VIDEO_STREAM_MEDIUM: 2\n      }, b.streamFallbackTypes = {\n        STREAM_FALLBACK_OPTION_DISABLED: 0,\n        STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW: 1,\n        STREAM_FALLBACK_OPTION_AUDIO_ONLY: 2\n      }, b.configPublisher = function (e) {\n        b.config = e;\n      }, b.getGatewayInfo = function (e, t) {\n        b.makeRequest({\n          _type: \"gateway_info\"\n        }, e, t);\n      }, b.setClientRole = function (e, t) {\n        o.default.debug(\"[\".concat(b.clientId, \"] setClientRole to \").concat(e));\n        var n = s.b.reportApiInvoke(b.joinInfo.sid, {\n          name: \"_setClientRole\",\n          callback: t\n        });\n        b.makeRequest({\n          _type: \"set_client_role\",\n          _message: {\n            role: e\n          }\n        }, function () {\n          b.role = e, b.dispatchEvent({\n            type: \"client-role-changed\",\n            role: e\n          }), n && n(null, {\n            role: e\n          });\n        }, function (t, i) {\n          if (i && i.code && (t = I.GatewayErrorCode[i.code] || \"UNKNOW_ERROR_\" + i.code), \"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE\" === t) return n && n(null);\n          o.default.error(\"set Client role error to \" + e + \": \" + t), n && n(t);\n        });\n      }, b.join = function (e, t, i, a) {\n        e.useProxyServer && (b.hasChangeBGPAddress = !0);\n        var c = new Date().getTime(),\n            d = e.uid;\n        if (b.inChannelInfo.joinAt && (b.inChannelInfo.duration += c - b.inChannelInfo.joinAt), b.inChannelInfo.joinAt = c, b.state !== _) return o.default.error(\"[\".concat(b.clientId, \"] GatewayClient.join Failed: state \"), b.state), a && a(I.default.INVALID_OPERATION), void s.b.joinGateway(e.sid, {\n          lts: c,\n          succ: !1,\n          ec: I.default.INVALID_OPERATION,\n          addr: null\n        });\n        if (null != d && parseInt(d) !== d) return o.default.error(\"[\".concat(b.clientId, \"] Input uid is invalid\")), b.state = S, a && a(I.default.INVALID_PARAMETER), void s.b.joinGateway(e.sid, {\n          lts: c,\n          succ: !1,\n          ec: I.default.INVALID_PARAMETER,\n          addr: null\n        });\n        var u = Ze.register(b, {\n          uid: d,\n          cname: e && e.cname\n        });\n        if (u) return b.state = S, a && a(u), void s.b.joinGateway(e.sid, {\n          lts: c,\n          succ: !1,\n          ec: u,\n          addr: null\n        });\n        b.joinInfo = h()({}, e), b.uid = d, b.key = t, b.pingpongCounter = 0, N(e, function (t) {\n          if (b.state === T || b.state === S) return a && a(\"LEAVE_BEFORE_JOIN_SUCCESS\");\n          b.state = E, o.default.debug(\"[\".concat(b.clientId, \"] Connected to gateway server\")), clearInterval(b.pingTimer), b.pingTimer = setInterval(function () {\n            var e = Object(r.getParameter)(\"PING_PONG_TIME_OUT\");\n\n            if (++b.pingpongCounter >= e) {\n              var t = Date.now();\n              b.socket && o.default.warning(\"PINGPONG Timeout. Last Socket Message: \".concat(t - b.socket.getLastMsgTime(), \"ms\")), b.socket && b.socket.getLastMsgTime() && t - b.socket.getLastMsgTime() > Object(r.getParameter)(\"WEBSOCKET_TIMEOUT_MIN\") && (b.pingpongCounter = 0, b.socket.close(), b.socket.dispatchEvent(f({\n                type: \"disconnect\",\n                event: {\n                  msg: \"PING_PONG_TIME_OUT\"\n                }\n              })));\n            }\n\n            var n = Date.now();\n            b.makeRequest({\n              _type: \"ping\"\n            }, function () {\n              b.pingpongCounter = 0;\n              var e = Date.now() - n;\n              setTimeout(function () {\n                Object(r.getParameter)(\"REPORT_STATS\") && b.makeRequest({\n                  _type: \"ping_back\",\n                  _message: {\n                    pingpongElapse: e\n                  }\n                });\n              }, 1e3);\n            }, function (e, t) {\n              \"TIMEOUT\" !== e && (o.default.error(\"Ping Error \".concat(e, \" \").concat(JSON.stringify(t))), t && t.error_code && b.socket && b.socket.signal && b.socket.signal.connection && b.socket.signal.connection.readyState === WebSocket.OPEN && (o.default.info(\"Disconnecting websocket connection\"), b.socket.signal.connection.close()));\n            });\n          }, 3e3), b.makeRequest(function (e) {\n            var t = e.role,\n                i = h()({}, b.joinInfo.apResponse),\n                a = {\n              session_id: b.joinInfo.sid,\n              app_id: n.appId,\n              channel_key: b.key,\n              channel_name: b.joinInfo.cname,\n              sdk_version: r.VERSION,\n              browser: navigator.userAgent,\n              process_id: Object(s.a)(),\n              mode: b.mode,\n              codec: b.codec,\n              role: t,\n              has_changed_gateway: Object(r.getParameter)(\"FORCE_CHANGED_GATEWAY_FLAG\") || b.hasChangeBGPAddress,\n              ap_response: i,\n              extend: Object(r.getParameter)(\"JOIN_EXTEND\"),\n              details: {}\n            };\n\n            if (b.joinInfo.hasOwnProperty(\"stringUid\") && (a.string_uid = b.joinInfo.stringUid), b.joinInfo.aesmode && b.joinInfo.aespassword && (a.aes_mode = b.joinInfo.aesmode, a.aes_secret = b.joinInfo.aespassword), b.socket && b.socket.signal && b.socket.signal) {\n              if (i.addresses[b.socket.signal.hostIndex] && (a.ap_response.ticket = i.addresses[b.socket.signal.hostIndex].ticket, delete i.addresses), Object(r.getParameter)(\"SET_DEFAULT_TURNSERVER\") && b.socket.signal.turnConfig) {\n                var c = {\n                  username: \"test\",\n                  credential: Object(r.getParameter)(\"TURN_SERVER_PASSWORD\"),\n                  forceturn: Object(r.getParameter)(\"FORCE_TURN\")\n                };\n                c.url = b.socket.signal.turnConfig.url, b.socket.signal.turnConfig.tcpport && (c.tcpport = \"\" + b.socket.signal.turnConfig.tcpport), b.socket.signal.turnConfig.udpport && (c.udpport = \"\" + b.socket.signal.turnConfig.udpport), b.joinInfo.turnServers.push(c);\n              }\n\n              o.default.debug(\"TurnServers config\", b.joinInfo.turnServers);\n            }\n\n            return b.dispatchEvent({\n              type: \"join-message-hook\",\n              joinMessage: a\n            }), {\n              _type: \"join\",\n              _message: a\n            };\n          }({\n            role: b.role\n          }), function (t) {\n            if (s.b.joinGateway(e.sid, {\n              lts: c,\n              succ: !0,\n              ec: null,\n              vid: e.vid,\n              addr: b.socket.getURL()\n            }), b.rejoinAttempt = 0, b.hasJoined = !0, i && i(t.uid), !0 === t.return_vosip || !0 === Object(r.getParameter)(\"ENABLE_LIVE_SERVER_LIST\")) {\n              var n = null;\n\n              try {\n                n = b.socket.signal.connection.url;\n              } catch (e) {\n                o.default.debug(\"[\".concat(b.clientId, \"] Can not get gateway ip: \").concat(e));\n              }\n\n              n ? Object(r.setParameter)(\"LIVE_SERVER_LIST\", [n]) : Object(r.setParameter)(\"LIVE_SERVER_LIST\", []);\n            }\n\n            b.dispatchEvent({\n              type: \"join\"\n            }), clearInterval(b.timers.trafficStats), b.timers.trafficStats = setInterval(function () {\n              b.makeRequest({\n                _type: \"traffic_stats\"\n              }, function (e) {\n                var t = {};\n\n                for (var n in e) t[Qe(n)] = e[n];\n\n                if (t.peer_delay && t.peer_delay.length) {\n                  var i = [];\n                  t.peer_delay.forEach(function (e) {\n                    var t = {};\n\n                    for (var n in e) t[Qe(n)] = e[n];\n\n                    i.push(t);\n                  }), t.peer_delay = i;\n                }\n\n                b.traffic_stats = t;\n                var a = b.joinInfo.stringUid,\n                    r = b.localStreams[d] || b.localStreams[a];\n                r && (r.traffic_stats = {\n                  access_delay: t.access_delay\n                }), t.peer_delay && t.peer_delay.forEach(function (e) {\n                  var n = b.remoteStreams[e.peer_uid];\n                  n && (n.traffic_stats = {\n                    access_delay: t.access_delay,\n                    e2e_delay: e.e2e_delay,\n                    audio_delay: e.audio_delay,\n                    video_delay: e.video_delay\n                  });\n                }), b.dispatchEvent({\n                  type: \"after-getTrafficStats\",\n                  trafficStats: t\n                });\n              });\n            }, 3e3);\n          }, function (t, n) {\n            if (o.default.error(\"[\".concat(b.clientId, \"] User join failed [\").concat(t, \"]\")), \"ERR_JOIN_BY_MULTI_IP\" === t) {\n              try {\n                s.b.joinGateway(e.sid, {\n                  lts: c,\n                  succ: !1,\n                  ec: \"ERR_JOIN_BY_MULTI_IP\",\n                  addr: b.socket.getURL()\n                });\n              } catch (e) {}\n\n              return b.dispatchEvent({\n                type: \"onMultiIP\",\n                option: n.option\n              });\n            }\n\n            qe[t] && b.rejoinAttempt < 4 ? b._doWithAction(qe[t], i, a) : a && a(t), s.b.joinGateway(e.sid, {\n              lts: c,\n              succ: !1,\n              ec: t,\n              addr: b.socket && b.socket.getURL()\n            });\n          });\n        }, function (t) {\n          o.default.error(\"[\".concat(b.clientId, \"] User join failed [\").concat(t, \"]\")), a && a(t), s.b.joinGateway(e.sid, {\n            lts: c,\n            succ: !1,\n            ec: t,\n            addr: b.socket.getURL()\n          });\n        }), this.remoteMuteState = {}, b.resetAudioVolumeIndication();\n      }, b.leave = function (e, t) {\n        var n = Ze.unregister(b);\n\n        switch (n && o.default.debug(\"[\".concat(b.clientId, \"] \"), n), b.state) {\n          case S:\n            return o.default.debug(\"[\".concat(b.clientId, \"] Client Already in DISCONNECTED status\")), void R(e);\n\n          case T:\n            return o.default.debug(\"[\".concat(b.clientId, \"] Client Already in DISCONNECTING status\")), void R(t, I.default.INVALID_OPERATION);\n\n          case _:\n            return b.socket.close(), b.socket = void 0, o.default.info(\"[\".concat(b.clientId, \"] Client connecting, Leave channel success\")), b.state = S, e && e();\n        }\n\n        for (var i in b.state = T, b.channelMediaConfig && (b.channelMediaRelayController && b.channelMediaRelayController.dispose(), b.channelMediaConfig, b.channelMediaRelayController = null), clearInterval(b.pingTimer), b.timers) b.timers.hasOwnProperty(i) && clearInterval(b.timers[i]);\n\n        for (var i in b.inChannelInfo.joinAt && (b.inChannelInfo.duration += Date.now() - b.inChannelInfo.joinAt, b.inChannelInfo.joinAt = null), b.hasJoined ? b.makeRequest({\n          _type: \"leave\"\n        }, function (t) {\n          b.socket.close(), b.socket = void 0, o.default.info(\"[\".concat(b.clientId, \"] Leave channel success\")), b.state = S, e && e(t);\n        }, function (e) {\n          \"TIMEOUT\" !== e && (o.default.error(\"[\".concat(b.clientId, \"] Leave Channel Failed\"), e), b.state = E, t && t(e));\n        }) : (b.socket && (b.socket.close(), b.socket = void 0), o.default.info(\"[\".concat(b.clientId, \"] Leave channel before joined\")), b.state = S, e && e()), b.localStreams) if (b.localStreams.hasOwnProperty(i)) {\n          var a = b.localStreams[i];\n          delete b.localStreams[i], void 0 !== a.pc && (a.pc.close(), a.pc = void 0);\n        }\n\n        D();\n      }, b.publish = function (e, t, n, i) {\n        var c = new Date().getTime(),\n            d = !1;\n        if (e.publishLTS = c, \"object\" !== Se()(e) || null === e) return o.default.error(\"[\".concat(b.clientId, \"] Invalid local stream\")), i && i(I.default.INVALID_LOCAL_STREAM), void s.b.publish(b.joinInfo.sid, {\n          lts: c,\n          succ: !1,\n          audioName: e.hasAudio() && e.audioName,\n          videoName: e.hasVideo() && e.videoName,\n          screenName: e.hasScreen() && e.screenName,\n          ec: I.default.INVALID_LOCAL_STREAM\n        });\n        if (!e.stream && void 0 === e.url) return o.default.error(\"[\".concat(b.clientId, \"] Invalid local media stream\")), i && i(I.default.INVALID_LOCAL_STREAM), void s.b.publish(b.joinInfo.sid, {\n          lts: c,\n          succ: !1,\n          audioName: e.hasAudio() && e.audioName,\n          videoName: e.hasVideo() && e.videoName,\n          screenName: e.hasScreen() && e.screenName,\n          ec: I.default.INVALID_LOCAL_STREAM\n        });\n        if (b.state !== E) return o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\")), i && i(I.default.INVALID_OPERATION), void s.b.publish(b.joinInfo.sid, {\n          lts: c,\n          succ: !1,\n          audioName: e.hasAudio() && e.audioName,\n          videoName: e.hasVideo() && e.videoName,\n          screenName: e.hasScreen() && e.screenName,\n          ec: I.default.INVALID_OPERATION\n        });\n        var u = e.getAttributes() || {};\n\n        if (e.local && void 0 === b.localStreams[e.getId()] && (e.hasAudio() || e.hasVideo() || e.hasScreen())) {\n          var f = b.generateP2PId();\n          if (b.p2ps.set(f, e), e.p2pId = f, void 0 !== e.url) w(m({\n            state: \"url\",\n            audio: e.hasAudio(),\n            video: e.hasVideo(),\n            attributes: e.getAttributes()\n          }, e.url), function (t, n) {\n            \"success\" === t ? (e.getUserId() !== n && e.setUserId(n), b.localStreams[n] = e, e.onClose = function () {\n              b.unpublish(e);\n            }) : o.default.error(\"[\".concat(b.clientId, \"] Publish local stream failed\"), t);\n          });else {\n            b.localStreams[e.getId()] = e, e.connectionSpec = {\n              callback: function (u) {\n                o.default.debug(\"[\".concat(b.clientId, \"] SDP exchange in publish : send offer --  \"), JSON.parse(u)), b.makeRequest(m({\n                  state: \"offer\",\n                  stream_type: 1 == t.streamType ? \"low\" : \"high\",\n                  p2p_id: f,\n                  sdp: u,\n                  audio: e.audio || e.screenAudio,\n                  video: e.screen || e.video,\n                  screen: e.screen,\n                  attributes: e.getAttributes(),\n                  dtx: e.DTX,\n                  hq: e.highQuality,\n                  lq: e.lowQuality,\n                  stereo: e.stereo,\n                  speech: e.speech,\n                  codec: b.codec,\n                  extend: Object(r.getParameter)(\"PUB_EXTEND\")\n                }), function (t) {\n                  e.getUserId() !== t.uid && e.setUserId(t.uid), o.default.info(\"[\".concat(b.clientId, \"] Local stream published with uid\"), t.uid), e.onClose = function () {\n                    b.unpublish(e);\n                  }, e._onAudioUnmute = function () {\n                    b.makeReport(a({\n                      action: \"unmute_local_audio\",\n                      stream_id: e.getId()\n                    }));\n                  }, e._onVideoUnmute = function () {\n                    b.makeReport(a({\n                      action: \"unmute_local_video\",\n                      stream_id: e.getId()\n                    }));\n                  }, e._onAudioMute = function () {\n                    b.makeReport(a({\n                      action: \"mute_local_audio\",\n                      stream_id: e.getId()\n                    }));\n                  }, e._onVideoMute = function () {\n                    b.makeReport(a({\n                      action: \"mute_local_video\",\n                      stream_id: e.getId()\n                    }));\n                  }, e.getId() === e.getUserId() && (e.isAudioOn() || e.hasAudio() && (o.default.debug(\"[\".concat(b.clientId, \"] local stream audio mute\")), e._onAudioMute()), e.isVideoOn() || (e.hasVideo() || e.hasScreen()) && (o.default.debug(\"[\".concat(b.clientId, \"] local stream video mute\")), e._onVideoMute())), e.pc.oniceconnectionstatechange = function (t) {\n                    if (\"failed\" === t) {\n                      if (null != b.timers[e.getId()] && (clearInterval(b.timers[e.getId()]), clearInterval(b.timers[e.getId()] + \"_RelatedStats\")), o.default.error(\"[\".concat(b.clientId, \"] Publisher connection is lost -- streamId: \").concat(e.getId(), \", p2pId: \").concat(f)), b.p2ps.delete(f), o.default.debug(\"[\".concat(b.clientId, \"] publish p2p failed: \"), b.p2ps), !d) return d = !0, s.b.publish(b.joinInfo.sid, {\n                        lts: c,\n                        succ: !1,\n                        audioName: e.hasAudio() && e.audioName,\n                        videoName: e.hasVideo() && e.videoName,\n                        screenName: e.hasScreen() && e.screenName,\n                        ec: I.default.PEERCONNECTION_FAILED\n                      }), b.dispatchEvent(l({\n                        type: \"pubP2PLost\",\n                        stream: e\n                      })), i && i(I.default.PEERCONNECTION_FAILED);\n                      b.dispatchEvent(l({\n                        type: \"pubP2PLost\",\n                        stream: e\n                      }));\n                    } else if (\"connected\" === t && (o.default.debug(\"[\".concat(b.clientId, \"] publish p2p connected: \"), b.p2ps), e._isAudioMuted() ? b.makeReport(a({\n                      action: \"mute_local_audio\",\n                      stream_id: e.getId()\n                    })) : b.makeReport(a({\n                      action: \"unmute_local_audio\",\n                      stream_id: e.getId()\n                    })), e._isVideoMuted() ? b.makeReport(a({\n                      action: \"mute_local_video\",\n                      stream_id: e.getId()\n                    })) : b.makeReport(a({\n                      action: \"unmute_local_video\",\n                      stream_id: e.getId()\n                    })), !d)) return d = !0, s.b.publish(b.joinInfo.sid, {\n                      lts: c,\n                      succ: !0,\n                      audioName: e.hasAudio() && e.audioName,\n                      videoName: e.hasVideo() && e.videoName,\n                      screenName: e.hasScreen() && e.screenName,\n                      ec: null\n                    }), n && n();\n                  }, o.default.debug(\"[\".concat(b.clientId, \"] SDP exchange in publish : receive answer --  \"), JSON.parse(t.sdp)), e.pc.processSignalingMessage(t.sdp);\n                }, function (t, n) {\n                  o.default.error(\"Publish Failed: \".concat(t)), s.b.publish(b.joinInfo.sid, {\n                    lts: c,\n                    succ: !1,\n                    audioName: e.hasAudio() && e.audioName,\n                    videoName: e.hasVideo() && e.videoName,\n                    screenName: e.hasScreen() && e.screenName,\n                    ec: t\n                  }), \"TIMEOUT\" != t && (b.processPublishFailure(e), i && i(t));\n                });\n              },\n              audio: e.hasAudio(),\n              video: e.hasVideo(),\n              screen: e.hasScreen(),\n              isSubscriber: !1,\n              stunServerUrl: b.stunServerUrl,\n              turnServers: b.joinInfo.turnServers,\n              maxAudioBW: u.maxAudioBW,\n              minVideoBW: u.minVideoBW,\n              maxVideoBW: u.maxVideoBW,\n              mode: b.mode,\n              codec: b.codec,\n              isVideoMute: e.userMuteVideo || e.peerMuteVideo,\n              isAudioMute: e.userMuteAudio || e.peerMuteAudio,\n              maxFrameRate: e.attributes.maxFrameRate,\n              clientId: b.clientId\n            }, e.pc = V(e.connectionSpec), e.pc.addStream(e.stream), o.default.debug(\"[\".concat(b.clientId, \"] PeerConnection add stream :\"), e.stream), e.pc.onnegotiationneeded = function (n) {\n              var i = {\n                state: \"negotiation\",\n                stream_type: 1 === t.streamType ? \"low\" : \"high\",\n                p2p_id: f,\n                sdp: n\n              };\n              b.makeRequest(m(i), function (t) {\n                o.default.debug(\"Negotating Stream \".concat(e.getId())), e.pc.processSignalingMessage(t.sdp);\n              }, function (e, t) {\n                o.default.error(\"Negotiation failed \".concat(e), t, i);\n              });\n            }, clearInterval(b.timers[e.getId()]), b.timers[e.getId()] = setInterval(function () {\n              if (Object(r.getParameter)(\"REPORT_STATS\")) {\n                var t = 0;\n                e && e.pc && e.pc.getStats && e.pc.getStatsRate(function (n) {\n                  n.forEach(function (n) {\n                    if (n && n.id && !/_recv$/.test(n.id) && !/^time$/.test(n.id) && e.getUserId()) {\n                      if (-1 === n.id.indexOf(\"outbound_rtp\") && -1 === n.id.indexOf(\"OutboundRTP\") && -1 === n.type.toLowerCase().indexOf(\"outbound\") || \"video\" !== n.mediaType || (n.googFrameWidthSent = e.videoWidth + \"\", n.googFrameHeightSent = e.videoHeight + \"\"), \"video\" === n.mediaType) try {\n                        var i = e.stream.getVideoTracks()[0];\n                        n.A_vstd = i.enabled ? \"0\" : \"1\";\n                      } catch (e) {}\n                      if (\"audio\" === n.mediaType) try {\n                        var a = e.stream.getAudioTracks()[0];\n                        n.A_astd = a.enabled ? \"0\" : \"1\";\n                      } catch (e) {}\n\n                      if (e.getId() == e.getUserId()) {\n                        var s = 200 * t;\n                        t++, setTimeout(function () {\n                          var e = b.socket && b.socket.getLastMsgTime() && Date.now() - b.socket.getLastMsgTime();\n                          e > Object(r.getParameter)(\"REPORT_STATS_TIMEOUT\") ? o.default.debug(\"PublishStats report blocked by REPORT_STATS_TIMEOUT \".concat(e)) : b.makeReport(function (e) {\n                            var t = {};\n                            return Object.keys(e).forEach(function (n) {\n                              Object(r.getParameter)(\"STATS_FILTER\")[n] || (t[Xe(n)] = e[n]);\n                            }), {\n                              _type: \"publish_stats\",\n                              _message: {\n                                stream_type: \"high\",\n                                stats: t\n                              }\n                            };\n                          }(n));\n                        }, s);\n                      } else {\n                        s = 200 * t;\n                        t++, setTimeout(function () {\n                          var e = b.socket && b.socket.getLastMsgTime() && Date.now() - b.socket.getLastMsgTime();\n                          e > Object(r.getParameter)(\"REPORT_STATS_TIMEOUT\") ? o.default.debug(\"PublishStatsLow report blocked by REPORT_STATS_TIMEOUT \".concat(e)) : b.makeReport(function (e) {\n                            var t = {};\n                            return Object.keys(e).forEach(function (n) {\n                              Object(r.getParameter)(\"STATS_FILTER\")[n] || (t[Xe(n)] = e[n]);\n                            }), {\n                              _type: \"publish_stats\",\n                              _message: {\n                                stream_type: \"low\",\n                                stats: t\n                              }\n                            };\n                          }(n));\n                        }, s);\n                      }\n                    }\n                  });\n                });\n              }\n            }, 3e3);\n\n            var p = function () {\n              Object(r.getParameter)(\"REPORT_STATS\") && e && e.pc && e.pc.getVideoRelatedStats && e.pc.getVideoRelatedStats(function (t) {\n                var n,\n                    i,\n                    a = b.socket && b.socket.getLastMsgTime() && Date.now() - b.socket.getLastMsgTime();\n                a > Object(r.getParameter)(\"REPORT_STATS_TIMEOUT\") ? o.default.debug(\"PublishRelatedStats report blocked by REPORT_STATS_TIMEOUT \".concat(a)) : e.getId() === e.getUserId() ? b.makeReport((n = t, i = {}, Object.keys(n).forEach(function (e) {\n                  Object(r.getParameter)(\"STATS_FILTER\")[e] || (i[Xe(e)] = n[e]);\n                }), {\n                  _type: \"publish_related_stats\",\n                  _message: {\n                    stream_type: \"high\",\n                    stats: i\n                  }\n                })) : b.makeReport(function (e) {\n                  var t = {};\n                  return Object.keys(e).forEach(function (n) {\n                    Object(r.getParameter)(\"STATS_FILTER\")[n] || (t[Xe(n)] = e[n]);\n                  }), {\n                    _type: \"publish_related_stats\",\n                    _message: {\n                      stream_type: \"low\",\n                      stats: t\n                    }\n                  };\n                }(t));\n              });\n            };\n\n            p(), clearInterval(b.timers[e.getId() + \"_RelatedStats\"]), b.timers[e.getId() + \"_RelatedStats\"] = setInterval(p, 1e3);\n          }\n        }\n      }, b.unpublish = function (e, t, n, i) {\n        if (\"object\" !== Se()(e) || null === e) return o.default.error(\"[\".concat(b.clientId, \"] Invalid local stream\")), void R(i, I.default.INVALID_LOCAL_STREAM);\n        if (b.state !== E) return o.default.error(\"[\".concat(b.clientId, \"] User not in the session\")), void R(i, I.default.INVALID_OPERATION);\n        if (null != b.timers[e.getId()] && (clearInterval(b.timers[e.getId()]), clearInterval(b.timers[e.getId() + \"_RelatedStats\"])), void 0 !== b.socket) {\n          if (e.local && void 0 !== b.localStreams[e.getId()]) {\n            delete b.localStreams[e.getId()];\n            var a = {\n              stream_id: e.getUserId(),\n              stream_type: 1 === t.streamType ? \"low\" : \"high\"\n            };\n            b.makeRequest({\n              _type: \"unpublish\",\n              _message: a\n            }), (e.hasAudio() || e.hasVideo() || e.hasScreen()) && void 0 === e.url && void 0 !== e.pc && (e.pc.close(), e.pc = void 0), e.onClose = void 0, e._onAudioMute = void 0, e._onAudioUnute = void 0, e._onVideoMute = void 0, e._onVideoUnmute = void 0, b.p2ps.delete(e.p2pId), b.dispatchEvent({\n              type: \"stream-unpublished\",\n              stream: e,\n              options: t\n            }), n && n();\n          } else o.default.error(\"[\".concat(b.clientId, \"] Invalid local stream\")), R(i, I.default.INVALID_LOCAL_STREAM);\n        } else o.default.error(\"[\".concat(b.clientId, \"] User not in the session\")), R(i, I.default.INVALID_OPERATION);\n      }, b.subscribe = function (e, t, n) {\n        var i = new Date().getTime();\n        e.subscribeLTS = i;\n        var c = !1;\n        if (o.default.info(\"[\".concat(b.clientId, \"] Gatewayclient \").concat(b.uid, \" Subscribe \").concat(e.getId(), \": \").concat(JSON.stringify(e.subscribeOptions))), \"object\" !== Se()(e) || null === e) return o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\")), n && n(I.default.INVALID_REMOTE_STREAM), void s.b.subscribe(b.joinInfo.sid, {\n          lts: i,\n          succ: !1,\n          video: e.subscribeOptions && e.subscribeOptions.video,\n          audio: e.subscribeOptions && e.subscribeOptions.audio,\n          peerid: e.getId(),\n          ec: I.default.INVALID_REMOTE_STREAM\n        });\n        if (b.state !== E && (o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\")), !c)) return c = !0, s.b.subscribe(b.joinInfo.sid, {\n          lts: i,\n          succ: !1,\n          video: e.subscribeOptions && e.subscribeOptions.video,\n          audio: e.subscribeOptions && e.subscribeOptions.audio,\n          peerid: e.getId(),\n          ec: I.default.INVALID_OPERATION\n        }), n && n(I.default.INVALID_OPERATION);\n        if (!e.local && b.remoteStreams.hasOwnProperty(e.getId())) {\n          if (e.hasAudio() || e.hasVideo() || e.hasScreen()) {\n            var f = b.generateP2PId();\n            b.p2ps.set(f, e), e.p2pId = f, e.pc = V({\n              callback: function (t) {\n                o.default.debug(\"[\".concat(b.clientId, \"] SDP exchange in subscribe : send offer --  \"), JSON.parse(t));\n                var a = {\n                  stream_id: e.getId(),\n                  audio: !e.subscribeOptions || e.subscribeOptions.audio,\n                  video: !e.subscribeOptions || e.subscribeOptions.video,\n                  codec: b.codec,\n                  p2p_id: f,\n                  sdp: t,\n                  tcc: Object(r.getParameter)(\"SUBSCRIBE_TCC\"),\n                  extend: Object(r.getParameter)(\"SUB_EXTEND\")\n                };\n                b.makeRequest({\n                  _type: \"subscribe\",\n                  _message: a\n                }, function (t) {\n                  o.default.debug(\"[\".concat(b.clientId, \"] SDP exchange in subscribe : receive answer --  \"), JSON.parse(t.sdp)), e.pc.processSignalingMessage(t.sdp);\n                }, function (t, a) {\n                  o.default.error(\"[\".concat(b.clientId, \"] Subscribe remote stream Failed: \").concat(t, \", closing stream \"), e.getId(), a), s.b.subscribe(b.joinInfo.sid, {\n                    lts: i,\n                    succ: !1,\n                    video: e.subscribeOptions && e.subscribeOptions.video,\n                    audio: e.subscribeOptions && e.subscribeOptions.audio,\n                    peerid: e.getId(),\n                    ec: t\n                  }), \"TIMEOUT\" != t && (b.processSubscribeFailure(e), n && n(t));\n                });\n              },\n              nop2p: !0,\n              audio: !0,\n              video: !0,\n              screen: e.hasScreen(),\n              isSubscriber: !0,\n              stunServerUrl: b.stunServerUrl,\n              turnServers: b.joinInfo.turnServers,\n              isVideoMute: e.userMuteVideo,\n              isAudioMute: e.userMuteAudio,\n              uid: e.getId(),\n              clientId: b.clientId\n            }), e.pc.onaddstream = function (t, n) {\n              if (e._onAudioUnmute = function () {\n                b.makeReport(a({\n                  action: \"unmute_remote_audio\",\n                  stream_id: e.getId()\n                }), function () {}, function () {});\n              }, e._onAudioMute = function () {\n                b.makeReport(a({\n                  action: \"mute_remote_audio\",\n                  stream_id: e.getId()\n                }), function () {}, function () {});\n              }, e._onVideoUnmute = function () {\n                b.makeReport(a({\n                  action: \"unmute_remote_video\",\n                  stream_id: e.getId()\n                }), function () {}, function () {});\n              }, e._onVideoMute = function () {\n                b.makeReport(a({\n                  action: \"mute_remote_video\",\n                  stream_id: e.getId()\n                }), function () {}, function () {});\n              }, \"ontrack\" === n && \"video\" === t.track.kind || \"onaddstream\" === n) {\n                o.default.info(\"[\".concat(b.clientId, \"] Remote stream subscribed with uid \"), e.getId());\n                var i = b.remoteStreams[e.getId()];\n\n                if (b.remoteStreams[e.getId()].stream = \"onaddstream\" === n ? t.stream : t.streams[0], b.remoteStreams[e.getId()].hasVideo()) {\n                  if (Object(g.isFireFox)() || Object(g.isSafari)()) {\n                    var r = b.remoteStreams[e.getId()].stream;\n                    Object(F.vsResHack)(r, function (t, n) {\n                      e.videoWidth = t, e.videoHeight = n;\n                    }, function (e) {\n                      return o.default.warning(\"[\".concat(b.clientId, \"] vsResHack failed: \") + e);\n                    });\n                  }\n                } else {\n                  var s = b.remoteStreams[e.getId()];\n                  s.peerMuteVideo = !0, b._adjustPCMuteStatus(s);\n                }\n\n                i && i.isPlaying() && i.elementID && (o.default.debug(\"[\".concat(b.clientId, \"] Reload Player \").concat(i.elementID, \" StreamId \").concat(i.getId())), e.audioOutput = i.audioOutput, i.stop(), e.play(i.elementID, i.playOptions)), delete e.audioLevelHelper;\n                var c = u({\n                  type: \"stream-subscribed\",\n                  stream: b.remoteStreams[e.getId()]\n                });\n                b.dispatchEvent(c);\n              }\n            }, clearInterval(b.timers[e.getId()]), b.timers[e.getId()] = setInterval(function () {\n              if (Object(r.getParameter)(\"REPORT_STATS\")) {\n                var t = 0;\n                e && e.pc && e.pc.getStats && e.pc.getStatsRate(function (n) {\n                  n.forEach(function (n) {\n                    if (n && n.id) {\n                      if (/_send$/.test(n.id) || /^time$/.test(n.id) || /^bweforvideo$/.test(n.id)) return;\n                      -1 === n.id.indexOf(\"inbound_rtp\") && -1 === n.id.indexOf(\"inbound-rtp\") && -1 === n.type.toLowerCase().indexOf(\"inbound\") || \"video\" !== n.mediaType || (n.googFrameWidthReceived = e.videoWidth + \"\", n.googFrameHeightReceived = e.videoHeight + \"\");\n                      var i = 200 * t;\n                      t++;\n                      var a = e.getId();\n                      setTimeout(function () {\n                        var t = b.socket && b.socket.getLastMsgTime() && Date.now() - b.socket.getLastMsgTime();\n                        if (t > Object(r.getParameter)(\"REPORT_STATS_TIMEOUT\")) o.default.debug(\"SubscribeStats report blocked by REPORT_STATS_TIMEOUT \".concat(t));else {\n                          if (\"video\" === n.mediaType) try {\n                            var i = e.stream.getVideoTracks()[0];\n                            n.A_vrtd = i.enabled ? \"0\" : \"1\";\n                          } catch (e) {}\n                          if (\"audio\" === n.mediaType) try {\n                            var s = e.stream.getAudioTracks()[0];\n                            n.A_artd = s.enabled ? \"0\" : \"1\";\n                          } catch (e) {}\n                          b.makeReport(v(a, n));\n                        }\n                      }, i);\n                    } else ;\n                  });\n                });\n              }\n            }, 3e3), clearInterval(b.timers[e.getId() + \"_RelatedStats\"]), b.timers[e.getId() + \"_RelatedStats\"] = setInterval(function () {\n              if (Object(r.getParameter)(\"REPORT_STATS\") && e && e.pc) {\n                var t = b.socket && b.socket.getLastMsgTime() && Date.now() - b.socket.getLastMsgTime();\n                if (t > Object(r.getParameter)(\"REPORT_STATS_TIMEOUT\")) return void o.default.debug(\"SubscribeRelatedStats report blocked by REPORT_STATS_TIMEOUT \".concat(t));\n                e.pc.getVideoRelatedStats && e.pc.getVideoRelatedStats(function (t) {\n                  e.player && (t.isFreeze = e.player.freezeCount > e.player.lastFreezeCount, e.player.lastFreezeCount = e.player.freezeCount), b.makeReport(d(e.getId(), t));\n                }), e.pc.getAudioRelatedStats && e.pc.getAudioRelatedStats(function (t) {\n                  b.makeReport(d(e.getId(), t));\n                });\n              }\n            }, 1e3), b.audioLevel[e.getId()] = 0, clearInterval(b.timers[e.getId() + \"audio\"]), b.timers[e.getId() + \"audio\"] = setInterval(function () {\n              b.hasListeners(\"active-speaker\") && e && e.pc && \"established\" === e.pc.state && e.pc.getStats && e.pc.getStats(function (t) {\n                t.forEach(function (t) {\n                  if (\"audio\" === t.mediaType) {\n                    if (t.audioOutputLevel > 5e3) for (var n in b.audioLevel[e.getId()] < 20 && (b.audioLevel[e.getId()] += 1), b.audioLevel) n !== \"\" + e.getId() && b.audioLevel[n] > 0 && (b.audioLevel[n] -= 1);\n                    var i = Object.keys(b.audioLevel).sort(function (e, t) {\n                      return b.audioLevel[t] - b.audioLevel[e];\n                    });\n\n                    if (b.activeSpeaker !== i[0]) {\n                      var a = l({\n                        type: \"active-speaker\",\n                        uid: i[0]\n                      });\n                      b.dispatchEvent(a), b.activeSpeaker = i[0], o.default.debug(\"[\".concat(b.clientId, \"] Update active speaker: \").concat(b.activeSpeaker));\n                    }\n                  }\n                });\n              }, 50);\n            }, 50), e.pc.oniceconnectionstatechange = function (a) {\n              if (\"failed\" === a) null != b.timers[e.getId()] && (clearInterval(b.timers[e.getId()]), clearInterval(b.timers[e.getId()] + \"audio\")), o.default.error(\"[\".concat(b.clientId, \"] Subscriber connection is lost -- streamId: \").concat(e.getId(), \", p2pId: \").concat(f)), o.default.debug(\"[\".concat(b.clientId, \"] subscribe p2p failed: \"), b.p2ps), c || (c = !0, n && n(I.default.PEERCONNECTION_FAILED), s.b.subscribe(b.joinInfo.sid, {\n                lts: i,\n                succ: !1,\n                video: e.subscribeOptions && e.subscribeOptions.video,\n                audio: e.subscribeOptions && e.subscribeOptions.audio,\n                peerid: e.getId(),\n                ec: I.default.PEERCONNECTION_FAILED\n              })), b.remoteStreams[e.getId()] && b.p2ps.has(f) && (b.p2ps.delete(f), b.dispatchEvent(l({\n                type: \"subP2PLost\",\n                stream: e\n              })));else if (\"connected\" === a && (o.default.debug(\"[\".concat(b.clientId, \"] subscribe p2p connected: \"), b.p2ps), !c)) {\n                c = !0, s.b.subscribe(b.joinInfo.sid, {\n                  lts: i,\n                  succ: !0,\n                  video: e.subscribeOptions && e.subscribeOptions.video,\n                  audio: e.subscribeOptions && e.subscribeOptions.audio,\n                  peerid: e.getId(),\n                  ec: null\n                }), b._adjustPCMuteStatus(e);\n                var r = !1,\n                    d = !1,\n                    u = setInterval(function () {\n                  r && d || (e.pc ? e.pc.getStats(function (t) {\n                    t.forEach(function (t) {\n                      (-1 !== t.id.indexOf(\"recv\") || t.type && -1 !== t.type.toLowerCase().indexOf(\"inbound\") || -1 !== t.id.indexOf(\"inbound_rtp\") || -1 !== t.id.indexOf(\"inbound-rtp\") || -1 !== t.id.indexOf(\"InboundRTP\")) && \"audio\" === t.mediaType && ((t.googDecodingNormal > 0 || t.audioOutputLevel > 0) && (r || (r = !0, b.dispatchEvent({\n                        type: \"first-audio-frame-decode\",\n                        stream: e\n                      }), r && d && clearInterval(u), s.b.firstAudioDecode(b.joinInfo.sid, {\n                        peerid: e.uintId,\n                        elapse: Date.now() - e.subscribeLTS,\n                        uid: b.uid\n                      }))), parseInt(t.packetsReceived) > 0 && (d || (d = !0, b.dispatchEvent({\n                        type: \"first-audio-packet-received\",\n                        stream: e\n                      }), r && d && clearInterval(u), s.b.firstAudioReceived(b.joinInfo.sid, {\n                        peerid: e.uintId,\n                        elapse: Date.now() - e.subscribeLTS,\n                        uid: b.uid\n                      }))));\n                    });\n                  }, 100) : clearInterval(u));\n                }, 100),\n                    p = !1,\n                    g = !1,\n                    m = setInterval(function () {\n                  p && g || (e.pc ? e.pc.getStats(function (t) {\n                    t.forEach(function (t) {\n                      (-1 !== t.id.indexOf(\"recv\") || t.type && -1 !== t.type.toLowerCase().indexOf(\"inbound\") || -1 !== t.id.indexOf(\"inbound_rtp\") || -1 !== t.id.indexOf(\"inbound-rtp\") || -1 !== t.id.indexOf(\"InboundRTP\")) && \"video\" === t.mediaType && ((t.framesDecoded > 0 || t.googFramesDecoded > 0) && (p || (p = !0, b.dispatchEvent({\n                        type: \"first-video-frame-decode\",\n                        stream: e\n                      }), p && g && clearInterval(m), e.firstFrameTime = new Date().getTime() - e.subscribeLTS, s.b.firstVideoDecode(b.joinInfo.sid, {\n                        peerid: e.uintId,\n                        elapse: Date.now() - e.subscribeLTS,\n                        width: parseInt(t.googFrameWidthReceived) || 0,\n                        height: parseInt(t.googFrameHeightReceived) || 0,\n                        uid: b.uid\n                      }))), t.packetsReceived > 0 && (g || (g = !0, b.dispatchEvent({\n                        type: \"first-video-packet-received\",\n                        stream: e\n                      }), p && g && clearInterval(m), s.b.firstVideoReceived(b.joinInfo.sid, {\n                        peerid: e.uintId,\n                        elapse: Date.now() - e.subscribeLTS,\n                        uid: b.uid\n                      }))));\n                    });\n                  }, 100) : clearInterval(m));\n                }, 100);\n                return e.sid = b.joinInfo.sid, t && t();\n              }\n            };\n          } else o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\")), c || (c = !0, n && n(I.default.INVALID_REMOTE_STREAM), s.b.subscribe(b.joinInfo.sid, {\n            lts: i,\n            succ: !1,\n            video: e.subscribeOptions && e.subscribeOptions.video,\n            audio: e.subscribeOptions && e.subscribeOptions.audio,\n            peerid: e.getId(),\n            ec: I.default.INVALID_REMOTE_STREAM\n          }));\n        } else o.default.error(\"[\".concat(b.clientId, \"] No such remote stream\")), c || (c = !0, n && n(I.default.NO_SUCH_REMOTE_STREAM), s.b.subscribe(b.joinInfo.sid, {\n          lts: i,\n          succ: !1,\n          video: e.subscribeOptions && e.subscribeOptions.video,\n          audio: e.subscribeOptions && e.subscribeOptions.audio,\n          peerid: e.getId(),\n          ec: I.default.NO_SUCH_REMOTE_STREAM\n        }));\n      }, b.subscribeChange = function (e, t, n) {\n        var i = Date.now();\n        o.default.info(\"[\".concat(b.clientId, \"] Gatewayclient \").concat(b.uid, \" SubscribeChange \").concat(e.getId(), \": \").concat(JSON.stringify(e.subscribeOptions))), b._adjustPCMuteStatus(e);\n        var a = {\n          stream_id: e.getId(),\n          audio: e.subscribeOptions.audio,\n          video: e.subscribeOptions.video\n        };\n        b.makeRequest({\n          _type: \"subscribe_change\",\n          _message: a\n        }, function (n) {\n          var a = u({\n            type: \"stream-subscribe-changed\",\n            stream: b.remoteStreams[e.getId()]\n          });\n          s.b.subscribe(b.joinInfo.sid, {\n            lts: i,\n            succ: !0,\n            video: e.subscribeOptions && e.subscribeOptions.video,\n            audio: e.subscribeOptions && e.subscribeOptions.audio,\n            peerid: e.getId(),\n            ec: null\n          }), b.dispatchEvent(a), t && t();\n        }, function (t, i) {\n          o.default.error(\"[\".concat(b.clientId, \"] Subscribe Change Failed \").concat(e.getId()), t, i), n && n(t, i);\n        });\n      }, b.processPublishFailure = function (e) {\n        e.publishLTS = null, e.p2pId && b.p2ps.get(e.p2pId) === e && b.p2ps.delete(e.p2pId), b.localStreams[e.getUserId()] === e && delete b.localStreams[e.getUserId()], b.localStreams[e.getId()] === e && delete b.localStreams[e.getId()], e.pc && (e.pc.processSignalingMessage = function () {}, e.pc.oniceconnectionstatechange = function () {}, e.pc.close(), delete e.pc), delete e.onClose, delete e._onAudioUnmute, delete e._onVideoUnmute, delete e._onAudioMute, delete e._onVideoMute, delete e._onAudioUnmute;\n      }, b.processSubscribeFailure = function (e) {\n        e.p2pId && b.p2ps.get(e.p2pId) === e && b.p2ps.delete(e.p2pId), e.pc && (e.pc.onaddstream = function () {}, e.pc.processSignalingMessage = function () {}, e.pc.oniceconnectionstatechange = function () {}, e.pc.close(), delete e.pc), delete e.onClose, delete e._onAudioUnmute, delete e._onVideoUnmute, delete e._onAudioMute, delete e._onVideoMute, delete e._onAudioUnmute;\n      }, b._adjustPCMuteStatus = function (e) {\n        !e.local && e.pc && e.pc.peerConnection.getReceivers && e.pc.peerConnection.getReceivers().forEach(function (t) {\n          if (t && t.track && \"audio\" === t.track.kind) {\n            var n = !e.userMuteAudio && !e.peerMuteAudio;\n            e.subscribeOptions && !e.subscribeOptions.audio && (n = !1), t.track.enabled = !!n;\n          } else if (t && t.track && \"video\" === t.track.kind) {\n            var i = !e.userMuteVideo && !e.peerMuteVideo;\n            e.subscribeOptions && !e.subscribeOptions.video && (i = !1), t.track.enabled = !!i;\n          }\n        });\n      }, b.unsubscribe = function (e, t, n) {\n        if (\"object\" !== Se()(e) || null === e) return o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\")), void R(n, I.default.INVALID_REMOTE_STREAM);\n        if (b.state !== E) return o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\")), void R(n, I.default.INVALID_OPERATION);\n\n        if (null != b.timers[e.getId()] && (clearInterval(b.timers[e.getId()]), clearInterval(b.timers[e.getId()] + \"audio\")), null != b.audioLevel[e.getId()] && delete b.audioLevel[e.getId()], null != b.timer_counter[e.getId()] && delete b.timer_counter[e.getId()], b.remoteStreams.hasOwnProperty(e.getId())) {\n          if (!b.socket) return o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\")), void R(n, I.default.INVALID_OPERATION);\n          if (e.local) return o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\")), void R(n, I.default.INVALID_REMOTE_STREAM);\n          e.close();\n          var i = {\n            stream_id: e.getId()\n          };\n          b.makeRequest({\n            _type: \"unsubscribe\",\n            _message: i\n          }), void 0 !== e.pc && (e.pc.close(), e.pc = void 0), e.onClose = void 0, e._onAudioMute = void 0, e._onAudioUnute = void 0, e._onVideoMute = void 0, e._onVideoUnmute = void 0, delete e.subscribeOptions, b.p2ps.delete(e.p2pId), o.default.info(\"[\".concat(b.clientId, \"] Unsubscribe stream success\")), t && t();\n        } else R(n, I.default.NO_SUCH_REMOTE_STREAM);\n      }, b.setRemoteVideoStreamType = function (e, t) {\n        if (o.default.debug(\"[\".concat(b.clientId, \"] Switching remote video stream \").concat(e.getId(), \" to \").concat(t)), \"object\" === Se()(e) && null !== e) {\n          if (b.state === E) {\n            if (!e.local) {\n              switch (t) {\n                case b.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_HIGH:\n                case b.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_LOW:\n                case b.remoteVideoStreamTypes.REMOTE_VIDEO_STREAM_MEDIUM:\n                  break;\n\n                default:\n                  return;\n              }\n\n              var n = {\n                stream_id: e.getId(),\n                stream_type: t\n              };\n              b.makeRequest({\n                _type: \"switch_video_stream\",\n                _message: n\n              }, function () {\n                o.default.debug(\"SwitchVideoStream Success \".concat(n.stream_id, \" \").concat(n.stream_type));\n              }, function (e, t) {\n                o.default.error(\"SwitchVideoStream Error \".concat(e, \" \").concat(n.stream_id, \" \").concat(n.stream_type), t);\n              });\n            }\n          } else o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\"));\n        } else o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\"));\n      }, b.renewToken = function (e, t, n) {\n        e ? b.key ? b.state !== E ? (o.default.debug(\"[\".concat(b.clientId, \"] Client is not connected. Trying to rejoin\")), b.key = e, b.rejoin(), t && t()) : (o.default.debug(\"[\".concat(b.clientId, \"] renewToken from \").concat(b.key, \" to \").concat(e)), b.makeRequest({\n          _type: \"renew_token\",\n          _message: {\n            token: e\n          }\n        }, t, n)) : (o.default.error(\"[\".concat(b.clientId, \"] Client is previously joined without token\")), n && n(I.default.INVALID_PARAMETER)) : (o.default.error(\"[\".concat(b.clientId, \"] Invalid Token \").concat(e)), n && n(I.default.INVALID_PARAMETER));\n      }, b.setStreamFallbackOption = function (e, t) {\n        if (o.default.debug(\"[\".concat(b.clientId, \"] Set stream fallback option \").concat(e.getId(), \" to \").concat(t)), \"object\" === Se()(e) && null !== e) {\n          if (b.state === E) {\n            if (!e.local) {\n              switch (t) {\n                case b.streamFallbackTypes.STREAM_FALLBACK_OPTION_DISABLED:\n                case b.streamFallbackTypes.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:\n                case b.streamFallbackTypes.STREAM_FALLBACK_OPTION_AUDIO_ONLY:\n                  break;\n\n                default:\n                  return;\n              }\n\n              var n = {\n                stream_id: e.getId(),\n                fallback_type: t\n              };\n              b.makeRequest({\n                _type: \"set_fallback_option\",\n                _message: n\n              }, function () {\n                o.default.debug(\"SetStreamFallbackOption success \".concat(n.stream_id, \" \").concat(t));\n              }, function (e, i) {\n                o.default.error(\"Failed to SetStreamFallbackOption \".concat(n.stream_id, \" \").concat(t, \" \").concat(e), i);\n              });\n            }\n          } else o.default.error(\"[\".concat(b.clientId, \"] User is not in the session\"));\n        } else o.default.error(\"[\".concat(b.clientId, \"] Invalid remote stream\"));\n      }, b.enableAudioVolumeIndicator = function (e, t) {\n        b.audioVolumeIndication.enabled = !0, b.audioVolumeIndication.interval = e, b.audioVolumeIndication.smooth = t, b.resetAudioVolumeIndication();\n      }, b.resetAudioVolumeIndication = function () {\n        if (clearInterval(b.timers.audioVolumeIndication), clearInterval(b.timers.audioVolumeSampling), b.audioVolumeIndication.enabled && b.audioVolumeIndication.interval) {\n          var e = Math.floor(1e3 * b.audioVolumeIndication.smooth / 100);\n          clearInterval(b.timers.audioVolumeSampling), b.timers.audioVolumeSampling = setInterval(function () {\n            b.audioVolumeSampling || (b.audioVolumeSampling = {});\n            var t = {};\n\n            for (var n in b.remoteStreams) {\n              var i = b.remoteStreams[n];\n\n              if (i.stream && i.hasAudio()) {\n                var a = i.getAudioLevel();\n                a > 0 && a < 1 && (a *= 100);\n                var r = b.audioVolumeSampling[n] || [];\n\n                for (r.push(a); r.length > e;) r.shift();\n\n                t[n] = r;\n              }\n            }\n\n            b.audioVolumeSampling = t;\n          }, 100), clearInterval(b.timers.audioVolumeIndication), b.timers.audioVolumeIndication = setInterval(function () {\n            if (b.socket && b.socket.signal && b.socket.signal.connection && b.socket.signal.connection.readyState === WebSocket.OPEN) {\n              var e = [];\n\n              for (var t in b.remoteStreams) if (b.audioVolumeSampling && b.audioVolumeSampling[t]) {\n                var n = b.audioVolumeSampling[t],\n                    i = 0;\n                n.forEach(function (e) {\n                  i += e;\n                });\n                var a = {\n                  uid: t,\n                  level: Math.floor(i / n.length)\n                };\n                a.level && e.push(a);\n              }\n\n              var r = e.sort(function (e, t) {\n                return e.level - t.level;\n              });\n              o.default.debug(\"[\".concat(b.clientId, \"] volume-indicator \"), JSON.stringify(r)), b.audioVolumeIndication.sortedAudioVolumes = r;\n              var s = l({\n                type: \"volume-indicator\",\n                attr: r\n              });\n              b.dispatchEvent(s);\n            }\n          }, b.audioVolumeIndication.interval);\n        }\n      }, b.closeGateway = function () {\n        o.default.debug(\"[\".concat(b.clientId, \"] close gateway\")), b.state = S, b.socket.close(), C();\n      }, b.startChannelMediaRelay = function () {\n        var e = K()(Y.a.mark(function e(t) {\n          var n, i, a, r;\n          return Y.a.wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (!b.channelMediaRelayController) {\n                  e.next = 2;\n                  break;\n                }\n\n                throw new ye.ChannelMediaError(\"RELAY_ALREADY_START\", \"\", ye.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ALREADY_START);\n\n              case 2:\n                return n = function (e) {\n                  b.dispatchEvent({\n                    type: \"channel-media-relay-event\",\n                    code: e\n                  });\n                }, i = function (e, t, n) {\n                  e === ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE && t === ye.CHANNEL_MEDIA_RELAY_ERROR.SERVER_CONNECTION_LOST && (b.channelMediaRelayController.dispose(), b.channelMediaRelayController = null), b.dispatchEvent({\n                    type: \"channel-media-relay-state\",\n                    state: e,\n                    code: t,\n                    data: n\n                  });\n                }, b.channelMediaRelayController = new be.a(b.joinInfo, b.clientId), b.channelMediaRelayController.on(\"event\", n), b.channelMediaRelayController.on(\"state\", i), e.prev = 7, e.next = 10, b.channelMediaRelayController.startChannelMediaRelay(t);\n\n              case 10:\n                e.next = 22;\n                break;\n\n              case 12:\n                throw e.prev = 12, e.t0 = e.catch(7), o.default.debug(\"[\".concat(b.clientId, \"] startChannelMediaRelay exception: \").concat(JSON.stringify(e.t0))), a = ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE, r = \"\", r = e.t0 instanceof ye.ChannelMediaError ? \"SetSourceChannelStatus\" === e.t0.data || e.t0.data && e.t0.data.serverResponse && \"SetSourceChannel\" === e.t0.data.serverResponse.command ? \"FAILED_JOIN_SRC\" : \"SetDestChannelStatus\" === e.t0.data || e.t0.data && e.t0.data.serverResponse && \"SetDestChannel\" === e.t0.data.serverResponse.command ? \"FAILED_JOIN_DEST\" : e.t0.data && e.t0.data.serverResponse && \"StartPacketTransfer\" === e.t0.data.serverResponse.command ? \"FAILED_PACKET_SENT_TO_DEST\" : e.t0.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT || e.t0.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT ? \"SERVER_NO_RESPONSE\" : e.t0.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_FAILED || e.t0.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR ? \"SERVER_ERROR_RESPONSE\" : e.t0.message === ye.CHANNEL_MEDIA_ERROR.AP_REQUEST_TIMEOUT ? \"NO_RESOURCE_AVAILABLE\" : e.t0.message === ye.CHANNEL_MEDIA_ERROR.WS_ABORT || e.t0.message === ye.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT ? \"OPERATION_ABORT\" : \"INTERNAL_ERROR\" : \"INTERNAL_ERROR\", b.dispatchEvent({\n                  type: \"channel-media-relay-state\",\n                  state: a,\n                  code: ye.CHANNEL_MEDIA_RELAY_ERROR[r]\n                }), b.channelMediaRelayController && (b.channelMediaRelayController.dispose(), b.channelMediaConfig = null, b.channelMediaRelayController = null), b.dispatchEvent({\n                  type: \"channel-media-relay-state\",\n                  state: ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE\n                }), new ye.ChannelMediaError(r, null, ye.CHANNEL_MEDIA_RELAY_ERROR[r]);\n\n              case 22:\n                b.dispatchEvent({\n                  type: \"channel-media-relay-state\",\n                  state: ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING,\n                  code: ye.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK\n                }), b.channelMediaConfig = t;\n\n              case 24:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, this, [[7, 12]]);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), b.updateChannelMediaRelay = function () {\n        var t = K()(Y.a.mark(function t(n) {\n          var i, a;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                if (b.channelMediaRelayController) {\n                  t.next = 2;\n                  break;\n                }\n\n                throw new ye.ChannelMediaError(\"RELAY_NOT_START\", null, ye.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);\n\n              case 2:\n                return t.prev = 2, t.next = 5, b.channelMediaRelayController.updateChannelMediaRelay(n);\n\n              case 5:\n                t.next = 18;\n                break;\n\n              case 7:\n                throw t.prev = 7, t.t0 = t.catch(2), o.default.debug(\"[\".concat(b.clientId, \"] updateChannelMediaRelay exception: \").concat(JSON.stringify(e))), i = ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE, a = \"\", a = e instanceof ye.ChannelMediaError ? e.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT || e.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT ? \"SERVER_NO_RESPONSE\" : e.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_FAILED || e.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR ? \"SERVER_ERROR_RESPONSE\" : e.message === ye.CHANNEL_MEDIA_ERROR.WS_ABORT || e.message === ye.CHANNEL_MEDIA_ERROR.AP_REQUEST_ABORT ? \"OPERATION_ABORT\" : \"INTERNAL_ERROR\" : \"INTERNAL_ERROR\", b.dispatchEvent({\n                  type: \"channel-media-relay-event\",\n                  code: ye.CHANNEL_MEDIA_RELAY_EVENT.PACKET_UPDATE_DEST_CHANNEL_REFUSED\n                }), b.dispatchEvent({\n                  type: \"channel-media-relay-state\",\n                  state: i,\n                  code: ye.CHANNEL_MEDIA_RELAY_ERROR[a]\n                }), b.channelMediaRelayController && (b.channelMediaRelayController.dispose(), b.channelMediaConfig = null, b.channelMediaRelayController = null), b.dispatchEvent({\n                  type: \"channel-media-relay-state\",\n                  state: ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE\n                }), new ye.ChannelMediaError(a, null, ye.CHANNEL_MEDIA_RELAY_ERROR[a]);\n\n              case 18:\n                b.channelMediaConfig = n;\n\n              case 19:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this, [[2, 7]]);\n        }));\n        return function (e) {\n          return t.apply(this, arguments);\n        };\n      }(), b.stopChannelMediaRelay = K()(Y.a.mark(function t() {\n        var n, i;\n        return Y.a.wrap(function (t) {\n          for (;;) switch (t.prev = t.next) {\n            case 0:\n              if (b.channelMediaRelayController) {\n                t.next = 2;\n                break;\n              }\n\n              throw new ye.ChannelMediaError(\"RELAY_NOT_START\", null, ye.CHANNEL_MEDIA_RELAY_ERROR.RELAY_NOT_START);\n\n            case 2:\n              return t.prev = 2, t.next = 5, b.channelMediaRelayController.stopChannelMediaRelay();\n\n            case 5:\n              t.next = 17;\n              break;\n\n            case 7:\n              throw t.prev = 7, t.t0 = t.catch(2), o.default.debug(\"[\".concat(b.clientId, \"] stopChannelMediaRelay exception: \").concat(JSON.stringify(e))), n = ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE, i = \"\", i = e instanceof ye.ChannelMediaError ? e.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_TIMEOUT || e.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_TIMEOUT ? \"SERVER_NO_RESPONSE\" : e.message === ye.CHANNEL_MEDIA_ERROR.REQUEST_FAILED || e.message === ye.CHANNEL_MEDIA_ERROR.WAIT_STATUS_ERROR ? \"SERVER_ERROR_RESPONSE\" : \"INTERNAL_ERROR\" : \"INTERNAL_ERROR\", b.dispatchEvent({\n                type: \"channel-media-relay-state\",\n                state: n,\n                code: ye.CHANNEL_MEDIA_RELAY_ERROR[i]\n              }), b.channelMediaRelayController && (b.channelMediaRelayController.dispose(), b.channelMediaConfig = null, b.channelMediaRelayController = null), b.dispatchEvent({\n                type: \"channel-media-relay-state\",\n                state: ye.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE\n              }), new ye.ChannelMediaError(i, null, ye.CHANNEL_MEDIA_RELAY_ERROR[i]);\n\n            case 17:\n              b.channelMediaConfig = null, b.channelMediaRelayController = null;\n\n            case 19:\n            case \"end\":\n              return t.stop();\n          }\n        }, t, this, [[2, 7]]);\n      })), b.sendMetadata = function (e, t) {\n        b.makeRequest(function (e) {\n          return {\n            _type: \"send_metadata\",\n            _message: {\n              session_id: b.joinInfo.sid,\n              metadata: window.btoa(unescape(encodeURIComponent(e)))\n            }\n          };\n        }(e), function () {\n          o.default.debug(\"[\".concat(b.clientId, '] send metadata \"').concat(e, '\" success')), t && t(null);\n        }, function (n) {\n          o.default.error(\"[\".concat(b.clientId, '] send metadata \"').concat(e, '\" failed'), n), t && t(n);\n        });\n      };\n\n      var A = function () {\n        o.default.debug(\"[\".concat(b.clientId, \"] Reconnect gateway\")), b.state = S, b.socket.close(), C(), b.reconnectMode = \"recover\", b.state = _, O();\n      };\n\n      b.recover = A;\n\n      var C = function () {\n        for (var e in b.dispatchEvent({\n          type: \"before-clear-connection\"\n        }), b.timers) b.timers.hasOwnProperty(e) && clearInterval(b.timers[e]);\n\n        for (var e in b.remoteStreams) if (b.remoteStreams.hasOwnProperty(e)) {\n          var t = b.remoteStreams[e],\n              n = l({\n            type: \"stream-removed\",\n            uid: t.getId(),\n            stream: t\n          });\n          b.dispatchEvent(n);\n        }\n\n        b.p2ps.clear(), D(), k(), clearInterval(b.pingTimer);\n      };\n\n      b.rejoin = function () {\n        b.socket && (clearInterval(b.pingTimer), b.socket.close(), b.socket = void 0), b.state = _, O();\n      };\n\n      var O = function (e, t) {\n        b.dispatchEvent(l({\n          type: \"rejoin-start\"\n        })), e = e || function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] User \").concat(e, \" is re-joined to \").concat(b.joinInfo.cname)), b.dispatchEvent(l({\n            type: \"rejoin\"\n          })), b.channelMediaConfig && b.startChannelMediaRelay(b.channelMediaConfig).then(function () {\n            o.default.debug(\"[\".concat(b.clientId, \"] restartChannelMediaRelay success\"));\n          }).catch(function (e) {\n            o.default.debug(\"[\".concat(b.clientId, \"] restartChannelMediaRelay failed: \").concat(JSON.stringify(e)));\n          }), b.liveStreams && b.liveStreams.size && b.liveStreams.forEach(function (e, t) {\n            e && b.setLiveTranscoding(b.transcoding), b.startLiveStreaming(t, e);\n          }), b.injectLiveStreams && b.injectLiveStreams.size && b.injectLiveStreams.forEach(function (e, t) {\n            b.addInjectStreamUrl(t, e);\n          });\n        }, t = t || function (e) {\n          o.default.error(\"[\".concat(b.clientId, \"] Re-join to channel failed \"), e), b.dispatchEvent(u({\n            type: \"error\",\n            reason: e\n          }));\n        }, b.key ? (++b.rejoinAttempt, b.join(b.joinInfo, b.key, e, t)) : o.default.error(\"[\".concat(b.clientId, \"] Connection recover failed [Invalid channel key]\"));\n      },\n          N = function (e, t, n) {\n        if (b.onConnect = t, b.socket) {\n          if (b.dispatchEvent({\n            type: \"reconnect\"\n          }), \"retry\" === b.reconnectMode) o.default.debug(\"[\".concat(b.clientId, \"] Retry current gateway\")), b.socket.reconnect();else if (\"tryNext\" === b.reconnectMode) o.default.debug(\"[\".concat(b.clientId, \"] Try next gateway\")), b.socket.connectNext();else if (\"recover\" === b.reconnectMode) {\n            o.default.debug(\"[\".concat(b.clientId, \"] Recover gateway\")), o.default.debug(\"[\".concat(b.clientId, \"] Try to reconnect choose server and get gateway list again \")), b.reconnectingCS = !0;\n            var a = b.joinInfo && b.joinInfo.sid;\n            0, We(b.joinInfo, function (e) {\n              o.default.debug(\"[\".concat(b.clientId, \"] session:  \").concat(a, \" get gateway list success\")), b.joinInfo.apResponse = e.res, b.reconnectingCS ? b.socket.replaceHost(e.gateway_addr) : o.default.debug(\"[\".concat(b.clientId, \"] session:  \").concat(a, \" already leave\"));\n            });\n          }\n        } else c = e.gatewayAddr, b.socket = Le(c, {\n          sid: b.joinInfo.sid,\n          clientId: b.clientId\n        }), b.socket.on(\"start-connection\", function (e) {\n          b.ticket = e && e.msg && e.msg.ticket;\n        }), b.socket.on(\"on_uplink_stats\", function (e) {\n          var t = {};\n\n          for (var n in e) t[Qe(n)] = e[n];\n\n          if (b.OutgoingAvailableBandwidth = t.uplink_available_bandwidth, b.localStreams[b.uid]) {\n            var i = b.localStreams[b.uid].uplinkStats;\n            i && i.period_fir === t.period_fir || o.default.debug(\"[\".concat(b.clientId, \"]: Period fir change to: \").concat(t.period_fir)), b.localStreams[b.uid].uplinkStats = t;\n          }\n        }), b.socket.on(\"connect\", function () {\n          b.dispatchEvent({\n            type: \"connected\"\n          }), b.attemps = 1, b.onConnect();\n        }), b.socket.on(\"recover\", function () {\n          b.state = _, o.default.debug(\"[\".concat(b.clientId, \"] Try to reconnect choose server and get gateway list again \")), b.reconnectingCS = !0;\n          var e = b.joinInfo && b.joinInfo.sid;\n          We(b.joinInfo, function (t) {\n            o.default.debug(\"[\".concat(b.clientId, \"] session:  \").concat(e, \" get gateway list success\")), b.reconnectingCS ? b.socket.replaceHost(t.gateway_addr) : o.default.debug(\"[\".concat(b.clientId, \"] session:  \").concat(e, \" already leave\"));\n          });\n        }), b.socket.on(\"disconnect\", function (e) {\n          if (o.default.debug(\"[\".concat(b.clientId, \"] Receive disconnect message\")), b.state !== S) {\n            b.state = S;\n            var t = u({\n              type: \"error\",\n              reason: I.default.SOCKET_DISCONNECTED\n            });\n\n            if (b.dispatchEvent(t), 0 === b.p2ps.size ? b.reconnectMode = \"tryNext\" : b.reconnectMode = \"retry\", C(), b.channelMediaRelayController && b.channelMediaRelayController.dispose(), b.channelMediaRelayController = null, 1 != i) {\n              var n,\n                  a = (n = b.attemps, 1e3 * Math.min(30, Math.pow(2, n) - 1));\n              if (o.default.error(\"[\".concat(b.clientId, \"] Disconnect from server [\").concat(JSON.stringify(e), \"], attempt to recover [#\").concat(b.attemps, \"] after \").concat(a / 1e3, \" seconds\")), b.hasInvokeLeave) return o.default.debug(\"[\".concat(b.clientId, \"] No reconnection because Client.leave has been invoked\")), void (b.hasInvokeLeave = !1);\n              setTimeout(function () {\n                b.attemps++, b.state = _, b.inChannelInfo && Date.now() - b.inChannelInfo.joinAt > Object(r.getParameter)(\"TICKET_RENEW_TIMEOUT\") ? (o.default.debug(\"Recovering to renew ticket\"), A()) : O();\n              }, a);\n            }\n          }\n        }), b.socket.on(\"on_add_audio_stream\", function (e) {\n          if (o.default.info(\"[\".concat(b.clientId, \"] Newly added audio stream with uid \").concat(e.uid)), b.joinInfo.stringUid && \"string\" != typeof e.uid && o.default.error(\"StringUID is Mixed with UintUID\"), b.remoteStreamsInChannel.has(e.uid) || b.remoteStreamsInChannel.add(e.uid), void 0 === b.remoteStreams[e.uid]) {\n            var t = Ie({\n              streamID: e.uid,\n              local: !1,\n              audio: e.audio,\n              video: e.video,\n              uintUID: e.uint_id || e.uid\n            });\n            t.peerMuteVideo = !0, b.remoteStreams[e.uid] = t;\n            var n = u({\n              type: \"stream-added\",\n              stream: t\n            });\n            b.dispatchEvent(n);\n            var i = b.remoteMuteState[e.uid];\n\n            if (i && i.audio) {\n              n = l({\n                type: \"mute-audio\",\n                uid: e.uid\n              });\n              b.dispatchEvent(n);\n            }\n\n            if (i && i.video) {\n              n = l({\n                type: \"mute-video\",\n                uid: e.uid\n              });\n              b.dispatchEvent(n);\n            }\n          }\n\n          s.b.onAddAudioStream(b.joinInfo.sid, {\n            peerid: e.uint_id || e.uid,\n            uid: b.uid\n          });\n        }), b.socket.on(\"on_update_stream\", function (e) {\n          var t = b.remoteStreams[e.uid];\n\n          if (b.joinInfo.stringUid && \"string\" != typeof e.uid && o.default.error(\"StringUID is Mixed with UintUID\"), t) {\n            t.audio = e.audio, t.video = e.video, t.screen = e.screen, t.pc && b._adjustPCMuteStatus(t);\n            var n = u({\n              type: \"stream-updated\",\n              stream: t\n            });\n            b.dispatchEvent(n);\n          } else o.default.debug(\"[\".concat(b.clientId, \"] Ignoring onUpdateStream event before onAddStream for uid \").concat(e.uid));\n\n          s.b.onUpdateStream(b.joinInfo.sid, {\n            peerid: e.uint_id || e.uid,\n            audio: e.audio,\n            video: e.video,\n            uid: b.uid\n          });\n        }), b.socket.on(\"on_add_video_stream\", function (e) {\n          if (o.default.info(\"[\".concat(b.clientId, \"] Newly added remote stream with uid \").concat(e.uid, \".\")), b.joinInfo.stringUid && \"string\" != typeof e.uid && o.default.error(\"StringUID is Mixed with UintUID\"), b.remoteStreamsInChannel.has(e.uid) || b.remoteStreamsInChannel.add(e.uid), void 0 === b.remoteStreams[e.uid]) {\n            var t = Ie({\n              streamID: e.uid,\n              local: !1,\n              audio: e.audio,\n              video: e.video,\n              uintUID: e.uint_id || e.uid\n            });\n            b.remoteStreams[e.uid] = t;\n            var n = u({\n              type: \"stream-added\",\n              stream: t\n            });\n            b.dispatchEvent(n);\n            var i = b.remoteMuteState[e.uid];\n\n            if (i && i.audio) {\n              n = l({\n                type: \"mute-audio\",\n                uid: e.uid\n              });\n              b.dispatchEvent(n);\n            }\n\n            if (i && i.video) {\n              n = l({\n                type: \"mute-video\",\n                uid: e.uid\n              });\n              b.dispatchEvent(n);\n            }\n          } else {\n            var a = b.remoteStreams[e.uid];\n\n            if (void 0 !== a.stream) {\n              if ((t = b.remoteStreams[e.uid]).video = !0, t.peerMuteVideo = !1, t.pc && b._adjustPCMuteStatus(t), o.default.info(\"[\".concat(b.clientId, \"] Stream changed: enable video \").concat(e.uid)), t.isPlaying()) {\n                var r = t.player.elementID;\n                t.stop(), t.play(r, t.playOptions);\n              }\n            } else if (a.p2pId) b.remoteStreams[e.uid].video = !0;else {\n              t = Ie({\n                streamID: e.uid,\n                local: !1,\n                audio: !0,\n                video: !0,\n                uintUID: e.uint_id || e.uid\n              });\n              b.remoteStreams[e.uid] = t, o.default.info(\"[\".concat(b.clientId, \"] Stream changed: modify video \").concat(e.uid));\n            }\n          }\n\n          s.b.onAddVideoStream(b.joinInfo.sid, {\n            peerid: e.uint_id || e.uid,\n            uid: b.uid\n          });\n        }), b.socket.on(\"on_remove_stream\", function (e) {\n          b.remoteStreamsInChannel.has(e.uid) && b.remoteStreamsInChannel.delete(e.uid);\n          var t = b.remoteStreams[e.uid];\n\n          if (t) {\n            delete b.remoteStreams[e.uid], delete b.remoteMuteState[e.uid];\n            var n = u({\n              type: \"stream-removed\",\n              stream: t\n            });\n            b.dispatchEvent(n), t.close(), void 0 !== t.pc && (t.pc.close(), t.pc = void 0, b.p2ps.delete(t.p2pId)), s.b.onRemoveStream(b.joinInfo.sid, {\n              peerid: e.uint_id || e.uid,\n              uid: b.uid\n            });\n          } else o.default.error(\"ERROR stream \", e.uid, \" not found onRemoveStream \", e);\n        }), b.socket.on(\"on_publish_stream\", function (e) {\n          var t = b.localStreams[e.uid],\n              n = u({\n            type: \"streamPublished\",\n            stream: t\n          });\n          b.dispatchEvent(n);\n        }), b.socket.on(\"mute_audio\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] rcv peer mute audio: \").concat(e.uid)), b.remoteMuteState[e.uid] = b.remoteMuteState[e.uid] || {\n            audio: !1,\n            video: !1\n          }, b.remoteMuteState[e.uid].audio = !0;\n          var t = l({\n            type: \"mute-audio\",\n            uid: e.uid\n          }),\n              n = b.remoteStreams[e.uid];\n          n ? (n.peerMuteAudio = !0, n.pc && b._adjustPCMuteStatus(n), b.dispatchEvent(t)) : o.default.debug(\"Ignoring event \".concat(e.type), e);\n        }), b.socket.on(\"unmute_audio\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] rcv peer unmute audio: \").concat(e.uid)), b.remoteMuteState[e.uid] = b.remoteMuteState[e.uid] || {\n            audio: !1,\n            video: !1\n          }, b.remoteMuteState[e.uid].audio = !1;\n          var t = l({\n            type: \"unmute-audio\",\n            uid: e.uid\n          }),\n              n = b.remoteStreams[e.uid];\n          n ? (n.peerMuteAudio = !1, n.pc && b._adjustPCMuteStatus(n), b.dispatchEvent(t)) : o.default.debug(\"Ignoring event \".concat(e.type), e);\n        }), b.socket.on(\"mute_video\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] rcv peer mute video: \").concat(e.uid)), b.remoteMuteState[e.uid] = b.remoteMuteState[e.uid] || {\n            audio: !1,\n            video: !1\n          }, b.remoteMuteState[e.uid].video = !0;\n          var t = l({\n            type: \"mute-video\",\n            uid: e.uid\n          }),\n              n = b.remoteStreams[e.uid];\n          n ? (n.peerMuteVideo = !0, n.pc && b._adjustPCMuteStatus(n), b.dispatchEvent(t)) : o.default.debug(\"Ignoring event \".concat(e.type), e);\n        }), b.socket.on(\"unmute_video\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] rcv peer unmute video: \").concat(e.uid)), b.remoteMuteState[e.uid] = b.remoteMuteState[e.uid] || {\n            audio: !1,\n            video: !1\n          }, b.remoteMuteState[e.uid].video = !1;\n          var t = l({\n            type: \"unmute-video\",\n            uid: e.uid\n          }),\n              n = b.remoteStreams[e.uid];\n          n ? (n.peerMuteVideo = !1, n.pc && b._adjustPCMuteStatus(n), b.dispatchEvent(t)) : o.default.debug(\"Ignoring event \".concat(e.type), e);\n        }), b.socket.on(\"on_crypt_error\", function (e) {\n          o.default.warning(\"[\".concat(b.clientId, \"] stream crypt error\"));\n          var t = l({\n            type: \"crypt-error\",\n            cryptType: e.crypt_type\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"on_user_banned\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] user banned uid: \").concat(e.uid, \" error: \").concat(e.error_code));\n          var t = l({\n            type: \"client-banned\",\n            uid: e.uid,\n            attr: e.error_code\n          });\n          b.dispatchEvent(t), i = !0;\n        }), b.socket.on(\"on_stream_fallback_update\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] stream fallback peerId: \").concat(e.stream_id, \" type: \").concat(e.stream_type));\n          var t = l({\n            type: \"stream-fallback\",\n            uid: e.stream_id,\n            stream: e.stream_id,\n            attr: e.stream_type\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"stream_recover\", function (e) {\n          o.default.info(\"[\".concat(b.clientId, \"] stream recover uid: \").concat(e.id, \" peerId: \").concat(e.peerid, \" type: \").concat(e.type));\n          var t = l({\n            type: \"stream-recover\",\n            uid: e.id,\n            stream: e.peerid,\n            attr: e.type\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"on_p2p_lost\", function (e) {\n          o.default.debug(\"[\".concat(b.clientId, \"] p2plost: \"), e, \"p2ps:\", b.p2ps);\n          var t,\n              n = \"DTLS failed\";\n          (t = b.localStreams[e.uid] || b.remoteStreams[e.uid]) ? (t.pc && t.pc.offerCandidates && 0 === t.pc.offerCandidates.length && (n = \"NO_CANDIDATES_IN_OFFER\"), \"publish\" === e.event && s.b.publish(b.joinInfo.sid, {\n            lts: t.publishLTS,\n            succ: !1,\n            audioName: t.hasAudio() && t.audioName,\n            videoName: t.hasVideo() && t.videoName,\n            screenName: t.hasScreen() && t.screenName,\n            ec: n\n          }), \"subscribe\" === e.event && s.b.subscribe(b.joinInfo.sid, {\n            lts: t.subscribeLTS,\n            succ: !1,\n            video: t.subscribeOptions && t.subscribeOptions.video,\n            audio: t.subscribeOptions && t.subscribeOptions.audio,\n            peerid: e.uid + \"\",\n            ec: n\n          })) : o.default.warning(\"P2PLost Stream Not found\", e), o.default.debug(\"[\".concat(b.clientId, \"] p2plost:\"), e.p2pid), (t = b.p2ps.get(e.p2pid)) && (b.p2ps.delete(e.p2pid), t.local ? b.dispatchEvent(l({\n            type: \"pubP2PLost\",\n            stream: t,\n            attr: n\n          })) : b.remoteStreams[t.getId()] && b.dispatchEvent(l({\n            type: \"subP2PLost\",\n            stream: t,\n            attr: n\n          })));\n        }), b.socket.on(\"on_token_privilege_will_expire\", function (e) {\n          o.default.debug(\"[\".concat(b.clientId, \"] Received Message onTokenPrivilegeWillExpire\")), b.dispatchEvent(l({\n            type: \"onTokenPrivilegeWillExpire\"\n          }));\n        }), b.socket.on(\"on_token_privilege_did_expire\", function () {\n          o.default.warning(\"[\".concat(b.clientId, \"] Received Message onTokenPrivilegeDidExpire, please get new token and join again\")), b.closeGateway(), b.dispatchEvent(l({\n            type: \"onTokenPrivilegeDidExpire\"\n          }));\n        }), b.socket.on(\"enable_local_video\", function (e) {\n          b.dispatchEvent(l({\n            type: \"enable-local-video\",\n            uid: e.uid\n          }));\n        }), b.socket.on(\"disable_local_video\", function (e) {\n          b.dispatchEvent(l({\n            type: \"disable-local-video\",\n            uid: e.uid\n          }));\n        }), b._doWithAction = function (e, t, n) {\n          \"tryNext\" === e ? function (e, t) {\n            o.default.debug(\"[\".concat(b.clientId, \"] Connect next gateway\")), b.state = S, b.socket.close(), C(), b.reconnectMode = \"tryNext\", b.state = _, O(e, t);\n          }(t, n) : \"retry\" === e ? function (e, t) {\n            o.default.debug(\"[\".concat(b.clientId, \"] Reconnect gateway\")), b.state = S, b.socket.close(), C(), b.reconnectMode = \"retry\", b.state = _, O(e, t);\n          }(t, n) : \"quit\" === e ? (o.default.debug(\"[\".concat(b.clientId, \"] quit gateway\")), b.state = S, b.socket.close(), C()) : \"recover\" === e && A();\n        }, b.socket.on(\"on_notification\", function (e) {\n          if (o.default.debug(\"[\".concat(b.clientId, \"] Receive notification: \"), e), \"ERR_JOIN_BY_MULTI_IP\" === I.GatewayErrorCode[e.code]) return b.dispatchEvent({\n            type: \"onMultiIP\",\n            option: e.option\n          });\n          e.detail ? b._doWithAction(qe[I.GatewayErrorCode[e.code]]) : e.action && b._doWithAction(e.action);\n        }), b.socket.on(\"on_user_offline\", function (e) {\n          var t = l({\n            type: \"peer-leave\",\n            uid: e.uid\n          });\n\n          if (b.remoteStreamsInChannel.has(e.uid) && b.remoteStreamsInChannel.delete(e.uid), b.remoteStreams.hasOwnProperty(e.uid) && (t.stream = b.remoteStreams[e.uid]), t.reason = e.reason, b.dispatchEvent(t), b.remoteStreams.hasOwnProperty(e.uid)) {\n            o.default.info(\"[\".concat(b.clientId, \"] closing stream on peer leave\"), e.uid);\n            var n = b.remoteStreams[e.uid];\n            n.close(), delete b.remoteStreams[e.uid], delete b.remoteMuteState[e.uid], s.b.onRemoveStream(b.joinInfo.sid, {\n              peerid: e.uint_id || e.uid,\n              uid: b.uid\n            }), void 0 !== n.pc && (n.pc.close(), n.pc = void 0, b.p2ps.delete(n.p2pId));\n          }\n\n          b.timers.hasOwnProperty(e.uid) && (clearInterval(b.timers[e.uid]), clearInterval(b.timers[e.uid] + \"_RelatedStats\"), delete b.timers[e.uid]), null != b.audioLevel[e.uid] && delete b.audioLevel[e.uid], null != b.timer_counter[e.uid] && delete b.timer_counter[e.uid];\n        }), b.socket.on(\"onUplinkStats\", function (e) {}), b.socket.on(\"liveStreamingStarted\", function (e) {\n          var t = p({\n            type: \"liveStreamingStarted\",\n            url: e.url\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"liveStreamingFailed\", function (e) {\n          var t = p({\n            type: \"liveStreamingFailed\",\n            url: e.url\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"liveStreamingStopped\", function (e) {\n          var t = p({\n            type: \"liveStreamingStopped\",\n            url: e.url\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"liveTranscodingUpdated\", function (e) {\n          var t = p({\n            type: \"liveTranscodingUpdated\",\n            reason: e.reason\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"streamInjectedStatus\", function (e) {\n          var t = p({\n            type: \"streamInjectedStatus\",\n            url: e.url,\n            uid: e.uid,\n            status: e.status\n          });\n          b.dispatchEvent(t);\n        }), b.socket.on(\"on_user_online\", function (e) {\n          b.joinInfo.stringUid && \"string\" != typeof e.uid && o.default.error(\"StringUID is Mixed with UintUID\"), b.dispatchEvent({\n            type: \"peer-online\",\n            uid: e.uid\n          });\n        }), b.socket.on(\"receive_metadata\", function (e) {\n          b.joinInfo.stringUid && \"string\" != typeof e.uid && o.default.error(\"StringUID is Mixed with UintUID\");\n          var t = decodeURIComponent(escape(window.atob(e.metadata)));\n          o.default.debug(\"[\".concat(b.clientId, \"] received \").concat(e.uid, \" metadata: \").concat(t)), b.dispatchEvent({\n            type: \"receive-metadata\",\n            uid: e.uid,\n            metadata: t\n          });\n        });\n\n        var c;\n      },\n          w = function (e, t) {\n        if (void 0 !== b.socket) try {\n          b.socket.emitSimpleMessage(e, function (e, n) {\n            t && t(e, n);\n          });\n        } catch (e) {\n          o.default.error(\"[\".concat(b.clientId, \"] Error in sendSimpleSdp [\").concat(e, \"]\"));\n        } else o.default.error(\"[\".concat(b.clientId, \"] Error in sendSimpleSdp [socket not ready]\"));\n      },\n          k = function () {\n        for (var e in b.localStreams) if (void 0 !== b.localStreams[e]) {\n          var t = b.localStreams[e];\n          delete b.localStreams[e], void 0 !== t.pc && (t.pc.close(), t.pc = void 0);\n        }\n      },\n          D = function () {\n        for (var e in b.remoteStreamsInChannel.clear(), b.remoteStreams) if (b.remoteStreams.hasOwnProperty(e)) {\n          var t = b.remoteStreams[e];\n          t.isPlaying() && t.stop(), t.close(), delete b.remoteStreams[e], void 0 !== t.pc && (t.pc.close(), t.pc = void 0);\n        }\n      };\n\n      return b;\n    },\n        Ze = {\n      _gatewayClients: {},\n      register: function (e, t) {\n        if (!t.uid) {\n          var n = \"NO_UID_PROVIDED\";\n          return o.default.error(\"[\".concat(e.clientId, \"] \"), n, t), n;\n        }\n\n        if (t.cname) {\n          if (this._gatewayClients[t.cname] && this._gatewayClients[t.cname][t.uid] && this._gatewayClients[t.cname][t.uid] !== e) {\n            n = \"UID_CONFLICT\";\n            return o.default.error(\"[\".concat(e.clientId, \"] \"), n, t), n;\n          }\n\n          return o.default.debug(\"[\".concat(e.clientId, \"] register client Channel\"), t.cname, \"Uid\", t.uid), this._gatewayClients[t.cname] || (this._gatewayClients[t.cname] = {}), this._gatewayClients[t.cname][t.uid] = e, null;\n        }\n\n        var n = \"NO_CHANNEL_PROVIDED\";\n        return o.default.error(\"[\".concat(e.clientId, \"] \"), n, t), n;\n      },\n      unregister: function (e) {\n        var t = e && e.uid,\n            n = e.joinInfo && e.joinInfo.cname;\n\n        if (!t || !n) {\n          var i = \"INVALID_GATEWAYCLIENT\";\n          return o.default.error(\"[\".concat(e.clientId, \"] \"), i), i;\n        }\n\n        if (this._gatewayClients[n] && this._gatewayClients[n][t]) {\n          if (this._gatewayClients[n][t] !== e) {\n            i = \"GATEWAYCLIENT_UID_CONFLICT\";\n            return o.default.error(\"[\".concat(e.clientId, \"] \"), i), i;\n          }\n\n          return o.default.debug(\"[\".concat(e.clientId, \"] unregister client \"), e.uid), delete this._gatewayClients[n][t], null;\n        }\n\n        var i = \"GATEWEAY_CLIENT_UNREGISTERED\";\n        o.default.error(\"[\".concat(e.clientId, \"] \"), i);\n      }\n    };\n\n    $e.DISCONNECTED = 0, $e.CONNECTING = 1, $e.CONNECTED = 2, $e.DISCONNECTING = 3, $e.connetionStateMap = {\n      0: \"DISCONNECTED\",\n      1: \"CONNECTING\",\n      2: \"CONNECTED\",\n      3: \"DISCONNECTING\"\n    };\n\n    var et = $e,\n        tt = {\n      1001: \"FRAMERATE_INPUT_TOO_LOW\",\n      1002: \"FRAMERATE_SENT_TOO_LOW\",\n      1003: \"SEND_VIDEO_BITRATE_TOO_LOW\",\n      1005: \"RECV_VIDEO_DECODE_FAILED\",\n      2001: \"AUDIO_INPUT_LEVEL_TOO_LOW\",\n      2002: \"AUDIO_OUTPUT_LEVEL_TOO_LOW\",\n      2003: \"SEND_AUDIO_BITRATE_TOO_LOW\",\n      2005: \"RECV_AUDIO_DECODE_FAILED\",\n      3001: \"FRAMERATE_INPUT_TOO_LOW_RECOVER\",\n      3002: \"FRAMERATE_SENT_TOO_LOW_RECOVER\",\n      3003: \"SEND_VIDEO_BITRATE_TOO_LOW_RECOVER\",\n      3005: \"RECV_VIDEO_DECODE_FAILED_RECOVER\",\n      4001: \"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER\",\n      4002: \"AUDIO_OUTPUT_LEVEL_TOO_LOW_RECOVER\",\n      4003: \"SEND_AUDIO_BITRATE_TOO_LOW_RECOVER\",\n      4005: \"RECV_AUDIO_DECODE_FAILED_RECOVER\"\n    },\n        nt = {\n      FramerateInput: 1001,\n      FramerateSent: 1002,\n      SendVideoBitrate: 1003,\n      VideoDecode: 1005,\n      AudioIntputLevel: 2001,\n      AudioOutputLevel: 2002,\n      SendAudioBitrate: 2003,\n      AudioDecode: 2005\n    },\n        it = function (e) {\n      var t = {\n        remoteStreamStorage: {},\n        localStreamStorage: {}\n      };\n      return t.gatewayClient = e, t.checkAudioOutputLevel = function (e) {\n        return !(e && parseInt(e.audioRecvBytesDelta) > 0 && parseInt(e.audioDecodingNormalDelta) > 0 && 0 === parseInt(e.audioOutputLevel));\n      }, t.checkAudioIntputLevel = function (e) {\n        return !e || 0 !== parseInt(e.audioInputLevel);\n      }, t.checkFramerateInput = function (e, t) {\n        if (!e || !t.attributes) return !0;\n        var n = parseInt(t.attributes.maxFrameRate),\n            i = parseInt(e.googFrameRateInput);\n        return !n || !i || !(n > 10 && i < 5 || n < 10 && n >= 5 && i <= 1);\n      }, t.checkFramerateSent = function (e) {\n        return !(e && parseInt(e.googFrameRateInput) > 5 && parseInt(e.googFrameRateSent) <= 1);\n      }, t.checkSendVideoBitrate = function (e) {\n        return !e || 0 !== parseInt(e.videoSendBytesDelta);\n      }, t.checkSendAudioBitrate = function (e) {\n        return !e || 0 !== parseInt(e.audioSendBytesDelta);\n      }, t.checkVideoDecode = function (e) {\n        return !e || 0 === parseInt(e.videoRecvBytesDelta) || 0 !== parseInt(e.googFrameRateDecoded);\n      }, t.checkAudioDecode = function (e) {\n        return !e || 0 === parseInt(e.audioRecvBytesDelta) || 0 !== parseInt(e.audioDecodingNormalDelta);\n      }, t.record = function (e, n, i, a, r) {\n        i[e] || (i[e] = {\n          isPrevNormal: !0,\n          record: []\n        });\n        var o = i[e],\n            s = t[\"check\" + e](n, r);\n\n        if (o.record.push(s), o.record.length >= 5) {\n          o.isCurNormal = -1 !== o.record.indexOf(!0);\n          var c = nt[e];\n          o.isPrevNormal && !o.isCurNormal && t.gatewayClient.dispatchEvent({\n            type: \"exception\",\n            code: c,\n            msg: tt[c],\n            uid: a\n          }), !o.isPrevNormal && o.isCurNormal && t.gatewayClient.dispatchEvent({\n            type: \"exception\",\n            code: c + 2e3,\n            msg: tt[c + 2e3],\n            uid: a\n          }), o.isPrevNormal = o.isCurNormal, o.record = [];\n        }\n      }, t.setLocalStats = function (e) {\n        var n = {};\n        Object.keys(e).map(function (i) {\n          var a = e[i],\n              r = t.gatewayClient.localStreams[parseInt(i)],\n              o = t.localStreamStorage[i] || {};\n          r && r.hasVideo() && (t.record(\"SendVideoBitrate\", a.videoStats, o, i), t.record(\"FramerateInput\", a.videoStats, o, i, r), t.record(\"FramerateSent\", a.videoStats, o, i)), r && r.hasAudio() && (t.record(\"AudioIntputLevel\", a.audioStats, o, i), t.record(\"SendAudioBitrate\", a.audioStats, o, i)), n[i] = o;\n        }), t.localStreamStorage = n;\n      }, t.setRemoteStats = function (n) {\n        var i = {};\n        Object.keys(n).map(function (a) {\n          var r = n[a],\n              o = e.remoteStreams[a],\n              s = t.remoteStreamStorage[a] || {};\n          o && o.hasVideo() && o.isPlaying() && t.record(\"VideoDecode\", r.videoStats, s, a), o && o.hasAudio() && o.isPlaying() && (t.record(\"AudioOutputLevel\", r.audioStats, s, a), t.record(\"AudioDecode\", r.audioStats, s, a)), i[a] = s;\n        }), t.remoteStreamStorage = i;\n      }, t;\n    },\n        at = new function () {\n      var e = c();\n      return e.states = {\n        UNINIT: \"UNINIT\",\n        INITING: \"INITING\",\n        INITED: \"INITED\"\n      }, e.state = e.states.UNINIT, e.type = null, e.lastConnectedAt = null, e.lastDisconnectedAt = null, e.lastTypeChangedAt = null, e.networkChangeTimer = null, e._init = function (t, n) {\n        if (e.state = e.states.INITING, navigator.connection && navigator.connection.addEventListener) {\n          var i = e._getNetworkInfo();\n\n          e.type = i && i.type, e.state = e.states.INITED, t && t();\n        } else e.state = e.states.UNINIT, n && n(\"DO_NOT_SUPPORT\");\n      }, e._getNetworkInfo = function () {\n        return navigator.connection;\n      }, e._reloadNetworkInfo = function () {\n        var t = e._getNetworkInfo(),\n            n = t && t.type || \"UNSUPPORTED\",\n            i = Date.now();\n\n        if (n !== e.type) {\n          e.lastTypeChangedAt = i, \"none\" == n ? e.lastDisconnectedAt = i : \"none\" == e.type && (e.lastConnectedAt = i), e.type = n;\n          var a = {\n            type: \"networkTypeChanged\",\n            networkType: n\n          };\n          e.dispatchEvent(a);\n        }\n      }, e.getStats = function (t, n) {\n        var i = {},\n            a = e._getNetworkInfo();\n\n        a && (i.NetworkType = a.type || \"UNSUPPORTED\"), setTimeout(function () {\n          t(i);\n        }, 0);\n      }, e._init(function () {\n        navigator.connection.addEventListener(\"change\", function () {\n          e._reloadNetworkInfo();\n        }), e.networkChangeTimer = setInterval(function () {\n          e._reloadNetworkInfo();\n        }, 5e3);\n      }, function (e) {}), e;\n    }(),\n        rt = \"DISCONNECTING\",\n        ot = \"DISCONNECTED\",\n        st = \"CONNECTED\",\n        ct = \"INIT\",\n        dt = [],\n        ut = (setInterval(function () {\n      Date.now();\n      dt.forEach(function (e) {\n        for (var t = e.requests.length - 1; t >= 0; t--) {\n          var n = e.requests[t];\n          n.timeoutCnt++, n.timeoutCnt >= 15 && (e.requests.splice(t, 1), n.promises.reject({\n            reason: \"TIMEOUT\",\n            code: 499\n          }));\n        }\n      });\n    }, 1e3), 1),\n        lt = 1,\n        ft = 1,\n        pt = function () {\n      var e = K()(Y.a.mark(function e(t) {\n        var n, i, a, s, c, d, u;\n        return Y.a.wrap(function (e) {\n          for (;;) switch (e.prev = e.next) {\n            case 0:\n              return n = t.uid, i = t.url, a = t.serviceName, s = t.sid, c = t.appId, d = t.cname, u = t.timeout, e.abrupt(\"return\", new Promise(function (e, t) {\n                var l = !1,\n                    f = new XMLHttpRequest();\n                f.open(\"POST\", i, !0), f.setRequestHeader(\"Content-Type\", \"application/json; charset=utf-8\"), f.setRequestHeader(\"X-Packet-Service-Type\", \"0\"), f.setRequestHeader(\"X-Packet-URI\", \"61\"), f.onload = function () {\n                  if (!l) {\n                    var n = null,\n                        i = null;\n\n                    try {\n                      n = JSON.parse(f.responseText);\n                    } catch (e) {\n                      var a = \"Invalid text \".concat(f.responseText);\n                      return o.default.error(a), l = !0, t(a);\n                    }\n\n                    if (n.code) {\n                      var r = \"AP_ERR_\".concat(n.code);\n                      return o.default.error(r, n), l = !0, t(r);\n                    }\n\n                    try {\n                      i = JSON.parse(n.json_body || n.json);\n                    } catch (e) {\n                      var s = \"Invalid json_body \".concat(f.responseText);\n                      return o.default.error(s), l = !0, t(s);\n                    }\n\n                    if (200 !== i.code) {\n                      var c = \"APPCENTER_CODE_\".concat(i.code);\n                      return o.default.error(c, i), l = !0, t(c);\n                    }\n\n                    if (!(i.servers && i.servers.length > 0)) {\n                      return o.default.error(\"APPCENTER_EMPTY_SERVER\", i), l = !0, t(\"APPCENTER_EMPTY_SERVER\");\n                    }\n\n                    return l = !0, e(i);\n                  }\n                }, f.onerror = function (e) {\n                  var n = \"AP_REUEST_\".concat(e.type);\n                  o.default.error(n, i, e), l || (l = !0, t(n));\n                }, f.ontimeout = function (e) {\n                  o.default.error(\"AP_REUEST_TIMEOUT\", i, e), l || (l = !0, t(\"AP_REUEST_TIMEOUT\"));\n                }, u && (f.timeout = u), f.send(JSON.stringify({\n                  service_name: a,\n                  json_body: JSON.stringify({\n                    command: \"convergeAllocateEdge\",\n                    sid: s,\n                    uid: n + \"\",\n                    appId: c,\n                    ts: Math.floor(Date.now() / 1e3),\n                    seq: ut++,\n                    cname: d,\n                    version: r.VERSION,\n                    requestId: lt++\n                  })\n                }));\n              }));\n\n            case 2:\n            case \"end\":\n              return e.stop();\n          }\n        }, e, this);\n      }));\n      return function (t) {\n        return e.apply(this, arguments);\n      };\n    }(),\n        gt = function () {\n      var e = K()(Y.a.mark(function e(t) {\n        var n, i, a, s, c, d, u, l, f, p, g, m;\n        return Y.a.wrap(function (e) {\n          for (;;) switch (e.prev = e.next) {\n            case 0:\n              n = t.serviceName, i = t.sid, a = t.appId, s = t.cname, c = t.uid, d = null, e.t0 = Y.a.keys(Object(r.getParameter)(\"UAP_AP\"));\n\n            case 3:\n              if ((e.t1 = e.t0()).done) {\n                e.next = 34;\n                break;\n              }\n\n              return u = e.t1.value, l = \"https://\".concat(Object(r.getParameter)(\"UAP_AP\")[u], \"/api/v1?action=uap\"), f = void 0, e.prev = 7, e.next = 10, pt({\n                uid: c,\n                url: l,\n                appId: a,\n                sid: i,\n                serviceName: n,\n                cname: s,\n                timeout: Object(r.getParameter)(\"HTTP_CONNECT_TIMEOUT\")\n              });\n\n            case 10:\n              f = e.sent, e.next = 18;\n              break;\n\n            case 13:\n              return e.prev = 13, e.t2 = e.catch(7), o.default.error(e.t2), d = e.t2, e.abrupt(\"continue\", 3);\n\n            case 18:\n              p = Y.a.mark(function e(t) {\n                var i, a, r;\n                return Y.a.wrap(function (e) {\n                  for (;;) switch (e.prev = e.next) {\n                    case 0:\n                      if (i = f.servers[t], a = \"wss://\".concat(i.address.replace(/\\./g, \"-\"), \".edge.\").concat(t % 2 == 0 ? \"agora.io\" : \"agoraio.cn\", \":\").concat(i.wss, \"?serviceName=\").concat(encodeURIComponent(n)), i.wss) {\n                        e.next = 5;\n                        break;\n                      }\n\n                      return o.default.error(\"Invalid server response\", i), e.abrupt(\"return\", \"continue\");\n\n                    case 5:\n                      return e.prev = 5, e.next = 8, new Promise(function (e, t) {\n                        var n = new WebSocket(a),\n                            i = !1;\n                        n.addEventListener(\"open\", function () {\n                          i || (i = !0, e(n));\n                        }), n.addEventListener(\"error\", function (e) {\n                          i || (i = !0, t(e));\n                        });\n                      });\n\n                    case 8:\n                      return (r = e.sent).workerToken = f.workerToken, e.abrupt(\"return\", {\n                        v: r\n                      });\n\n                    case 13:\n                      e.prev = 13, e.t0 = e.catch(5), o.default.error(e.t0), d = e.t0;\n\n                    case 17:\n                    case \"end\":\n                      return e.stop();\n                  }\n                }, e, this, [[5, 13]]);\n              }), g = 0;\n\n            case 20:\n              if (!(g < f.servers.length)) {\n                e.next = 32;\n                break;\n              }\n\n              return e.delegateYield(p(g), \"t3\", 22);\n\n            case 22:\n              m = e.t3, e.t4 = m, e.next = \"continue\" === e.t4 ? 26 : 27;\n              break;\n\n            case 26:\n              return e.abrupt(\"continue\", 29);\n\n            case 27:\n              if (\"object\" !== Se()(m)) {\n                e.next = 29;\n                break;\n              }\n\n              return e.abrupt(\"return\", m.v);\n\n            case 29:\n              g++, e.next = 20;\n              break;\n\n            case 32:\n              e.next = 3;\n              break;\n\n            case 34:\n              throw d;\n\n            case 35:\n            case \"end\":\n              return e.stop();\n          }\n        }, e, this, [[7, 13]]);\n      }));\n      return function (t) {\n        return e.apply(this, arguments);\n      };\n    }(),\n        mt = {},\n        vt = function (e) {\n      return mt[e] ? (mt[e] += 1, mt[e]) : (mt[e] = 1, mt[e]);\n    },\n        St = {},\n        ht = function (e) {\n      return St[e] ? (St[e] += 1, St[e]) : (St[e] = 1, St[e]);\n    },\n        _t = function (e) {\n      var t = e.appId,\n          n = e.cname,\n          i = e.uid,\n          a = e.sid,\n          s = c();\n      return s.status = ct, s.pingpongTimer = null, s.connection = null, s.requests = [], s.appId = t, s.cname = n, s.uid = i, s.sid = a, s.connection = null, s.connectionId = ft++, s.connect = function () {\n        var e = K()(Y.a.mark(function e(t) {\n          var n;\n          return Y.a.wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (n = t.wsClient, s.status === ct) {\n                  e.next = 4;\n                  break;\n                }\n\n                return o.default.debug(\"Ignored UapConnection.connect: \".concat(s.status)), e.abrupt(\"return\");\n\n              case 4:\n                s.connection = n, s.status = st, s._flush(), s.startPingpong(), n.addEventListener(\"close\", function (e) {\n                  if (console.log(\"Weboskcet closed\", e), n === s.connection) {\n                    var t = {\n                      type: \"close\",\n                      evt: e\n                    };\n                    s.dispatchEvent(t);\n                  }\n                }), n.addEventListener(\"message\", function (e) {\n                  if (e.data) {\n                    var t = null;\n\n                    try {\n                      t = JSON.parse(e.data);\n                    } catch (e) {\n                      return void o.default.error(\"Invalid data from worker manager\", t);\n                    }\n\n                    if (t.requestId) for (var n = s.requests.length - 1; n >= 0; n--) {\n                      var i = s.requests[n];\n\n                      if (i.reqData.requestId === t.requestId) {\n                        s.requests.splice(n, 1), t.code < 400 && t.code >= 200 ? i.promises.resolve(t) : i.promises.reject(t);\n                        break;\n                      }\n                    } else t.type = \"notification\", s.dispatchEvent(t);\n                  }\n                });\n\n              case 10:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, this);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), s.disconnect = K()(Y.a.mark(function e() {\n        var t;\n        return Y.a.wrap(function (e) {\n          for (;;) switch (e.prev = e.next) {\n            case 0:\n              for (t in s.status = rt, clearInterval(s.pingpongTimer), s.pingpongTimer = null, s.requests) s.requests[t].promises.reject(\"DISCONNECTED\");\n\n              return s.requests = [], null, s.connection && (s.connection.close(), s.connection = null), s.status = ot, e.abrupt(\"return\", null);\n\n            case 9:\n            case \"end\":\n              return e.stop();\n          }\n        }, e, this);\n      })), s.request = function () {\n        var e = K()(Y.a.mark(function e(t) {\n          var n, i, a, c;\n          return Y.a.wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (n = h()({\n                  command: \"request\",\n                  sdkVersion: r.VERSION,\n                  seq: ht(s.sid),\n                  appId: s.appId,\n                  cname: s.cname,\n                  uid: \"\" + s.uid,\n                  sid: s.sid,\n                  requestId: vt(s.sid),\n                  ts: Math.floor(Date.now() / 1e3)\n                }, t), \"INIT\" !== s.status) {\n                  e.next = 5;\n                  break;\n                }\n\n                return e.abrupt(\"return\", new Promise(function (e, t) {\n                  var i = {\n                    reqData: n,\n                    stalledTs: Date.now(),\n                    timeoutCnt: 0,\n                    promises: {\n                      resolve: e,\n                      reject: t\n                    }\n                  };\n                  s.requests.push(i);\n                }));\n\n              case 5:\n                if (s.connection) {\n                  e.next = 11;\n                  break;\n                }\n\n                throw i = \"NO_WEBSOCKET_CONNECTION\", o.default.error(i), new Error(i);\n\n              case 11:\n                if (s.status !== rt || t.clientRequest && \"DestroyWorker\" === t.clientRequest.command) {\n                  e.next = 17;\n                  break;\n                }\n\n                throw a = \"WEBSOCKET_DISCONNECTING\", o.default.error(a), new Error(a);\n\n              case 17:\n                if (\"DISCONNECTED\" !== s.status) {\n                  e.next = 23;\n                  break;\n                }\n\n                throw c = \"WEBSOCKET_DISCONNECTED\", o.default.error(c), new Error(c);\n\n              case 23:\n                return e.abrupt(\"return\", new Promise(function (e, t) {\n                  var i = {\n                    reqData: n,\n                    stalledTs: Date.now(),\n                    timeoutCnt: 0,\n                    promises: {\n                      resolve: e,\n                      reject: t\n                    }\n                  };\n                  s.requests.push(i), s._flush();\n                }));\n\n              case 24:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, this);\n        }));\n        return function (t) {\n          return e.apply(this, arguments);\n        };\n      }(), s._flush = function () {\n        s.connection && s.status === st && s.requests.forEach(function (e) {\n          e.sentTs || (e.sentTs = Date.now(), e.reqData.clientRequest && (e.reqData.clientRequest.workerToken = s.connection.workerToken), s.connection.send(JSON.stringify(e.reqData)));\n        });\n      }, s.startPingpong = function () {\n        clearInterval(s.pingpongTimer), s.pingpongTimer = setInterval(K()(Y.a.mark(function e() {\n          return Y.a.wrap(function (e) {\n            for (;;) switch (e.prev = e.next) {\n              case 0:\n                if (s.status !== st || !s.connection || 1 !== s.connection.readyState) {\n                  e.next = 9;\n                  break;\n                }\n\n                return e.prev = 1, e.next = 4, s.request({\n                  command: \"ping\"\n                });\n\n              case 4:\n                e.next = 9;\n                break;\n\n              case 6:\n                e.prev = 6, e.t0 = e.catch(1), o.default.error(\"pingpong\", e.t0);\n\n              case 9:\n              case \"end\":\n                return e.stop();\n            }\n          }, e, this, [[1, 6]]);\n        })), 6e3);\n      }, s._flush(), s.startPingpong(), dt.push(s), s;\n    },\n        Et = function (e) {\n      e.disconnect();\n      var t = dt.find(function (t) {\n        return e.connectionId === t.connectionId;\n      });\n      dt.splice(t, 1);\n    },\n        It = function (e) {\n      return \"number\" == typeof e && 0 <= e && e <= 4294967295;\n    };\n\n    var Tt = function (e) {\n      var t = e;\n      if (Object(r.getParameter)(\"LIVESTREAMING_ALIGN\")) switch (e) {\n        case 200:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_SUCCESS;\n          break;\n\n        case 451:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_ALREADY_EXISTS;\n          break;\n\n        case 453:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_UNAUTHORIZED;\n          break;\n\n        case 470:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_BROKEN;\n          break;\n\n        case 499:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_TIMEDOUT;\n          break;\n\n        default:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_FAILED;\n      }\n      return t;\n    },\n        yt = function (e) {\n      var t = e;\n      if (Object(r.getParameter)(\"LIVESTREAMING_ALIGN\")) switch (e) {\n        case 200:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_SUCCESS;\n          break;\n\n        case 404:\n        case 452:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_NOT_FOUND;\n          break;\n\n        case 453:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED;\n          break;\n\n        case 499:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_TIMEDOUT;\n          break;\n\n        default:\n          t = I.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_FAILED;\n      }\n      return t;\n    },\n        bt = a(22),\n        Rt = a.n(bt),\n        At = function (e) {\n      var t = {\n        key: void 0,\n        highStream: null,\n        lowStream: null,\n        lowStreamParameter: null,\n        isDualStream: !1,\n        highStreamState: 2,\n        lowStreamState: 2,\n        proxyServer: null,\n        turnServers: [],\n        useProxyServer: !1\n      };\n      t.mode = e.mode, t.codec = e.codec, t.clientId = Object(F.generateSessionId)().slice(0, 5), t.uintUid = null;\n      e = h()({}, e);\n      return t.aespassword = null, t.aesmode = \"none\", t.hasPublished = !1, t.getSessionId = function () {\n        return e.sessionId;\n      }, t.startChannelMediaRelay = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e) {\n            if (e) return i && i(e);\n            i && i();\n          },\n          name: \"Client.startChannelMediaRelay\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (!(n instanceof ye.ChannelMediaRelayConfiguration)) throw \"Configration should be instance of [ChannelMediaRelayConfiguration]\";\n        var r = n.getSrcChannelMediaInfo(),\n            o = n.getDestChannelMediaInfos();\n        if (Object(H.isEmpty)(r)) throw \"srcChannelMediaInfo should not be empty\";\n        if (Object(H.isEmpty)(o) || 0 === o.length) throw \"destChannelMediaInfos should not be empty\";\n        if (!Object(F.is32Uint)(r.uid)) throw \"Invalid uid in srcChannelMediaInfo\";\n        if (!Object(H.isValidChannelName)(r.channelName)) throw \"Invalid channelName in srcChannelMediaInfo\";\n        if (r.token && !Object(H.isValidToken)(r.token)) throw \"Invalid token in srcChannelMediaInfo\";\n        if (o.forEach(function (e) {\n          if (!Object(F.is32Uint)(e.uid)) throw \"Invalid uid in destChannelMediaInfo\";\n          if (!Object(H.isValidChannelName)(e.channelName)) throw \"Invalid channelName in destChannelMediaInfo\";\n          if (e.token && !Object(H.isValidToken)(e.token)) throw \"Invalid token in destChannelMediaInfo\";\n        }), t.gatewayClient.state !== et.CONNECTED) throw \"startChannelMediaRelay should be used after join\";\n        t.gatewayClient.startChannelMediaRelay(n).then(function () {\n          a && a();\n        }).catch(function (e) {\n          a && a(e);\n        });\n      }, t.updateChannelMediaRelay = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e) {\n            if (e) return i && i(e);\n            i && i();\n          },\n          name: \"Client.updateChannelMediaRelay\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (!(n instanceof ye.ChannelMediaRelayConfiguration)) throw \"Configration should be instance of [ChannelMediaRelayConfiguration]\";\n        var r = n.getSrcChannelMediaInfo(),\n            o = n.getDestChannelMediaInfos();\n        if (Object(H.isEmpty)(r)) throw \"srcChannelMediaInfo should not be empty\";\n        if (Object(H.isEmpty)(o) || 0 === o.length) throw \"destChannelMediaInfos should not be empty\";\n        if (!Object(F.is32Uint)(r.uid)) throw \"Invalid uid in srcChannelMediaInfo\";\n        if (!Object(H.isValidChannelName)(r.channelName)) throw \"Invalid channelName in srcChannelMediaInfo\";\n        if (r.token && !Object(H.isValidToken)(r.token)) throw \"Invalid token in srcChannelMediaInfo\";\n        if (o.forEach(function (e) {\n          if (!Object(F.is32Uint)(e.uid)) throw \"Invalid uid in destChannelMediaInfo\";\n          if (!Object(H.isValidChannelName)(e.channelName)) throw \"Invalid channelName in destChannelMediaInfo\";\n          if (e.token && !Object(H.isValidToken)(e.token)) throw \"Invalid token in destChannelMediaInfo\";\n        }), t.gatewayClient.state !== et.CONNECTED) throw \"updateChannelMediaRelay should be used after join\";\n        t.gatewayClient.updateChannelMediaRelay(n).then(function () {\n          a && a();\n        }).catch(function (e) {\n          a && a(e);\n        });\n      }, t.stopChannelMediaRelay = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e) {\n            if (e) return n && n(e);\n            n && n();\n          },\n          name: \"Client.stopChannelMediaRelay\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        t.gatewayClient.stopChannelMediaRelay().then(function () {\n          i && i();\n        }).catch(function (e) {\n          i && i(e);\n        });\n      }, t.getConnectionState = function () {\n        var n = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.getConnectionState\",\n          options: arguments,\n          tag: \"tracer\"\n        }),\n            i = et.connetionStateMap[t.gatewayClient.state];\n        return n(), i;\n      }, t.setClientRole = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: i,\n          name: \"Client.setClientRole\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n\n        if (Object(H.checkValidEnum)(n, \"setClientRole\", [\"host\", \"audience\"]), \"rtc\" === t.mode) {\n          var r = \"RTC mode can not use setClientRole\";\n          return o.default.warning(\"[\".concat(t.clientId, \"] \").concat(r)), a && a(r);\n        }\n\n        t.gatewayClient && t.gatewayClient.state === et.CONNECTED ? (\"audience\" === n && (0 === this.highStreamState ? this._unpublish(this.highStream, function () {\n          a && a(null, {\n            role: n\n          });\n        }, function (e) {\n          a && a(e);\n        }) : t.gatewayClient.setClientRole(\"audience\", a)), \"host\" === n && t.gatewayClient.setClientRole(\"host\", a)) : (t.gatewayClient.role = n, a && a(null, {\n          role: n\n        }));\n      }, t.getGatewayInfo = function (e) {\n        if (t.gatewayClient.state !== et.CONNECTED) {\n          var n = \"Client is not in connected state\";\n          return o.default.error(\"[\".concat(t.clientId, \"] \").concat(n)), void e(n);\n        }\n\n        t.gatewayClient.getGatewayInfo(function (t) {\n          e(null, t);\n        }, e);\n      }, t.renewToken = function (n, i, a) {\n        var r = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return o.default.error(\"Failed to renew token \".concat(e), t), a && a(e);\n            i && i(t);\n          },\n          name: \"Client.renewToken\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (!Object(H.isValidToken)(n)) throw new Error(\"Invalid token: Token is of the string type .Length of the string: [1,255]. ASCII characters only.\");\n        return t.gatewayClient ? t.key ? (t.key = n, void t.gatewayClient.renewToken(n, function (e) {\n          return r(null, e);\n        }, r)) : (o.default.error(\"[\".concat(t.clientId, \"] renewToken should not be called before user join\")), r(I.default.INVALID_OPERATION)) : (o.default.error(\"[\".concat(t.clientId, \"] renewToken Failed. GatewayClient not Exist\")), r(I.default.INVALID_OPERATION));\n      }, t.setLowStreamParameter = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setLowStreamParameter\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidObject)(n, \"param\");\n        var a = n.width,\n            r = n.height,\n            c = n.framerate,\n            d = n.bitrate;\n        Object(H.isEmpty)(a) || Object(H.checkValidNumber)(a, \"width\"), Object(H.isEmpty)(r) || Object(H.checkValidNumber)(r, \"height\"), Object(H.isEmpty)(c) || Object(H.checkValidNumber)(c, \"framerate\"), Object(H.isEmpty)(d) || Object(H.checkValidNumber)(d, \"bitrate\", 1, 1e7), (!a && r || a && !r) && o.default.warning(\"[\".concat(t.clientId, \"] The width and height parameters take effect only when both are set\")), t.lowStreamParameter = n, i();\n      }, t.init = function (n, i, a) {\n        var r = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n            i && i(t);\n          },\n          name: \"Client.init\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidString)(n), Object(g.isChromeKernel)() && Object(g.getChromeKernelVersion)() <= 48 ? a ? r(I.default.BAD_ENVIRONMENT) : Object(F.popBanTip)() : (o.default.info(\"[\".concat(t.clientId, \"] Initializing AgoraRTC client, appId: \").concat(n, \".\")), e.appId = n, e.sessionId = Object(F.generateSessionId)(), r());\n      }, t.setTurnServer = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setTurnServer\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (t.gatewayClient && t.gatewayClient.state !== et.DISCONNECTED) throw new Error(\"Set turn server before join channel\");\n        if (t.useProxyServer) throw new Error(\"You have already set the proxy\");\n        n instanceof Array || (n = [n]);\n        var a = [];\n        n.map(function (e, n) {\n          Object(H.checkValidObject)(e, \"turnServer\");\n          var i = e.turnServerURL,\n              r = e.username,\n              s = e.password,\n              c = e.udpport,\n              d = e.forceturn,\n              u = e.tcpport;\n          if (Object(H.checkValidString)(i, \"turnServerURL\"), Object(H.checkValidString)(r, \"username\"), Object(H.checkValidString)(s, \"password\"), Object(H.checkValidString)(c, \"udpport\"), 0 === parseInt(c)) throw new Error(\"udpport should not be \".concat(c));\n          Object(H.isEmpty)(d) || Object(H.checkValidBoolean)(d, \"forceturn\");\n          var l = {\n            mode: \"manual\"\n          };\n\n          if (l.url = i, l.udpport = c, l.username = r, l.credential = s, l.forceturn = d || !1, !Object(H.isEmpty)(u)) {\n            if (Object(H.checkValidString)(u, \"tcpport\"), 0 === parseInt(u)) throw new Error(\"tcpport should not be \".concat(u));\n            l.tcpport = u, o.default.info(\"[\".concat(t.clientId, \"] Set turnserver[\").concat(n, \"] tcpurl. \").concat(l.url, \":\").concat(l.tcpport));\n          }\n\n          o.default.info(\"[\".concat(t.clientId, \"] Set turnserver[\").concat(n, \"] udpurl. \").concat(l.url, \":\").concat(l.udpport, \",username: \").concat(l.uername, \",password: \").concat(l.credential)), a.push(l);\n        }), t.turnServers = a, i();\n      }, t.setProxyServer = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setProxyServer\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (t.gatewayClient && t.gatewayClient.state !== et.DISCONNECTED) throw new Error(\"Set proxy server before join channel\");\n        if (!n) throw new Error(\"Do not set the proxyServer parameter as empty\");\n        if (t.useProxyServer) throw new Error(\"You have already set the proxy\");\n        Object(H.checkValidString)(n, \"proxyServer\"), t.proxyServer = n, s.b.setProxyServer(n), o.default.setProxyServer(n), i();\n      }, t.startProxyServer = function () {\n        var n = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.startProxyServer\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (t.gatewayClient && t.gatewayClient.state !== et.DISCONNECTED) throw new Error(\"Start proxy server before join channel\");\n        if (t.proxyServer) throw new Error(\"You have already set the proxy\");\n        t.useProxyServer = !0, n();\n      }, t.stopProxyServer = function () {\n        var n = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.stopProxyServer\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (t.gatewayClient && t.gatewayClient.state !== et.DISCONNECTED) throw new Error(\"Stop proxy server after leave channel\");\n        s.b.setProxyServer(), o.default.setProxyServer(), t.turnServers = [], t.proxyServer = null, t.useProxyServer = !1, n();\n      }, t.setEncryptionSecret = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setEncryptionSecret\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidString)(n, \"password\"), t.aespassword = n, i();\n      }, t.setEncryptionMode = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setEncryptionMode\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (Object(H.checkValidString)(n, \"encryptionMode\"), -1 === Ce.indexOf(n)) throw new Error('Invalid encryptionMode: encryptionMode should be \"aes-128-xts\" | \"aes-256-xts\" | \"aes-128-ecb\"');\n        t.aesmode = n, i();\n      }, t.configPublisher = function (n) {\n        var i = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.configPublisher\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidObject)(n, \"config\");\n        var a = n.width,\n            r = n.height,\n            o = n.framerate,\n            c = n.bitrate,\n            d = n.publisherUrl;\n        Object(H.checkValidNumber)(a, \"width\"), Object(H.checkValidNumber)(r, \"height\"), Object(H.checkValidNumber)(o, \"framerate\"), Object(H.checkValidNumber)(c, \"bitrate\", 1, 1e7), d && Object(H.checkValidString)(d, \"publisherUrl\"), t.gatewayClient.configPublisher(n), i();\n      }, t.enableDualStream = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return i && i(e);\n            n && n(t);\n          },\n          name: \"Client.enableDualStream\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        return \"iOS\" === Object(g.getBrowserOS)() ? (s.b.streamSwitch(e.sessionId, {\n          lts: new Date().getTime(),\n          isdual: !0,\n          succ: !1\n        }), a(I.default.IOS_NOT_SUPPORT)) : Object(g.isWeChatBrowser)() ? (s.b.streamSwitch(e.sessionId, {\n          lts: new Date().getTime(),\n          isdual: !0,\n          succ: !1\n        }), a(I.default.WECHAT_NOT_SUPPORT)) : (s.b.streamSwitch(e.sessionId, {\n          lts: new Date().getTime(),\n          isdual: !0,\n          succ: !0\n        }), t.isDualStream = !0, t.highStream && (t.highStream.isDualStream = !0), void (0 === t.highStreamState ? t._publishLowStream(function (e) {\n          return a(null, e);\n        }, function (e) {\n          o.default.warning(\"[\".concat(t.clientId, \"]\"), e), a(I.default.ENABLE_DUALSTREAM_FAILED);\n        }) : 1 === t.highStreamState ? a(I.default.STILL_ON_PUBLISHING) : a(null)));\n      }, t.disableDualStream = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return i && i(e);\n            n && n(t);\n          },\n          name: \"Client.disableDualStream\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        s.b.streamSwitch(e.sessionId, {\n          lts: new Date().getTime(),\n          isdual: !1,\n          succ: !0\n        }), t.isDualStream = !1, t.highStream && (t.highStream.isDualStream = !1), 0 === t.highStreamState ? t._unpublishLowStream(function () {\n          t.highStream.lowStream = null, a();\n        }, function (e) {\n          o.default.warning(\"[\".concat(t.clientId, \"]\"), e), a(I.default.DISABLE_DUALSTREAM_FAILED);\n        }) : 1 === t.highStreamState ? a(I.default.STILL_ON_PUBLISHING) : a();\n      }, t._getLowStream = function (e, n) {\n        t.lowStream ? e(t.lowStream) : t._createLowStream(function (n) {\n          t.lowStream = n, e(t.lowStream);\n        }, n);\n      }, t._createLowStream = function (e, n) {\n        if (t.highStream && t.highStream.stream) {\n          var i = h()({}, t.highStream.params);\n          if (i.streamID += 1, i.audio = !1, i.video) {\n            if (t.highStream.stream.getVideoTracks()[0]) {\n              var a = new Ie(i);\n\n              if (a.isLowStream = !0, a.streamId = t.highStream.getId() + 1, t.lowStreamParameter) {\n                var r = h()({}, t.lowStreamParameter);\n                r.width && r.height || (r.width = 160, r.height = 120), r.framerate = r.framerate || 15, r.bitrate = r.bitrate || 50, a.setVideoProfileCustomPlus(r);\n              } else a.setVideoProfileCustom(function (e) {\n                var t;\n\n                switch (e) {\n                  case \"120p\":\n                  case \"120p_1\":\n                    t = [\"120p_1\", \"120p_1\", \"120p_1\"];\n                    break;\n\n                  case \"120p_3\":\n                    t = [\"120p_3\", \"120p_3\", \"120p_3\"];\n                    break;\n\n                  case \"180p\":\n                  case \"180p_1\":\n                    t = [\"90p_1\", \"90p_1\", \"180p_1\"];\n                    break;\n\n                  case \"180p_3\":\n                    t = [\"120p_3\", \"120p_3\", \"180p_3\"];\n                    break;\n\n                  case \"180p_4\":\n                    t = [\"120p_1\", \"120p_1\", \"180p_4\"];\n                    break;\n\n                  case \"240p\":\n                  case \"240p_1\":\n                    t = [\"120p_1\", \"120p_1\", \"240p_1\"];\n                    break;\n\n                  case \"240p_3\":\n                    t = [\"120p_3\", \"120p_3\", \"240p_3\"];\n                    break;\n\n                  case \"240p_4\":\n                    t = [\"120p_4\", \"120p_4\", \"240p_4\"];\n                    break;\n\n                  case \"360p\":\n                  case \"360p_1\":\n                  case \"360p_4\":\n                  case \"360p_9\":\n                  case \"360p_10\":\n                  case \"360p_11\":\n                    t = [\"90p_1\", \"90p_1\", \"360p_1\"];\n                    break;\n\n                  case \"360p_3\":\n                  case \"360p_6\":\n                    t = [\"120p_3\", \"120p_3\", \"360p_3\"];\n                    break;\n\n                  case \"360p_7\":\n                  case \"360p_8\":\n                    t = [\"120p_1\", \"120p_1\", \"360p_7\"];\n                    break;\n\n                  case \"480p\":\n                  case \"480p_1\":\n                  case \"480p_2\":\n                  case \"480p_4\":\n                  case \"480p_10\":\n                    t = [\"120p_1\", \"120p_1\", \"480p_1\"];\n                    break;\n\n                  case \"480p_3\":\n                  case \"480p_6\":\n                    t = [\"120p_3\", \"120p_3\", \"480p_3\"];\n                    break;\n\n                  case \"480p_8\":\n                  case \"480p_9\":\n                    t = [\"120p_4\", \"120p_4\", \"480p_8\"];\n                    break;\n\n                  case \"720p\":\n                  case \"720p_1\":\n                  case \"720p_2\":\n                  case \"720p_3\":\n                    t = [\"90p_1\", \"90p_1\", \"720p_1\"];\n                    break;\n\n                  case \"720p_5\":\n                  case \"720p_6\":\n                    t = [\"120p_1\", \"120p_1\", \"720p_5\"];\n                    break;\n\n                  case \"1080p\":\n                  case \"1080p_1\":\n                  case \"1080p_2\":\n                  case \"1080p_3\":\n                  case \"1080p_5\":\n                    t = [\"90p_1\", \"90p_1\", \"1080p_1\"];\n                    break;\n\n                  case \"1440p\":\n                  case \"1440p_1\":\n                  case \"1440p_2\":\n                    t = [\"90p_1\", \"90p_1\", \"1440p_1\"];\n                    break;\n\n                  case \"4k\":\n                  case \"4k_1\":\n                  case \"4k_3\":\n                    t = [\"90p_1\", \"90p_1\", \"4k_1\"];\n                    break;\n\n                  default:\n                    t = [\"120p_1\", \"120p_1\", \"360p_7\"];\n                }\n\n                return Object(g.isOpera)() ? [e, 15, 50] : Object(g.isFireFox)() ? [t[1], 15, 100] : Object(g.isSafari)() ? [t[2], 15, 50] : [t[0], 15, 50];\n              }(t.highStream.profile));\n\n              try {\n                console.log(a.videoConstraint);\n                var o = Rt()(t.highStream, {\n                  width: a.videoConstraint.width.ideal,\n                  height: a.videoConstraint.height.ideal,\n                  framerate: a.videoConstraint.frameRate.max\n                });\n                return a.stream = o, t.highStream.lowStream = a, t.highStream.userMuteVideo && a.muteVideo(), e && e(a);\n              } catch (e) {\n                return n && n(e);\n              }\n            } else n && n(I.default.HIGH_STREAM_NOT_VIDEO_TRACE);\n          } else n && n(I.default.HIGH_STREAM_NOT_VIDEO_TRACE);\n        } else n && n(I.default.HIGH_STREAM_NOT_VIDEO_TRACE);\n      }, t._publishLowStream = function (e, n) {\n        return 2 !== t.lowStreamState ? n && n(I.default.LOW_STREAM_ALREADY_PUBLISHED) : t.highStream && t.highStream.hasScreen() ? n && n(I.default.SHARING_SCREEN_NOT_SUPPORT) : void t._getLowStream(function (i) {\n          t.lowStreamState = 1, t.gatewayClient.publish(i, {\n            streamType: 1\n          }, function () {\n            t.lowStreamState = 0, e && e();\n          }, function (e) {\n            1 === t.lowStreamState && (t.lowStreamState = 2), o.default.debug(\"[\".concat(t.clientId, \"] publish low stream failed\")), n && n(e);\n          });\n        }, n);\n      }, t._unpublishLowStream = function (e, n) {\n        if (0 !== t.lowStreamState) return n && n(I.default.LOW_STREAM_NOT_YET_PUBLISHED);\n        t.lowStream && (t.gatewayClient.unpublish(t.lowStream, {\n          streamType: 1\n        }, function () {}, function (e) {\n          o.default.debug(\"[\".concat(t.clientId, \"] unpublish low stream failed\")), n && n(e);\n        }), t.lowStream.close(), t.lowStream = null, t.lowStreamState = 2, e && e());\n      }, t.join = function (n, i, a, r, c) {\n        var d = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return c && c(e);\n            r && r(t);\n          },\n          name: \"Client.join\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        if (n && !Object(H.isValidToken)(n)) return o.default.warning(\"[\".concat(t.clientId, \"] Param channelKey should be string\")), d(I.default.INVALID_PARAMETER);\n        if (!Object(H.isValidChannelName)(i)) return o.default.error(\"Invalid Channel Name \".concat(i)), o.default.warning(\"[\".concat(t.clientId, \"] The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,\")), d(I.default.INVALID_PARAMETER);\n        if (\"string\" == typeof i && \"\" === i) return o.default.warning(\"[\".concat(t.clientId, \"] Param channel should not be empty\")), d(I.default.INVALID_PARAMETER);\n        if (a && !Object(F.is32Uint)(a) && !Object(H.isValidString)(a, 1, 255)) return o.default.error(\"Invalid UID \".concat(a, \" \").concat(Se()(a))), o.default.warning(\"[\".concat(t.clientId, \"] [String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]\")), d(I.default.INVALID_PARAMETER);\n        if (\"string\" == typeof a && 0 == a.length) return o.default.warning(\"[\".concat(t.clientId, \"] String uid should not be empty\")), d(I.default.INVALID_PARAMETER);\n        if (\"string\" == typeof a && a.length > 256) return o.default.warning(\"[\".concat(t.clientId, \"] Length of string uid should be less than 255\")), d(I.default.INVALID_PARAMETER);\n        t.highStream = null, t.lowStream = null, t.lowStreamParameter = null, t.isDualStream = !1, t.highStreamState = 2, t.lowStreamState = 2;\n        var u = {\n          clientId: t.clientId,\n          appId: e.appId,\n          sid: e.sessionId,\n          cname: i,\n          uid: a,\n          turnServers: t.turnServers,\n          proxyServer: t.proxyServer,\n          token: n || e.appId,\n          useProxyServer: t.useProxyServer\n        };\n        if (\"string\" == typeof a && (u.stringUid = a, t.uintUid ? (u.uid = t.uintUid, delete t.uintUid) : u.uid = 0), t.aespassword && \"none\" !== t.aesmode && h()(u, {\n          aespassword: t.aespassword,\n          aesmode: t.aesmode\n        }), s.b.sessionInit(e.sessionId, {\n          lts: new Date().getTime(),\n          cname: i,\n          appid: e.appId,\n          mode: e.mode,\n          succ: !0\n        }), t.onSuccess = function (e) {\n          t.rtcStatsCollector.startNetworkQualityTimer(), t.onSuccess = null, d(null, e);\n        }, t.onFailure = function (e) {\n          return d(e);\n        }, t.channel = i, t.gatewayClient.state !== et.DISCONNECTED) return o.default.error(\"[\".concat(t.clientId, \"] Client already in connecting/connected state\")), d(I.default.INVALID_OPERATION), void s.b.joinGateway(e.sessionId, {\n          lts: Date.now(),\n          succ: !1,\n          ec: I.default.INVALID_OPERATION,\n          addr: null\n        });\n        t.gatewayClient.state = et.CONNECTING;\n\n        var l = function (a, r) {\n          o.default.info(\"[\".concat(t.clientId, \"] Joining channel: \").concat(i)), t.gatewayClient.dispatchEvent({\n            type: \"config-distribute\",\n            config: r,\n            joinInfo: u\n          }), t.key = n || e.appId, u.cid = a.cid, u.uid || (u.uid = a.uid), u.vid = a.vid, u.clientId = t.clientId, u.apResponse = a.res, a.uni_lbs_ip && a.uni_lbs_ip[1] && (u.uni_lbs_ip = a.uni_lbs_ip[1]), u.gatewayAddr = a.gateway_addr, t.joinInfo = u, t.gatewayClient.join(u, t.key, function (e) {\n            o.default.info(\"[\".concat(t.clientId, \"] Join channel \").concat(i, \" success, join with uid: \").concat(e, \".\")), t.onSuccess = null, t.rtcStatsCollector.startNetworkQualityTimer(), d(null, e);\n          }, function (e) {\n            return d(e);\n          });\n        };\n\n        u.stringUid && !u.uid ? (t.userAccountReq && !t.userAccountReq.isFinished() && t.userAccountReq.cancel(), t.userAccountReq = Ge(u, t.gatewayClient), t.userAccountReq.then(function (e) {\n          o.default.debug(\"getUserAccount Success \".concat(e.url, \" \").concat(u.stringUid, \" => \").concat(e.uid)), u.uid = e.uid, We(u, l, function (e) {\n            return d(e);\n          });\n        }).catch(function (e) {\n          o.default.error(\"getUserAccount rejected\", e), d(e);\n        })) : We(u, l, function (e) {\n          return d(e);\n        });\n      }, t.renewChannelKey = function (n, i, a) {\n        var r = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n            i && i(t);\n          },\n          name: \"Client.renewChannelKey\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        Object(H.checkValidString)(n, \"key\", 1, 2047), void 0 === t.key ? (o.default.error(\"[\".concat(t.clientId, \"] renewChannelKey should not be called before user join\")), r(I.default.INVALID_OPERATION)) : (t.key = n, t.gatewayClient.joinInfo.token = n, t.gatewayClient.key = n, t.gatewayClient.recover(), r());\n      }, t.leave = function (n, i) {\n        t.gatewayClient.hasInvokeLeave = !0;\n        var a = !1,\n            c = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, a) {\n            if (e) return i && i(e);\n            var r;\n            t.gatewayClient.reconnectingCS = !1, t.gatewayClient.state = et.DISCONNECTED, clearTimeout((r = t.clientId, je[r])), t._renewSession(), t.rtcStatsCollector.clearNetworkQualityTimer(), n && n(a);\n          },\n          name: \"Client.leave\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        o.default.info(\"[\".concat(t.clientId, \"] Leaving channel\")), t.userAccountReq && !t.userAccountReq.isFinished() && (t.userAccountReq.cancel(), t.gatewayClient.state === et.CONNECTING && (t.gatewayClient.state = et.DISCONNECTED)), t.gatewayClient.leave(function (e) {\n          a = !0, c(null, e);\n        }, c), setTimeout(function () {\n          a || (t.gatewayClient.socket && (t.gatewayClient.socket.close(), t.gatewayClient.socket = null), t.gatewayClient.state = et.DISCONNECTED, c(null, \"LEAVE_MSG_TIMEOUT\"));\n        }, Object(r.getParameter)(\"LEAVE_MSG_TIMEOUT\"));\n      }, t._renewSession = function () {\n        var n = Object(F.generateSessionId)();\n        if (o.default.debug(\"renewSession \".concat(e.sessionId, \" => \").concat(n)), e.sessionId = n, t.joinInfo && (t.joinInfo.sid = n), t.gatewayClient && (t.gatewayClient.joinInfo && (t.gatewayClient.joinInfo.sid = n), t.gatewayClient.localStreams)) for (var i in t.gatewayClient.localStreams) {\n          var a = t.gatewayClient.localStreams[i];\n          a && (a.sid = n);\n        }\n      }, t._publish = function (n, i, a, s) {\n        if (2 !== t.highStreamState) return o.default.warning(\"[\".concat(t.clientId, \"] Can't publish stream when stream already publish \").concat(n.getId())), a && a(I.default.STREAM_ALREADY_PUBLISHED);\n        if (0 === t.turnServers.length && Object(r.getParameter)(\"FORCE_TURN\") && !Object(r.getParameter)(\"TURN_ENABLE_TCP\") && !Object(r.getParameter)(\"TURN_ENABLE_UDP\")) throw new Error(\"force TURN With No TURN Configuration\");\n        o.default.info(\"[\".concat(t.clientId, \"] Publishing stream, uid \").concat(n.getId())), t.highStream = n, t.highStreamState = 1, t.highStream.streamId = t.joinInfo.stringUid || t.joinInfo.uid, t.hasPublished = !1;\n\n        var c = function (n, i, a) {\n          t.gatewayClient.publish(n, {\n            streamType: 0\n          }, function () {\n            n.sid = e.sessionId, t.highStreamState = 0, o.default.info(\"[\".concat(t.clientId, \"] Publish success, uid: \").concat(n.getId())), t.highStream && (t.highStream.isDualStream = t.isDualStream), t.isDualStream ? t._publishLowStream(function () {\n              i && i();\n            }, function (e) {\n              o.default.warning(\"[\".concat(t.clientId, \"] \"), e), me.replaceWithCanvasTrack(n), i && i();\n            }) : (me.replaceWithCanvasTrack(n), i && i());\n          }, a);\n        };\n\n        \"audience\" !== t.gatewayClient.role || \"live\" !== t.mode || s ? c(n, i, a) : t.gatewayClient.setClientRole(\"host\", function (e) {\n          if (e) return a && a(e);\n          c(n, i, a);\n        });\n      }, t._unpublish = function (e, n, i, a) {\n        if (0 !== t.highStreamState) return o.default.warning(\"[\".concat(t.clientId, \"] Can't unpublish stream when stream not publish\")), i && i(I.default.STREAM_NOT_YET_PUBLISHED);\n        o.default.info(\"[\".concat(t.clientId, \"] Unpublish stream, uid \").concat(e.getId()));\n\n        var r = function (e, n, i) {\n          t.isDualStream && t.lowStream && t._unpublishLowStream(null, i), t.gatewayClient.unpublish(e, {\n            streamType: 0\n          }, function () {\n            t.highStreamState = 2, o.default.info(\"[\".concat(t.clientId, \"] Unpublish stream success, uid: \").concat(e.getId())), n && n();\n          }, function (n) {\n            o.default.info(\"[\".concat(t.clientId, \"] Unpublish stream fail, uid: \").concat(e.getId())), i && i(n);\n          });\n        };\n\n        \"host\" !== t.gatewayClient.role || \"live\" !== t.mode || a ? r(e, n, i) : t.gatewayClient.setClientRole(\"audience\", function (t) {\n          if (t) return i && i(t);\n          r(e, n, i);\n        });\n      }, t.publish = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, n) {\n            if (e) return 1 === t.highStreamState && (t.highStreamState = 2), i && i(e);\n          },\n          name: \"Client.publish\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            onFailure: !!i\n          }\n        });\n        2 === t.highStreamState ? n._hasVideoTracks() || n._hasAudioTracks() ? t._publish(n, function (e) {\n          return a(null, e);\n        }, function (e) {\n          return a(e);\n        }) : a(I.default.NO_TRACK_IN_STREAM) : a(I.default.STREAM_ALREADY_PUBLISHED);\n      }, t.unpublish = function (n, i, a) {\n        var r = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return i && i(e);\n            a && a(t);\n          },\n          name: \"Client.unpublish\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            onFailure: !!i\n          }\n        });\n        0 === t.highStreamState ? t._unpublish(n, function (e) {\n          return r(null, e);\n        }, function (e) {\n          return r(e);\n        }) : r(I.default.STREAM_NOT_YET_PUBLISHED);\n      }, t.subscribe = function (n, i, a) {\n        var r = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return a && a(e);\n          },\n          name: \"Client.subscribe\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            options: i,\n            onFailure: !!a\n          }\n        });\n        \"function\" == typeof i && (a = i, i = null), Object(H.checkValidObject)(n, \"stream\"), Object(H.isEmpty)(i) || (Object(H.checkValidObject)(i, \"options\"), Object(H.isEmpty)(i.video) || Object(H.checkValidBoolean)(i.video, \"options.video\"), Object(H.isEmpty)(i.audio) || Object(H.checkValidBoolean)(i.audio, \"options.audio\"));\n        var c = {\n          video: !0,\n          audio: !0\n        };\n\n        if (!Object(H.isEmpty)(i)) {\n          if (Object(g.isSafari)() && (!i.video || !i.audio)) {\n            var d = \"SAFARI_NOT_SUPPORTED_FOR_TRACK_SUBSCRIPTION\";\n            return o.default.error(\"[\".concat(t.clientId, \"] \"), d), void r(d);\n          }\n\n          if (!Object(H.isEmpty)(i.video) && !Object(H.isValidBoolean)(i.video) || !Object(H.isEmpty)(i.audio) && !Object(H.isValidBoolean)(i.audio) || !1 === i.audio && !1 === i.video) {\n            d = \"INVALID_PARAMETER \".concat(JSON.stringify(i));\n            return o.default.error(\"[\".concat(t.clientId, \"] \"), d), void r(d);\n          }\n        }\n\n        n.subscribeOptions ? (h()(n.subscribeOptions, c, i), t.gatewayClient.subscribeChange(n, function (e) {\n          return r(null, e);\n        }, r)) : (n.subscribeOptions = h()({}, c, i), t.gatewayClient.subscribe(n, function (e) {\n          return r(null, e);\n        }, r));\n      }, t.unsubscribe = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          callback: function (e, t) {\n            if (e) return i && i(e);\n          },\n          name: \"Client.unsubscribe\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            onFailure: !!i\n          }\n        });\n        o.default.info(\"[\".concat(t.clientId, \"] Unsubscribe stream, uid: \").concat(n.getId())), t.gatewayClient.unsubscribe(n, function (e) {\n          return a(null, e);\n        }, a);\n      }, t.setRemoteVideoStreamType = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setRemoteVideoStreamType\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            streamType: i\n          }\n        });\n        Object(H.checkValidEnum)(i, \"streamType\", [0, 1]), t.gatewayClient.setRemoteVideoStreamType(n, i), a();\n      }, t.setStreamFallbackOption = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.setStreamFallbackOption\",\n          tag: \"tracer\",\n          options: {\n            stream: \"too long to show\",\n            fallbackType: i\n          }\n        });\n        Object(H.checkValidEnum)(i, \"fallbackType\", [0, 1, 2]), t.gatewayClient.setStreamFallbackOption(n, i), a();\n      }, t.enableAudioVolumeIndicator = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.enableAudioVolumeIndicator\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        n = n || 2e3, i = i || 3, Object(H.checkValidNumber)(i, \"smooth\", 1, 100), Object(H.checkValidNumber)(n, \"interval\", 50, 1e5), t.audioVolumeIndication = t.audioVolumeIndication || {\n          enabled: !0\n        }, t.audioVolumeIndication.interval = n, t.audioVolumeIndication.smooth = i, t.audioVolumeIndication = {\n          interval: n,\n          smooth: i\n        }, o.default.info(\"[\".concat(t.clientId, \"] enableAudioVolumeIndicator interval \").concat(n, \" smooth \").concat(i)), t.gatewayClient.enableAudioVolumeIndicator(n, i), a();\n      }, t.getNetworkStats = function (e, n) {\n        return o.default.deprecate(\"[\".concat(t.clientId, \"] client.getNetworkStats is deprecated. Use client.getTransportStats instead.\")), at.getStats(e, n);\n      }, t.getSystemStats = function (e, t) {\n        return v.getStats(e, t);\n      }, t.getRecordingDevices = function (e, t) {\n        return W.getRecordingDevices(e, t);\n      }, t.getPlayoutDevices = function (e, t) {\n        return W.getPlayoutDevices(e, t);\n      }, t.getCameras = function (e, t) {\n        return W.getCameras(e, t);\n      }, t.getRemoteAudioStats = function (e, n) {\n        return t.rtcStatsCollector.getRemoteAudioStats(e, n);\n      }, t.getLocalAudioStats = function (e, n) {\n        return t.rtcStatsCollector.getLocalAudioStats(e, n);\n      }, t.getRemoteVideoStats = function (e, n) {\n        return t.rtcStatsCollector.getRemoteVideoStats(e, n);\n      }, t.getLocalVideoStats = function (e, n) {\n        return t.rtcStatsCollector.getLocalVideoStats(e, n);\n      }, t._getRemoteVideoQualityStats = function (e, n) {\n        return t.rtcStatsCollector.getRemoteVideoQualityStats(e, n);\n      }, t._getRemoteAudioQualityStats = function (e, n) {\n        return t.rtcStatsCollector.getRemoteAudioQualityStats(e, n);\n      }, t.getTransportStats = function (e, n) {\n        return t.rtcStatsCollector.getTransportStats(function (t) {\n          return at.getStats(function (n) {\n            var i = h()({}, t, n);\n            e && e(i);\n          }, n);\n        }, n);\n      }, t.getSessionStats = function (e, n) {\n        return t.rtcStatsCollector.getSessionStats(e, n);\n      }, t.onNetworkQuality = function () {\n        return t.rtcStatsCollector.onNetworkQuality(onSuccess, onFailure);\n      }, t.sendMetadata = function (n, i) {\n        var a = s.b.reportApiInvoke(e.sessionId, {\n          name: \"Client.sendMetadata\",\n          tag: \"tracer\",\n          callback: function (e) {\n            if (e) return i && i(e);\n            i && i();\n          }\n        });\n        t.gatewayClient.sendMetadata(n, a);\n      }, e.clientId = t.clientId, t.gatewayClient = et(e), t.listenerLoggerTimer = null, t.listenerLoggerCache = [], t.on = function (e, n) {\n        t.gatewayClient.on(e, n), t.listenerLoggerCache.push(\"\".concat(e).concat(n.name ? \":\" + n.name : \"\")), t.listenerLoggerTimer ? clearTimeout(t.listenerLoggerTimer) : o.default.info(\"[\".concat(t.clientId, \"] Adding event handler on \").concat(e)), t.listenerLoggerTimer = setTimeout(function () {\n          t.listenerLoggerCache.length && (t.listenerLoggerTimer = null, o.default.info(\"[\".concat(t.clientId, \"] Added event handler on \").concat(t.listenerLoggerCache.join(\", \"))), t.listenerLoggerCache = []);\n        }, 0);\n      }, t.off = function (e, n) {\n        o.default.info(\"remove event handler from [\".concat(e, \"]\")), t.gatewayClient.removeEventListener(e, n);\n      }, t.rtcStatsCollector = function (e) {\n        var t = c();\n        return t.gatewayClient = e, t.exceptionMonitor = new it(e), t.localStats = {}, t.remoteStats = {}, t.session = {\n          sendBytes: 0,\n          recvBytes: 0,\n          WSSendBytes: 0,\n          WSSendBytesDelta: 0,\n          WSRecvBytes: 0,\n          WSRecvBytesDelta: 0,\n          HTTPSendBytes: 0,\n          HTTPSendBytesDelta: 0,\n          HTTPRecvBytes: 0,\n          HTTPRecvBytesDelta: 0\n        }, t.getRemoteAudioStats = function (e) {\n          var n = {};\n\n          for (var i in t.remoteStats) {\n            var a = {},\n                r = t.remoteStats[i];\n            B(a, \"End2EndDelay\", r.peer_delay && r.peer_delay.audio_delay), B(a, \"TransportDelay\", r.peer_delay && r.peer_delay.e2e_delay), B(a, \"PacketLossRate\", r.peer_delay && r.peer_delay.e2e_audio_lost_ratio_400ms), B(a, \"RecvLevel\", r.audioStats && r.audioStats.audioOutputLevel), B(a, \"RecvBitrate\", r.audioRecvBitrate), B(a, \"CodecType\", r.audioStats && r.audioStats.googCodecName), B(a, \"MuteState\", r.audioDisabled), B(a, \"TotalFreezeTime\", r.audioStats && r.audioStats.audioTotalFreezeTime), B(a, \"TotalPlayDuration\", r.audioStats && r.audioStats.audioTotalPlayDuration), n[i] = a;\n          }\n\n          e && e(n);\n        }, t.getLocalAudioStats = function (e) {\n          var n = {};\n\n          for (var i in t.localStats) {\n            var a = {},\n                r = t.localStats[i];\n            B(a, \"RecordingLevel\", r.audioStats && r.audioStats.audioInputLevel), B(a, \"SendLevel\", r.audioStats && r.audioStats.totalAudioEnergy), B(a, \"SamplingRate\", r.audioStats && r.audioStats.totalSamplesDuration), B(a, \"SendBitrate\", r.audioSendBitrate), B(a, \"CodecType\", r.audioStats && r.audioStats.googCodecName), B(a, \"MuteState\", r.audioDisabled), B(a, \"audioSendPacketsLost\", r.audioStats && r.audioStats.packetsLost);\n            var o = t.gatewayClient.localStreams[i];\n            o && o.isPlaying() && B(a, \"MuteState\", o.userMuteAudio ? \"1\" : \"0\"), n[i] = a;\n          }\n\n          e && e(n);\n        }, t.getRemoteVideoStats = function (e) {\n          var n = {};\n\n          for (var i in t.remoteStats) {\n            var a = {},\n                r = t.remoteStats[i];\n            B(a, \"End2EndDelay\", r.peer_delay && r.peer_delay.video_delay), B(a, \"TransportDelay\", r.peer_delay && r.peer_delay.e2e_delay), B(a, \"PacketLossRate\", r.peer_delay && r.peer_delay.e2e_video_lost_ratio_400ms), B(a, \"RecvBitrate\", r.videoRecvBitrate), B(a, \"RecvResolutionWidth\", r.videoStats && r.videoStats.googFrameWidthReceived), B(a, \"RecvResolutionHeight\", r.videoStats && r.videoStats.googFrameHeightReceived), B(a, \"RenderResolutionWidth\", r.videoStats && r.videoStats.renderRemoteWidth), B(a, \"RenderResolutionHeight\", r.videoStats && r.videoStats.renderRemoteHeight), B(a, \"RenderFrameRate\", r.videoStats && r.videoStats.googFrameRateOutput), B(a, \"MuteState\", r.videoDisabled), B(a, \"TotalFreezeTime\", r.videoStats && r.videoStats.videoTotalFreezeTime), B(a, \"TotalPlayDuration\", r.videoStats && r.videoStats.videoTotalPlayDuration), n[i] = a;\n          }\n\n          e && e(n);\n        }, t.getLocalVideoStats = function (e) {\n          var n = {};\n\n          for (var i in t.localStats) {\n            var a = {},\n                r = t.localStats[i];\n            B(a, \"TargetSendBitrate\", r.videoTargetSendBitrate), B(a, \"SendFrameRate\", r.videoStats && r.videoStats.googFrameRateSent), B(a, \"SendBitrate\", r.videoSendBitrate), B(a, \"SendResolutionWidth\", r.videoStats && r.videoStats.googFrameWidthSent), B(a, \"SendResolutionHeight\", r.videoStats && r.videoStats.googFrameHeightSent), B(a, \"CaptureResolutionWidth\", r.videoStats && r.videoStats.googFrameWidthInput), B(a, \"CaptureResolutionHeight\", r.videoStats && r.videoStats.googFrameHeightInput), B(a, \"EncodeDelay\", r.videoStats && r.videoStats.googAvgEncodeMs), B(a, \"MuteState\", r.videoDisabled), B(a, \"TotalFreezeTime\", r.videoStats && r.videoStats.videoTotalFreezeTime), B(a, \"TotalDuration\", r.videoStats && r.videoStats.videoTotalPlayDuration), B(a, \"CaptureFrameRate\", r.videoStats && r.videoStats.googFrameRateSent), B(a, \"videoSendPacketsLost\", r.videoStats && r.videoStats.packetsLost), r.videoStats && !r.videoStats.googFrameWidthInput && B(a, \"CaptureResolutionWidth\", r.videoStats && r.videoStats.renderLocalWidth), r.videoStats && !r.videoStats.googFrameHeightInput && B(a, \"CaptureResolutionHeight\", r.videoStats && r.videoStats.renderLocalHeight), n[i] = a, e && e(n);\n          }\n        }, t.getRemoteVideoQualityStats = function (e) {\n          var n = {};\n\n          for (var i in t.remoteStats) {\n            var a = {},\n                r = t.remoteStats[i];\n            B(a, \"videoReceiveDelay\", r.videoStats && r.videoStats.googCurrentDelayMs), B(a, \"VideoFreezeRate\", r.videoStats && r.videoStats.videoFreezeRate), B(a, \"FirstFrameTime\", r.firstFrameTime), n[i] = a;\n          }\n\n          e && e(n);\n        }, t.getRemoteAudioQualityStats = function (e) {\n          var n = {};\n\n          for (var i in t.remoteStats) {\n            var a = {},\n                r = t.remoteStats[i];\n            B(a, \"audioReceiveDelay\", r.audioStats && r.audioStats.googCurrentDelayMs), B(a, \"AudioFreezeRate\", r.videoStats && r.videoStats.videoFreezeRate), n[i] = a;\n          }\n\n          e && e(n);\n        }, t.getTransportStats = function (e) {\n          var n = {},\n              i = {},\n              a = t.gatewayClient.traffic_stats,\n              r = a.peer_delay;\n\n          if (B(n, \"OutgoingAvailableBandwidth\", t.gatewayClient.OutgoingAvailableBandwidth / 1e3), B(n, \"RTT\", a && 2 * a.access_delay), r) {\n            var o = !0,\n                s = !1,\n                c = void 0;\n\n            try {\n              for (var d, u = r[Symbol.iterator](); !(o = (d = u.next()).done); o = !0) {\n                var l = d.value;\n                l.downlink_estimate_bandwidth && (i[l.peer_uid] = l.downlink_estimate_bandwidth / 1e3 + \"\");\n              }\n            } catch (e) {\n              s = !0, c = e;\n            } finally {\n              try {\n                o || null == u.return || u.return();\n              } finally {\n                if (s) throw c;\n              }\n            }\n          }\n\n          n.IncomingAvailableBandwidth = i, e && e(n);\n        }, t.getSessionStats = function (e) {\n          var n = {},\n              i = t.gatewayClient.traffic_stats,\n              a = t.gatewayClient.socket,\n              r = 0,\n              o = 0;\n\n          for (var s in t.remoteStats) (c = t.remoteStats[s]) && c.videoStats && c.videoStats.videoRecvBytesDelta && (o += parseInt(c.videoStats.videoRecvBytesDelta)), c && c.audioStats && c.audioStats.audioRecvBytesDelta && (o += parseInt(c.audioStats.audioRecvBytesDelta));\n\n          for (var s in t.localStats) {\n            var c;\n            (c = t.localStats[s]) && c.videoStats && c.videoStats.videoSendBytesDelta && (r += parseInt(c.videoStats.videoSendBytesDelta)), c && c.audioStats && c.audioStats.audioSendBytesDelta && (r += parseInt(c.audioStats.audioSendBytesDelta));\n          }\n\n          var d = r + t.session.WSSendBytesDelta + t.session.HTTPSendBytesDelta,\n              u = o + t.session.WSRecvBytesDelta + t.session.HTTPRecvBytesDelta,\n              l = t.session.sendBytes + Object(ke.getHTTPSendBytes)(),\n              f = t.session.recvBytes + Object(ke.getHTTPRecvBytes)();\n          t.gatewayClient.socket && t.gatewayClient.socket.state === t.gatewayClient.CONNECTED && (l += a.getSendBytes(), f += a.getRecvBytes());\n          var p = 1;\n          i.peer_delay && (p = i.peer_delay.length, p += 1), B(n, \"Duration\", a.getDuration()), B(n, \"UserCount\", p), B(n, \"SendBytes\", l), B(n, \"RecvBytes\", f), B(n, \"SendBitrate\", 8 * d / 1e3), B(n, \"RecvBitrate\", 8 * u / 1e3), e && e(n);\n        }, t.isLocalVideoFreeze = function (e, t) {\n          var n = 0,\n              i = 0;\n          if (!e || !t) return !1;\n          if (Object(g.isChrome)() || Object(g.isOpera)()) n = e.googFrameRateInput, i = e.googFrameRateSent;else if (Object(g.isSafari)()) n = parseInt(e.framerateMean), i = parseInt(e.framesEncoded) - parseInt(t.framesEncoded);else {\n            if (!Object(g.isFireFox)()) return !1;\n            n = parseInt(e.framerateMean), i = parseInt(e.framesEncoded) - parseInt(t.framesEncoded);\n          }\n          return n > 5 && i < 3;\n        }, t.isRemoteVideoFreeze = function (e, t) {\n          var n = 0,\n              i = 0;\n          if (!e || !t) return !1;\n          if (Object(g.isChrome)() || Object(g.isOpera)()) n = e.googFrameRateReceived, i = e.googFrameRateDecoded;else if (Object(g.isSafari)()) n = e.framerateMean, i = parseInt(e.framesDecoded) - parseInt(t.framesDecoded);else {\n            if (!Object(g.isFireFox)()) return !1;\n            n = parseInt(e.framesReceived) - parseInt(t.framesReceived), i = parseInt(e.framesDecoded) - parseInt(t.framesDecoded);\n          }\n          return n > 5 && n < 10 && i < 3 || n > 10 && n < 20 && i < 4 || n > 20 && i < 5;\n        }, t.isAudioFreeze = function (e) {\n          if (Object(g.isChrome)() && e) {\n            if (e.googDecodingPLC && e.googDecodingPLCCNG && e.googDecodingCTN) return (parseInt(e.googDecodingPLC) + parseInt(e.googDecodingPLCCNG)) / parseInt(e.googDecodingCTN) > .2;\n          } else if ((Object(g.isSafari)() || Object(g.isFireFox)()) && e.packetsLost && e.packetsReceived) return parseInt(e.packetsLost) / (parseInt(e.packetsLost) + parseInt(e.packetsReceived)) > .2;\n\n          return !1;\n        }, t.isAudioDecodeFailed = function (e) {\n          return !!((Object(g.isChrome)() || Object(g.isOpera)()) && e && parseInt(e.bytesReceived) > 0 && 0 === parseInt(e.googDecodingNormal));\n        }, t.startNetworkQualityTimer = function () {\n          t.clearNetworkQualityTimer(), t.networkQualityTimer = setInterval(function () {\n            if (t.gatewayClient.state !== et.CONNECTED) t.gatewayClient.dispatchEvent({\n              type: \"network-quality\",\n              uplinkNetworkQuality: 0,\n              downlinkNetworkQuality: 0\n            });else {\n              var e = t.gatewayClient.traffic_stats;\n              t.gatewayClient.dispatchEvent({\n                type: \"network-quality\",\n                uplinkNetworkQuality: t.networkQualityTrans(e.uplink_network_quality),\n                downlinkNetworkQuality: t.networkQualityTrans(e.downlink_network_quality)\n              });\n            }\n          }, 2e3);\n        }, t.clearNetworkQualityTimer = function () {\n          t.networkQualityTimer && clearInterval(t.networkQualityTimer);\n        }, t.networkQualityTrans = function (e) {\n          return e >= 0 && e < .17 ? 1 : e >= .17 && e < .36 ? 2 : e >= .36 && e < .59 ? 3 : e >= .59 && e <= 1 ? 4 : e > 1 ? 5 : 0;\n        }, t.getStatsTimer = setInterval(function () {\n          var e = t.gatewayClient.traffic_stats,\n              n = Date.now();\n          t.gatewayClient.dispatchEvent({\n            type: \"_testException\"\n          }), Object.keys(t.localStats).length && t.exceptionMonitor.setLocalStats(t.localStats), Object.keys(t.remoteStats).length && t.exceptionMonitor.setRemoteStats(t.remoteStats);\n          var i = {};\n          Object.keys(t.gatewayClient.remoteStreams).forEach(function (a) {\n            var r = t.gatewayClient.remoteStreams[a],\n                o = t.remoteStats[a],\n                s = {\n              id: a,\n              updatedAt: n\n            };\n            i[a] = s, s.firstFrameTime = r.firstFrameTime, o ? (s.audioTotalPlayDuration = o.audioTotalPlayDuration + 1, s.audioTotalFreezeTime = o.audioTotalFreezeTime, s.isAudioFreeze = !1, s.isAudioDecodeFailed = !1, s.videoTotalPlayDuration = o.videoTotalPlayDuration + 1, s.videoTotalFreezeTime = o.videoTotalFreezeTime, s.isVideoFreeze = !1) : (s.audioTotalPlayDuration = 1, s.audioTotalFreezeTime = 0, s.videoTotalPlayDuration = 1, s.videoTotalFreezeTime = 0);\n            var c = e && e.peer_delay && e.peer_delay.find(function (e) {\n              return e.peer_uid == a;\n            });\n            c && (s.peer_delay = c), r && (r.isPlaying() && (s.audioDisabled = r.userMuteAudio || r.peerMuteAudio ? \"1\" : \"0\", s.videoDisabled = r.userMuteVideo || r.peerMuteVideo ? \"1\" : \"0\"), o && o.peer_delay && c && o.peer_delay.stream_type !== c.stream_type && t.gatewayClient.dispatchEvent({\n              type: \"streamTypeChange\",\n              uid: a,\n              streamType: c.stream_type\n            }), r.pc && \"established\" == r.pc.state && r.pc.getStats(function (e) {\n              if (s.pcStats = e, s.audioStats = e.find(function (e) {\n                return \"audio\" == e.mediaType && (e.id.indexOf(\"_recv\") > -1 || e.id.toLowerCase().indexOf(\"inbound\") > -1);\n              }), s.videoStats = e.find(function (e) {\n                return \"video\" == e.mediaType && (e.id.indexOf(\"_recv\") > -1 || e.id.toLowerCase().indexOf(\"inbound\") > -1);\n              }), o && o.audioStats && s.audioStats) {\n                var n = parseInt(s.audioStats.bytesReceived) - parseInt(o.audioStats.bytesReceived),\n                    i = parseInt(s.audioStats.googDecodingNormal) - parseInt(o.audioStats.googDecodingNormal);\n\n                if (s.audioStats.audioRecvBytesDelta = n, s.audioStats.audioDecodingNormalDelta = i, t.session.recvBytes += n, isFinite(n) && s.audioStats.timestamp) {\n                  var a = s.audioStats.timestamp.getTime() - o.audioStats.timestamp.getTime();\n                  s.audioRecvBitrate = Math.floor(8 * n / a);\n                }\n\n                t.isAudioFreeze(s.audioStats) && s.audioTotalPlayDuration > 10 && (s.audioTotalFreezeTime++, s.isAudioFreeze = !0), t.isAudioDecodeFailed(s.audioStats) && s.audioTotalPlayDuration > 10 && (s.isAudioDecodeFailed = !0), s.audioStats.audioTotalFreezeTime = s.audioTotalFreezeTime, s.audioStats.audioTotalPlayDuration = s.audioTotalPlayDuration, s.audioStats.audioFreezeRate = Math.ceil(100 * s.audioTotalFreezeTime / s.audioTotalPlayDuration);\n              }\n\n              if (o && o.videoStats && s.videoStats) {\n                var c = parseInt(s.videoStats.bytesReceived) - parseInt(o.videoStats.bytesReceived);\n                s.videoStats.videoRecvBytesDelta = c, t.session.recvBytes += c, isFinite(c) && s.videoStats.timestamp && (a = s.videoStats.timestamp.getTime() - o.videoStats.timestamp.getTime(), s.videoRecvBitrate = Math.floor(8 * c / a)), t.isRemoteVideoFreeze(s.videoStats, o.videoStats) && (s.videoTotalFreezeTime++, s.isVideoFreeze = !0), s.videoStats.videoTotalFreezeTime = s.videoTotalFreezeTime, s.videoStats.videoTotalPlayDuration = s.videoTotalPlayDuration, s.videoStats.videoFreezeRate = Math.ceil(100 * s.videoTotalFreezeTime / s.videoTotalPlayDuration), r.player && r.player.video && r.player.video.videoWidth && r.player.video.videoHeight ? (s.videoStats.renderRemoteWidth = r.player.video.videoWidth, s.videoStats.renderRemoteHeight = r.player.video.videoHeight) : (s.videoStats.renderRemoteWidth = r.videoWidth || s.videoStats.googFrameWidthReceived, s.videoStats.renderRemoteHeight = r.videoHeight || s.videoStats.googFrameHeightReceived);\n              }\n            }));\n          }), t.remoteStats = i;\n          var a = {};\n\n          if (Object.keys(t.gatewayClient.localStreams).forEach(function (e) {\n            var i = t.gatewayClient.localStreams[e],\n                r = t.localStats[e],\n                o = {\n              id: e,\n              updatedAt: n\n            };\n            a[e] = o, r ? (o.videoTotalPlayDuration = r.videoTotalPlayDuration + 1, o.videoTotalFreezeTime = r.videoTotalFreezeTime, o.isVideoFreeze = !1) : (o.videoTotalPlayDuration = 1, o.videoTotalFreezeTime = 0), i && (i.isPlaying() && (o.audioDisabled = i.userMuteAudio ? \"1\" : \"0\", o.videoDisabled = i.userMuteVideo ? \"1\" : \"0\"), i.video && i.attributes.maxVideoBW ? o.videoTargetSendBitrate = i.attributes.maxVideoBW : i.video && i.screenAttributes && (o.videoTargetSendBitrate = i.screenAttributes.maxVideoBW), i.pc && \"established\" == i.pc.state && i.pc.getStats(function (e) {\n              if (o.pcStats = e.reverse(), o.audioStats = e.find(function (e) {\n                return \"audio\" == e.mediaType && (e.id.indexOf(\"_send\") > -1 || e.id.toLowerCase().indexOf(\"outbound\") > -1);\n              }), o.videoStats = e.find(function (e) {\n                return \"video\" == e.mediaType && (e.id.indexOf(\"_send\") > -1 || e.id.toLowerCase().indexOf(\"outbound\") > -1);\n              }), o.audioStats && r && r.audioStats) {\n                var n = parseInt(o.audioStats.bytesSent) - parseInt(r.audioStats.bytesSent);\n\n                if (o.audioStats.audioSendBytesDelta = n, t.session.sendBytes += n, isFinite(n) && o.audioStats.timestamp) {\n                  var a = o.audioStats.timestamp.getTime() - r.audioStats.timestamp.getTime();\n                  o.audioSendBitrate = Math.floor(8 * n / a);\n                }\n              }\n\n              if (o.videoStats && r && r.videoStats) {\n                var s = parseInt(o.videoStats.bytesSent) - parseInt(r.videoStats.bytesSent);\n                o.videoStats.videoSendBytesDelta = s, t.session.sendBytes += s, isFinite(s) && o.videoStats.timestamp && (a = o.videoStats.timestamp.getTime() - r.videoStats.timestamp.getTime(), o.videoSendBitrate = Math.floor(8 * s / a)), t.isLocalVideoFreeze(o.videoStats, r.videoStats) && (o.videoTotalFreezeTime++, o.isVideoFreeze = !0), o.videoStats.videoTotalFreezeTime = o.videoTotalFreezeTime, o.videoStats.videoTotalPlayDuration = o.videoTotalPlayDuration, o.videoStats.videoFreezeRate = Math.ceil(100 * o.videoTotalFreezeTime / o.videoTotalPlayDuration), o.videoStats.renderLocalWidth = i.videoWidth || o.videoStats.googFrameWidthSent, o.videoStats.renderLocalHeight = i.videoHeight || o.videoStats.googFrameHeightSent;\n              }\n            }));\n          }), t.localStats = a, t.session.HTTPSendBytesDelta = Object(ke.getHTTPSendBytes)() - t.session.HTTPSendBytes, t.session.HTTPSendBytes = Object(ke.getHTTPSendBytes)(), t.session.HTTPRecvBytesDelta = Object(ke.getHTTPRecvBytes)() - t.session.HTTPRecvBytes, t.session.HTTPRecvBytes = Object(ke.getHTTPRecvBytes)(), t.gatewayClient.socket && t.gatewayClient.socket.state === t.gatewayClient.CONNECTED) {\n            var r = t.gatewayClient.socket;\n            t.session.WSSendBytesDelta = r.getSendBytes() - t.session.WSSendBytes, t.session.WSSendBytes = r.getSendBytes(), t.session.WSRecvBytesDelta = r.getRecvBytes() - t.session.WSRecvBytes, t.session.WSRecvBytes = r.getRecvBytes();\n          }\n        }, 1e3), t.gatewayClient.on(\"join\", function () {\n          t.session = {\n            sendBytes: 0,\n            recvBytes: 0,\n            WSSendBytes: 0,\n            WSSendBytesDelta: 0,\n            WSRecvBytes: 0,\n            WSRecvBytesDelta: 0,\n            HTTPSendBytes: 0,\n            HTTPSendBytesDelta: 0,\n            HTTPRecvBytes: 0,\n            HTTPRecvBytesDelta: 0\n          };\n        }), t;\n      }(t.gatewayClient), t.configDistributManager = function (e) {\n        var t = {};\n        return t.client = e, t.client.gatewayClient && t.client.gatewayClient.on(\"config-distribute\", function (n) {\n          var i = n.joinInfo,\n              a = n.config;\n\n          if (a) {\n            Object(H.isEmpty)(a.uploadLog) || (Object(r.setParameter)(\"UPLOAD_LOG\", a.uploadLog), s.b.reportApiInvoke(i.sid, {\n              name: \"_configDistribute\",\n              options: {\n                feature: \"uploadLog\",\n                value: a.uploadLog\n              }\n            })()), Object(H.isEmpty)(a.dualStream) || (e.isDualStream = a.dualStream, s.b.reportApiInvoke(i.sid, {\n              name: \"_configDistribute\",\n              options: {\n                feature: \"dualStream\",\n                value: a.dualStream\n              }\n            })()), Object(H.isEmpty)(a.streamFallbackOption) || t.client.gatewayClient && t.client.gatewayClient.on(\"stream-subscribed\", function (e) {\n              var n = e.stream;\n              n ? (t.client.gatewayClient.setStreamFallbackOption(n, a.streamFallbackOption), s.b.reportApiInvoke(i.sid, {\n                name: \"_configDistribute\",\n                options: {\n                  feature: \"streamFallbackOption\",\n                  value: a.streamFallbackOption,\n                  streamId: n.getId()\n                }\n              })()) : s.b.reportApiInvoke(i.sid, {\n                name: \"_configDistribute\",\n                options: {\n                  feature: \"streamFallbackOption\",\n                  value: a.streamFallbackOption,\n                  streamId: n.getId(),\n                  err: \"invalid stream\"\n                }\n              })();\n            });\n\n            try {\n              o.default.debug(\"[\".concat(e.clientId, \"] setParameter in distribution: \").concat(JSON.stringify(a))), Object.keys(a).map(function (e) {\n                return Object(r.setParameter)(e, a[e]);\n              });\n            } catch (t) {\n              o.default.debug(\"[\".concat(e.clientId, \"] setParameter in distribution failed: \").concat(JSON.stringify(a)));\n            }\n          }\n        }), t;\n      }(t), function (e, t) {\n        var n = arguments;\n        e.liveStreaming = c(), e.liveStreaming.connections = {\n          inject_streaming: null,\n          mix_streaming: null,\n          raw_streaming: null\n        }, e.liveStreaming.connectionTypes = {\n          inject_streaming: \"pull\",\n          mix_streaming: \"push\",\n          raw_streaming: \"push\"\n        }, e.liveStreaming.pushStates = {}, e.liveStreaming.pullStates = {}, e.gatewayClient.addEventListener(\"join\", function (t) {\n          e.liveStreaming.resumeStates(\"pull\");\n        }), e.gatewayClient.addEventListener(\"stream-unpublished\", function (t) {\n          if (t.options && 0 === t.options.streamType) for (var n in e.liveStreaming.pushStates) {\n            var i = e.liveStreaming.pushStates[n];\n            i.url && e._stopLiveStreaming(i.url, i.transcodingEnabled, !0);\n          }\n        }), e.gatewayClient.addEventListener(\"stream-published\", function (t) {\n          e.liveStreaming.resumeStates(\"push\");\n        }), e.liveStreaming.connect = (g = K()(Y.a.mark(function n(i) {\n          var a, r;\n          return Y.a.wrap(function (n) {\n            for (;;) switch (n.prev = n.next) {\n              case 0:\n                if (e.joinInfo && e.joinInfo.uid && parseInt(e.joinInfo.vid, 10)) {\n                  n.next = 3;\n                  break;\n                }\n\n                throw new Error(\"CLIENT_NOT_JOINED\");\n\n              case 3:\n                return a = new _t({\n                  appId: t.appId,\n                  cname: e.channel,\n                  sid: t.sessionId,\n                  uid: e.joinInfo.uid\n                }), e.liveStreaming.connections[i] = a, n.next = 7, gt({\n                  appId: t.appId,\n                  cname: e.channel,\n                  serviceName: i,\n                  sid: t.sessionId,\n                  uid: e.joinInfo.uid\n                });\n\n              case 7:\n                return r = n.sent, n.next = 10, a.connect({\n                  wsClient: r\n                });\n\n              case 10:\n                return a.on(\"notification\", function (t) {\n                  if (t.serviceName = i, e.liveStreaming.dispatchEvent(t), 503 === t.code) ;else switch (t.serviceName) {\n                    case \"inject_streaming\":\n                      var n = {\n                        reason: t && t.reason,\n                        status: Tt(t && t.code),\n                        type: \"streamInjectedStatus\",\n                        uid: t && t.serverStatus && t.serverStatus.inject_uid,\n                        url: t && t.serverStatus && t.serverStatus.url\n                      };\n                      e.gatewayClient.dispatchEvent(n);\n                      break;\n\n                    case \"raw_streaming\":\n                    case \"mix_streaming\":\n                      var a = {\n                        reason: t && t.reason,\n                        status: t && t.code,\n                        type: t && 200 === t.code ? \"liveStreamingStarted\" : \"liveStreamingFailed\",\n                        uid: t && t.serverStatus && t.uid,\n                        url: t && t.serverStatus && t.serverStatus.url\n                      };\n                      e.gatewayClient.dispatchEvent(a);\n                  }\n                }), a.on(\"close\", function (t) {\n                  Et(a), o.default.debug(\"Reconnect \".concat(i)), e.liveStreaming.connect(i).catch(function (t) {\n                    e.liveStreaming.connections[i] = null, e.gatewayClient.dispatchEvent({\n                      type: \"\".concat(i.replace(\"_\", \"-\"), \"-disconnected\")\n                    });\n                  });\n                }), o.default.debug(\"\".concat(i, \" connected\")), n.abrupt(\"return\", a);\n\n              case 14:\n              case \"end\":\n                return n.stop();\n            }\n          }, n, this);\n        })), function (e) {\n          return g.apply(this, arguments);\n        }), e.liveStreaming.disconnect = (p = K()(Y.a.mark(function t(n) {\n          var i, a;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                t.t0 = Y.a.keys(e.liveStreaming.connections);\n\n              case 1:\n                if ((t.t1 = t.t0()).done) {\n                  t.next = 13;\n                  break;\n                }\n\n                if (i = t.t1.value, !e.liveStreaming.connections.hasOwnProperty(i)) {\n                  t.next = 11;\n                  break;\n                }\n\n                if (!(a = e.liveStreaming.connections[i]) || n && n !== i) {\n                  t.next = 11;\n                  break;\n                }\n\n                return o.default.info(\"Disconnecting liveStreaming \".concat(i)), t.next = 9, a.disconnect();\n\n              case 9:\n                t.sent, e.liveStreaming.connections[i] = null;\n\n              case 11:\n                t.next = 1;\n                break;\n\n              case 13:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this);\n        })), function (e) {\n          return p.apply(this, arguments);\n        }), e.liveStreaming.resumeStates = (f = K()(Y.a.mark(function t(n) {\n          var i, a, r, s, c, d, u, l;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                t.t0 = Y.a.keys(e.liveStreaming.connections);\n\n              case 1:\n                if ((t.t1 = t.t0()).done) {\n                  t.next = 8;\n                  break;\n                }\n\n                if (i = t.t1.value, !n || e.liveStreaming.connectionTypes[i] === n) {\n                  t.next = 5;\n                  break;\n                }\n\n                return t.abrupt(\"continue\", 1);\n\n              case 5:\n                e.liveStreaming.connections.hasOwnProperty(i) && (a = e.liveStreaming.connections[i]) && (o.default.info(\"LiveStreaming closing connection \".concat(i)), a.disconnect(), e.liveStreaming.connections[i] = null), t.next = 1;\n                break;\n\n              case 8:\n                t.t2 = Y.a.keys(e.liveStreaming.pushStates);\n\n              case 9:\n                if ((t.t3 = t.t2()).done) {\n                  t.next = 37;\n                  break;\n                }\n\n                if (r = t.t3.value, !n || \"push\" === n) {\n                  t.next = 13;\n                  break;\n                }\n\n                return t.abrupt(\"continue\", 9);\n\n              case 13:\n                if (!e.liveStreaming.pushStates.hasOwnProperty(r)) {\n                  t.next = 35;\n                  break;\n                }\n\n                if (s = e.liveStreaming.pushStates[r], \"audience\" !== e.gatewayClient.role) {\n                  t.next = 19;\n                  break;\n                }\n\n                o.default.warning(\"Cannot resume LiveStreaming in audience mode. \".concat(s.url), s), t.next = 35;\n                break;\n\n              case 19:\n                if (!s) {\n                  t.next = 35;\n                  break;\n                }\n\n                return o.default.debug(\"Resuming LiveStreaming \".concat(s.url), s), t.prev = 21, t.next = 24, e._startLiveStreaming(s.url, s.transcodingEnabled);\n\n              case 24:\n                c = t.sent, o.default.debug(\"Resumed LiveStreaming \".concat(s.url, \": \").concat(c.reason)), t.next = 35;\n                break;\n\n              case 28:\n                if (t.prev = 28, t.t4 = t.catch(21), 454 !== t.t4.code) {\n                  t.next = 34;\n                  break;\n                }\n\n                o.default.debug(\"Resumed LiveStreaming \".concat(s.url, \": \").concat(t.t4.reason)), t.next = 35;\n                break;\n\n              case 34:\n                throw t.t4;\n\n              case 35:\n                t.next = 9;\n                break;\n\n              case 37:\n                t.t5 = Y.a.keys(e.liveStreaming.pullStates);\n\n              case 38:\n                if ((t.t6 = t.t5()).done) {\n                  t.next = 62;\n                  break;\n                }\n\n                if (d = t.t6.value, !n || \"pull\" === n) {\n                  t.next = 42;\n                  break;\n                }\n\n                return t.abrupt(\"continue\", 38);\n\n              case 42:\n                if (!e.liveStreaming.pullStates.hasOwnProperty(d)) {\n                  t.next = 60;\n                  break;\n                }\n\n                if (u = e.liveStreaming.pullStates[d], \"audience\" !== e.gatewayClient.role) {\n                  t.next = 48;\n                  break;\n                }\n\n                o.default.warning(\"Cannot resume addInjectStreamUrl in audience mode. \".concat(u.url), u), t.next = 60;\n                break;\n\n              case 48:\n                if (!u) {\n                  t.next = 60;\n                  break;\n                }\n\n                return o.default.debug(\"Resuming LiveStreaming pullStream \".concat(u.url), u), t.prev = 50, t.next = 53, e._addInjectStreamUrl(u.url, u.transcodingConfig);\n\n              case 53:\n                l = t.sent, o.default.debug(\"Resumed LiveStreaming pullStream \".concat(u.url, \": \").concat(l.reason)), t.next = 60;\n                break;\n\n              case 57:\n                t.prev = 57, t.t7 = t.catch(50), 451 === t.t7.code && o.default.debug(\"Resumed LiveStreaming pullStream \".concat(u.url, \": \").concat(t.t7.reason));\n\n              case 60:\n                t.next = 38;\n                break;\n\n              case 62:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this, [[21, 28], [50, 57]]);\n        })), function (e) {\n          return f.apply(this, arguments);\n        }), e.liveStreaming.startOptions = {\n          autoDestroyTime: 30\n        }, e.liveStreaming.transcodingConfig = {\n          audioBitrate: 48,\n          audioChannels: 1,\n          audioSampleRate: 48e3,\n          backgroundColor: 0,\n          height: 360,\n          images: [],\n          lowLatency: !1,\n          metadata: \"\",\n          userConfigExtraInfo: \"\",\n          userConfigs: [],\n          videoBitrate: 400,\n          videoCodecProfile: 100,\n          videoCodecType: 1,\n          videoFramerate: 15,\n          videoGop: 30,\n          width: 640\n        }, e.startLiveStreaming = function (n, i) {\n          Object(H.isEmpty)(i) || Object(H.checkValidBoolean)(i, \"transcodingEnabled\"), Object(H.checkValidString)(n, \"url\", 1, 1024);\n          var a = s.b.reportApiInvoke(t.sessionId, {\n            name: \"Client.startLiveStreaming\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n\n          if (e.gatewayClient && \"audience\" === e.gatewayClient.role) {\n            var r = {\n              code: 403,\n              reason: \"AUDIENCE_STREAMING_FORBIDDEN\"\n            };\n            throw a(r), r;\n          }\n\n          var o = e._startLiveStreaming(n, i);\n\n          return o.then(function (e) {\n            a(null, e);\n          }).catch(function (e) {\n            a(e);\n          }), o;\n        }, e._startLiveStreaming = (l = K()(Y.a.mark(function n(i, a) {\n          var r, s, c, d;\n          return Y.a.wrap(function (n) {\n            for (;;) switch (n.prev = n.next) {\n              case 0:\n                return r = h()({\n                  allocate: !0,\n                  clientRequest: {\n                    command: \"PublishStream\"\n                  },\n                  command: \"request\"\n                }), o.default.debug(\"startLiveStreaming \".concat(i, \", \").concat(a)), h()(r.clientRequest, e.liveStreaming.startOptions, {\n                  ts: Date.now(),\n                  url: i,\n                  vid: parseInt(e.joinInfo.vid, 10)\n                }), s = null, a ? (e.liveStreaming.connections.mix_streaming || e.liveStreaming.connect(\"mix_streaming\"), r.clientRequest.transcodingConfig = JSON.parse(JSON.stringify(e.liveStreaming.transcodingConfig)), s = e.liveStreaming.connections.mix_streaming) : (\"vp8\" === t.codec && o.default.warning(\"VP8 is not supported by raw_streaming. Subscriber side will suffer\"), \"rtc\" === t.mode && o.default.warning(\"RTC mode is not supported by raw_streaming. Subscriber side will suffer\"), e.liveStreaming.connections.raw_streaming || e.liveStreaming.connect(\"raw_streaming\"), s = e.liveStreaming.connections.raw_streaming), c = null, d = {}, n.prev = 7, n.next = 10, s.request(r);\n\n              case 10:\n                c = n.sent, d.type = \"liveStreamingStarted\", d.reason = c && c.reason, d.status = c && c.code, d.url = c && c.serverResponse && c.serverResponse.url, e.gatewayClient.dispatchEvent(d), n.next = 26;\n                break;\n\n              case 18:\n                throw n.prev = 18, n.t0 = n.catch(7), d.type = \"liveStreamingFailed\", d.reason = n.t0 && n.t0.reason, d.status = n.t0 && n.t0.code, d.url = n.t0 && n.t0.serverResponse && n.t0.serverResponse.url, e.gatewayClient.dispatchEvent(d), n.t0;\n\n              case 26:\n                return e.liveStreaming.pushStates[i] = {\n                  transcodingEnabled: a,\n                  url: i\n                }, n.abrupt(\"return\", c);\n\n              case 28:\n              case \"end\":\n                return n.stop();\n            }\n          }, n, this, [[7, 18]]);\n        })), function (e, t) {\n          return l.apply(this, arguments);\n        }), e.setLiveTranscoding = function (n, i) {\n          o.default.debug(\"setLiveTranscoding: \".concat(JSON.stringify(n))), Object(H.checkValidObject)(n, \"transcoding\");\n          var a = n,\n              r = a.width,\n              c = a.height,\n              d = a.videoBitrate,\n              u = a.videoFramerate,\n              l = a.lowLatency,\n              f = a.audioSampleRate,\n              p = a.audioBitrate,\n              g = a.audioChannels,\n              m = a.videoGop,\n              v = a.images,\n              S = a.videoCodecProfile,\n              h = a.userCount,\n              _ = a.backgroundColor,\n              E = a.transcodingUsers;\n\n          if (E || (E = n.userConfigs), Object(H.isEmpty)(r) || Object(H.checkValidNumber)(r, \"width\"), Object(H.isEmpty)(c) || Object(H.checkValidNumber)(c, \"height\"), Object(H.isEmpty)(d) || Object(H.checkValidNumber)(d, \"videoBitrate\", 1, 1e6), Object(H.isEmpty)(u) || Object(H.checkValidNumber)(u, \"videoFramerate\"), Object(H.isEmpty)(l) || Object(H.checkValidBoolean)(l, \"lowLatency\"), Object(H.isEmpty)(f) || Object(H.checkValidEnum)(f, \"audioSampleRate\", [32e3, 44100, 48e3]), Object(H.isEmpty)(p) || Object(H.checkValidNumber)(p, \"audioBitrate\", 1, 128), Object(H.isEmpty)(g) || Object(H.checkValidEnum)(g, \"audioChannels\", [1, 2, 3, 4, 5]), Object(H.isEmpty)(m) || Object(H.checkValidNumber)(m, \"videoGop\"), Object(H.isEmpty)(S) || Object(H.checkValidEnum)(S, \"videoCodecProfile\", [66, 77, 100]), Object(H.isEmpty)(h) || Object(H.checkValidNumber)(h, \"userCount\", 0, 17), Object(H.isEmpty)(_) || Object(H.checkValidNumber)(_, \"backgroundColor\", 0, 16777215), !Object(H.isEmpty)(E)) {\n            if (!Object(H.isArray)(E)) throw new Error(\"[transcodingUsers]: transcodingUsers should be Array\");\n            if (E.length > 17) throw new Error(\"The length of transcodingUsers cannot greater than 17\");\n            E.map(function (e, t) {\n              if (!Object(H.isEmpty)(e.uid) && !It(e.uid) && !Object(H.isValidString)(e.uid, 1, 255)) throw new Error(\"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]\");\n              if (Object(H.isEmpty)(e.x) ? e.x = 0 : Object(H.checkValidNumber)(e.x, \"transcodingUser[\".concat(t, \"].x\"), 0, 1e4), Object(H.isEmpty)(e.y) ? e.y = 0 : Object(H.checkValidNumber)(e.y, \"transcodingUser[\".concat(t, \"].y\"), 0, 1e4), Object(H.isEmpty)(e.width) ? e.width = 640 : Object(H.checkValidNumber)(e.width, \"transcodingUser[\".concat(t, \"].width\"), 0, 1e4), Object(H.isEmpty)(e.height) ? e.height = 360 : Object(H.checkValidNumber)(e.height, \"transcodingUser[\".concat(t, \"].height\"), 0, 1e4), Object(H.isEmpty)(e.zOrder) ? e.zOrder = 0 : Object(H.checkValidNumber)(e.zOrder, \"transcodingUser[\".concat(t, \"].zOrder\"), 0, 100), Object(H.isEmpty)(e.alpha)) e.alpha = 1;else if (!(Object(H.isNumber)(e.alpha) && e.alpha <= 1 && e.alpha >= 0)) throw new Error(\"transcodingUser[${index}].alpha: The value range is [0, 1]\");\n            });\n          }\n\n          if (!Object(H.isEmpty)(v)) {\n            if (!Object(H.isArray)(v)) throw new Error(\"[images]: images should be Array\");\n            v.map(function (e, t) {\n              if (Object(H.checkValidString)(e.url, \"images[\".concat(t, \"].url\"), 1, 1024), Object(H.isEmpty)(e.x) ? e.x = 0 : Object(H.checkValidNumber)(e.x, \"images[\".concat(t, \"].x\"), 0, 1e4), Object(H.isEmpty)(e.y) ? e.y = 0 : Object(H.checkValidNumber)(e.y, \"images[\".concat(t, \"].y\"), 0, 1e4), Object(H.isEmpty)(e.width) ? e.width = 160 : Object(H.checkValidNumber)(e.width, \"images[\".concat(t, \"].width\"), 0, 1e4), Object(H.isEmpty)(e.height) ? e.height = 160 : Object(H.checkValidNumber)(e.height, \"images[\".concat(t, \"].height\"), 0, 1e4), Object(H.isEmpty)(e.zOrder) ? e.zOrder = 0 : Object(H.checkValidNumber)(e.zOrder, \"images[\".concat(t, \"].zOrder\"), 0, 100), Object(H.isEmpty)(e.alpha)) e.alpha = 1;else if (!(Object(H.isNumber)(e.alpha) && e.alpha <= 1 && e.alpha >= 0)) throw new Error(\"image[${index}].alpha: The value range is [0, 1]\");\n            });\n          }\n\n          var I = s.b.reportApiInvoke(t.sessionId, {\n            name: \"Client.setLiveTranscoding\",\n            options: arguments,\n            tag: \"tracer\"\n          });\n\n          if ((n = JSON.parse(JSON.stringify(n))).transcodingUsers && (n.userConfigs = n.transcodingUsers, delete n.transcodingUsers), e.joinInfo.stringUid && n.userConfigs && n.userConfigs.length) {\n            var T = [];\n            n.userConfigs.forEach(function (t) {\n              T.push(Ge(e.joinInfo, e.gatewayClient, t.uid).then(function (e) {\n                t.uid = e.uid;\n              }));\n            });\n            var y = Promise.all(T).then(function () {\n              return e._setLiveTranscoding(n, i);\n            });\n            return y.then(function (e) {\n              I(null, e);\n            }).catch(function (e) {\n              I(e);\n            }), y;\n          }\n\n          var b = e._setLiveTranscoding(n, i);\n\n          return b.then(function (e) {\n            I(null, e);\n          }).catch(function (e) {\n            I(e);\n          }), b;\n        }, e._setLiveTranscoding = (u = K()(Y.a.mark(function t(n, i) {\n          var a, r, o;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                if (e.liveStreaming.transcodingConfig = h()(e.liveStreaming.transcodingConfig, n), \"boolean\" != typeof i && (i = !!e.liveStreaming.connections.mix_streaming), a = JSON.parse(JSON.stringify({\n                  allocate: !1,\n                  clientRequest: {\n                    command: \"UpdateTranscoding\",\n                    transcodingConfig: e.liveStreaming.transcodingConfig\n                  },\n                  command: \"request\"\n                })), r = {}, !i) {\n                  t.next = 16;\n                  break;\n                }\n\n                return e.liveStreaming.connections.mix_streaming || e.liveStreaming.connect(\"mix_streaming\"), t.next = 8, e.liveStreaming.connections.mix_streaming.request(a);\n\n              case 8:\n                return o = t.sent, r.type = \"liveTranscodingUpdated\", r.reason = o.reason, r.status = o.code, e.gatewayClient.dispatchEvent(r), t.abrupt(\"return\", o);\n\n              case 16:\n                return t.abrupt(\"return\", {\n                  code: 200,\n                  reason: \"success\"\n                });\n\n              case 17:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this);\n        })), function (e, t) {\n          return u.apply(this, arguments);\n        }), e.stopLiveStreaming = function (n, i) {\n          Object(H.checkValidString)(n, \"url\", 1, 1024);\n\n          var a = s.b.reportApiInvoke(t.sessionId, {\n            name: \"Client.stopLiveStreaming\",\n            options: arguments,\n            tag: \"tracer\"\n          }),\n              r = e._stopLiveStreaming(n, i);\n\n          return r.then(function (e) {\n            a(null, e);\n          }).catch(function (e) {\n            a(e);\n          }), r;\n        }, e._stopLiveStreaming = (d = K()(Y.a.mark(function t(n, i, a) {\n          var r, o, s, c, d, u;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                return r = null, o = e.liveStreaming.pushStates[n], r = o ? o.transcodingEnabled ? \"mix_streaming\" : \"raw_streaming\" : i ? \"mix_streaming\" : \"raw_streaming\", s = {\n                  allocate: !1,\n                  clientRequest: {\n                    command: \"UnpublishStream\",\n                    url: n\n                  },\n                  command: \"request\"\n                }, e.liveStreaming.connections[r] || e.liveStreaming.connect(r), c = null, t.prev = 6, t.next = 9, e.liveStreaming.connections[r].request(s);\n\n              case 9:\n                c = t.sent, (d = {}).type = \"liveStreamingStopped\", d.reason = c && c.reason, d.status = c && c.code, d.url = c && c.serverResponse && c.serverResponse.url, e.gatewayClient.dispatchEvent(d), t.next = 27;\n                break;\n\n              case 18:\n                throw t.prev = 18, t.t0 = t.catch(6), (u = {}).type = \"liveStreamingStopped\", u.reason = t.t0 && t.t0.reason, u.status = t.t0 && t.t0.code, u.url = t.t0 && t.t0.serverResponse && t.t0.serverResponse.url, e.gatewayClient.dispatchEvent(u), t.t0;\n\n              case 27:\n                return a || delete e.liveStreaming.pushStates[n], t.abrupt(\"return\", c);\n\n              case 29:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this, [[6, 18]]);\n        })), function (e, t, n) {\n          return d.apply(this, arguments);\n        }), e.liveStreaming.injectStreamTranscodingConfig = {\n          autoDestroyTime: 30,\n          audioBitrate: 48,\n          audioChannels: 1,\n          audioSampleRate: 44100,\n          height: 0,\n          videoBitrate: 400,\n          videoFramerate: 15,\n          videoGop: 30,\n          width: 0\n        }, e.addInjectStreamUrl = function (i, a) {\n          Object(H.checkValidString)(i, \"url\", 1, 1024), Object(H.checkValidObject)(a, \"config\"), !Object(H.isEmpty)(a && a.width) && Object(H.checkValidNumber)(a.width, \"config.width\", 0, 1e4), !Object(H.isEmpty)(a && a.height) && Object(H.checkValidNumber)(a.height, \"config.height\", 0, 1e4), !Object(H.isEmpty)(a && a.videoGop) && Object(H.checkValidNumber)(a.videoGop, \"config.videoGop\", 1, 1e4), !Object(H.isEmpty)(a && a.videoFramerate) && Object(H.checkValidNumber)(a.videoFramerate, \"config.videoFramerate\", 1, 1e4), !Object(H.isEmpty)(a && a.videoBitrate) && Object(H.checkValidNumber)(a.videoBitrate, \"config.videoBitrate\", 1, 1e4), !Object(H.isEmpty)(a && a.audioSampleRate) && Object(H.checkValidEnum)(a.audioSampleRate, \"config.audioSampleRate\", [32e3, 44100, 48e3]), !Object(H.isEmpty)(a && a.audioBitrate) && Object(H.checkValidNumber)(a.audioBitrate, \"config.audioBitrate\", 1, 1e4), !Object(H.isEmpty)(a && a.audioChannels) && Object(H.checkValidNumber)(a.audioChannels, \"config.audioChannels\", 1, 2);\n          var r = s.b.reportApiInvoke(t.sessionId, {\n            name: \"Client.addInjectStreamUrl\",\n            options: n,\n            tag: \"tracer\"\n          });\n\n          if (\"audience\" === e.gatewayClient.role) {\n            var o = {\n              code: 403,\n              reason: \"AUDIENCE_INJECTING_FORBIDDEN\"\n            };\n            throw r(o), o;\n          }\n\n          var c = e._addInjectStreamUrl(i, a);\n\n          return c.then(function (e) {\n            r(null, e);\n          }).catch(function (e) {\n            r(e);\n          }), c;\n        }, e._addInjectStreamUrl = (r = K()(Y.a.mark(function n(i, a) {\n          var r, o, s, c, d;\n          return Y.a.wrap(function (n) {\n            for (;;) switch (n.prev = n.next) {\n              case 0:\n                return r = h()({}, e.liveStreaming.injectStreamTranscodingConfig, a), o = {\n                  allocate: !0,\n                  clientRequest: {\n                    cname: e.channel,\n                    command: \"InjectStream\",\n                    sid: t.sessionId,\n                    transcodingConfig: r,\n                    ts: Date.now(),\n                    url: i,\n                    vid: parseInt(e.joinInfo.vid, 10)\n                  },\n                  command: \"request\"\n                }, e.liveStreaming.connections.inject_streaming || e.liveStreaming.connect(\"inject_streaming\"), s = null, n.prev = 4, n.next = 7, e.liveStreaming.connections.inject_streaming.request(o);\n\n              case 7:\n                s = n.sent, c = {\n                  reason: s && s.reason,\n                  status: Tt(s && s.code),\n                  type: \"streamInjectedStatus\",\n                  uid: s && s.serverResponse && s.serverResponse.inject_uid,\n                  url: s && s.serverResponse && s.serverResponse.url\n                }, e.gatewayClient.dispatchEvent(c), n.next = 17;\n                break;\n\n              case 12:\n                throw n.prev = 12, n.t0 = n.catch(4), d = {\n                  reason: n.t0 && n.t0.reason,\n                  status: Tt(n.t0 && n.t0.code),\n                  type: \"streamInjectedStatus\",\n                  uid: n.t0 && n.t0.serverResponse && n.t0.serverResponse.inject_uid,\n                  url: n.t0 && n.t0.serverResponse && n.t0.serverResponse.url\n                }, e.gatewayClient.dispatchEvent(d), n.t0;\n\n              case 17:\n                return e.liveStreaming.pullStates[i] = {\n                  transcodingConfig: r,\n                  url: i\n                }, n.abrupt(\"return\", s);\n\n              case 19:\n              case \"end\":\n                return n.stop();\n            }\n          }, n, this, [[4, 12]]);\n        })), function (e, t) {\n          return r.apply(this, arguments);\n        }), e.removeInjectStreamUrl = (a = K()(Y.a.mark(function n(i) {\n          var a,\n              r,\n              o = arguments;\n          return Y.a.wrap(function (n) {\n            for (;;) switch (n.prev = n.next) {\n              case 0:\n                return Object(H.checkValidString)(i, \"url\", 1, 255), a = s.b.reportApiInvoke(t.sessionId, {\n                  name: \"Client.removeInjectStreamUrl\",\n                  options: o,\n                  tag: \"tracer\"\n                }), (r = e._removeInjectStreamUrl(i)).then(function (e) {\n                  a(null, e);\n                }).catch(function (e) {\n                  a(e);\n                }), n.abrupt(\"return\", r);\n\n              case 5:\n              case \"end\":\n                return n.stop();\n            }\n          }, n, this);\n        })), function (e) {\n          return a.apply(this, arguments);\n        }), e._removeInjectStreamUrl = (i = K()(Y.a.mark(function t(n) {\n          var i, a, r, o;\n          return Y.a.wrap(function (t) {\n            for (;;) switch (t.prev = t.next) {\n              case 0:\n                return i = {\n                  allocate: !1,\n                  clientRequest: {\n                    command: \"UninjectStream\",\n                    url: n\n                  },\n                  command: \"request\"\n                }, e.liveStreaming.connections.inject_streaming || e.liveStreaming.connect(\"inject_streaming\"), a = null, t.prev = 3, t.next = 6, e.liveStreaming.connections.inject_streaming.request(i);\n\n              case 6:\n                a = t.sent, r = {\n                  reason: a && a.reason,\n                  status: yt(a && a.code),\n                  type: \"streamInjectedStatus\",\n                  uid: a && a.serverResponse && a.serverResponse.inject_uid,\n                  url: a && a.serverResponse && a.serverResponse.url\n                }, e.gatewayClient.dispatchEvent(r), t.next = 16;\n                break;\n\n              case 11:\n                throw t.prev = 11, t.t0 = t.catch(3), o = {\n                  reason: t.t0 && t.t0.reason,\n                  status: yt(t.t0 && t.t0.code),\n                  type: \"streamInjectedStatus\",\n                  uid: t.t0 && t.t0.serverResponse && t.t0.serverResponse.inject_uid,\n                  url: t.t0 && t.t0.serverResponse && t.t0.serverResponse.url\n                }, e.gatewayClient.dispatchEvent(o), t.t0;\n\n              case 16:\n                return delete e.liveStreaming.pullStates[n], t.abrupt(\"return\", a);\n\n              case 18:\n              case \"end\":\n                return t.stop();\n            }\n          }, t, this, [[3, 11]]);\n        })), function (e) {\n          return i.apply(this, arguments);\n        });\n        var i;\n        var a;\n        var r;\n        var d;\n        var u;\n        var l;\n        var f;\n        var p;\n        var g;\n      }(t, e), Object(H.isEmpty)(e.turnServer) || t.setTurnServer(e.turnServer), Object(H.isEmpty)(e.proxyServer) || t.setProxyServer(e.proxyServer), \"live\" === t.mode && (t.gatewayClient.role = \"audience\"), \"rtc\" === t.mode && (t.gatewayClient.role = \"host\"), t.gatewayClient.on(\"onMultiIP\", function (e) {\n        t.gatewayClient.closeGateway(), t.gatewayClient.socket = void 0, t.gatewayClient.hasChangeBGPAddress = !0, t.joinInfo.multiIP = e.option, t.gatewayClient.state = et.CONNECTING;\n\n        var n = function (e) {\n          o.default.info(\"[\".concat(t.clientId, \"] Joining channel: \").concat(t.channel)), t.joinInfo.cid = e.cid, t.joinInfo.uid || (t.joinInfo.uid = e.uid), t.joinInfo.uni_lbs_ip = e.uni_lbs_ip, t.joinInfo.gatewayAddr = e.gateway_addr, t.onSuccess ? t.gatewayClient.join(t.joinInfo, t.key, function (e) {\n            o.default.info(\"[\".concat(t.clientId, \"] Join channel \").concat(t.channel, \" success\"));\n            var n = t.onSuccess;\n            t.onSuccess = null, t.onFailure = null, n(e);\n          }, t.onFailure) : (t.gatewayClient.joinInfo = h()({}, t.joinInfo), t.gatewayClient.rejoin());\n        };\n\n        t.joinInfo.stringUid && !t.joinInfo.uid ? (t.userAccountReq && !t.userAccountReq.isFinished() && t.userAccountReq.cancel(), t.userAccountReq = Ge(joinInfo, t.gatewayClient), t.userAccountReq.then(function (e) {\n          o.default.error(\"getUserAccount Success \".concat(e.url, \" \").concat(joinInfo.stringUid, \" => \").concat(e.uid)), t.joinInfo.uid = e.uid, We(t.joinInfo, n, t.onFailure);\n        }).catch(function (e) {\n          o.default.error(\"getUserAccount rejected\", e), t.onFailure(e);\n        })) : We(t.joinInfo, n, t.onFailure);\n      }), t.gatewayClient.on(\"rejoin-start\", function () {\n        t._renewSession(), s.b.sessionInit(e.sessionId, {\n          lts: new Date().getTime(),\n          extend: {\n            rejoin: !0\n          },\n          cname: t.channel,\n          appid: e.appId,\n          mode: e.mode,\n          succ: !0\n        });\n      }), t.gatewayClient.on(\"recover\", function () {\n        t._renewSession(), console.log(\"recover\", e.sessionId), s.b.sessionInit(e.sessionId, {\n          lts: new Date().getTime(),\n          extend: {\n            recover: !0\n          },\n          cname: t.channel,\n          appid: e.appId,\n          mode: e.mode,\n          succ: !0\n        });\n      }), t.gatewayClient.on(\"rejoin\", function () {\n        var e = t.highStreamState;\n\n        if (o.default.debug(\"[\".concat(t.clientId, \"] Client local stream preState: \").concat(e)), t.onSuccess) {\n          var n = t.onSuccess;\n          t.onSuccess = null, t.onFailure = null, n(t.joinInfo.uid);\n        }\n\n        !t.highStream || 0 !== e && 1 !== e || (o.default.info(\"[\".concat(t.clientId, \"] publish after rejoin\")), t.highStreamState = 2, t.lowStreamState = 2, t.publish(t.highStream, function (e) {\n          e && o.default.info(\"[\".concat(t.clientId, \"] \"), e);\n        }));\n      }), t.gatewayClient.on(\"streamPublished\", function (e) {\n        t.hasPublished || (t.hasPublished = !0, t.gatewayClient.dispatchEvent(u({\n          type: \"stream-published\",\n          stream: e.stream\n        })));\n      }), t.gatewayClient.on(\"pubP2PLost\", function (e) {\n        o.default.debug(\"[\".concat(t.clientId, \"] Start reconnect local peerConnection: \").concat(t.highStream.getId())), t.gatewayClient.dispatchEvent({\n          type: \"stream-reconnect-start\",\n          uid: t.highStream.getId()\n        }), 1 === t.highStreamState && (t.highStreamState = 0, t.lowStreamState = 0), t._unpublish(t.highStream, function () {\n          t._publish(t.highStream, function () {\n            o.default.debug(\"[\".concat(t.clientId, \"] Reconnect local peerConnection success: \").concat(t.highStream.getId())), t.gatewayClient.dispatchEvent({\n              type: \"stream-reconnect-end\",\n              uid: t.highStream.getId(),\n              success: !0,\n              reason: \"\"\n            });\n          }, function (e) {\n            o.default.debug(\"[\".concat(t.clientId, \"] Reconnect local peerConnection failed: \").concat(e)), t.gatewayClient.dispatchEvent({\n              type: \"stream-reconnect-end\",\n              uid: t.highStream.getId(),\n              success: !1,\n              reason: e\n            });\n          }, !0);\n        }, function (e) {\n          o.default.debug(\"[\".concat(t.clientId, \"] Reconnect local peerConnection failed: \").concat(e)), t.gatewayClient.dispatchEvent({\n            type: \"stream-reconnect-end\",\n            uid: t.highStream.getId(),\n            success: !1,\n            reason: e\n          });\n        }, !0);\n      }), t.gatewayClient.on(\"subP2PLost\", function (e) {\n        o.default.debug(\"[\".concat(t.clientId, \"] Start reconnect remote peerConnection: \").concat(e.stream.getId(), \" \").concat(e.stream.subscribeOptions)), t.gatewayClient.dispatchEvent({\n          type: \"stream-reconnect-start\",\n          uid: e.stream.getId()\n        });\n        var n = e.stream.subscribeOptions;\n        console.log(\"Re-subscribe stream\", n, e.stream), t.gatewayClient.unsubscribe(e.stream, function () {\n          e.stream.subscribeOptions = n, t.gatewayClient.subscribe(e.stream, function () {\n            o.default.debug(\"[\".concat(t.clientId, \"] Reconnect remote peerConnection success: \").concat(e.stream.getId())), t.gatewayClient.dispatchEvent({\n              type: \"stream-reconnect-end\",\n              uid: e.stream.getId(),\n              success: !1,\n              reason: \"\"\n            });\n          }, function (n) {\n            o.default.debug(\"[\".concat(t.clientId, \"] Reconnect remote peerConnection failed: \"), n), t.gatewayClient.dispatchEvent({\n              type: \"stream-reconnect-end\",\n              uid: e.stream.getId(),\n              success: !1,\n              reason: n\n            });\n          });\n        }, function (n) {\n          o.default.debug(\"[\".concat(t.clientId, \"] Reconnect remote peerConnection failed: \"), n), t.gatewayClient.dispatchEvent({\n            type: \"stream-reconnect-end\",\n            uid: e.stream.getId(),\n            success: !1,\n            reason: n\n          });\n        });\n      }), at.on(\"networkTypeChanged\", function (e) {\n        t.gatewayClient && t.gatewayClient.dispatchEvent(e);\n        var n = h()({}, e, {\n          type: \"network-type-changed\"\n        });\n        t.gatewayClient.dispatchEvent(n);\n      }), W.on(\"recordingDeviceChanged\", function (e) {\n        t.gatewayClient && t.gatewayClient.dispatchEvent(e);\n        var n = h()({}, e, {\n          type: \"recording-device-changed\"\n        });\n        t.gatewayClient.dispatchEvent(n);\n      }), W.on(\"playoutDeviceChanged\", function (e) {\n        t.gatewayClient && t.gatewayClient.dispatchEvent(e);\n        var n = h()({}, e, {\n          type: \"playout-device-changed\"\n        });\n        t.gatewayClient.dispatchEvent(n);\n      }), W.on(\"cameraChanged\", function (e) {\n        t.gatewayClient && t.gatewayClient.dispatchEvent(e);\n        var n = h()({}, e, {\n          type: \"camera-changed\"\n        });\n        t.gatewayClient.dispatchEvent(n);\n      }), t.gatewayClient.on(\"streamTypeChange\", function (n) {\n        var i = h()({}, n, {\n          type: \"stream-type-changed\"\n        });\n        t.gatewayClient.dispatchEvent(i), s.b.reportApiInvoke(e.sessionId, {\n          name: \"streamTypeChange\"\n        })(null, JSON.stringify(n));\n      }), t;\n    },\n        Ct = {\n      width: 640,\n      height: 360,\n      videoBitrate: 400,\n      videoFramerate: 15,\n      lowLatency: !1,\n      audioSampleRate: 48e3,\n      audioBitrate: 48,\n      audioChannels: 1,\n      videoGop: 30,\n      videoCodecProfile: 100,\n      userCount: 0,\n      userConfigExtraInfo: {},\n      backgroundColor: 0,\n      transcodingUsers: []\n    },\n        Ot = W.getDevices,\n        Nt = M,\n        wt = JSON.parse(JSON.stringify(r.SUPPORT_RESOLUTION_LIST));\n\n    n.default = {\n      TranscodingUser: {\n        uid: 0,\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n        zOrder: 0,\n        alpha: 1\n      },\n      LiveTranscoding: Ct,\n      createClient: function (e) {\n        var t = s.b.reportApiInvoke(null, {\n          name: \"createClient\",\n          options: arguments,\n          tag: \"tracer\"\n        });\n        (e = h()({}, e || {})).codec || (e.codec = function (e) {\n          switch (e) {\n            case \"h264_interop\":\n              return \"h264\";\n\n            default:\n              return \"vp8\";\n          }\n        }(e.mode));\n\n        var n = function (e) {\n          return -1 === Re.indexOf(e.mode) ? I.default.INVALID_CLIENT_MODE : -1 === Ae.indexOf(e.codec) ? I.default.INVALID_CLIENT_CODEC : \"h264_interop\" == e.mode && \"h264\" !== e.codec && I.default.CLIENT_MODE_CODEC_MISMATCH;\n        }(e);\n\n        if (n) throw o.default.error(\"Invalid parameter setting MODE: \".concat(e.mode, \" CODEC: \").concat(e.codec, \" ERROR \").concat(n)), t(n), new Error(n);\n        return o.default.info(\"Creating client, MODE: \".concat(e.mode, \" CODEC: \").concat(e.codec)), function (e) {\n          switch (e.mode) {\n            case \"interop\":\n            case \"h264_interop\":\n              e.mode = \"live\";\n              break;\n\n            case \"web-only\":\n              e.mode = \"rtc\";\n          }\n        }(e), t(null, e), At(e);\n      },\n      createStream: function (e) {\n        var t = s.b.reportApiInvoke(null, {\n          name: \"createStream\",\n          options: arguments,\n          tag: \"tracer\",\n          getStates: function () {\n            return {\n              audioTrackEnable: e && e.audioSource ? e.audioSource.enabled : null,\n              videoTrackEnable: e && e.videoSource ? e.videoSource.enabled : null\n            };\n          }\n        });\n        Object(H.checkValidObject)(e, \"StreamSpec\");\n        var n = e.streamID,\n            i = e.audio,\n            a = e.video,\n            r = e.screen,\n            c = e.screenAudio,\n            d = (e.audioSource, e.videoSource, e.cameraId),\n            u = e.facingMode,\n            l = e.microphoneId,\n            f = e.mirror,\n            p = e.extensionId,\n            g = e.mediaSource,\n            m = e.audioProcessing;\n        if (!Object(H.isEmpty)(n) && !Object(F.is32Uint)(n) && !Object(H.isValidString)(n, 1, 255)) throw new Error(\"[String streamID] Length of the string: [1,255]. ASCII characters only. [Number streamID] The value range is Uint32\");\n\n        if (Object(H.checkValidBoolean)(i, \"audio\"), Object(H.checkValidBoolean)(a, \"video\"), Object(H.isEmpty)(r) || Object(H.checkValidBoolean)(r, \"screen\"), Object(H.isEmpty)(c) || Object(H.checkValidBoolean)(c, \"screenAudio\"), Object(H.isEmpty)(d) || Object(H.checkValidString)(d, \"cameraId\", 0, 255, !1), Object(H.isEmpty)(u) || Object(H.checkValidEnum)(u, \"facingMode\", [\"user\", \"environment\", \"left\", \"right\"]), Object(H.isEmpty)(l) || Object(H.checkValidString)(l, \"microphoneId\", 0, 255, !1), Object(H.isEmpty)(p) || Object(H.checkValidString)(p, \"extensionId\"), Object(H.isEmpty)(g) || Object(H.checkValidEnum)(g, \"mediaSource\", [\"screen\", \"application\", \"window\"]), Object(H.isEmpty)(f) || Object(H.checkValidBoolean)(f, \"mirror\"), !Object(H.isEmpty)(m)) {\n          var v = m.AGC,\n              S = m.AEC,\n              h = m.ANS;\n          Object(H.isEmpty)(v) || Object(H.checkValidBoolean)(v, \"AGC\"), Object(H.isEmpty)(S) || Object(H.checkValidBoolean)(S, \"AEC\"), Object(H.isEmpty)(h) || Object(H.checkValidBoolean)(h, \"ANS\");\n        }\n\n        o.default.debug(\"Create stream\"), !0 === c && !0 === i && o.default.warning(\"Do not set both 'screenAudio' and 'audio' to true at the same time\");\n\n        var _ = Ie(e);\n\n        return t(), _;\n      },\n      Logger: o.default,\n      report: s.b,\n      getDevices: Ot,\n      getScreenSources: Nt,\n      getParameter: r.getParameter,\n      setParameter: r.setParameter,\n      checkSystemRequirements: function () {\n        var e = s.b.reportApiInvoke(null, {\n          name: \"checkSystemRequirements\",\n          options: arguments,\n          tag: \"tracer\"\n        }),\n            t = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection,\n            n = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.msGetUserMedia || navigator.mozGetUserMedia || navigator.mediaDevices && navigator.mediaDevices.getUserMedia,\n            i = window.WebSocket,\n            a = !!t && !!n && !!i,\n            r = !1;\n        g.isChrome() && g.getBrowserVersion() >= 58 && \"iOS\" !== g.getBrowserOS() && (r = !0), g.isFireFox() && g.getBrowserVersion() >= 56 && (r = !0), g.isOpera() && g.getBrowserVersion() >= 45 && (r = !0), g.isSafari() && g.getBrowserVersion() >= 11 && (r = !0), g.isEdge() && (r = !0), (g.isWeChatBrowser() || g.isQQBrowser()) && \"iOS\" !== g.getBrowserOS() && (r = !0), g.isSupportedPC() || g.isSupportedMobile() || (r = !1), o.default.debug(g.getBrowserInfo(), \"isAPISupport: \" + a + \", isVendorAndVersionSupport: \" + r);\n        var c = a && r;\n        return e(null, c), c;\n      },\n      getSupportedCodec: Te.getSupportedCodec,\n      ChannelMediaRelayConfiguration: ye.ChannelMediaRelayConfiguration,\n      VERSION: r.VERSION,\n      BUILD: r.BUILD,\n      PROFILE_TABLE: wt,\n      AUDIO_SAMPLE_RATE_32000: 32e3,\n      AUDIO_SAMPLE_RATE_44100: 44100,\n      AUDIO_SAMPLE_RATE_48000: 48e3,\n      VIDEO_CODEC_PROFILE_BASELINE: 66,\n      VIDEO_CODEC_PROFILE_MAIN: 77,\n      VIDEO_CODEC_PROFILE_HIGH: 100,\n      REMOTE_VIDEO_STREAM_HIGH: 0,\n      REMOTE_VIDEO_STREAM_LOW: 1,\n      REMOTE_VIDEO_STREAM_MEDIUM: 2\n    };\n  }]).default;\n});","map":null,"metadata":{},"sourceType":"script"}